{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}],
"warnings":[{"warn_data": {"at_line": 650, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "len -= size;", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}], "at_file": "drivers/usb/gadget/function/f_printer.c", "by": "IntegerOverflowDetector says:", "at_func": "printer_write"}, "warn_no": 1},
{"warn_data": {"at_line": 649, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "bytes_copied += size;", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 649, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "bytes_copied += size;"}], "at_file": "drivers/usb/gadget/function/f_printer.c", "by": "IntegerOverflowDetector says:", "at_func": "printer_write"}, "warn_no": 2},
{"warn_data": {"at_line": 643, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(req->buf, buf, size)) {", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 643, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "if (copy_from_user(req->buf, buf, size)) {"}, {"instr_func": "printer_write", "instr_loc": 641, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "spin_unlock_irqrestore(&dev->lock, flags);"}, {"instr_func": "printer_write", "instr_loc": 641, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "spin_unlock_irqrestore(&dev->lock, flags);"}, {"instr_func": "printer_write", "instr_loc": 643, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "if (copy_from_user(req->buf, buf, size)) {"}], "at_file": "drivers/usb/gadget/function/f_printer.c", "by": "TaintedLoopBoundDetector says:", "at_func": "printer_write"}, "warn_no": 3},
{"warn_data": {"at_line": 616, "warn_str": "Loop is bounded by a tainted value.", "at": "while (likely(!list_empty(&dev->tx_reqs)) && len) {", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 616, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "while (likely(!list_empty(&dev->tx_reqs)) && len) {"}, {"instr_func": "printer_write", "instr_loc": 616, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "while (likely(!list_empty(&dev->tx_reqs)) && len) {"}, {"instr_func": "printer_write", "instr_loc": 0, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "  %277 = phi i1 [ false, %272 ], [ %275, %273 ], !dbg !6017"}], "at_file": "drivers/usb/gadget/function/f_printer.c", "by": "TaintedLoopBoundDetector says:", "at_func": "printer_write"}, "warn_no": 4},
{"warn_data": {"at_line": 641, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "spin_unlock_irqrestore(&dev->lock, flags);", "inst_trace": [], "at_file": "drivers/usb/gadget/function/f_printer.c", "by": "TaintedSizeDetector says:", "at_func": "printer_write"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 625, "file": "drivers/usb/gadget/function/f_printer.c", "instr": "list_del_init(&req->list);"}, {"lineno": 204, "file": "./include/linux/list.h", "instr": "  call void @__list_del_entry(%struct.list_head* %3) #12, !dbg !5757"}, {"lineno": 135, "file": "./include/linux/list.h", "instr": "  call void @__list_del(%struct.list_head* %9, %struct.list_head* %12) #12, !dbg !5765"}],
"warnings":[{"warn_data": {"at_line": 113, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile %struct.list_head* %12, %struct.list_head** %14, align 8, !dbg !5767", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 650, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "len -= size;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "__list_del_entry", "instr_loc": 135, "instr_file": "./include/linux/list.h", "instr": "  %9 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !5762"}, {"instr_func": "__list_del_entry", "instr_loc": 135, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_del(%struct.list_head* %9, %struct.list_head* %12) #12, !dbg !5765"}, {"instr_func": "__list_del", "instr_loc": 111, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %0, %struct.list_head** %3, align 8"}, {"instr_func": "__list_del", "instr_loc": 113, "instr_file": "./include/linux/list.h", "instr": "  %13 = load %struct.list_head*, %struct.list_head** %3, align 8, !dbg !5767"}, {"instr_func": "__list_del", "instr_loc": 113, "instr_file": "./include/linux/list.h", "instr": "  %14 = getelementptr inbounds %struct.list_head, %struct.list_head* %13, i32 0, i32 0, !dbg !5767"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_del"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 670, "file": "drivers/usb/gadget/function/f_printer.c", "instr": "list_del(&req->list);"}, {"lineno": 146, "file": "./include/linux/list.h", "instr": "  call void @__list_del_entry(%struct.list_head* %3) #12, !dbg !5757"}, {"lineno": 135, "file": "./include/linux/list.h", "instr": "  call void @__list_del(%struct.list_head* %9, %struct.list_head* %12) #12, !dbg !5765"}],
"warnings":[{"warn_data": {"at_line": 113, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile %struct.list_head* %12, %struct.list_head** %14, align 8, !dbg !5767", "inst_trace": [{"instr_func": "printer_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "printer_write", "instr_loc": 571, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "{"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 621, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "size = len;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "printer_write", "instr_loc": 628, "instr_file": "drivers/usb/gadget/function/f_printer.c", "instr": "req->length = size;"}, {"instr_func": "__list_del_entry", "instr_loc": 135, "instr_file": "./include/linux/list.h", "instr": "  %9 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !5762"}, {"instr_func": "__list_del_entry", "instr_loc": 135, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_del(%struct.list_head* %9, %struct.list_head* %12) #12, !dbg !5765"}, {"instr_func": "__list_del", "instr_loc": 111, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %0, %struct.list_head** %3, align 8"}, {"instr_func": "__list_del", "instr_loc": 113, "instr_file": "./include/linux/list.h", "instr": "  %13 = load %struct.list_head*, %struct.list_head** %3, align 8, !dbg !5767"}, {"instr_func": "__list_del", "instr_loc": 113, "instr_file": "./include/linux/list.h", "instr": "  %14 = getelementptr inbounds %struct.list_head, %struct.list_head* %13, i32 0, i32 0, !dbg !5767"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_del"}, "warn_no": 1}]}]}