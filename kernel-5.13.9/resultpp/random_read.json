{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1840, "file": "drivers/char/random.c", "instr": "ret = wait_for_random_bytes();"}],
"warnings":[{"warn_data": {"at_line": 1617, "warn_str": "Trying to use a global variable without locking.", "at": "if (likely(crng_ready()))", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1840, "instr_file": "drivers/char/random.c", "instr": "ret = wait_for_random_bytes();"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "wait_for_random_bytes"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1840, "file": "drivers/char/random.c", "instr": "ret = wait_for_random_bytes();"}, {"lineno": 1626, "file": "drivers/char/random.c", "instr": "try_to_generate_entropy();"}],
"warnings":[{"warn_data": {"at_line": 1594, "warn_str": "Trying to use a global variable without locking.", "at": "mod_timer(&stack.timer, jiffies+1);", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1840, "instr_file": "drivers/char/random.c", "instr": "ret = wait_for_random_bytes();"}, {"instr_func": "wait_for_random_bytes", "instr_loc": 1626, "instr_file": "drivers/char/random.c", "instr": "try_to_generate_entropy();"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "try_to_generate_entropy"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}],
"warnings":[{"warn_data": {"at_line": 1079, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nbytes -= i;", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "extract_crng_user"}, "warn_no": 1},
{"warn_data": {"at_line": 1062, "warn_str": "Loop is bounded by a tainted value.", "at": "while (nbytes) {", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1062, "instr_file": "drivers/char/random.c", "instr": "while (nbytes) {"}, {"instr_func": "extract_crng_user", "instr_loc": 1062, "instr_file": "drivers/char/random.c", "instr": "while (nbytes) {"}], "at_file": "drivers/char/random.c", "by": "TaintedLoopBoundDetector says:", "at_func": "extract_crng_user"}, "warn_no": 2},
{"warn_data": {"at_line": 1074, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(buf, tmp, i)) {", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1074, "instr_file": "drivers/char/random.c", "instr": "if (copy_to_user(buf, tmp, i)) {"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1074, "instr_file": "drivers/char/random.c", "instr": "if (copy_to_user(buf, tmp, i)) {"}], "at_file": "drivers/char/random.c", "by": "TaintedLoopBoundDetector says:", "at_func": "extract_crng_user"}, "warn_no": 3},
{"warn_data": {"at_line": 1081, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret += i;", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1081, "instr_file": "drivers/char/random.c", "instr": "ret += i;"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "extract_crng_user"}, "warn_no": 4},
{"warn_data": {"at_line": 1073, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);", "inst_trace": [], "at_file": "drivers/char/random.c", "by": "TaintedSizeDetector says:", "at_func": "extract_crng_user"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1072, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}],
"warnings":[{"warn_data": {"at_line": 1011, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1072, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1072, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"lineno": 1016, "file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}],
"warnings":[{"warn_data": {"at_line": 993, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_ready() &&", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1072, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"instr_func": "extract_crng", "instr_loc": 1016, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1072, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"lineno": 1016, "file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"lineno": 996, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}],
"warnings":[{"warn_data": {"at_line": 965, "warn_str": "Trying to use a global variable without locking.", "at": "crng->init_time = jiffies;", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1072, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"instr_func": "extract_crng", "instr_loc": 1016, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"instr_func": "_extract_crng", "instr_loc": 996, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "crng_reseed"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1083, "file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}],
"warnings":[{"warn_data": {"at_line": 1048, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "crng_backtrack_protect"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1083, "file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"lineno": 1053, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}],
"warnings":[{"warn_data": {"at_line": 1030, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "used = round_up(used, sizeof(__u32));", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 1},
{"warn_data": {"at_line": 1030, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "used = round_up(used, sizeof(__u32));", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 2},
{"warn_data": {"at_line": 1031, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (used + CHACHA_KEY_SIZE > CHACHA_BLOCK_SIZE) {", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1031, "instr_file": "drivers/char/random.c", "instr": "if (used + CHACHA_KEY_SIZE > CHACHA_BLOCK_SIZE) {"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 3},
{"warn_data": {"at_line": 1039, "warn_str": "Trying to read from a user pointer.", "at": "*d++ ^= *s++;", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1837, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1039, "instr_file": "drivers/char/random.c", "instr": "*d++ ^= *s++;"}], "at_file": "drivers/char/random.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1843, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1812, "file": "drivers/char/random.c", "instr": "trace_urandom_read(8 * nbytes, 0, ENTROPY_BITS(&input_pool));"}, {"lineno": 205, "file": "./include/trace/events/random.h", "instr": "  %65 = call zeroext i1 @cpu_online(i32 %64) #17, !dbg !8169"}, {"lineno": 895, "file": "./include/linux/cpumask.h", "instr": "  %4 = call i32 @cpumask_test_cpu(i32 %3, %struct.cpumask* @__cpu_online_mask) #17, !dbg !8101"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #17, !dbg !8103"}],
"warnings":[{"warn_data": {"at_line": 115, "warn_str": "Trying to use a global variable without locking.", "at": "  %4 = load i32, i32* @nr_cpu_ids, align 4, !dbg !8101", "inst_trace": [{"instr_func": "random_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "random_read", "instr_loc": 1843, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1812, "instr_file": "drivers/char/random.c", "instr": "trace_urandom_read(8 * nbytes, 0, ENTROPY_BITS(&input_pool));"}, {"instr_func": "trace_urandom_read", "instr_loc": 205, "instr_file": "./include/trace/events/random.h", "instr": "  %65 = call zeroext i1 @cpu_online(i32 %64) #17, !dbg !8169"}, {"instr_func": "cpu_online", "instr_loc": 895, "instr_file": "./include/linux/cpumask.h", "instr": "  %4 = call i32 @cpumask_test_cpu(i32 %3, %struct.cpumask* @__cpu_online_mask) #17, !dbg !8101"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #17, !dbg !8103"}], "at_file": "./include/linux/cpumask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "cpumask_check"}, "warn_no": 1}]}]}