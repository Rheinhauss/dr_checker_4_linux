{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1718, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&features, featurep, sizeof(features)))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1713, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "features = VHOST_NET_BACKEND_FEATURES;", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1702, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "features = VHOST_NET_FEATURES;", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1707, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&features, featurep, sizeof features))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1698, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&backend, argp, sizeof backend))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 5}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}],
"warnings":[{"warn_data": {"at_line": 1550, "warn_str": "Trying to write to a user pointer.", "at": "nvq->rx_ring = get_tap_ptr_ring(fd);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1550, "instr_file": "drivers/vhost/net.c", "instr": "nvq->rx_ring = get_tap_ptr_ring(fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1550, "instr_file": "drivers/vhost/net.c", "instr": "nvq->rx_ring = get_tap_ptr_ring(fd);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 1},
{"warn_data": {"at_line": 1552, "warn_str": "Trying to read from a user pointer.", "at": "oldubufs = nvq->ubufs;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 2},
{"warn_data": {"at_line": 1553, "warn_str": "Trying to write to a user pointer.", "at": "nvq->ubufs = ubufs;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1553, "instr_file": "drivers/vhost/net.c", "instr": "nvq->ubufs = ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1553, "instr_file": "drivers/vhost/net.c", "instr": "nvq->ubufs = ubufs;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 3},
{"warn_data": {"at_line": 1571, "warn_str": "Trying to read from a user pointer.", "at": "sockfd_put(oldsock);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1571, "instr_file": "drivers/vhost/net.c", "instr": "sockfd_put(oldsock);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1571, "instr_file": "drivers/vhost/net.c", "instr": "sockfd_put(oldsock);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1531, "file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}],
"warnings":[{"warn_data": {"at_line": 270, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !12052", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_get_backend"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1540, "file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 427, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 427, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_disable_vq"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1540, "file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"lineno": 428, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_get_backend(vq))"}],
"warnings":[{"warn_data": {"at_line": 270, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !12052", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 428, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_get_backend(vq))"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 428, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_get_backend(vq))"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_get_backend"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1541, "file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, sock);"}],
"warnings":[{"warn_data": {"at_line": 257, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* %5, i8** %7, align 8, !dbg !12056", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1541, "instr_file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, sock);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1541, "instr_file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, sock);"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !12054"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.h", "instr": "  %7 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %6, i32 0, i32 27, !dbg !12055"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_set_backend"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}],
"warnings":[{"warn_data": {"at_line": 190, "warn_str": "Trying to read from a user pointer.", "at": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 1},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 2},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 3},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 4},
{"warn_data": {"at_line": 194, "warn_str": "Trying to write to a user pointer.", "at": "rxq->head = rxq->tail = 0;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 5},
{"warn_data": {"at_line": 194, "warn_str": "Trying to write to a user pointer.", "at": "rxq->head = rxq->tail = 0;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 190, "file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}],
"warnings":[{"warn_data": {"at_line": 166, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail == rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 165, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_is_empty"}, "warn_no": 1},
{"warn_data": {"at_line": 166, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail == rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 165, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_is_empty"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 192, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}],
"warnings":[{"warn_data": {"at_line": 161, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 1},
{"warn_data": {"at_line": 161, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 2},
{"warn_data": {"at_line": 161, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 3}]},
{"num_warnings": 27,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 191, "file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}],
"warnings":[{"warn_data": {"at_line": 520, "warn_str": "Trying to read from a user pointer.", "at": "  %42 = load i32, i32* %41, align 64, !dbg !12107", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 520, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %40 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12105"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 520, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %41 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %40, i32 0, i32 7, !dbg !12107"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 1},
{"warn_data": {"at_line": 527, "warn_str": "Trying to read from a user pointer.", "at": "  %48 = load i32, i32* %47, align 64, !dbg !12111", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %46 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12110"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %47 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %46, i32 0, i32 3, !dbg !12111"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 2},
{"warn_data": {"at_line": 527, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %49 = sub i32 %48, 1, !dbg !12112", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %46 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12110"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %47 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %46, i32 0, i32 3, !dbg !12111"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 3},
{"warn_data": {"at_line": 529, "warn_str": "Trying to read from a user pointer.", "at": "  %64 = load i8**, i8*** %63, align 8, !dbg !12117", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %62 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12116"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %63 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %62, i32 0, i32 9, !dbg !12117"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 4},
{"warn_data": {"at_line": 529, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %66 = add i32 %65, -1, !dbg !12118", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %46 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12110"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %47 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %46, i32 0, i32 3, !dbg !12111"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %49 = sub i32 %48, 1, !dbg !12112"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %49, i32* %18, align 4, !dbg !12113"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %65 = load i32, i32* %18, align 4, !dbg !12118"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 5},
{"warn_data": {"at_line": 529, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* null, i8** %68, align 8, !dbg !12119", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %62 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12116"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %63 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %62, i32 0, i32 9, !dbg !12117"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %68 = getelementptr i8*, i8** %64, i64 %67, !dbg !12116"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 6},
{"warn_data": {"at_line": 528, "warn_str": "Trying to read from a user pointer.", "at": "  %54 = load i32, i32* %53, align 4, !dbg !12115", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %52 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %53 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %52, i32 0, i32 4, !dbg !12115"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 7},
{"warn_data": {"at_line": 528, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %60, label %61, label %69, !dbg !12114", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %46 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12110"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %47 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %46, i32 0, i32 3, !dbg !12111"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %49 = sub i32 %48, 1, !dbg !12112"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %49, i32* %18, align 4, !dbg !12113"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %51 = load i32, i32* %18, align 4, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %55 = icmp sge i32 %51, %54, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %56 = xor i1 %55, true, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %57 = xor i1 %56, true, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %58 = zext i1 %57 to i32, !dbg !12115"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %60 = icmp ne i64 %59, 0, !dbg !12114"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 8},
{"warn_data": {"at_line": 530, "warn_str": "Trying to read from a user pointer.", "at": "  %72 = load i32, i32* %71, align 64, !dbg !12123", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 530, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %70 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12122"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 530, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %71 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %70, i32 0, i32 3, !dbg !12123"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 9},
{"warn_data": {"at_line": 530, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %72, i32* %74, align 4, !dbg !12126", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 530, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %73 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12124"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 530, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %74 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %73, i32 0, i32 4, !dbg !12125"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 10},
{"warn_data": {"at_line": 547, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %121, i32* %123, align 64, !dbg !12165", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 547, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %122 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12165"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 547, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %123 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %122, i32 0, i32 3, !dbg !12165"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 11},
{"warn_data": {"at_line": 544, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %104 = add i32 %103, -1, !dbg !12151", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %15, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %103 = load i32, i32* %15, align 4, !dbg !12151"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 12},
{"warn_data": {"at_line": 544, "warn_str": "Trying to read from a user pointer.", "at": "  %107 = load i8*, i8** %106, align 8, !dbg !12150", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8** %1, i8*** %14, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %102 = load i8**, i8*** %14, align 8, !dbg !12150"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %106 = getelementptr i8*, i8** %102, i64 %105, !dbg !12150"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 13},
{"warn_data": {"at_line": 544, "warn_str": "Trying to read from a user pointer.", "at": "  %110 = load i8**, i8*** %109, align 8, !dbg !12153", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %108 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12152"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %109 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %108, i32 0, i32 9, !dbg !12153"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 14},
{"warn_data": {"at_line": 544, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* %107, i8** %113, align 8, !dbg !12155", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %108 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12152"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %109 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %108, i32 0, i32 9, !dbg !12153"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %113 = getelementptr i8*, i8** %110, i64 %112, !dbg !12152"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 15},
{"warn_data": {"at_line": 545, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %114, i32* %116, align 4, !dbg !12159", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 545, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %115 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12157"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 545, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %116 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %115, i32 0, i32 4, !dbg !12158"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 16},
{"warn_data": {"at_line": 540, "warn_str": "Trying to read from a user pointer.", "at": "  %94 = load i8**, i8*** %93, align 8, !dbg !12145", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %92 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12143"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %93 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %92, i32 0, i32 9, !dbg !12145"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 17},
{"warn_data": {"at_line": 540, "warn_str": "Trying to read from a user pointer.", "at": "  %98 = load i8*, i8** %97, align 8, !dbg !12143", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %92 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12143"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %93 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %92, i32 0, i32 9, !dbg !12145"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %97 = getelementptr i8*, i8** %94, i64 %96, !dbg !12143"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 18},
{"warn_data": {"at_line": 540, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %99, label %100, label %101, !dbg !12147", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %92 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12143"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %93 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %92, i32 0, i32 9, !dbg !12145"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %97 = getelementptr i8*, i8** %94, i64 %96, !dbg !12143"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 540, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %99 = icmp ne i8* %98, null, !dbg !12143"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 19},
{"warn_data": {"at_line": 539, "warn_str": "Trying to read from a user pointer.", "at": "  %89 = load i32, i32* %88, align 64, !dbg !12139", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %87 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12138"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %88 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %87, i32 0, i32 7, !dbg !12139"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 20},
{"warn_data": {"at_line": 539, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %90 = sub i32 %89, 1, !dbg !12140", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %87 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12138"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %88 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %87, i32 0, i32 7, !dbg !12139"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 21},
{"warn_data": {"at_line": 537, "warn_str": "Trying to read from a user pointer.", "at": "  %81 = load i32, i32* %80, align 64, !dbg !12131", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 537, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %79 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12129"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 537, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %80 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %79, i32 0, i32 3, !dbg !12131"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 22},
{"warn_data": {"at_line": 537, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %82 = sub i32 %81, 1, !dbg !12132", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %13, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 537, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %79 = load %struct.ptr_ring*, %struct.ptr_ring** %13, align 8, !dbg !12129"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 537, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %80 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %79, i32 0, i32 3, !dbg !12131"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 23},
{"warn_data": {"at_line": 536, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %77, label %78, label %126, !dbg !12127", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %15, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %103 = load i32, i32* %15, align 4, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %104 = add i32 %103, -1, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %104, i32* %15, align 4, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %76 = load i32, i32* %15, align 4, !dbg !12128"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %77 = icmp ne i32 %76, 0, !dbg !12127"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 24},
{"warn_data": {"at_line": 553, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %135 = add i32 %134, -1, !dbg !12175", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %15, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 553, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %134 = load i32, i32* %15, align 4, !dbg !12175"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 25},
{"warn_data": {"at_line": 553, "warn_str": "Trying to read from a user pointer.", "at": "  %138 = load i8*, i8** %137, align 8, !dbg !12174", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8** %1, i8*** %14, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 553, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %133 = load i8**, i8*** %14, align 8, !dbg !12174"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 553, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %137 = getelementptr i8*, i8** %133, i64 %136, !dbg !12174"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 26},
{"warn_data": {"at_line": 552, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %130, label %131, label %139, !dbg !12171", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 513, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %15, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %103 = load i32, i32* %15, align 4, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %104 = add i32 %103, -1, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %104, i32* %15, align 4, !dbg !12151"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 552, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %129 = load i32, i32* %15, align 4, !dbg !12172"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 552, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %130 = icmp ne i32 %129, 0, !dbg !12171"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 27}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 438, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 438, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 1},
{"warn_data": {"at_line": 445, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_poll_start(poll, sock->file);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 445, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 445, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 441, "file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}],
"warnings":[{"warn_data": {"at_line": 270, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !12052", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_get_backend"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1563, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"lineno": 265, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}],
"warnings":[{"warn_data": {"at_line": 260, "warn_str": "Trying to read from a user pointer.", "at": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_ubuf_put_and_wait"}, "warn_no": 1},
{"warn_data": {"at_line": 260, "warn_str": "Trying to read from a user pointer.", "at": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_ubuf_put_and_wait"}, "warn_no": 2},
{"warn_data": {"at_line": 260, "warn_str": "Loop is bounded by a tainted value.", "at": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_net_ubuf_put_and_wait"}, "warn_no": 3}]},
{"num_warnings": 21,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 366, "warn_str": "Trying to read from a user pointer.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 1},
{"warn_data": {"at_line": 366, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 2},
{"warn_data": {"at_line": 370, "warn_str": "Trying to read from a user pointer.", "at": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 3},
{"warn_data": {"at_line": 370, "warn_str": "Trying to write to a user pointer.", "at": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 4},
{"warn_data": {"at_line": 369, "warn_str": "Trying to read from a user pointer.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 5},
{"warn_data": {"at_line": 369, "warn_str": "Trying to read from a user pointer.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 6},
{"warn_data": {"at_line": 369, "warn_str": "Loop is bounded by a tainted value.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 7},
{"warn_data": {"at_line": 367, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 8},
{"warn_data": {"at_line": 367, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 9},
{"warn_data": {"at_line": 366, "warn_str": "Trying to read from a user pointer.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 10},
{"warn_data": {"at_line": 366, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 11},
{"warn_data": {"at_line": 377, "warn_str": "Trying to read from a user pointer.", "at": "vhost_add_used_and_signal_n(vq->dev, vq,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 12},
{"warn_data": {"at_line": 379, "warn_str": "Trying to write to a user pointer.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 13},
{"warn_data": {"at_line": 378, "warn_str": "Trying to read from a user pointer.", "at": "&vq->heads[nvq->done_idx], add);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 14},
{"warn_data": {"at_line": 378, "warn_str": "Trying to read from a user pointer.", "at": "&vq->heads[nvq->done_idx], add);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 15},
{"warn_data": {"at_line": 379, "warn_str": "Trying to read from a user pointer.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 16},
{"warn_data": {"at_line": 379, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 17},
{"warn_data": {"at_line": 376, "warn_str": "Trying to read from a user pointer.", "at": "add = min(UIO_MAXIOV - nvq->done_idx, j);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 18},
{"warn_data": {"at_line": 376, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "add = min(UIO_MAXIOV - nvq->done_idx, j);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 19},
{"warn_data": {"at_line": 380, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "j -= add;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 20},
{"warn_data": {"at_line": 375, "warn_str": "Loop is bounded by a tainted value.", "at": "while (j) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 375, "instr_file": "drivers/vhost/net.c", "instr": "while (j) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 375, "instr_file": "drivers/vhost/net.c", "instr": "while (j) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 21}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1578, "file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, oldsock);"}],
"warnings":[{"warn_data": {"at_line": 257, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* %5, i8** %7, align 8, !dbg !12056", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1578, "instr_file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, oldsock);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1578, "instr_file": "drivers/vhost/net.c", "instr": "vhost_vq_set_backend(vq, oldsock);"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !12054"}, {"instr_func": "vhost_vq_set_backend", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.h", "instr": "  %7 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %6, i32 0, i32 27, !dbg !12055"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_set_backend"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 438, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 438, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 1},
{"warn_data": {"at_line": 445, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_poll_start(poll, sock->file);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 445, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 445, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1700, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 441, "file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}],
"warnings":[{"warn_data": {"at_line": 270, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !12052", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1698, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1700, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 441, "instr_file": "drivers/vhost/net.c", "instr": "sock = vhost_vq_get_backend(vq);"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 269, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !12051"}, {"instr_func": "vhost_vq_get_backend", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 27, !dbg !12052"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_get_backend"}, "warn_no": 1}]}]}