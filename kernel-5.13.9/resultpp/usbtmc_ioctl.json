{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2154, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc488_ioctl_simple(data, (void __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 665, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rv = copy_from_user(&val, arg, sizeof(val));", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc488_ioctl_simple"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2149, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc488_ioctl_simple(data, (void __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 665, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rv = copy_from_user(&val, arg, sizeof(val));", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc488_ioctl_simple"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2144, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc488_ioctl_simple(data, (void __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 665, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rv = copy_from_user(&val, arg, sizeof(val));", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc488_ioctl_simple"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2119, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_read(file_data,"}],
"warnings":[{"warn_data": {"at_line": 1050, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_generic_read"}, "warn_no": 1}]},
{"num_warnings": 15,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2119, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_read(file_data,"}, {"lineno": 1059, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}],
"warnings":[{"warn_data": {"at_line": 852, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "roundup(max_transfer_size + 1 - bufsize,", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 1},
{"warn_data": {"at_line": 852, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "roundup(max_transfer_size + 1 - bufsize,", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 2},
{"warn_data": {"at_line": 852, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "roundup(max_transfer_size + 1 - bufsize,", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 3},
{"warn_data": {"at_line": 847, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "max_transfer_size += (data->wMaxPacketSize - 1);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 847, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size += (data->wMaxPacketSize - 1);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 4},
{"warn_data": {"at_line": 883, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 5},
{"warn_data": {"at_line": 885, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "bufcount -= file_data->in_urbs_used;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 885, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount -= file_data->in_urbs_used;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 6},
{"warn_data": {"at_line": 889, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (bufcount + file_data->in_urbs_used > MAX_URBS_IN_FLIGHT) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 889, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (bufcount + file_data->in_urbs_used > MAX_URBS_IN_FLIGHT) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 7},
{"warn_data": {"at_line": 925, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "bufcount--;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 925, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount--;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 8},
{"warn_data": {"at_line": 900, "warn_str": "Loop is bounded by a tainted value.", "at": "while (bufcount > 0) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 851, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size ="}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 883, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount = roundup(max_transfer_size, bufsize) / bufsize;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 885, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount -= file_data->in_urbs_used;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 885, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount -= file_data->in_urbs_used;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 885, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "bufcount -= file_data->in_urbs_used;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 900, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (bufcount > 0) {"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 900, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (bufcount > 0) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 9},
{"warn_data": {"at_line": 997, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "remaining -= this_part;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 997, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 10},
{"warn_data": {"at_line": 998, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "done += this_part;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 998, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "done += this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 11},
{"warn_data": {"at_line": 978, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "max_transfer_size -= urb->actual_length;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 978, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size -= urb->actual_length;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 12},
{"warn_data": {"at_line": 938, "warn_str": "Loop is bounded by a tainted value.", "at": "while (max_transfer_size > 0) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 938, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (max_transfer_size > 0) {"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 938, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (max_transfer_size > 0) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 13},
{"warn_data": {"at_line": 990, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(user_buffer + done,", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1050, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1060, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_read", "instr_loc": 1059, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_read(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 822, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 838, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size = transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 852, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "roundup(max_transfer_size + 1 - bufsize,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 851, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "max_transfer_size ="}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 855, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = max_transfer_size;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 985, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 991, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "urb->transfer_buffer, this_part)) {"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 991, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "urb->transfer_buffer, this_part)) {"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 990, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_to_user(user_buffer + done,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 990, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_to_user(user_buffer + done,"}, {"instr_func": "usbtmc_generic_read", "instr_loc": 990, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_to_user(user_buffer + done,"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 14},
{"warn_data": {"at_line": 990, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(user_buffer + done,", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_generic_read"}, "warn_no": 15}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2104, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_eom_enable(file_data,"}],
"warnings":[{"warn_data": {"at_line": 2012, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_eom_enable"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}],
"warnings":[{"warn_data": {"at_line": 1261, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_generic_write"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}],
"warnings":[{"warn_data": {"at_line": 1223, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "remaining -= this_part;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1271, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1270, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1223, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1224, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "done += this_part;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1271, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1270, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1224, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "done += this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1201, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "aligned = (this_part + 3) & ~3;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1271, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1270, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1201, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "aligned = (this_part + 3) & ~3;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1149, "warn_str": "Loop is bounded by a tainted value.", "at": "while (remaining > 0) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1271, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1270, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1149, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (remaining > 0) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1149, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (remaining > 0) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 4},
{"warn_data": {"at_line": 1189, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(buffer, user_buffer + done, this_part)) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1271, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "msg.transfer_size, &msg.transferred,"}, {"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1270, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 5},
{"warn_data": {"at_line": 1189, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buffer, user_buffer + done, this_part)) {", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2109, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_config_termc(file_data,"}],
"warnings":[{"warn_data": {"at_line": 2031, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_config_termc"}, "warn_no": 1}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 472, "warn_str": "Trying to read from a user pointer.", "at": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 1},
{"warn_data": {"at_line": 478, "warn_str": "Loop is bounded by a tainted value.", "at": "if (sg->length % max)", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 2},
{"warn_data": {"at_line": 445, "warn_str": "Trying to read from a user pointer.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 3},
{"warn_data": {"at_line": 445, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 4},
{"warn_data": {"at_line": 446, "warn_str": "Trying to read from a user pointer.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 5},
{"warn_data": {"at_line": 446, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 6},
{"warn_data": {"at_line": 452, "warn_str": "Trying to read from a user pointer.", "at": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 7},
{"warn_data": {"at_line": 456, "warn_str": "Trying to read from a user pointer.", "at": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 8},
{"warn_data": {"at_line": 493, "warn_str": "Trying to read from a user pointer.", "at": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\",", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 9},
{"warn_data": {"at_line": 467, "warn_str": "Loop is bounded by a tainted value.", "at": "if (len < 0 || len > max)", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i16, i16* %4, align 1, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 2047, !dbg !70483"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 10}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 401, "file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 411, "file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 506, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 505, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_dir_out.662"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 425, "file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 649, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i16, i16* %4, align 1, !dbg !70482", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !70482"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp.663"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 461, "file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 661, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i16, i16* %5, align 1, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 1},
{"warn_data": {"at_line": 663, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %18 = add i32 %17, 1, !dbg !70487", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %6 = load i16, i16* %5, align 1, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = zext i16 %6 to i32, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store i32 %7, i32* %3, align 4, !dbg !70483"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %12 = and i32 %8, 6144, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %17 = ashr i32 %12, 11, !dbg !70485"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "IntegerOverflowDetector says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}],
"warnings":[{"warn_data": {"at_line": 210, "warn_str": "Trying to read from a user pointer.", "at": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_pipe_type_check"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}, {"lineno": 210, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2114, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_generic_write(file_data,"}, {"lineno": 1270, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, msg.message,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 427, "file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}],
"warnings":[{"warn_data": {"at_line": 471, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_ioctl_generic_write", "instr_loc": 1261, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 470, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_num.664"}, "warn_no": 1}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2090, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_request(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1917, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 1},
{"warn_data": {"at_line": 1932, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 2},
{"warn_data": {"at_line": 1932, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 3},
{"warn_data": {"at_line": 1932, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 4},
{"warn_data": {"at_line": 1932, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 5},
{"warn_data": {"at_line": 1932, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}, {"instr_func": "usbtmc_ioctl_request", "instr_loc": 1932, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "buffer = kmalloc(request.req.wLength, GFP_KERNEL);"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 6},
{"warn_data": {"at_line": 1938, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "res = copy_from_user(buffer, request.data,", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 7},
{"warn_data": {"at_line": 1962, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "res = copy_to_user(request.data, buffer, rv);", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_ioctl_request"}, "warn_no": 8}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2090, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_ioctl_request(data, (void __user *)arg);"}, {"lineno": 1947, "file": "drivers/usb/class/usbtmc.c", "instr": "rv = usb_control_msg(data->usb_dev,"}, {"lineno": 153, "file": "drivers/usb/core/message.c", "instr": "ret = usb_internal_control_msg(dev, pipe, dr, data, size, timeout);"}, {"lineno": 102, "file": "drivers/usb/core/message.c", "instr": "retv = usb_start_wait_urb(urb, timeout, &length);"}, {"lineno": 58, "file": "drivers/usb/core/message.c", "instr": "retval = usb_submit_urb(urb, GFP_NOIO);"}],
"warnings":[{"warn_data": {"at_line": 472, "warn_str": "Trying to read from a user pointer.", "at": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1938, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "res = copy_from_user(buffer, request.data,"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 1},
{"warn_data": {"at_line": 478, "warn_str": "Loop is bounded by a tainted value.", "at": "if (sg->length % max)", "inst_trace": [{"instr_func": "usbtmc_ioctl_request", "instr_loc": 1917, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 2}]}]}