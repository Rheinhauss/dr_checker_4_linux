{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.file*, align 8"}, {"lineno": 335, "file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}],
"warnings":[{"warn_data": {"at_line": 315, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = min(event->v[i].size, count - total);", "inst_trace": [{"instr_func": "fw_device_op_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.file*, align 8"}, {"instr_func": "fw_device_op_read", "instr_loc": 332, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "dequeue_event", "instr_loc": 293, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}], "at_file": "drivers/firewire/core-cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "dequeue_event"}, "warn_no": 1},
{"warn_data": {"at_line": 320, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "total += size;", "inst_trace": [{"instr_func": "fw_device_op_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.file*, align 8"}, {"instr_func": "fw_device_op_read", "instr_loc": 332, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "dequeue_event", "instr_loc": 293, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 320, "instr_file": "drivers/firewire/core-cdev.c", "instr": "total += size;"}], "at_file": "drivers/firewire/core-cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "dequeue_event"}, "warn_no": 2},
{"warn_data": {"at_line": 314, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < ARRAY_SIZE(event->v) && total < count; i++) {", "inst_trace": [{"instr_func": "fw_device_op_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.file*, align 8"}, {"instr_func": "fw_device_op_read", "instr_loc": 332, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "dequeue_event", "instr_loc": 293, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "dequeue_event", "instr_loc": 314, "instr_file": "drivers/firewire/core-cdev.c", "instr": "for (i = 0; i < ARRAY_SIZE(event->v) && total < count; i++) {"}, {"instr_func": "dequeue_event", "instr_loc": 314, "instr_file": "drivers/firewire/core-cdev.c", "instr": "for (i = 0; i < ARRAY_SIZE(event->v) && total < count; i++) {"}, {"instr_func": "dequeue_event", "instr_loc": 0, "instr_file": "drivers/firewire/core-cdev.c", "instr": "  %142 = phi i1 [ false, %136 ], [ %140, %137 ], !dbg !5712"}], "at_file": "drivers/firewire/core-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dequeue_event"}, "warn_no": 3},
{"warn_data": {"at_line": 316, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(buffer + total, event->v[i].data, size)) {", "inst_trace": [{"instr_func": "fw_device_op_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.file*, align 8"}, {"instr_func": "fw_device_op_read", "instr_loc": 332, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "fw_device_op_read", "instr_loc": 335, "instr_file": "drivers/firewire/core-cdev.c", "instr": "return dequeue_event(client, buffer, count);"}, {"instr_func": "dequeue_event", "instr_loc": 293, "instr_file": "drivers/firewire/core-cdev.c", "instr": "{"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 316, "instr_file": "drivers/firewire/core-cdev.c", "instr": "if (copy_to_user(buffer + total, event->v[i].data, size)) {"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 315, "instr_file": "drivers/firewire/core-cdev.c", "instr": "size = min(event->v[i].size, count - total);"}, {"instr_func": "dequeue_event", "instr_loc": 316, "instr_file": "drivers/firewire/core-cdev.c", "instr": "if (copy_to_user(buffer + total, event->v[i].data, size)) {"}], "at_file": "drivers/firewire/core-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dequeue_event"}, "warn_no": 4},
{"warn_data": {"at_line": 315, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "size = min(event->v[i].size, count - total);", "inst_trace": [], "at_file": "drivers/firewire/core-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "dequeue_event"}, "warn_no": 5}]}]}