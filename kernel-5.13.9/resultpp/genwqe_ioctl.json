{"all_contexts":[
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1202, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct genwqe_mem m;", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1193, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct genwqe_mem m;", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1183, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = do_flash_read(cfile, &load);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1180, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1159, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&load, (void __user *)arg,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1163, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = do_flash_update(cfile, &load);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1219, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}],
"warnings":[{"warn_data": {"at_line": 1022, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 1},
{"warn_data": {"at_line": 1034, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, cmd,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1219, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}, {"lineno": 1028, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 1001, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}],
"warnings":[{"warn_data": {"at_line": 937, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "page_offs = (u_addr -", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1022, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 938, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u64)m->u_vaddr)/PAGE_SIZE;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ddcb_cmd_fixups"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1212, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}],
"warnings":[{"warn_data": {"at_line": 1022, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 1},
{"warn_data": {"at_line": 1034, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, cmd,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1212, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}, {"lineno": 1028, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 1001, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}],
"warnings":[{"warn_data": {"at_line": 937, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "page_offs = (u_addr -", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1022, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 938, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u64)m->u_vaddr)/PAGE_SIZE;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ddcb_cmd_fixups"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1207, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_unpin_mem(cfile, &m);"}],
"warnings":[{"warn_data": {"at_line": 814, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 1},
{"warn_data": {"at_line": 814, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 2},
{"warn_data": {"at_line": 814, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 814, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1207, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_unpin_mem(cfile, &m);"}, {"lineno": 816, "file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}],
"warnings":[{"warn_data": {"at_line": 106, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 1},
{"warn_data": {"at_line": 105, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 2},
{"warn_data": {"at_line": 110, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1202, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 813, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 816, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 110, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1198, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}],
"warnings":[{"warn_data": {"at_line": 784, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1193, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 1},
{"warn_data": {"at_line": 780, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1193, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 780, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 780, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 2},
{"warn_data": {"at_line": 784, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1193, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 3},
{"warn_data": {"at_line": 784, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1193, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 784, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1198, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}, {"lineno": 786, "file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = kzalloc(sizeof(struct dma_mapping), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !6202", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "genwqe_ioctl", "instr_loc": 1198, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 786, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = kzalloc(sizeof(struct dma_mapping), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1183, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = do_flash_read(cfile, &load);"}],
"warnings":[{"warn_data": {"at_line": 756, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "load->size  -= tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1180, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 756, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 1},
{"warn_data": {"at_line": 759, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blocks_to_flash--;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1180, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 680, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 680, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 680, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 759, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash--;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 2},
{"warn_data": {"at_line": 681, "warn_str": "Loop is bounded by a tainted value.", "at": "while (load->size) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1180, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_read"}, "warn_no": 3},
{"warn_data": {"at_line": 739, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = copy_to_user(buf, xbuf, tocopy);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_flash_read"}, "warn_no": 4},
{"warn_data": {"at_line": 757, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "flash += tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1180, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 686, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 757, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "flash += tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 5}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1163, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = do_flash_update(cfile, &load);"}],
"warnings":[{"warn_data": {"at_line": 627, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "load->size  -= tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1159, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 1},
{"warn_data": {"at_line": 630, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blocks_to_flash--;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1159, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 544, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 544, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 544, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 630, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash--;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 2},
{"warn_data": {"at_line": 545, "warn_str": "Loop is bounded by a tainted value.", "at": "while (load->size) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1159, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 545, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}, {"instr_func": "do_flash_update", "instr_loc": 545, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_update"}, "warn_no": 3},
{"warn_data": {"at_line": 555, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rc) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1159, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 554, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 554, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 554, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 555, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (rc) {"}, {"instr_func": "do_flash_update", "instr_loc": 555, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (rc) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_update"}, "warn_no": 4},
{"warn_data": {"at_line": 628, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "flash += tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1159, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 627, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 552, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 628, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "flash += tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 5},
{"warn_data": {"at_line": 552, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_flash_update"}, "warn_no": 6}]}]}