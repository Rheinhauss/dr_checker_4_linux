{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 1271, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "err = str_to_slot(buf, &domain, &bus, &slot, &func);"}],
"warnings":[{"warn_data": {"at_line": 1021, "warn_str": "Trying to read from a user pointer.", "at": "if (parsed && !buf[parsed])", "inst_trace": [{"instr_func": "irq_handler_state_store", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "str_to_slot", "instr_loc": 1010, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "switch (sscanf(buf, \" %x:%x:%x.%x %n\", domain, bus, slot, func,"}, {"instr_func": "str_to_slot", "instr_loc": 1021, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}, {"instr_func": "str_to_slot", "instr_loc": 1021, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "str_to_slot"}, "warn_no": 1},
{"warn_data": {"at_line": 1036, "warn_str": "Trying to read from a user pointer.", "at": "if (parsed && !buf[parsed])", "inst_trace": [{"instr_func": "irq_handler_state_store", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "str_to_slot", "instr_loc": 1010, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "switch (sscanf(buf, \" %x:%x:%x.%x %n\", domain, bus, slot, func,"}, {"instr_func": "str_to_slot", "instr_loc": 1036, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}, {"instr_func": "str_to_slot", "instr_loc": 1036, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "str_to_slot"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 1275, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find(domain, bus, slot, func);"}],
"warnings":[{"warn_data": {"at_line": 180, "warn_str": "Trying to use a global variable without locking.", "at": "spin_lock_irqsave(&pcistub_devices_lock, flags);", "inst_trace": [{"instr_func": "irq_handler_state_store", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "irq_handler_state_store", "instr_loc": 1275, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find(domain, bus, slot, func);"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pcistub_device_find"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 1275, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find(domain, bus, slot, func);"}, {"lineno": 182, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find_locked(domain, bus, slot, func);"}],
"warnings":[{"warn_data": {"at_line": 162, "warn_str": "Loop is bounded by a tainted value.", "at": "if (psdev->dev != NULL", "inst_trace": [{"instr_func": "irq_handler_state_store", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "str_to_slot", "instr_loc": 1010, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "switch (sscanf(buf, \" %x:%x:%x.%x %n\", domain, bus, slot, func,"}, {"instr_func": "irq_handler_state_store", "instr_loc": 1275, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find(domain, bus, slot, func);"}, {"instr_func": "irq_handler_state_store", "instr_loc": 1275, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find(domain, bus, slot, func);"}, {"instr_func": "pcistub_device_find", "instr_loc": 176, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "{"}, {"instr_func": "pcistub_device_find", "instr_loc": 182, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find_locked(domain, bus, slot, func);"}, {"instr_func": "pcistub_device_find", "instr_loc": 182, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "psdev = pcistub_device_find_locked(domain, bus, slot, func);"}, {"instr_func": "pcistub_device_find_locked", "instr_loc": 158, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "{"}, {"instr_func": "pcistub_device_find_locked", "instr_loc": 166, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "&& func == PCI_FUNC(psdev->dev->devfn)) {"}, {"instr_func": "pcistub_device_find_locked", "instr_loc": 166, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "&& func == PCI_FUNC(psdev->dev->devfn)) {"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "TaintedLoopBoundDetector says:", "at_func": "pcistub_device_find_locked"}, "warn_no": 1}]}]}