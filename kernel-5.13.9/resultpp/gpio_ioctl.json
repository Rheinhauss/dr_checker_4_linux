{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2135, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineinfo_unwatch(cdev, ip);"}],
"warnings":[{"warn_data": {"at_line": 2087, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_unwatch"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}],
"warnings":[{"warn_data": {"at_line": 1372, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < ulr.num_lines; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linereq_create", "instr_loc": 1372, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < ulr.num_lines; i++) {"}, {"instr_func": "linereq_create", "instr_loc": 1372, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < ulr.num_lines; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "linereq_create"}, "warn_no": 1},
{"warn_data": {"at_line": 1314, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "linereq_create"}, "warn_no": 2},
{"warn_data": {"at_line": 1344, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < ulr.num_lines; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linereq_create", "instr_loc": 1344, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < ulr.num_lines; i++) {"}, {"instr_func": "linereq_create", "instr_loc": 1344, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < ulr.num_lines; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "linereq_create"}, "warn_no": 3},
{"warn_data": {"at_line": 1434, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ulr.fd = fd;", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "linereq_create"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1333, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = gpio_v2_line_config_validate(lc, ulr.num_lines);"}],
"warnings":[{"warn_data": {"at_line": 951, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < num_lines; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linereq_create", "instr_loc": 1333, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = gpio_v2_line_config_validate(lc, ulr.num_lines);"}, {"instr_func": "linereq_create", "instr_loc": 1333, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = gpio_v2_line_config_validate(lc, ulr.num_lines);"}, {"instr_func": "gpio_v2_line_config_validate", "instr_loc": 940, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_validate", "instr_loc": 951, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < num_lines; i++) {"}, {"instr_func": "gpio_v2_line_config_validate", "instr_loc": 951, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < num_lines; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_validate"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1333, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = gpio_v2_line_config_validate(lc, ulr.num_lines);"}, {"lineno": 958, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "if (gpio_v2_line_config_debounced(lc, i) &&"}],
"warnings":[{"warn_data": {"at_line": 748, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_DEBOUNCE) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounced"}, "warn_no": 1},
{"warn_data": {"at_line": 747, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 747, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 747, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounced"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1333, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = gpio_v2_line_config_validate(lc, ulr.num_lines);"}, {"lineno": 952, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "flags = gpio_v2_line_config_flags(lc, i);"}],
"warnings":[{"warn_data": {"at_line": 868, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_FLAGS) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_flags"}, "warn_no": 1},
{"warn_data": {"at_line": 867, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 867, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 867, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_flags"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1337, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "lr = kzalloc(struct_size(lr, lines, ulr.num_lines), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !6136", "inst_trace": [{"instr_func": "gpio_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "gpio_ioctl", "instr_loc": 2133, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"instr_func": "linereq_create", "instr_loc": 1337, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "lr = kzalloc(struct_size(lr, lines, ulr.num_lines), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2130, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineinfo_get(cdev, ip,"}],
"warnings":[{"warn_data": {"at_line": 2053, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_get"}, "warn_no": 1},
{"warn_data": {"at_line": 2075, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "gpio_desc_to_lineinfo(desc, &lineinfo);", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_get"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1408, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = edge_detector_setup(&lr->lines[i], lc, i,"}, {"lineno": 800, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "if (gpio_v2_line_config_debounced(lc, line_idx)) {"}],
"warnings":[{"warn_data": {"at_line": 748, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_DEBOUNCE) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 749, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounced"}, "warn_no": 1},
{"warn_data": {"at_line": 747, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 747, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_debounced", "instr_loc": 747, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounced"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1408, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "ret = edge_detector_setup(&lr->lines[i], lc, i,"}, {"lineno": 801, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "debounce_period_us = gpio_v2_line_config_debounce_period(lc, line_idx);"}],
"warnings":[{"warn_data": {"at_line": 762, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_DEBOUNCE) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounce_period", "instr_loc": 763, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounce_period", "instr_loc": 763, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_debounce_period", "instr_loc": 763, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounce_period"}, "warn_no": 1},
{"warn_data": {"at_line": 761, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_debounce_period", "instr_loc": 761, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_debounce_period", "instr_loc": 761, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_debounce_period"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1398, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "int val = gpio_v2_line_config_output_value(lc, i);"}],
"warnings":[{"warn_data": {"at_line": 882, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_OUTPUT_VALUES) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_output_value", "instr_loc": 883, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_output_value", "instr_loc": 883, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_output_value", "instr_loc": 883, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_output_value"}, "warn_no": 1},
{"warn_data": {"at_line": 881, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_output_value", "instr_loc": 881, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_output_value", "instr_loc": 881, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_output_value"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1386, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "flags = gpio_v2_line_config_flags(lc, i);"}],
"warnings":[{"warn_data": {"at_line": 868, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((lc->attrs[i].attr.id == GPIO_V2_LINE_ATTR_ID_FLAGS) &&", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 869, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "(lc->attrs[i].mask & mask))"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_flags"}, "warn_no": 1},
{"warn_data": {"at_line": 867, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lc->num_attrs; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 867, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}, {"instr_func": "gpio_v2_line_config_flags", "instr_loc": 867, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lc->num_attrs; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gpio_v2_line_config_flags"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2133, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linereq_create(gdev, ip);"}, {"lineno": 1455, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "linereq_free(lr);"}],
"warnings":[{"warn_data": {"at_line": 1282, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lr->num_lines; i++) {", "inst_trace": [{"instr_func": "linereq_create", "instr_loc": 1314, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linereq_create", "instr_loc": 1369, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "lr->num_lines = ulr.num_lines;"}, {"instr_func": "linereq_create", "instr_loc": 1369, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "lr->num_lines = ulr.num_lines;"}, {"instr_func": "linereq_free", "instr_loc": 1282, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lr->num_lines; i++) {"}, {"instr_func": "linereq_free", "instr_loc": 1282, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lr->num_lines; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "linereq_free"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2130, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineinfo_get(cdev, ip,"}, {"lineno": 2075, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "gpio_desc_to_lineinfo(desc, &lineinfo);"}],
"warnings":[{"warn_data": {"at_line": 1913, "warn_str": "Trying to use a global variable without locking.", "at": "spin_lock_irqsave(&gpio_lock, flags);", "inst_trace": [{"instr_func": "gpio_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "gpio_ioctl", "instr_loc": 2130, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineinfo_get(cdev, ip,"}, {"instr_func": "lineinfo_get", "instr_loc": 2075, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "gpio_desc_to_lineinfo(desc, &lineinfo);"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gpio_desc_to_lineinfo"}, "warn_no": 1},
{"warn_data": {"at_line": 1911, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pinctrl_gpio_can_use_line(gc->base + info->offset);", "inst_trace": [{"instr_func": "lineinfo_get", "instr_loc": 2053, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "gpio_desc_to_lineinfo", "instr_loc": 1911, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "pinctrl_gpio_can_use_line(gc->base + info->offset);"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "gpio_desc_to_lineinfo"}, "warn_no": 2},
{"warn_data": {"at_line": 1916, "warn_str": "Tainted Data used in risky function", "at": "strscpy(info->name, desc->name, sizeof(info->name));", "inst_trace": [{"instr_func": "lineinfo_get", "instr_loc": 2053, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "ImproperTaintedDataUseDetector says:", "tainted_obj": "  %35 = alloca %struct.gpio_v2_line_info, align 8", "at_func": "gpio_desc_to_lineinfo"}, "warn_no": 3},
{"warn_data": {"at_line": 1919, "warn_str": "Tainted Data used in risky function", "at": "strscpy(info->consumer, desc->label, sizeof(info->consumer));", "inst_trace": [{"instr_func": "lineinfo_get", "instr_loc": 2053, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "ImproperTaintedDataUseDetector says:", "tainted_obj": "  %35 = alloca %struct.gpio_v2_line_info, align 8", "at_func": "gpio_desc_to_lineinfo"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2125, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineinfo_get_v1(cdev, ip,"}],
"warnings":[{"warn_data": {"at_line": 2038, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "gpio_desc_to_lineinfo(desc, &lineinfo_v2);", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_get_v1"}, "warn_no": 1},
{"warn_data": {"at_line": 2017, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_get_v1"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2122, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return lineevent_create(gdev, ip);"}],
"warnings":[{"warn_data": {"at_line": 1708, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineevent_create"}, "warn_no": 1},
{"warn_data": {"at_line": 1825, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "eventreq.fd = fd;", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineevent_create"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2120, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linehandle_create(gdev, ip);"}],
"warnings":[{"warn_data": {"at_line": 286, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "linehandle_create"}, "warn_no": 1},
{"warn_data": {"at_line": 324, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < handlereq.lines; i++) {", "inst_trace": [{"instr_func": "linehandle_create", "instr_loc": 286, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linehandle_create", "instr_loc": 324, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < handlereq.lines; i++) {"}, {"instr_func": "linehandle_create", "instr_loc": 324, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < handlereq.lines; i++) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "linehandle_create"}, "warn_no": 2},
{"warn_data": {"at_line": 381, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "handlereq.fd = fd;", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "linehandle_create"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2120, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return linehandle_create(gdev, ip);"}, {"lineno": 402, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "linehandle_free(lh);"}],
"warnings":[{"warn_data": {"at_line": 261, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < lh->num_descs; i++)", "inst_trace": [{"instr_func": "linehandle_create", "instr_loc": 286, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "linehandle_create", "instr_loc": 321, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "lh->num_descs = handlereq.lines;"}, {"instr_func": "linehandle_create", "instr_loc": 321, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "lh->num_descs = handlereq.lines;"}, {"instr_func": "linehandle_free", "instr_loc": 261, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lh->num_descs; i++)"}, {"instr_func": "linehandle_free", "instr_loc": 261, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "for (i = 0; i < lh->num_descs; i++)"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "linehandle_free"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2117, "file": "drivers/gpio/gpiolib-cdev.c", "instr": "return chipinfo_get(cdev, ip);"}],
"warnings":[{"warn_data": {"at_line": 1986, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "chipinfo_get"}, "warn_no": 1}]}]}