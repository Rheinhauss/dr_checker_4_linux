{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 620, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "__mptctl_ioctl"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 687, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_hp_targetinfo(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 2550, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_hp_targetinfo"}, "warn_no": 1},
{"warn_data": {"at_line": 2666, "warn_str": "Trying to read from a user pointer.", "at": "karg.select_timeouts = hd->sel_timeout[karg.hdr.id];", "inst_trace": [{"instr_func": "mptctl_hp_targetinfo", "instr_loc": 2550, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_hp_targetinfo", "instr_loc": 2666, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "karg.select_timeouts = hd->sel_timeout[karg.hdr.id];"}, {"instr_func": "mptctl_hp_targetinfo", "instr_loc": 2666, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "karg.select_timeouts = hd->sel_timeout[karg.hdr.id];"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mptctl_hp_targetinfo"}, "warn_no": 2},
{"warn_data": {"at_line": 2670, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((char __user *)arg, &karg, sizeof(hp_target_info_t))) {", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_hp_targetinfo"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 685, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_hp_hostinfo(iocp, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 2341, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&karg, uarg, sizeof(hp_host_info_t))) {", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_hp_hostinfo"}, "warn_no": 1},
{"warn_data": {"at_line": 2526, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((char __user *)arg, &karg, sizeof(hp_host_info_t))) {", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_hp_hostinfo"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 683, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_do_reset(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 707, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_reset"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 681, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_mpt_command(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1696, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_mpt_command"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 681, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_mpt_command(iocp, arg);"}, {"lineno": 1709, "file": "drivers/message/fusion/mptctl.c", "instr": "rc = mptctl_do_mpt_command (ioc, karg, &uarg->MF);"}],
"warnings":[{"warn_data": {"at_line": 1774, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sz += ioc->SGE_size;", "inst_trace": [{"instr_func": "mptctl_mpt_command", "instr_loc": 1696, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1774, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz += ioc->SGE_size;"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 1},
{"warn_data": {"at_line": 1776, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sz += ioc->SGE_size;", "inst_trace": [{"instr_func": "mptctl_mpt_command", "instr_loc": 1696, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1772, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz = karg.dataSgeOffset * 4;"}, {"instr_func": "mptctl_do_mpt_command", "instr_loc": 1776, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "sz += ioc->SGE_size;"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 2},
{"warn_data": {"at_line": 1790, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "hdr = (MPIHeader_t *) mf;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 3},
{"warn_data": {"at_line": 2113, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ioc->add_sge(psge, flagsLength, dma_addr_out);", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 4},
{"warn_data": {"at_line": 2233, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.replyFrameBufPtr,", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 5},
{"warn_data": {"at_line": 2250, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.senseDataPtr,", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 6},
{"warn_data": {"at_line": 2268, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.dataInBufPtr,", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_mpt_command"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 679, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_fw_download(iocp, arg);"}, {"lineno": 760, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}],
"warnings":[{"warn_data": {"at_line": 904, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "iocp->add_sge(sgOut, sgIn->FlagsLength, sgIn->Address);", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_do_fw_download"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 679, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_fw_download(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 749, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_fw_download"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 669, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_replace_fw(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1637, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_replace_fw"}, "warn_no": 1},
{"warn_data": {"at_line": 1660, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "newFwSize = ALIGN(karg.newImageSize, 4);", "inst_trace": [{"instr_func": "mptctl_replace_fw", "instr_loc": 1637, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_replace_fw", "instr_loc": 1660, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "newFwSize = ALIGN(karg.newImageSize, 4);"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_replace_fw"}, "warn_no": 2},
{"warn_data": {"at_line": 1668, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(ioc->cached_fw, uarg->newImage, newFwSize)) {", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_replace_fw"}, "warn_no": 3}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 679, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = mptctl_fw_download(iocp, arg);"}, {"lineno": 760, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"lineno": 859, "file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}],
"warnings":[{"warn_data": {"at_line": 1093, "warn_str": "Loop is bounded by a tainted value.", "at": "if (bytes_allocd >= bytes)", "inst_trace": [{"instr_func": "mptctl_fw_download", "instr_loc": 749, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 779, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1008, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1093, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if (bytes_allocd >= bytes)"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1093, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if (bytes_allocd >= bytes)"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "kbuf_alloc_2_sgl"}, "warn_no": 1},
{"warn_data": {"at_line": 1070, "warn_str": "Loop is bounded by a tainted value.", "at": "if (alloc_sz == 0) {", "inst_trace": [{"instr_func": "mptctl_fw_download", "instr_loc": 749, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 779, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1008, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1015, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "int\t\t alloc_sz = min(bytes,MAX_KMALLOC_SZ);\t// avoid kernel warning msg!"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1070, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if (alloc_sz == 0) {"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1070, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if (alloc_sz == 0) {"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "kbuf_alloc_2_sgl"}, "warn_no": 2},
{"warn_data": {"at_line": 1063, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "this_alloc = min(alloc_sz, bytes-bytes_allocd);", "inst_trace": [{"instr_func": "mptctl_fw_download", "instr_loc": 749, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 779, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1008, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "kbuf_alloc_2_sgl"}, "warn_no": 3},
{"warn_data": {"at_line": 1062, "warn_str": "Loop is bounded by a tainted value.", "at": "while (bytes_allocd < bytes) {", "inst_trace": [{"instr_func": "mptctl_fw_download", "instr_loc": 749, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 779, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1008, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1062, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "while (bytes_allocd < bytes) {"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1062, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "while (bytes_allocd < bytes) {"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "kbuf_alloc_2_sgl"}, "warn_no": 4},
{"warn_data": {"at_line": 1081, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "bytes_allocd += this_alloc;", "inst_trace": [{"instr_func": "mptctl_fw_download", "instr_loc": 749, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_fw_download", "instr_loc": 760, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_do_fw_download(iocp, kfwdl.bufp, kfwdl.fwlen);"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 779, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "mptctl_do_fw_download", "instr_loc": 859, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "if ((sgl = kbuf_alloc_2_sgl(fwlen, sgdir, sge_offset,"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1008, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1063, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "this_alloc = min(alloc_sz, bytes-bytes_allocd);"}, {"instr_func": "kbuf_alloc_2_sgl", "instr_loc": 1081, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "bytes_allocd += this_alloc;"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "kbuf_alloc_2_sgl"}, "warn_no": 5}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 667, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_eventreport(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1606, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);", "inst_trace": [{"instr_func": "mptctl_eventreport", "instr_loc": 1591, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_eventreport", "instr_loc": 1606, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_eventreport"}, "warn_no": 1},
{"warn_data": {"at_line": 1591, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_eventreport"}, "warn_no": 2},
{"warn_data": {"at_line": 1619, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ioc->aen_event_read_flag=0;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_eventreport"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 665, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_eventenable(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1552, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_eventenable"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 663, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_eventquery(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1522, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_eventquery"}, "warn_no": 1},
{"warn_data": {"at_line": 1535, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.eventEntries = MPTCTL_EVENT_LOG_SIZE;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_eventquery"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 661, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_readtest(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1470, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_readtest"}, "warn_no": 1},
{"warn_data": {"at_line": 1490, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.chip_type = ioc->pcidev->device;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_readtest"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 659, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_gettargetinfo(iocp, arg);"}],
"warnings":[{"warn_data": {"at_line": 1381, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_gettargetinfo"}, "warn_no": 1},
{"warn_data": {"at_line": 1360, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_gettargetinfo"}, "warn_no": 2},
{"warn_data": {"at_line": 1429, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "--maxWordsLeft;", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1382, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "maxWordsLeft = numBytes/sizeof(int);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1382, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "maxWordsLeft = numBytes/sizeof(int);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1382, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "maxWordsLeft = numBytes/sizeof(int);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1382, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "maxWordsLeft = numBytes/sizeof(int);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1429, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "--maxWordsLeft;"}], "at_file": "drivers/message/fusion/mptctl.c", "by": "IntegerOverflowDetector says:", "at_func": "mptctl_gettargetinfo"}, "warn_no": 3},
{"warn_data": {"at_line": 1432, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.numDevices = numDevices;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_gettargetinfo"}, "warn_no": 4},
{"warn_data": {"at_line": 1447, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uarg->targetInfo, pmem, numBytes)) {", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_gettargetinfo"}, "warn_no": 5}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 659, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_gettargetinfo(iocp, arg);"}, {"lineno": 1404, "file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %69 = add i64 %68, -1, !dbg !7769", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7739"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7748"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7750"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %68 = load i64, i64* %10, align 8, !dbg !7769"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 1},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %44 = sub i64 %43, 1, !dbg !7765", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7739"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7748"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7750"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %43 = load i64, i64* %10, align 8, !dbg !7765"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 2},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %61 = sub i64 %60, 1, !dbg !7765", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7739"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7748"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7750"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %60 = load i64, i64* %10, align 8, !dbg !7765"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 3},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %53 = sub i64 %52, 1, !dbg !7765", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7739"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7748"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7750"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %52 = load i64, i64* %10, align 8, !dbg !7765"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 4},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %48 = sub i64 %47, 1, !dbg !7765", "inst_trace": [{"instr_func": "mptctl_gettargetinfo", "instr_loc": 1360, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "{"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1381, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "numBytes = karg.hdr.maxDataSize - sizeof(mpt_ioctl_header);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "mptctl_gettargetinfo", "instr_loc": 1404, "instr_file": "drivers/message/fusion/mptctl.c", "instr": "pmem = kzalloc(numBytes, GFP_KERNEL);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7739"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7748"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7750"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %47 = load i64, i64* %10, align 8, !dbg !7765"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 701, "file": "drivers/message/fusion/mptctl.c", "instr": "ret = __mptctl_ioctl(file, cmd, arg);"}, {"lineno": 657, "file": "drivers/message/fusion/mptctl.c", "instr": "return mptctl_getiocinfo(iocp, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1322, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg->FWVersion = ioc->facts.FWVersion.Word;", "inst_trace": [], "at_file": "drivers/message/fusion/mptctl.c", "by": "TaintedSizeDetector says:", "at_func": "mptctl_getiocinfo"}, "warn_no": 1}]}]}