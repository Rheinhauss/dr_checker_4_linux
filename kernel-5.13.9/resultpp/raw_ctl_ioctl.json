{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 224, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rq.block_minor = MINOR(dev);", "inst_trace": [], "at_file": "drivers/char/raw.c", "by": "TaintedSizeDetector says:", "at_func": "raw_ctl_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 216, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))", "inst_trace": [], "at_file": "drivers/char/raw.c", "by": "TaintedSizeDetector says:", "at_func": "raw_ctl_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 210, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))", "inst_trace": [], "at_file": "drivers/char/raw.c", "by": "TaintedSizeDetector says:", "at_func": "raw_ctl_ioctl"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 219, "file": "drivers/char/raw.c", "instr": "err = bind_get(rq.raw_minor, &dev);"}],
"warnings":[{"warn_data": {"at_line": 191, "warn_str": "Trying to use a global variable without locking.", "at": "if (number <= 0 || number >= max_raw_minors)", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 219, "instr_file": "drivers/char/raw.c", "instr": "err = bind_get(rq.raw_minor, &dev);"}], "at_file": "drivers/char/raw.c", "by": "GlobalVariableRaceDetector says:", "at_func": "bind_get"}, "warn_no": 1},
{"warn_data": {"at_line": 193, "warn_str": "Trying to read from a user pointer.", "at": "*dev = raw_devices[number].binding;", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": 216, "instr_file": "drivers/char/raw.c", "instr": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 219, "instr_file": "drivers/char/raw.c", "instr": "err = bind_get(rq.raw_minor, &dev);"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 219, "instr_file": "drivers/char/raw.c", "instr": "err = bind_get(rq.raw_minor, &dev);"}, {"instr_func": "bind_get", "instr_loc": 190, "instr_file": "drivers/char/raw.c", "instr": "{"}, {"instr_func": "bind_get", "instr_loc": 193, "instr_file": "drivers/char/raw.c", "instr": "*dev = raw_devices[number].binding;"}, {"instr_func": "bind_get", "instr_loc": 193, "instr_file": "drivers/char/raw.c", "instr": "*dev = raw_devices[number].binding;"}, {"instr_func": "bind_get", "instr_loc": 193, "instr_file": "drivers/char/raw.c", "instr": "*dev = raw_devices[number].binding;"}], "at_file": "drivers/char/raw.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "bind_get"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 213, "file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}],
"warnings":[{"warn_data": {"at_line": 143, "warn_str": "Trying to use a global variable without locking.", "at": "if (number <= 0 || number >= max_raw_minors)", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}], "at_file": "drivers/char/raw.c", "by": "GlobalVariableRaceDetector says:", "at_func": "bind_set"}, "warn_no": 1},
{"warn_data": {"at_line": 169, "warn_str": "Trying to read from a user pointer.", "at": "if (rawdev->inuse) {", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": 216, "instr_file": "drivers/char/raw.c", "instr": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "bind_set", "instr_loc": 137, "instr_file": "drivers/char/raw.c", "instr": "{"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 169, "instr_file": "drivers/char/raw.c", "instr": "if (rawdev->inuse) {"}, {"instr_func": "bind_set", "instr_loc": 169, "instr_file": "drivers/char/raw.c", "instr": "if (rawdev->inuse) {"}], "at_file": "drivers/char/raw.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "bind_set"}, "warn_no": 2},
{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "if (rawdev->binding)", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": 216, "instr_file": "drivers/char/raw.c", "instr": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "bind_set", "instr_loc": 137, "instr_file": "drivers/char/raw.c", "instr": "{"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 173, "instr_file": "drivers/char/raw.c", "instr": "if (rawdev->binding)"}, {"instr_func": "bind_set", "instr_loc": 173, "instr_file": "drivers/char/raw.c", "instr": "if (rawdev->binding)"}], "at_file": "drivers/char/raw.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "bind_set"}, "warn_no": 3},
{"warn_data": {"at_line": 176, "warn_str": "Trying to write to a user pointer.", "at": "rawdev->binding = dev;", "inst_trace": [{"instr_func": "raw_ctl_ioctl", "instr_loc": 216, "instr_file": "drivers/char/raw.c", "instr": "if (copy_from_user(&rq, (void __user *) arg, sizeof(rq)))"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "raw_ctl_ioctl", "instr_loc": 213, "instr_file": "drivers/char/raw.c", "instr": "return bind_set(rq.raw_minor, rq.block_major, rq.block_minor);"}, {"instr_func": "bind_set", "instr_loc": 137, "instr_file": "drivers/char/raw.c", "instr": "{"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 149, "instr_file": "drivers/char/raw.c", "instr": "rawdev = &raw_devices[number];"}, {"instr_func": "bind_set", "instr_loc": 176, "instr_file": "drivers/char/raw.c", "instr": "rawdev->binding = dev;"}, {"instr_func": "bind_set", "instr_loc": 176, "instr_file": "drivers/char/raw.c", "instr": "rawdev->binding = dev;"}], "at_file": "drivers/char/raw.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "bind_set"}, "warn_no": 4}]}]}