{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 298, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}],
"warnings":[{"warn_data": {"at_line": 268, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedSizeDetector says:", "at_func": "udmabuf_ioctl_create_list"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 298, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 283, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}],
"warnings":[{"warn_data": {"at_line": 175, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < head->count; i++) {", "inst_trace": [{"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 268, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 175, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}, {"instr_func": "udmabuf_create", "instr_loc": 175, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 1},
{"warn_data": {"at_line": 192, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < head->count; i++) {", "inst_trace": [{"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 268, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 192, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}, {"instr_func": "udmabuf_create", "instr_loc": 192, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 2},
{"warn_data": {"at_line": 221, "warn_str": "Trying to use a global variable without locking.", "at": "exp_info.ops  = &udmabuf_ops;", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 298, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 283, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "GlobalVariableRaceDetector says:", "at_func": "udmabuf_create"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 298, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 283, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"lineno": 170, "file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf = kzalloc(sizeof(*ubuf), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !7481", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 298, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 283, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 170, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf = kzalloc(sizeof(*ubuf), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 298, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 283, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"lineno": 184, "file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pages = kmalloc_array(ubuf->pagecount, sizeof(*ubuf->pages),"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %278 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %277, !dbg !7503", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 298, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 283, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 184, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pages = kmalloc_array(ubuf->pagecount, sizeof(*ubuf->pages),"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 295, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}],
"warnings":[{"warn_data": {"at_line": 249, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedSizeDetector says:", "at_func": "udmabuf_ioctl_create"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 298, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 283, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"lineno": 197, "file": "drivers/dma-buf/udmabuf.c", "instr": "if (!shmem_mapping(file_inode(memfd)->i_mapping))"}],
"warnings":[{"warn_data": {"at_line": 73, "warn_str": "Trying to use a global variable without locking.", "at": "  %6 = icmp eq %struct.address_space_operations* %5, @shmem_aops, !dbg !7217", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 298, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 283, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(filp->private_data, &head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 197, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!shmem_mapping(file_inode(memfd)->i_mapping))"}], "at_file": "./include/linux/shmem_fs.h", "by": "GlobalVariableRaceDetector says:", "at_func": "shmem_mapping"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 295, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 264, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(filp->private_data, &head, &list);"}],
"warnings":[{"warn_data": {"at_line": 180, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "IntegerOverflowDetector says:", "at_func": "udmabuf_create"}, "warn_no": 1},
{"warn_data": {"at_line": 178, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 178, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 178, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 178, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 2},
{"warn_data": {"at_line": 181, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ubuf->pagecount > pglimit)", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 262, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 180, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 181, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (ubuf->pagecount > pglimit)"}, {"instr_func": "udmabuf_create", "instr_loc": 181, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (ubuf->pagecount > pglimit)"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 3},
{"warn_data": {"at_line": 176, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_create", "instr_loc": 176, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 176, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 176, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 4},
{"warn_data": {"at_line": 210, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "file_inode(memfd)->i_mapping, pgoff + pgidx);", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_create", "instr_loc": 206, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 206, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 206, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 210, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "file_inode(memfd)->i_mapping, pgoff + pgidx);"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "IntegerOverflowDetector says:", "at_func": "udmabuf_create"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 295, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 264, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(filp->private_data, &head, &list);"}, {"lineno": 240, "file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"lineno": 1229, "file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #11, !dbg !7213"}],
"warnings":[{"warn_data": {"at_line": 184, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load volatile i64, i64* %11, align 8, !dbg !7217", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1228, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !7212"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #11, !dbg !7213"}, {"instr_func": "compound_head", "instr_loc": 183, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %3, align 8"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %8 = load %struct.page*, %struct.page** %3, align 8, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %9 = getelementptr inbounds %struct.page, %struct.page* %8, i32 0, i32 1, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = getelementptr inbounds %struct.anon.12, %struct.anon.12* %10, i32 0, i32 0, !dbg !7217"}], "at_file": "./include/linux/page-flags.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "compound_head"}, "warn_no": 1},
{"warn_data": {"at_line": 187, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = sub i64 %23, 1, !dbg !7225", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1228, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !7212"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #11, !dbg !7213"}, {"instr_func": "compound_head", "instr_loc": 183, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %3, align 8"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %8 = load %struct.page*, %struct.page** %3, align 8, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %9 = getelementptr inbounds %struct.page, %struct.page* %8, i32 0, i32 1, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = getelementptr inbounds %struct.anon.12, %struct.anon.12* %10, i32 0, i32 0, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = load volatile i64, i64* %11, align 8, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  store i64 %12, i64* %5, align 8, !dbg !7219"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  %13 = load i64, i64* %5, align 8, !dbg !7217"}, {"instr_func": "compound_head", "instr_loc": 184, "instr_file": "./include/linux/page-flags.h", "instr": "  store i64 %13, i64* %4, align 8, !dbg !7216"}, {"instr_func": "compound_head", "instr_loc": 187, "instr_file": "./include/linux/page-flags.h", "instr": "  %23 = load i64, i64* %4, align 8, !dbg !7224"}], "at_file": "./include/linux/page-flags.h", "by": "IntegerOverflowDetector says:", "at_func": "compound_head"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 295, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 264, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(filp->private_data, &head, &list);"}, {"lineno": 240, "file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"lineno": 1237, "file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @page_is_devmap_managed(%struct.page* %5) #11, !dbg !7217"}],
"warnings":[{"warn_data": {"at_line": 1159, "warn_str": "Trying to read from a user pointer.", "at": "  %45 = load %struct.dev_pagemap*, %struct.dev_pagemap** %44, align 8, !dbg !7251", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1228, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1237, "instr_file": "./include/linux/mm.h", "instr": "  %5 = load %struct.page*, %struct.page** %2, align 8, !dbg !7215"}, {"instr_func": "put_page", "instr_loc": 1237, "instr_file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @page_is_devmap_managed(%struct.page* %5) #11, !dbg !7217"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1154, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %41 = load %struct.page*, %struct.page** %6, align 8, !dbg !7250"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %42 = getelementptr inbounds %struct.page, %struct.page* %41, i32 0, i32 1, !dbg !7251"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %44 = getelementptr inbounds %struct.anon.81, %struct.anon.81* %43, i32 0, i32 0, !dbg !7251"}], "at_file": "./include/linux/mm.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "page_is_devmap_managed"}, "warn_no": 1},
{"warn_data": {"at_line": 1159, "warn_str": "Trying to read from a user pointer.", "at": "  %47 = load i32, i32* %46, align 8, !dbg !7252", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1228, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1237, "instr_file": "./include/linux/mm.h", "instr": "  %5 = load %struct.page*, %struct.page** %2, align 8, !dbg !7215"}, {"instr_func": "put_page", "instr_loc": 1237, "instr_file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @page_is_devmap_managed(%struct.page* %5) #11, !dbg !7217"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1154, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %41 = load %struct.page*, %struct.page** %6, align 8, !dbg !7250"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %42 = getelementptr inbounds %struct.page, %struct.page* %41, i32 0, i32 1, !dbg !7251"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %44 = getelementptr inbounds %struct.anon.81, %struct.anon.81* %43, i32 0, i32 0, !dbg !7251"}, {"instr_func": "page_is_devmap_managed", "instr_loc": 1159, "instr_file": "./include/linux/mm.h", "instr": "  %46 = getelementptr inbounds %struct.dev_pagemap, %struct.dev_pagemap* %45, i32 0, i32 4, !dbg !7252"}], "at_file": "./include/linux/mm.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "page_is_devmap_managed"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 295, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 264, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(filp->private_data, &head, &list);"}, {"lineno": 240, "file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"lineno": 1242, "file": "./include/linux/mm.h", "instr": "  %11 = call i32 @put_page_testzero(%struct.page* %10) #11, !dbg !7225"}, {"lineno": 746, "file": "./include/linux/mm.h", "instr": "  %5 = call i32 @page_ref_count(%struct.page* %4) #11, !dbg !7213"}],
"warnings":[{"warn_data": {"at_line": 66, "warn_str": "Trying to read from a user pointer.", "at": "  %20 = load volatile i32, i32* %19, align 4, !dbg !7247", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 249, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 240, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1228, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !7212"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #11, !dbg !7213"}, {"instr_func": "compound_head", "instr_loc": 183, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %3, align 8"}, {"instr_func": "compound_head", "instr_loc": 188, "instr_file": "./include/linux/page-flags.h", "instr": "  %27 = load %struct.page*, %struct.page** %3, align 8, !dbg !7228"}, {"instr_func": "compound_head", "instr_loc": 188, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %27, %struct.page** %2, align 8, !dbg !7229"}, {"instr_func": "compound_head", "instr_loc": 189, "instr_file": "./include/linux/page-flags.h", "instr": "  %29 = load %struct.page*, %struct.page** %2, align 8, !dbg !7230"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #11, !dbg !7213"}, {"instr_func": "put_page", "instr_loc": 1229, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %4, %struct.page** %2, align 8, !dbg !7214"}, {"instr_func": "put_page", "instr_loc": 1242, "instr_file": "./include/linux/mm.h", "instr": "  %10 = load %struct.page*, %struct.page** %2, align 8, !dbg !7223"}, {"instr_func": "put_page", "instr_loc": 1242, "instr_file": "./include/linux/mm.h", "instr": "  %11 = call i32 @put_page_testzero(%struct.page* %10) #11, !dbg !7225"}, {"instr_func": "put_page_testzero", "instr_loc": 745, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page_testzero", "instr_loc": 746, "instr_file": "./include/linux/mm.h", "instr": "  %4 = load %struct.page*, %struct.page** %2, align 8, !dbg !7213"}, {"instr_func": "put_page_testzero", "instr_loc": 746, "instr_file": "./include/linux/mm.h", "instr": "  %5 = call i32 @page_ref_count(%struct.page* %4) #11, !dbg !7213"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "page_ref_count", "instr_loc": 67, "instr_file": "./include/linux/page_ref.h", "instr": "  %7 = load %struct.page*, %struct.page** %6, align 8, !dbg !7239"}, {"instr_func": "page_ref_count", "instr_loc": 67, "instr_file": "./include/linux/page_ref.h", "instr": "  %8 = getelementptr inbounds %struct.page, %struct.page* %7, i32 0, i32 3, !dbg !7240"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  store %struct.atomic_t* %8, %struct.atomic_t** %5, align 8"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  %17 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !7246"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  store %struct.atomic_t* %17, %struct.atomic_t** %2, align 8"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  %18 = load %struct.atomic_t*, %struct.atomic_t** %2, align 8, !dbg !7247"}, {"instr_func": "page_ref_count", "instr_loc": 66, "instr_file": "./include/linux/page_ref.h", "instr": "  %19 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %18, i32 0, i32 0, !dbg !7247"}], "at_file": "./include/linux/page_ref.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "page_ref_count"}, "warn_no": 1}]}]}