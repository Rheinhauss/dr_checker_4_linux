{"all_contexts":[
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 2056, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ucmd = (const struct qib_cmd __user *) data;", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_write"}, "warn_no": 1},
{"warn_data": {"at_line": 2046, "warn_str": "Trying to use a global variable without locking.", "at": "pr_err_once(\"qib_write: process %d (%s) changed security contexts after opening file descriptor, this is not allowed.\\n\",", "inst_trace": [{"instr_func": "qib_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "GlobalVariableRaceDetector says:", "at_func": "qib_write"}, "warn_no": 2},
{"warn_data": {"at_line": 2141, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if ((count - consumed) < copy) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "qib_write", "instr_loc": 2036, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "qib_write", "instr_loc": 2141, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if ((count - consumed) < copy) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_write"}, "warn_no": 3},
{"warn_data": {"at_line": 2145, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(dest, src, copy)) {", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_write"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2202, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = disarm_req_delay(rcd);"}, {"lineno": 1946, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(rcd->ppd)) {"}],
"warnings":[{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2202, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = disarm_req_delay(rcd);"}, {"lineno": 1965, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (i = 0; !usable(rcd->ppd) && i < 300; i++)"}],
"warnings":[{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2197, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_set_part_key(rcd, cmd.cmd.part_key);"}],
"warnings":[{"warn_data": {"at_line": 597, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rcd->pkeys[i] == key)", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2145, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (copy_from_user(dest, src, copy)) {"}, {"instr_func": "qib_write", "instr_loc": 2197, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_set_part_key(rcd, cmd.cmd.part_key);"}, {"instr_func": "qib_write", "instr_loc": 2197, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_set_part_key(rcd, cmd.cmd.part_key);"}, {"instr_func": "qib_set_part_key", "instr_loc": 573, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "qib_set_part_key", "instr_loc": 597, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (rcd->pkeys[i] == key)"}, {"instr_func": "qib_set_part_key", "instr_loc": 597, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (rcd->pkeys[i] == key)"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_set_part_key"}, "warn_no": 1},
{"warn_data": {"at_line": 620, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((ppd->pkeys[i] & 0x7FFF) == lkey)", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_set_part_key", "instr_loc": 620, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if ((ppd->pkeys[i] & 0x7FFF) == lkey)"}, {"instr_func": "qib_set_part_key", "instr_loc": 620, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if ((ppd->pkeys[i] & 0x7FFF) == lkey)"}, {"instr_func": "qib_set_part_key", "instr_loc": 620, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if ((ppd->pkeys[i] & 0x7FFF) == lkey)"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_set_part_key"}, "warn_no": 2},
{"warn_data": {"at_line": 635, "warn_str": "Trying to read from a user pointer.", "at": "(void) ppd->dd->f_set_ib_cfg(ppd, QIB_IB_CFG_PKEYS, 0);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_set_part_key", "instr_loc": 635, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(void) ppd->dd->f_set_ib_cfg(ppd, QIB_IB_CFG_PKEYS, 0);"}, {"instr_func": "qib_set_part_key", "instr_loc": 635, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(void) ppd->dd->f_set_ib_cfg(ppd, QIB_IB_CFG_PKEYS, 0);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_set_part_key"}, "warn_no": 3}]},
{"num_warnings": 17,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2193, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_free(rcd, subctxt_fp(fp), &cmd.cmd.tid_info);"}],
"warnings":[{"warn_data": {"at_line": 507, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 507, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_free", "instr_loc": 507, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 1},
{"warn_data": {"at_line": 497, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(tidmap, u64_to_user_ptr(ti->tidmap),", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_tid_free"}, "warn_no": 2},
{"warn_data": {"at_line": 509, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ctxttid += dd->rcvtidcnt - tidcnt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 3},
{"warn_data": {"at_line": 509, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ctxttid += dd->rcvtidcnt - tidcnt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 4},
{"warn_data": {"at_line": 512, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ctxttid += tidcnt * (subctxt - 1);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 511, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 511, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 511, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 512, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidcnt * (subctxt - 1);"}, {"instr_func": "qib_tid_free", "instr_loc": 512, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidcnt * (subctxt - 1);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 5},
{"warn_data": {"at_line": 523, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (cnt = 0; tid < limit; tid++) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %34 = add i64 0, %33, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %35 = and i64 %21, %34, !dbg !16309"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %35, i64* %7, align 8, !dbg !16304"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %39 = load i64, i64* %7, align 8, !dbg !16311"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %39, i64* %3, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %42 = load i64, i64* %3, align 8, !dbg !16315"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 523, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (cnt = 0; tid < limit; tid++) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 6},
{"warn_data": {"at_line": 538, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "p = dd->pageshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 538, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "p = dd->pageshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 7},
{"warn_data": {"at_line": 538, "warn_str": "Trying to read from a user pointer.", "at": "p = dd->pageshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 538, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "p = dd->pageshadow[ctxttid + tid];"}, {"instr_func": "qib_tid_free", "instr_loc": 538, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "p = dd->pageshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_free"}, "warn_no": 8},
{"warn_data": {"at_line": 539, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->pageshadow[ctxttid + tid] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 539, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 9},
{"warn_data": {"at_line": 539, "warn_str": "Trying to write to a user pointer.", "at": "dd->pageshadow[ctxttid + tid] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 539, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}, {"instr_func": "qib_tid_free", "instr_loc": 539, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_free"}, "warn_no": 10},
{"warn_data": {"at_line": 540, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "phys = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 509, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 540, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 11},
{"warn_data": {"at_line": 540, "warn_str": "Trying to read from a user pointer.", "at": "phys = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 540, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}, {"instr_func": "qib_tid_free", "instr_loc": 540, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_free"}, "warn_no": 12},
{"warn_data": {"at_line": 541, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 541, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 13},
{"warn_data": {"at_line": 541, "warn_str": "Trying to write to a user pointer.", "at": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 541, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}, {"instr_func": "qib_tid_free", "instr_loc": 541, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_free"}, "warn_no": 14},
{"warn_data": {"at_line": 534, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (dd->pageshadow[ctxttid + tid]) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 503, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 534, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_free"}, "warn_no": 15},
{"warn_data": {"at_line": 534, "warn_str": "Trying to read from a user pointer.", "at": "if (dd->pageshadow[ctxttid + tid]) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 534, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}, {"instr_func": "qib_tid_free", "instr_loc": 534, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_free"}, "warn_no": 16},
{"warn_data": {"at_line": 523, "warn_str": "Loop is bounded by a tainted value.", "at": "for (cnt = 0; tid < limit; tid++) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %34 = add i64 0, %33, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %35 = and i64 %21, %34, !dbg !16309"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %35, i64* %7, align 8, !dbg !16304"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %39 = load i64, i64* %7, align 8, !dbg !16311"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %39, i64* %3, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %42 = load i64, i64* %3, align 8, !dbg !16315"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 523, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (cnt = 0; tid < limit; tid++) {"}, {"instr_func": "qib_tid_free", "instr_loc": 523, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (cnt = 0; tid < limit; tid++) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_tid_free"}, "warn_no": 17}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2193, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_free(rcd, subctxt_fp(fp), &cmd.cmd.tid_info);"}, {"lineno": 522, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}],
"warnings":[{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %26 = sub i64 %25, 1, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 1},
{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %27 = sub i64 63, %26, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 2},
{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %34 = add i64 0, %33, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 505, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2193, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_free(rcd, subctxt_fp(fp), &cmd.cmd.tid_info);"}, {"lineno": 531, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !16331", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_free", "instr_loc": 508, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_free", "instr_loc": 508, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_free", "instr_loc": 507, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_free", "instr_loc": 507, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 521, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %34 = add i64 0, %33, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %35 = and i64 %21, %34, !dbg !16309"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %35, i64* %7, align 8, !dbg !16304"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %39 = load i64, i64* %7, align 8, !dbg !16311"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %39, i64* %3, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %42 = load i64, i64* %3, align 8, !dbg !16315"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 522, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit(tidmap, limit);"}, {"instr_func": "qib_tid_free", "instr_loc": 531, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}, {"instr_func": "qib_tid_free", "instr_loc": 531, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !16327"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !16332"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !16333"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !16331"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 32,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_update(rcd, fp, &cmd.cmd.tid_info);"}],
"warnings":[{"warn_data": {"at_line": 314, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 1},
{"warn_data": {"at_line": 316, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tidoff = dd->rcvtidcnt - tidcnt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 2},
{"warn_data": {"at_line": 317, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ctxttid += tidoff;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 3},
{"warn_data": {"at_line": 322, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ctxttid += tidoff;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 322, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 4},
{"warn_data": {"at_line": 366, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (i = 0; i < cnt; i++, vaddr += PAGE_SIZE) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 345, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "vaddr = ti->tidvaddr;"}, {"instr_func": "qib_tid_update", "instr_loc": 345, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "vaddr = ti->tidvaddr;"}, {"instr_func": "qib_tid_update", "instr_loc": 366, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (i = 0; i < cnt; i++, vaddr += PAGE_SIZE) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 5},
{"warn_data": {"at_line": 389, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tidlist[i] = tid + tidoff;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 389, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist[i] = tid + tidoff;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 6},
{"warn_data": {"at_line": 389, "warn_str": "Trying to write to a user pointer.", "at": "tidlist[i] = tid + tidoff;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 333, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist = (u16 *) &pagep[dd->rcvtidcnt];"}, {"instr_func": "qib_tid_update", "instr_loc": 333, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist = (u16 *) &pagep[dd->rcvtidcnt];"}, {"instr_func": "qib_tid_update", "instr_loc": 333, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist = (u16 *) &pagep[dd->rcvtidcnt];"}, {"instr_func": "qib_tid_update", "instr_loc": 333, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist = (u16 *) &pagep[dd->rcvtidcnt];"}, {"instr_func": "qib_tid_update", "instr_loc": 389, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist[i] = tid + tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 389, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidlist[i] = tid + tidoff;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 7},
{"warn_data": {"at_line": 391, "warn_str": "Trying to read from a user pointer.", "at": "dd->pageshadow[ctxttid + tid] = pagep[i];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 315, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_update", "instr_loc": 315, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 391, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = pagep[i];"}, {"instr_func": "qib_tid_update", "instr_loc": 391, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = pagep[i];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 8},
{"warn_data": {"at_line": 391, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->pageshadow[ctxttid + tid] = pagep[i];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 391, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = pagep[i];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 9},
{"warn_data": {"at_line": 391, "warn_str": "Trying to write to a user pointer.", "at": "dd->pageshadow[ctxttid + tid] = pagep[i];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 391, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = pagep[i];"}, {"instr_func": "qib_tid_update", "instr_loc": 391, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = pagep[i];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 10},
{"warn_data": {"at_line": 392, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->physshadow[ctxttid + tid] = daddr;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 392, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = daddr;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 11},
{"warn_data": {"at_line": 392, "warn_str": "Trying to write to a user pointer.", "at": "dd->physshadow[ctxttid + tid] = daddr;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 392, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = daddr;"}, {"instr_func": "qib_tid_update", "instr_loc": 392, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = daddr;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 12},
{"warn_data": {"at_line": 397, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "physaddr = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 397, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "physaddr = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 13},
{"warn_data": {"at_line": 397, "warn_str": "Trying to read from a user pointer.", "at": "physaddr = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 397, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "physaddr = dd->physshadow[ctxttid + tid];"}, {"instr_func": "qib_tid_update", "instr_loc": 397, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "physaddr = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 14},
{"warn_data": {"at_line": 385, "warn_str": "Trying to read from a user pointer.", "at": "ret = qib_map_page(dd->pcidev, pagep[i], &daddr);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 315, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_update", "instr_loc": 315, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(dd->rcvtidcnt % rcd->subctxt_cnt);"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 334, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "pagep += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 385, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_map_page(dd->pcidev, pagep[i], &daddr);"}, {"instr_func": "qib_tid_update", "instr_loc": 385, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_map_page(dd->pcidev, pagep[i], &daddr);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 15},
{"warn_data": {"at_line": 375, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ntids < 0) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 339, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ntids = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 339, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ntids = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 375, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (ntids < 0) {"}, {"instr_func": "qib_tid_update", "instr_loc": 375, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (ntids < 0) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_tid_update"}, "warn_no": 16},
{"warn_data": {"at_line": 372, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (!dd->pageshadow[ctxttid + tid])", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 372, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!dd->pageshadow[ctxttid + tid])"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 17},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "if (!dd->pageshadow[ctxttid + tid])", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 372, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!dd->pageshadow[ctxttid + tid])"}, {"instr_func": "qib_tid_update", "instr_loc": 372, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!dd->pageshadow[ctxttid + tid])"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 18},
{"warn_data": {"at_line": 369, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (; ntids--; tid++) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 339, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ntids = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 339, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ntids = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 369, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; ntids--; tid++) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 19},
{"warn_data": {"at_line": 366, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < cnt; i++, vaddr += PAGE_SIZE) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 366, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (i = 0; i < cnt; i++, vaddr += PAGE_SIZE) {"}, {"instr_func": "qib_tid_update", "instr_loc": 366, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (i = 0; i < cnt; i++, vaddr += PAGE_SIZE) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_tid_update"}, "warn_no": 20},
{"warn_data": {"at_line": 445, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "(unsigned long) ti->tidlist,", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_tid_update"}, "warn_no": 21},
{"warn_data": {"at_line": 450, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(u64_to_user_ptr(ti->tidmap),", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_tid_update"}, "warn_no": 22},
{"warn_data": {"at_line": 434, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->pageshadow[ctxttid + tid] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 434, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 23},
{"warn_data": {"at_line": 418, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (; tid < limit; tid++) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %34 = add i64 0, %33, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %35 = and i64 %21, %34, !dbg !16309"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %35, i64* %7, align 8, !dbg !16304"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %39 = load i64, i64* %7, align 8, !dbg !16311"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %39, i64* %3, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %42 = load i64, i64* %3, align 8, !dbg !16315"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 24},
{"warn_data": {"at_line": 434, "warn_str": "Trying to write to a user pointer.", "at": "dd->pageshadow[ctxttid + tid] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 434, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}, {"instr_func": "qib_tid_update", "instr_loc": 434, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->pageshadow[ctxttid + tid] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 25},
{"warn_data": {"at_line": 424, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "phys = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 424, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 26},
{"warn_data": {"at_line": 424, "warn_str": "Trying to read from a user pointer.", "at": "phys = dd->physshadow[ctxttid + tid];", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 424, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}, {"instr_func": "qib_tid_update", "instr_loc": 424, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "phys = dd->physshadow[ctxttid + tid];"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 27},
{"warn_data": {"at_line": 425, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 316, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidoff = dd->rcvtidcnt - tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 425, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 28},
{"warn_data": {"at_line": 425, "warn_str": "Trying to write to a user pointer.", "at": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 425, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}, {"instr_func": "qib_tid_update", "instr_loc": 425, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->physshadow[ctxttid + tid] = dd->tidinvalid;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 29},
{"warn_data": {"at_line": 421, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (dd->pageshadow[ctxttid + tid]) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid = rcd->ctxt * dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 317, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ctxttid += tidoff;"}, {"instr_func": "qib_tid_update", "instr_loc": 421, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_tid_update"}, "warn_no": 30},
{"warn_data": {"at_line": 421, "warn_str": "Trying to read from a user pointer.", "at": "if (dd->pageshadow[ctxttid + tid]) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 421, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}, {"instr_func": "qib_tid_update", "instr_loc": 421, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (dd->pageshadow[ctxttid + tid]) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "qib_tid_update"}, "warn_no": 31},
{"warn_data": {"at_line": 418, "warn_str": "Loop is bounded by a tainted value.", "at": "for (; tid < limit; tid++) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 320, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt / rcd->subctxt_cnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %44 = load i64, i64* %6, align 8, !dbg !16316"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "qib_tid_update"}, "warn_no": 32}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_update(rcd, fp, &cmd.cmd.tid_info);"}, {"lineno": 346, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !16301", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 32, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !16300"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 29, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !16298", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 303, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "cnt = ti->tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "qib_tid_update", "instr_loc": 346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!access_ok((void __user *) vaddr,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 29, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !16298"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_update(rcd, fp, &cmd.cmd.tid_info);"}, {"lineno": 417, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}],
"warnings":[{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %26 = sub i64 %25, 1, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 1},
{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %27 = sub i64 63, %26, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 2},
{"warn_data": {"at_line": 112, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %34 = add i64 0, %33, !dbg !16307", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 310, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = dd->rcvtidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %26 = sub i64 %25, 1, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %27 = sub i64 63, %26, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %32 = lshr i64 -1, %27, !dbg !16307"}, {"instr_func": "find_first_bit", "instr_loc": 112, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %33 = and i64 -1, %32, !dbg !16307"}], "at_file": "./include/asm-generic/bitops/find.h", "by": "IntegerOverflowDetector says:", "at_func": "find_first_bit"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_tid_update(rcd, fp, &cmd.cmd.tid_info);"}, {"lineno": 419, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !16331", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 314, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tidcnt = (dd->rcvtidcnt / rcd->subctxt_cnt) +"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 416, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "limit = tidcnt;"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "find_first_bit", "instr_loc": 110, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %44 = load i64, i64* %6, align 8, !dbg !16316"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %46 = phi i64 [ %42, %38 ], [ %44, %43 ], !dbg !16310"}, {"instr_func": "find_first_bit", "instr_loc": 114, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  store i64 %46, i64* %4, align 8, !dbg !16317"}, {"instr_func": "find_first_bit", "instr_loc": 118, "instr_file": "./include/asm-generic/bitops/find.h", "instr": "  %52 = load i64, i64* %4, align 8, !dbg !16322"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 417, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "tid = find_first_bit((const unsigned long *)tidmap, limit);"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 418, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (; tid < limit; tid++) {"}, {"instr_func": "qib_tid_update", "instr_loc": 419, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}, {"instr_func": "qib_tid_update", "instr_loc": 419, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!test_bit(tid, tidmap))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !16327"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !16332"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !16333"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !16331"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2184, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_ctxt_info(fp, (struct qib_ctxt_info __user *)"}],
"warnings":[{"warn_data": {"at_line": 1895, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info.num_ctxts = rcd->dd->cfgctxts - rcd->dd->first_user_ctxt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_ctxt_info", "instr_loc": 1895, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "info.num_ctxts = rcd->dd->cfgctxts - rcd->dd->first_user_ctxt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_ctxt_info"}, "warn_no": 1},
{"warn_data": {"at_line": 1880, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_ctxt_info"}, "warn_no": 2}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2171, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_do_user_init(fp, &cmd.cmd.user_info);"}],
"warnings":[{"warn_data": {"at_line": 1673, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rcd->pio_base = rcd->piocnt * uctxt +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1672, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->pbufsctxt;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1672, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->pbufsctxt;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 1},
{"warn_data": {"at_line": 1667, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "uctxt = rcd->ctxt - dd->first_user_ctxt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1667, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "uctxt = rcd->ctxt - dd->first_user_ctxt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 2},
{"warn_data": {"at_line": 1669, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rcd->piocnt = dd->pbufsctxt + 1;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1669, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->pbufsctxt + 1;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 3},
{"warn_data": {"at_line": 1683, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if ((rcd->pio_base + rcd->piocnt) > dd->piobcnt2k) {", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1672, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->pbufsctxt;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1672, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->pbufsctxt;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}, {"instr_func": "qib_do_user_init", "instr_loc": 1673, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->pio_base = rcd->piocnt * uctxt +"}, {"instr_func": "qib_do_user_init", "instr_loc": 1683, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if ((rcd->pio_base + rcd->piocnt) > dd->piobcnt2k) {"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 4},
{"warn_data": {"at_line": 1691, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rcd->piocnt = dd->piobcnt2k - rcd->pio_base;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1691, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piocnt = dd->piobcnt2k - rcd->pio_base;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 5},
{"warn_data": {"at_line": 1696, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rcd->piobufs = dd->pio2k_bufbase + rcd->pio_base * dd->palign;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_do_user_init", "instr_loc": 1696, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "rcd->piobufs = dd->pio2k_bufbase + rcd->pio_base * dd->palign;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_do_user_init"}, "warn_no": 6}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2174, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_get_base_info(fp, u64_to_user_ptr("}],
"warnings":[{"warn_data": {"at_line": 209, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_piobufbase = (u64) rcd->piobufs +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 1},
{"warn_data": {"at_line": 153, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_tidcnt += dd->rcvtidcnt % subctxt_cnt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 153, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_tidcnt += dd->rcvtidcnt % subctxt_cnt;"}, {"instr_func": "qib_get_base_info", "instr_loc": 153, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_tidcnt += dd->rcvtidcnt % subctxt_cnt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 2},
{"warn_data": {"at_line": 191, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(char *) ppd->statusp -", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 191, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(char *) ppd->statusp -"}, {"instr_func": "qib_get_base_info", "instr_loc": 190, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_status = (u64) kinfo->spi_pioavailaddr +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 3},
{"warn_data": {"at_line": 193, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_uregbase = (u64) dd->uregbase + dd->ureg_align * rcd->ctxt;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 193, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_uregbase = (u64) dd->uregbase + dd->ureg_align * rcd->ctxt;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 4},
{"warn_data": {"at_line": 231, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_pioindex = (kinfo->spi_piobufbase - dd->pio2k_bufbase) /", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}, {"instr_func": "qib_get_base_info", "instr_loc": 210, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign * kinfo->spi_piocnt * slave;"}, {"instr_func": "qib_get_base_info", "instr_loc": 209, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_piobufbase = (u64) rcd->piobufs +"}, {"instr_func": "qib_get_base_info", "instr_loc": 209, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_piobufbase = (u64) rcd->piobufs +"}, {"instr_func": "qib_get_base_info", "instr_loc": 231, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_pioindex = (kinfo->spi_piobufbase - dd->pio2k_bufbase) /"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 5},
{"warn_data": {"at_line": 202, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_piobufbase = (u64) rcd->piobufs +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 203, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign *"}, {"instr_func": "qib_get_base_info", "instr_loc": 203, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->palign *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 6},
{"warn_data": {"at_line": 240, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "kinfo->spi_piosize = dd->piosize2k - 2 * sizeof(u32);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "qib_get_base_info", "instr_loc": 240, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_piosize = dd->piosize2k - 2 * sizeof(u32);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 7},
{"warn_data": {"at_line": 251, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = (ubase_size < sizeof(*kinfo)) ? ubase_size : sizeof(*kinfo);", "inst_trace": [], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "qib_get_base_info"}, "warn_no": 8}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2174, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_get_base_info(fp, u64_to_user_ptr("}, {"lineno": 129, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo = kzalloc(sizeof(*kinfo), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !16556", "inst_trace": [{"instr_func": "qib_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "qib_write", "instr_loc": 2174, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_get_base_info(fp, u64_to_user_ptr("}, {"instr_func": "qib_get_base_info", "instr_loc": 129, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo = kzalloc(sizeof(*kinfo), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2174, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_get_base_info(fp, u64_to_user_ptr("}, {"lineno": 197, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_sendbuf_status = cvt_kvaddr(rcd->user_event_mask);"}],
"warnings":[{"warn_data": {"at_line": 93, "warn_str": "Trying to use a global variable without locking.", "at": "paddr = page_to_pfn(page) << PAGE_SHIFT;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "qib_write", "instr_loc": 2174, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_get_base_info(fp, u64_to_user_ptr("}, {"instr_func": "qib_get_base_info", "instr_loc": 197, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "kinfo->spi_sendbuf_status = cvt_kvaddr(rcd->user_event_mask);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "GlobalVariableRaceDetector says:", "at_func": "cvt_kvaddr"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1612, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_shared_ctxt(fp, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1496, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rcd->subctxt_id != uinfo->spu_subctxt_id)", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_shared_ctxt", "instr_loc": 1496, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (rcd->subctxt_id != uinfo->spu_subctxt_id)"}, {"instr_func": "find_shared_ctxt", "instr_loc": 1496, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (rcd->subctxt_id != uinfo->spu_subctxt_id)"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "find_shared_ctxt"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1631, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!find_free_ctxt(unit, fp, uinfo)) {"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1380, "warn_str": "Loop is bounded by a tainted value.", "at": "for (pidx = 0; pidx < dd->num_pports && !ppd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 0, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "  %116 = phi i1 [ false, %110 ], [ %114, %111 ], !dbg !16388"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "choose_port_ctxt"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1631, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!find_free_ctxt(unit, fp, uinfo)) {"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1361, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}],
"warnings":[{"warn_data": {"at_line": 1344, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 3},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 4},
{"warn_data": {"at_line": 1347, "warn_str": "Trying to read from a user pointer.", "at": "(ppd->lflags & QIBL_LINKACTIVE);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 5}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1631, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!find_free_ctxt(unit, fp, uinfo)) {"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}],
"warnings":[{"warn_data": {"at_line": 1288, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 1},
{"warn_data": {"at_line": 1298, "warn_str": "Trying to read from a user pointer.", "at": "numa_node_id()) : dd->assigned_node_id;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 2},
{"warn_data": {"at_line": 1307, "warn_str": "Trying to read from a user pointer.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 3},
{"warn_data": {"at_line": 1308, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcvtidcnt * sizeof(struct page **),", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 4},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 5},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 6},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 7},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 8},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 9},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 10},
{"warn_data": {"at_line": 1312, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 11},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 12},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 13},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to read from a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 14},
{"warn_data": {"at_line": 1327, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 15},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to write to a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 16},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 17},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to write to a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 18}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1631, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!find_free_ctxt(unit, fp, uinfo)) {"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1294, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}],
"warnings":[{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 1},
{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 2},
{"warn_data": {"at_line": 1176, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1631, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!find_free_ctxt(unit, fp, uinfo)) {"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1318, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1234, "warn_str": "Trying to read from a user pointer.", "at": "qib_devinfo(dd->pcidev,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 1},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 2},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 3},
{"warn_data": {"at_line": 1252, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "init_subctxts"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1461, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1380, "warn_str": "Loop is bounded by a tainted value.", "at": "for (pidx = 0; pidx < dd->num_pports && !ppd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 0, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "  %116 = phi i1 [ false, %110 ], [ %114, %111 ], !dbg !16388"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "choose_port_ctxt"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1461, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"lineno": 1361, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}],
"warnings":[{"warn_data": {"at_line": 1344, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 3},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 4},
{"warn_data": {"at_line": 1347, "warn_str": "Trying to read from a user pointer.", "at": "(ppd->lflags & QIBL_LINKACTIVE);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 5}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1461, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}],
"warnings":[{"warn_data": {"at_line": 1288, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 1},
{"warn_data": {"at_line": 1308, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcvtidcnt * sizeof(struct page **),", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 2},
{"warn_data": {"at_line": 1298, "warn_str": "Trying to read from a user pointer.", "at": "numa_node_id()) : dd->assigned_node_id;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 3},
{"warn_data": {"at_line": 1307, "warn_str": "Trying to read from a user pointer.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 4},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 5},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 6},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 7},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 8},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 9},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 10},
{"warn_data": {"at_line": 1312, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 11},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 12},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 13},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to read from a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 14},
{"warn_data": {"at_line": 1327, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 15},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to write to a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 16},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to write to a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 17},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 18}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1461, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1294, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}],
"warnings":[{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 1},
{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 2},
{"warn_data": {"at_line": 1176, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1461, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1318, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1234, "warn_str": "Trying to read from a user pointer.", "at": "qib_devinfo(dd->pcidev,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 1},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 2},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 3},
{"warn_data": {"at_line": 1252, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1461, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "init_subctxts"}, "warn_no": 4}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1433, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}],
"warnings":[{"warn_data": {"at_line": 1344, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 3},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 4},
{"warn_data": {"at_line": 1347, "warn_str": "Trying to read from a user pointer.", "at": "(ppd->lflags & QIBL_LINKACTIVE);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "get_a_ctxt", "instr_loc": 1433, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "usable(dd->pport + port - 1))"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1453, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1380, "warn_str": "Loop is bounded by a tainted value.", "at": "for (pidx = 0; pidx < dd->num_pports && !ppd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 0, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "  %116 = phi i1 [ false, %110 ], [ %114, %111 ], !dbg !16388"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "choose_port_ctxt"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1453, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"lineno": 1361, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}],
"warnings":[{"warn_data": {"at_line": 1344, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 3},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 4},
{"warn_data": {"at_line": 1347, "warn_str": "Trying to read from a user pointer.", "at": "(ppd->lflags & QIBL_LINKACTIVE);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 5}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1453, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}],
"warnings":[{"warn_data": {"at_line": 1288, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 1},
{"warn_data": {"at_line": 1308, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcvtidcnt * sizeof(struct page **),", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 2},
{"warn_data": {"at_line": 1298, "warn_str": "Trying to read from a user pointer.", "at": "numa_node_id()) : dd->assigned_node_id;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 3},
{"warn_data": {"at_line": 1307, "warn_str": "Trying to read from a user pointer.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 4},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 5},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 6},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 7},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 8},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 9},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 10},
{"warn_data": {"at_line": 1312, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 11},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 12},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 13},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to read from a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 14},
{"warn_data": {"at_line": 1327, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 15},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to write to a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 16},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to write to a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 17},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 18}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1453, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1294, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}],
"warnings":[{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 1},
{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 2},
{"warn_data": {"at_line": 1176, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1635, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = get_a_ctxt(fp, uinfo, alg);"}, {"lineno": 1453, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1318, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1234, "warn_str": "Trying to read from a user pointer.", "at": "qib_devinfo(dd->pcidev,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 1},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 2},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 3},
{"warn_data": {"at_line": 1252, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1410, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "u32 port = uinfo->spu_port, ctxt;"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "get_a_ctxt", "instr_loc": 1453, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, udd, port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "init_subctxts"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1623, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_free_ctxt(i_minor - 1, fp, uinfo);"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1380, "warn_str": "Loop is bounded by a tainted value.", "at": "for (pidx = 0; pidx < dd->num_pports && !ppd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1380, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "for (pidx = 0; pidx < dd->num_pports && !ppd;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 0, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "  %116 = phi i1 [ false, %110 ], [ %114, %111 ], !dbg !16388"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "choose_port_ctxt"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1623, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_free_ctxt(i_minor - 1, fp, uinfo);"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1361, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}],
"warnings":[{"warn_data": {"at_line": 1344, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 1},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 2},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1344, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 3},
{"warn_data": {"at_line": 1346, "warn_str": "Trying to read from a user pointer.", "at": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}, {"instr_func": "usable", "instr_loc": 1346, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "return dd && (dd->flags & QIB_PRESENT) && dd->kregbase && ppd->lid &&"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 4},
{"warn_data": {"at_line": 1347, "warn_str": "Trying to read from a user pointer.", "at": "(ppd->lflags & QIBL_LINKACTIVE);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1361, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "if (!usable(dd->pport + port - 1)) {"}, {"instr_func": "usable", "instr_loc": 1343, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}, {"instr_func": "usable", "instr_loc": 1347, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "(ppd->lflags & QIBL_LINKACTIVE);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usable"}, "warn_no": 5}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1623, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_free_ctxt(i_minor - 1, fp, uinfo);"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}],
"warnings":[{"warn_data": {"at_line": 1288, "warn_str": "Trying to read from a user pointer.", "at": "struct qib_devdata *dd = ppd->dd;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 1},
{"warn_data": {"at_line": 1298, "warn_str": "Trying to read from a user pointer.", "at": "numa_node_id()) : dd->assigned_node_id;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}, {"instr_func": "setup_ctxt", "instr_loc": 1298, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "numa_node_id()) : dd->assigned_node_id;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 2},
{"warn_data": {"at_line": 1307, "warn_str": "Trying to read from a user pointer.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 3},
{"warn_data": {"at_line": 1308, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcvtidcnt * sizeof(struct page **),", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}, {"instr_func": "setup_ctxt", "instr_loc": 1308, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcvtidcnt * sizeof(struct page **),"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 4},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 5},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 6},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 7},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 8},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 9},
{"warn_data": {"at_line": 1307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}, {"instr_func": "setup_ctxt", "instr_loc": 1307, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ptmp = kmalloc(dd->rcvtidcnt * sizeof(u16) +"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 10},
{"warn_data": {"at_line": 1312, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "setup_ctxt", "instr_loc": 1312, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 11},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 12},
{"warn_data": {"at_line": 1323, "warn_str": "Trying to read from a user pointer.", "at": "init_waitqueue_head(&dd->rcd[ctxt]->wait);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}, {"instr_func": "setup_ctxt", "instr_loc": 1323, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "init_waitqueue_head(&dd->rcd[ctxt]->wait);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 13},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to read from a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 14},
{"warn_data": {"at_line": 1327, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "setup_ctxt"}, "warn_no": 15},
{"warn_data": {"at_line": 1327, "warn_str": "Trying to write to a user pointer.", "at": "dd->freectxts--;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}, {"instr_func": "setup_ctxt", "instr_loc": 1327, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->freectxts--;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 16},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to read from a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 17},
{"warn_data": {"at_line": 1335, "warn_str": "Trying to write to a user pointer.", "at": "dd->rcd[ctxt] = NULL;", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}, {"instr_func": "setup_ctxt", "instr_loc": 1335, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "dd->rcd[ctxt] = NULL;"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "setup_ctxt"}, "warn_no": 18}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1623, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_free_ctxt(i_minor - 1, fp, uinfo);"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1294, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}],
"warnings":[{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 1},
{"warn_data": {"at_line": 1146, "warn_str": "Trying to read from a user pointer.", "at": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1146, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "const struct cpumask *local_mask = cpumask_of_pcibus(dd->pcidev->bus);"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 2},
{"warn_data": {"at_line": 1176, "warn_str": "Trying to read from a user pointer.", "at": "qib_dev_err(dd,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "setup_ctxt", "instr_loc": 1294, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "assign_ctxt_affinity(fp, dd);"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1143, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}, {"instr_func": "assign_ctxt_affinity", "instr_loc": 1176, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_dev_err(dd,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "assign_ctxt_affinity"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 2165, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = qib_assign_ctxt(fp, &cmd.cmd.user_info);"}, {"lineno": 1623, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = find_free_ctxt(i_minor - 1, fp, uinfo);"}, {"lineno": 1400, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"lineno": 1386, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"lineno": 1318, "file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}],
"warnings":[{"warn_data": {"at_line": 1234, "warn_str": "Trying to read from a user pointer.", "at": "qib_devinfo(dd->pcidev,", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}, {"instr_func": "init_subctxts", "instr_loc": 1234, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "qib_devinfo(dd->pcidev,"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 1},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 2},
{"warn_data": {"at_line": 1252, "warn_str": "Trying to read from a user pointer.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "init_subctxts"}, "warn_no": 3},
{"warn_data": {"at_line": 1252, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *", "inst_trace": [{"instr_func": "qib_write", "instr_loc": 2056, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ucmd = (const struct qib_cmd __user *) data;"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "find_free_ctxt", "instr_loc": 1400, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = choose_port_ctxt(fp, dd, uinfo->spu_port, uinfo);"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1356, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1365, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ppd = dd->pport + port - 1;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "choose_port_ctxt", "instr_loc": 1386, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = ppd ? setup_ctxt(ppd, ctxt, fp, uinfo) : -ENETDOWN;"}, {"instr_func": "setup_ctxt", "instr_loc": 1286, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1288, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "struct qib_devdata *dd = ppd->dd;"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "setup_ctxt", "instr_loc": 1318, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "ret = init_subctxts(dd, rcd, uinfo);"}, {"instr_func": "init_subctxts", "instr_loc": 1218, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "{"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}, {"instr_func": "init_subctxts", "instr_loc": 1252, "instr_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "instr": "size = ALIGN(dd->rcvhdrcnt * dd->rcvhdrentsize *"}], "at_file": "drivers/infiniband/hw/qib/qib_file_ops.c", "by": "IntegerOverflowDetector says:", "at_func": "init_subctxts"}, "warn_no": 4}]}]}