{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}],
"warnings":[{"warn_data": {"at_line": 2591, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_ioctl_main"}, "warn_no": 1},
{"warn_data": {"at_line": 2649, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&karg, arg, sizeof(karg))) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_ioctl_main"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2605, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_verify_adapter(ioctl_header.ioc_number,"}],
"warnings":[{"warn_data": {"at_line": 421, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "_ctl_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "_ctl_ioctl", "instr_loc": 2737, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"instr_func": "_ctl_ioctl_main", "instr_loc": 2605, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_verify_adapter(ioctl_header.ioc_number,"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_ctl_verify_adapter"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2707, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_addnl_diag_query(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 2524, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "out:", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_addnl_diag_query"}, "warn_no": 1},
{"warn_data": {"at_line": 2489, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_addnl_diag_query"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2703, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_read_buffer(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 2375, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "copy_size = request_size - karg.starting_offset;", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2307, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2375, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "copy_size = request_size - karg.starting_offset;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "IntegerOverflowDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 1},
{"warn_data": {"at_line": 2307, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 2},
{"warn_data": {"at_line": 2379, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)uarg->diagnostic_data,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2707, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_addnl_diag_query(ioc, arg);"}, {"lineno": 2504, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}],
"warnings":[{"warn_data": {"at_line": 1534, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ioc->unique_id[index] == unique_id)", "inst_trace": [{"instr_func": "_ctl_addnl_diag_query", "instr_loc": 2489, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_addnl_diag_query", "instr_loc": 2504, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_addnl_diag_query", "instr_loc": 2504, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1530, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_diag_get_bufftype"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2699, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_release(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 2223, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_release"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2703, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_read_buffer(ioc, arg);"}, {"lineno": 2329, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}],
"warnings":[{"warn_data": {"at_line": 1534, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ioc->unique_id[index] == unique_id)", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2307, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2329, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2329, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1530, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_diag_get_bufftype"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2699, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_release(ioc, arg);"}, {"lineno": 2239, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}],
"warnings":[{"warn_data": {"at_line": 1534, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ioc->unique_id[index] == unique_id)", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 2223, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2239, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2239, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1530, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_diag_get_bufftype"}, "warn_no": 1}]},
{"num_warnings": 14,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2695, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_query(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 2028, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_query"}, "warn_no": 1},
{"warn_data": {"at_line": 2054, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2054, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2054, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 2},
{"warn_data": {"at_line": 2052, "warn_str": "Trying to read from a user pointer.", "at": "if (!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2052, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2052, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 3},
{"warn_data": {"at_line": 2063, "warn_str": "Trying to read from a user pointer.", "at": "if (karg.unique_id != ioc->unique_id[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2063, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2063, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 4},
{"warn_data": {"at_line": 2070, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2070, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2070, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 5},
{"warn_data": {"at_line": 2077, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2077, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2077, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 6},
{"warn_data": {"at_line": 2081, "warn_str": "Trying to read from a user pointer.", "at": "if (!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2081, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2081, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 7},
{"warn_data": {"at_line": 2085, "warn_str": "Trying to read from a user pointer.", "at": "if (!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2085, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2085, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 8},
{"warn_data": {"at_line": 2089, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2089, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2089, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 9},
{"warn_data": {"at_line": 2095, "warn_str": "Trying to read from a user pointer.", "at": "ioc->product_specific[buffer_type][i];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2095, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2095, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2095, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 10},
{"warn_data": {"at_line": 2097, "warn_str": "Trying to read from a user pointer.", "at": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2097, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2097, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 11},
{"warn_data": {"at_line": 2099, "warn_str": "Trying to read from a user pointer.", "at": "karg.unique_id = ioc->unique_id[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2099, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.unique_id = ioc->unique_id[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2099, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.unique_id = ioc->unique_id[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 12},
{"warn_data": {"at_line": 2100, "warn_str": "Trying to read from a user pointer.", "at": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 2028, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2044, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2100, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 2100, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 13},
{"warn_data": {"at_line": 2097, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_query"}, "warn_no": 14}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2691, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_unregister(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1944, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2691, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_unregister(ioc, arg);"}, {"lineno": 1960, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}],
"warnings":[{"warn_data": {"at_line": 1534, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ioc->unique_id[index] == unique_id)", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1944, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1960, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1960, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = _ctl_diag_get_bufftype(ioc, karg.unique_id);"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1530, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}, {"instr_func": "_ctl_diag_get_bufftype", "instr_loc": 1534, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[index] == unique_id)"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_diag_get_bufftype"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2687, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_register(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1914, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_register"}, "warn_no": 1},
{"warn_data": {"at_line": 1928, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[karg.buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register", "instr_loc": 1928, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[karg.buffer_type] |="}, {"instr_func": "_ctl_diag_register", "instr_loc": 1928, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[karg.buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register"}, "warn_no": 2},
{"warn_data": {"at_line": 1926, "warn_str": "Trying to read from a user pointer.", "at": "if (!rc && (ioc->diag_buffer_status[karg.buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register", "instr_loc": 1926, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!rc && (ioc->diag_buffer_status[karg.buffer_type] &"}, {"instr_func": "_ctl_diag_register", "instr_loc": 1926, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!rc && (ioc->diag_buffer_status[karg.buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register"}, "warn_no": 3},
{"warn_data": {"at_line": 1928, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[karg.buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register", "instr_loc": 1928, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[karg.buffer_type] |="}, {"instr_func": "_ctl_diag_register", "instr_loc": 1928, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[karg.buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2683, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1480, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &karg, sizeof(karg))) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_btdh_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 1461, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_btdh_mapping"}, "warn_no": 2}]},
{"num_warnings": 35,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2687, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_register(ioc, arg);"}, {"lineno": 1924, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_diag_register_2(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1725, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1725, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1725, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 1},
{"warn_data": {"at_line": 1594, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1594, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1594, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 2},
{"warn_data": {"at_line": 1596, "warn_str": "Trying to read from a user pointer.", "at": "!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1596, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1596, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 3},
{"warn_data": {"at_line": 1598, "warn_str": "Trying to read from a user pointer.", "at": "ioc_err(ioc,", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1598, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc_err(ioc,"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1598, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc_err(ioc,"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 4},
{"warn_data": {"at_line": 1604, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1604, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1604, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 5},
{"warn_data": {"at_line": 1656, "warn_str": "Trying to read from a user pointer.", "at": "} else if (ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1656, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "} else if (ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1656, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "} else if (ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 6},
{"warn_data": {"at_line": 1659, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->unique_id[buffer_type] != MPT3DIAGBUFFUNIQUEID ||", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1659, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] != MPT3DIAGBUFFUNIQUEID ||"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1659, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] != MPT3DIAGBUFFUNIQUEID ||"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 7},
{"warn_data": {"at_line": 1660, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] !=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1660, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] !="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1660, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] !="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 8},
{"warn_data": {"at_line": 1663, "warn_str": "Trying to read from a user pointer.", "at": "ioc_err(ioc,", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1663, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc_err(ioc,"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1663, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc_err(ioc,"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 9},
{"warn_data": {"at_line": 1617, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->unique_id[buffer_type] == MPT3DIAGBUFFUNIQUEID &&", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1617, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] == MPT3DIAGBUFFUNIQUEID &&"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1617, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] == MPT3DIAGBUFFUNIQUEID &&"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 10},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] ==", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1618, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] =="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1618, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] =="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 11},
{"warn_data": {"at_line": 1638, "warn_str": "Trying to read from a user pointer.", "at": "} else if (ioc->unique_id[buffer_type] !=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1638, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "} else if (ioc->unique_id[buffer_type] !="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1638, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "} else if (ioc->unique_id[buffer_type] !="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 12},
{"warn_data": {"at_line": 1640, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->unique_id[buffer_type] !=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1640, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] !="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1640, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->unique_id[buffer_type] !="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 13},
{"warn_data": {"at_line": 1642, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] !=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1642, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] !="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1642, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] !="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 14},
{"warn_data": {"at_line": 1644, "warn_str": "Trying to read from a user pointer.", "at": "!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1644, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1644, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 15},
{"warn_data": {"at_line": 1621, "warn_str": "Trying to read from a user pointer.", "at": "if (!(ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1621, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1621, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (!(ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 16},
{"warn_data": {"at_line": 1623, "warn_str": "Trying to read from a user pointer.", "at": "dctlprintk(ioc, ioc_info(ioc,", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1623, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "dctlprintk(ioc, ioc_info(ioc,"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1623, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "dctlprintk(ioc, ioc_info(ioc,"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 17},
{"warn_data": {"at_line": 1633, "warn_str": "Trying to write to a user pointer.", "at": "ioc->unique_id[buffer_type] =", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1633, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] ="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1633, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] ="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 18},
{"warn_data": {"at_line": 1690, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1690, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1690, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 19},
{"warn_data": {"at_line": 1692, "warn_str": "Trying to write to a user pointer.", "at": "ioc->unique_id[buffer_type] = diag_register->unique_id;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1692, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] = diag_register->unique_id;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1692, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] = diag_register->unique_id;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 20},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1696, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1696, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 21},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1696, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1696, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 22},
{"warn_data": {"at_line": 1700, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1700, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1700, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 23},
{"warn_data": {"at_line": 1703, "warn_str": "Trying to read from a user pointer.", "at": "request_data_dma = ioc->diag_buffer_dma[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1703, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1703, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 24},
{"warn_data": {"at_line": 1704, "warn_str": "Trying to read from a user pointer.", "at": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1704, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1704, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 25},
{"warn_data": {"at_line": 1706, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type],", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1706, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type],"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1706, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type],"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 26},
{"warn_data": {"at_line": 1713, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1713, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1713, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 27},
{"warn_data": {"at_line": 1714, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_dma[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1714, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1714, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 28},
{"warn_data": {"at_line": 1724, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer[buffer_type] = request_data;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1724, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = request_data;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1724, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = request_data;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 29},
{"warn_data": {"at_line": 1726, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1726, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1726, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 30},
{"warn_data": {"at_line": 1745, "warn_str": "Trying to read from a user pointer.", "at": "cpu_to_le32(ioc->product_specific[buffer_type][i]);", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 31},
{"warn_data": {"at_line": 1770, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1770, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1770, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 32},
{"warn_data": {"at_line": 1770, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1770, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1770, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 33},
{"warn_data": {"at_line": 1789, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1789, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1789, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 34},
{"warn_data": {"at_line": 1789, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1914, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1580, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1789, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1789, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 35}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2679, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_reset(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1322, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_reset"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2683, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1474, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_btdh_search_sas_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1364, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1365, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == sas_device->handle) {"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1365, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == sas_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_sas_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1370, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == sas_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1371, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "sas_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1371, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "sas_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_sas_device"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2683, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1476, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_btdh_search_pcie_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1400, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1401, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == pcie_device->handle) {"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1401, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == pcie_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_pcie_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1406, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == pcie_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1407, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "pcie_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1407, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "pcie_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_pcie_device"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2683, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1478, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "_ctl_btdh_search_raid_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1437, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == raid_device->handle) {"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1437, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == raid_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_raid_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1442, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == raid_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1461, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1443, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "raid_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1443, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "raid_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_raid_device"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2675, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventreport(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1292, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "number_bytes = karg.hdr.max_data_size -", "inst_trace": [{"instr_func": "_ctl_eventreport", "instr_loc": 1278, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_eventreport", "instr_loc": 1292, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "number_bytes = karg.hdr.max_data_size -"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "IntegerOverflowDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 1},
{"warn_data": {"at_line": 1278, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 2},
{"warn_data": {"at_line": 1303, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "number_bytes = max * sizeof(struct MPT3_IOCTL_EVENTS);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2672, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventenable(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1240, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventenable"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2668, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventquery(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1209, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventquery"}, "warn_no": 1},
{"warn_data": {"at_line": 1221, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.event_entries = MPT3SAS_CTL_EVENT_LOG_SIZE;", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventquery"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}],
"warnings":[{"warn_data": {"at_line": 710, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 1},
{"warn_data": {"at_line": 765, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data_out, karg.data_out_buf_ptr,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 2},
{"warn_data": {"at_line": 1056, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.data_in_buf_ptr, data_in,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 3},
{"warn_data": {"at_line": 1067, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 4},
{"warn_data": {"at_line": 1089, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_sense_bytes, sz_arg);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 2553, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "uarg = (struct mpt3_ioctl_command32 __user *) arg;", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_compat_mpt_command"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 936, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 936, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 936, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 878, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_set_task_mid(ioc, &karg, tm_request)) {"}],
"warnings":[{"warn_data": {"at_line": 639, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg->max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_set_task_mid"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 886, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 886, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 886, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 848, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 848, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 848, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2633, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_getiocinfo(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1192, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.bios_version = le32_to_cpu(ioc->bios_pg3.BiosVersion);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_getiocinfo"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2662, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 828, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 828, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 828, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}],
"warnings":[{"warn_data": {"at_line": 710, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 1},
{"warn_data": {"at_line": 765, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data_out, karg.data_out_buf_ptr,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 2},
{"warn_data": {"at_line": 1056, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.data_in_buf_ptr, data_in,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 3},
{"warn_data": {"at_line": 1067, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 4},
{"warn_data": {"at_line": 1089, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_sense_bytes, sz_arg);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 936, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 936, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 936, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 878, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_set_task_mid(ioc, &karg, tm_request)) {"}],
"warnings":[{"warn_data": {"at_line": 639, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg->max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_set_task_mid"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 886, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 886, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 886, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 848, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 848, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 848, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2737, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0,"}, {"lineno": 2645, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2575, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 828, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !8239", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 710, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 745, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 828, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 828, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !8235"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !8240"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !8241"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !8239"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]}]}