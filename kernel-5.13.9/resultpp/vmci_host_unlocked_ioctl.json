{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 949, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}],
"warnings":[{"warn_data": {"at_line": 897, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!retval && copy_to_user(uptr, &info, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 1},
{"warn_data": {"at_line": 872, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&info, uptr, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 2},
{"warn_data": {"at_line": 885, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &info, sizeof(info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 949, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}, {"lineno": 888, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "info.result = drv_cp_harray_to_user(ubuf, &info.db_handle_buf_size,"}],
"warnings":[{"warn_data": {"at_line": 210, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*retval = copy_to_user(user_buf_uva,", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "drv_cp_harray_to_user"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 949, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}, {"lineno": 892, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "info.result = drv_cp_harray_to_user(ubuf,"}],
"warnings":[{"warn_data": {"at_line": 210, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*retval = copy_to_user(user_buf_uva,", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "drv_cp_harray_to_user"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 947, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFY_RESOURCE, notify_resource);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &info, sizeof(info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_notify_resource"}, "warn_no": 1},
{"warn_data": {"at_line": 818, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&info, uptr, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_notify_resource"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 945, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}],
"warnings":[{"warn_data": {"at_line": 797, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &notify_info, sizeof(notify_info)) ?", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_set_notify"}, "warn_no": 1},
{"warn_data": {"at_line": 785, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&notify_info, uptr, sizeof(notify_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_set_notify"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 945, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}, {"lineno": 790, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"lineno": 249, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "context->notify = kmap(context->notify_page) + (uva & (PAGE_SIZE - 1));"}],
"warnings":[{"warn_data": {"at_line": 145, "warn_str": "Trying to use a global variable without locking.", "at": "  %10 = load i64, i64* @vmemmap_base, align 8, !dbg !5111", "inst_trace": [{"instr_func": "vmci_host_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "vmci_host_unlocked_ioctl", "instr_loc": 945, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}, {"instr_func": "vmci_host_do_set_notify", "instr_loc": 790, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 249, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "context->notify = kmap(context->notify_page) + (uva & (PAGE_SIZE - 1));"}], "at_file": "././include/linux/highmem-internal.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmap"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 941, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_SET_CPT_STATE, ctx_set_cpt_state);"}],
"warnings":[{"warn_data": {"at_line": 747, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&set_info, uptr, sizeof(set_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_set_cpt_state"}, "warn_no": 1},
{"warn_data": {"at_line": 755, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "cid = vmci_ctx_get_id(vmci_host_dev->context);", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_set_cpt_state"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_GET_CPT_STATE, ctx_get_cpt_state);"}],
"warnings":[{"warn_data": {"at_line": 715, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&get_info, uptr, sizeof(get_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 1},
{"warn_data": {"at_line": 722, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "void __user *ubuf = (void __user *)(uintptr_t)get_info.cpt_buf;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 2},
{"warn_data": {"at_line": 730, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &get_info, sizeof(get_info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 937, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_REMOVE_NOTIFICATION, ctx_remove_notify);"}],
"warnings":[{"warn_data": {"at_line": 691, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ar_info, uptr, sizeof(ar_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_remove_notify"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 935, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_ADD_NOTIFICATION, ctx_add_notify);"}],
"warnings":[{"warn_data": {"at_line": 668, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ar_info, uptr, sizeof(ar_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_add_notify"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_DETACH, qp_detach);"}],
"warnings":[{"warn_data": {"at_line": 641, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&detach_info, uptr, sizeof(detach_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_qp_detach"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 931, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_SETPAGEFILE, queuepair_setpf);"}],
"warnings":[{"warn_data": {"at_line": 570, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&page_file_info, uptr, sizeof(*info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_queuepair_setpf"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 929, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_SETVA, queuepair_setva);"}],
"warnings":[{"warn_data": {"at_line": 527, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&set_va_info, uptr, sizeof(set_va_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_queuepair_setva"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 927, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_ALLOC, alloc_queuepair);"}],
"warnings":[{"warn_data": {"at_line": 475, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vmci_qp_alloc_info alloc_info;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_alloc_queuepair"}, "warn_no": 1},
{"warn_data": {"at_line": 454, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vmci_qp_alloc_info_vmvm alloc_info;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_alloc_queuepair"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 925, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(DATAGRAM_RECEIVE, receive_datagram);"}],
"warnings":[{"warn_data": {"at_line": 422, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&recv_info, uptr, sizeof(recv_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 1},
{"warn_data": {"at_line": 430, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "void __user *ubuf = (void __user *)(uintptr_t)recv_info.addr;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 2},
{"warn_data": {"at_line": 437, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &recv_info, sizeof(recv_info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 923, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(DATAGRAM_SEND, send_datagram);"}],
"warnings":[{"warn_data": {"at_line": 366, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&send_info, uptr, sizeof(send_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_send_datagram"}, "warn_no": 1},
{"warn_data": {"at_line": 395, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "pr_devel(\"Datagram dst (handle=0x%x:0x%x) src (handle=0x%x:0x%x), payload (size=%llu bytes)\\n\",", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_send_datagram"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 921, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(INIT_CONTEXT, init_context);"}],
"warnings":[{"warn_data": {"at_line": 292, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_init_context"}, "warn_no": 1},
{"warn_data": {"at_line": 332, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "init_block.cid = vmci_ctx_get_id(vmci_host_dev->context);", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_init_context"}, "warn_no": 2}]}]}