{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}],
"warnings":[{"warn_data": {"at_line": 1949, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_init < 2)", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "random_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1951, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"lineno": 952, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}],
"warnings":[{"warn_data": {"at_line": 993, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_ready() &&", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1951, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"instr_func": "crng_reseed", "instr_loc": 952, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1951, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"lineno": 952, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 996, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 953, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"lineno": 1032, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}],
"warnings":[{"warn_data": {"at_line": 1011, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1951, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"instr_func": "crng_reseed", "instr_loc": 952, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 996, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 953, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1032, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1951, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"lineno": 952, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 996, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 948, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1483, "file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}],
"warnings":[{"warn_data": {"at_line": 198, "warn_str": "Trying to use a global variable without locking.", "at": "  %195 = load i8, i8* @trace_extract_entropy.__warned, align 1, !dbg !8234", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1951, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"instr_func": "crng_reseed", "instr_loc": 952, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 996, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 948, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1483, "instr_file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}], "at_file": "./include/trace/events/random.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_extract_entropy"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1951, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"lineno": 952, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 996, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 948, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1484, "file": "drivers/char/random.c", "instr": "nbytes = account(r, nbytes, min, reserved);"}],
"warnings":[{"warn_data": {"at_line": 1356, "warn_str": "Trying to use a global variable without locking.", "at": "if (ibytes && ENTROPY_BITS(r) < random_write_wakeup_bits) {", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1951, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"instr_func": "crng_reseed", "instr_loc": 952, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 996, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 948, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1484, "instr_file": "drivers/char/random.c", "instr": "nbytes = account(r, nbytes, min, reserved);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "account"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1951, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"lineno": 953, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"lineno": 1032, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"lineno": 1016, "file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"lineno": 996, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}],
"warnings":[{"warn_data": {"at_line": 965, "warn_str": "Trying to use a global variable without locking.", "at": "crng->init_time = jiffies;", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1951, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, &input_pool);"}, {"instr_func": "crng_reseed", "instr_loc": 953, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1032, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"instr_func": "extract_crng", "instr_loc": 1016, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"instr_func": "_extract_crng", "instr_loc": 996, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "crng_reseed"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1931, "file": "drivers/char/random.c", "instr": "retval = write_pool(&input_pool, (const char __user *)p,"}],
"warnings":[{"warn_data": {"at_line": 1871, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "bytes = min(count, sizeof(buf));", "inst_trace": [], "at_file": "drivers/char/random.c", "by": "TaintedSizeDetector says:", "at_func": "write_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 1935, "file": "drivers/char/random.c", "instr": "return credit_entropy_bits_safe(&input_pool, ent_count);"}, {"lineno": 740, "file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, nbits);"}],
"warnings":[{"warn_data": {"at_line": 722, "warn_str": "Trying to use a global variable without locking.", "at": "if (r == &input_pool) {", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 1935, "instr_file": "drivers/char/random.c", "instr": "return credit_entropy_bits_safe(&input_pool, ent_count);"}, {"instr_func": "credit_entropy_bits_safe", "instr_loc": 740, "instr_file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, nbits);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "credit_entropy_bits"}, "warn_no": 1}]}]}