{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1995, "file": "drivers/md/dm-ioctl.c", "instr": "return (long)ctl_ioctl(file, command, (struct dm_ioctl __user *)u);"}],
"warnings":[{"warn_data": {"at_line": 1985, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!r && copy_to_user(user, param, param->data_size))", "inst_trace": [], "at_file": "drivers/md/dm-ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "ctl_ioctl"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1995, "file": "drivers/md/dm-ioctl.c", "instr": "return (long)ctl_ioctl(file, command, (struct dm_ioctl __user *)u);"}, {"lineno": 1943, "file": "drivers/md/dm-ioctl.c", "instr": "r = check_version(cmd, user);"}],
"warnings":[{"warn_data": {"at_line": 1785, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/md/dm-ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "check_version"}, "warn_no": 1},
{"warn_data": {"at_line": 1805, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "version[0] = DM_VERSION_MAJOR;", "inst_trace": [], "at_file": "drivers/md/dm-ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "check_version"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1995, "file": "drivers/md/dm-ioctl.c", "instr": "return (long)ctl_ioctl(file, command, (struct dm_ioctl __user *)u);"}, {"lineno": 1962, "file": "drivers/md/dm-ioctl.c", "instr": "r = copy_params(user, &param_kernel, ioctl_flags, &param, &param_flags);"}],
"warnings":[{"warn_data": {"at_line": 1828, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/md/dm-ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "copy_params"}, "warn_no": 1},
{"warn_data": {"at_line": 1872, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "param_kernel->data_size - minimum_data_size))", "inst_trace": [{"instr_func": "copy_params", "instr_loc": 1828, "instr_file": "drivers/md/dm-ioctl.c", "instr": "{"}, {"instr_func": "copy_params", "instr_loc": 1872, "instr_file": "drivers/md/dm-ioctl.c", "instr": "param_kernel->data_size - minimum_data_size))"}], "at_file": "drivers/md/dm-ioctl.c", "by": "IntegerOverflowDetector says:", "at_func": "copy_params"}, "warn_no": 2},
{"warn_data": {"at_line": 1866, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*param_flags |= DM_PARAMS_MALLOC;", "inst_trace": [], "at_file": "drivers/md/dm-ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "copy_params"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1995, "file": "drivers/md/dm-ioctl.c", "instr": "return (long)ctl_ioctl(file, command, (struct dm_ioctl __user *)u);"}, {"lineno": 1953, "file": "drivers/md/dm-ioctl.c", "instr": "fn = lookup_ioctl(cmd, &ioctl_flags);"}],
"warnings":[{"warn_data": {"at_line": 1776, "warn_str": "Trying to use a global variable without locking.", "at": "*ioctl_flags = _ioctls[cmd].flags;", "inst_trace": [{"instr_func": "dm_ctl_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "dm_ctl_ioctl", "instr_loc": 1995, "instr_file": "drivers/md/dm-ioctl.c", "instr": "return (long)ctl_ioctl(file, command, (struct dm_ioctl __user *)u);"}, {"instr_func": "ctl_ioctl", "instr_loc": 1953, "instr_file": "drivers/md/dm-ioctl.c", "instr": "fn = lookup_ioctl(cmd, &ioctl_flags);"}], "at_file": "drivers/md/dm-ioctl.c", "by": "GlobalVariableRaceDetector says:", "at_func": "lookup_ioctl"}, "warn_no": 1}]}]}