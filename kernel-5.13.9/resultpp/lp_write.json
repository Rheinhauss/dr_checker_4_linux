{"all_contexts":[
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 303, "warn_str": "Trying to use a global variable without locking.", "at": "struct parport *port = lp_table[minor].dev->port;", "inst_trace": [{"instr_func": "lp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/char/lp.c", "by": "GlobalVariableRaceDetector says:", "at_func": "lp_write"}, "warn_no": 1},
{"warn_data": {"at_line": 325, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(kbuf, buf, copy_size)) {", "inst_trace": [], "at_file": "drivers/char/lp.c", "by": "TaintedSizeDetector says:", "at_func": "lp_write"}, "warn_no": 2},
{"warn_data": {"at_line": 398, "warn_str": "Loop is bounded by a tainted value.", "at": "} while (count > 0);", "inst_trace": [{"instr_func": "lp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lp_write", "instr_loc": 301, "instr_file": "drivers/char/lp.c", "instr": "{"}, {"instr_func": "lp_write", "instr_loc": 398, "instr_file": "drivers/char/lp.c", "instr": "} while (count > 0);"}, {"instr_func": "lp_write", "instr_loc": 398, "instr_file": "drivers/char/lp.c", "instr": "} while (count > 0);"}], "at_file": "drivers/char/lp.c", "by": "TaintedLoopBoundDetector says:", "at_func": "lp_write"}, "warn_no": 3},
{"warn_data": {"at_line": 347, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count -= written;", "inst_trace": [{"instr_func": "lp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lp_write", "instr_loc": 301, "instr_file": "drivers/char/lp.c", "instr": "{"}, {"instr_func": "lp_write", "instr_loc": 347, "instr_file": "drivers/char/lp.c", "instr": "count -= written;"}], "at_file": "drivers/char/lp.c", "by": "IntegerOverflowDetector says:", "at_func": "lp_write"}, "warn_no": 4},
{"warn_data": {"at_line": 346, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "copy_size -= written;", "inst_trace": [{"instr_func": "lp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lp_write", "instr_loc": 301, "instr_file": "drivers/char/lp.c", "instr": "{"}, {"instr_func": "lp_write", "instr_loc": 307, "instr_file": "drivers/char/lp.c", "instr": "size_t copy_size = count;"}, {"instr_func": "lp_write", "instr_loc": 307, "instr_file": "drivers/char/lp.c", "instr": "size_t copy_size = count;"}, {"instr_func": "lp_write", "instr_loc": 346, "instr_file": "drivers/char/lp.c", "instr": "copy_size -= written;"}], "at_file": "drivers/char/lp.c", "by": "IntegerOverflowDetector says:", "at_func": "lp_write"}, "warn_no": 5},
{"warn_data": {"at_line": 392, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(kbuf, buf, copy_size)) {", "inst_trace": [{"instr_func": "lp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lp_write", "instr_loc": 301, "instr_file": "drivers/char/lp.c", "instr": "{"}, {"instr_func": "lp_write", "instr_loc": 307, "instr_file": "drivers/char/lp.c", "instr": "size_t copy_size = count;"}, {"instr_func": "lp_write", "instr_loc": 307, "instr_file": "drivers/char/lp.c", "instr": "size_t copy_size = count;"}, {"instr_func": "lp_write", "instr_loc": 392, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_write", "instr_loc": 392, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_write", "instr_loc": 392, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_write", "instr_loc": 392, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}], "at_file": "drivers/char/lp.c", "by": "TaintedLoopBoundDetector says:", "at_func": "lp_write"}, "warn_no": 6},
{"warn_data": {"at_line": 392, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(kbuf, buf, copy_size)) {", "inst_trace": [], "at_file": "drivers/char/lp.c", "by": "TaintedSizeDetector says:", "at_func": "lp_write"}, "warn_no": 7}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 341, "file": "drivers/char/lp.c", "instr": "if ((retv = lp_wait_ready(minor, nonblock)) == 0)"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}],
"warnings":[{"warn_data": {"at_line": 243, "warn_str": "Trying to read from a user pointer.", "at": "unsigned char status = r_str(minor);", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_check_status"}, "warn_no": 1},
{"warn_data": {"at_line": 243, "warn_str": "Trying to read from a user pointer.", "at": "unsigned char status = r_str(minor);", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_check_status"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 341, "file": "drivers/char/lp.c", "instr": "if ((retv = lp_wait_ready(minor, nonblock)) == 0)"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}, {"lineno": 273, "file": "drivers/char/lp.c", "instr": "lp_error(minor);"}],
"warnings":[{"warn_data": {"at_line": 227, "warn_str": "Trying to read from a user pointer.", "at": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_error", "instr_loc": 227, "instr_file": "drivers/char/lp.c", "instr": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;"}, {"instr_func": "lp_error", "instr_loc": 227, "instr_file": "drivers/char/lp.c", "instr": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_error"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 341, "file": "drivers/char/lp.c", "instr": "if ((retv = lp_wait_ready(minor, nonblock)) == 0)"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}, {"lineno": 273, "file": "drivers/char/lp.c", "instr": "lp_error(minor);"}, {"lineno": 236, "file": "drivers/char/lp.c", "instr": "parport_yield_blocking(lp_table[minor].dev);"}],
"warnings":[{"warn_data": {"at_line": 442, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load %struct.pardevice*, %struct.pardevice** %13, align 8, !dbg !5054", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %12 = load %struct.parport*, %struct.parport** %11, align 8, !dbg !5053"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %13 = getelementptr inbounds %struct.parport, %struct.parport* %12, i32 0, i32 16, !dbg !5054"}], "at_file": "./include/linux/parport.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parport_yield_blocking"}, "warn_no": 1},
{"warn_data": {"at_line": 441, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %9 = sub i64 %5, %8, !dbg !5050", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 441, "instr_file": "./include/linux/parport.h", "instr": "  %8 = load i64, i64* %7, align 8, !dbg !5049"}], "at_file": "./include/linux/parport.h", "by": "IntegerOverflowDetector says:", "at_func": "parport_yield_blocking"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 379, "file": "drivers/char/lp.c", "instr": "parport_yield_blocking(lp_table[minor].dev);"}],
"warnings":[{"warn_data": {"at_line": 441, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %9 = sub i64 %5, %8, !dbg !5050", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 441, "instr_file": "./include/linux/parport.h", "instr": "  %8 = load i64, i64* %7, align 8, !dbg !5049"}], "at_file": "./include/linux/parport.h", "by": "IntegerOverflowDetector says:", "at_func": "parport_yield_blocking"}, "warn_no": 1},
{"warn_data": {"at_line": 442, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load %struct.pardevice*, %struct.pardevice** %13, align 8, !dbg !5054", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %12 = load %struct.parport*, %struct.parport** %11, align 8, !dbg !5053"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %13 = getelementptr inbounds %struct.parport, %struct.parport* %12, i32 0, i32 16, !dbg !5054"}], "at_file": "./include/linux/parport.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parport_yield_blocking"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 367, "file": "drivers/char/lp.c", "instr": "error = lp_wait_ready(minor, nonblock);"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}],
"warnings":[{"warn_data": {"at_line": 243, "warn_str": "Trying to read from a user pointer.", "at": "unsigned char status = r_str(minor);", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_check_status"}, "warn_no": 1},
{"warn_data": {"at_line": 243, "warn_str": "Trying to read from a user pointer.", "at": "unsigned char status = r_str(minor);", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}, {"instr_func": "lp_check_status", "instr_loc": 243, "instr_file": "drivers/char/lp.c", "instr": "unsigned char status = r_str(minor);"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_check_status"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 367, "file": "drivers/char/lp.c", "instr": "error = lp_wait_ready(minor, nonblock);"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}, {"lineno": 273, "file": "drivers/char/lp.c", "instr": "lp_error(minor);"}],
"warnings":[{"warn_data": {"at_line": 227, "warn_str": "Trying to read from a user pointer.", "at": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "lp_error", "instr_loc": 227, "instr_file": "drivers/char/lp.c", "instr": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;"}, {"instr_func": "lp_error", "instr_loc": 227, "instr_file": "drivers/char/lp.c", "instr": "polling = lp_table[minor].dev->port->irq == PARPORT_IRQ_NONE;"}], "at_file": "drivers/char/lp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "lp_error"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 367, "file": "drivers/char/lp.c", "instr": "error = lp_wait_ready(minor, nonblock);"}, {"lineno": 288, "file": "drivers/char/lp.c", "instr": "error = lp_check_status(minor);"}, {"lineno": 273, "file": "drivers/char/lp.c", "instr": "lp_error(minor);"}, {"lineno": 236, "file": "drivers/char/lp.c", "instr": "parport_yield_blocking(lp_table[minor].dev);"}],
"warnings":[{"warn_data": {"at_line": 442, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load %struct.pardevice*, %struct.pardevice** %13, align 8, !dbg !5054", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %12 = load %struct.parport*, %struct.parport** %11, align 8, !dbg !5053"}, {"instr_func": "parport_yield_blocking", "instr_loc": 442, "instr_file": "./include/linux/parport.h", "instr": "  %13 = getelementptr inbounds %struct.parport, %struct.parport* %12, i32 0, i32 16, !dbg !5054"}], "at_file": "./include/linux/parport.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parport_yield_blocking"}, "warn_no": 1},
{"warn_data": {"at_line": 441, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %9 = sub i64 %5, %8, !dbg !5050", "inst_trace": [{"instr_func": "lp_write", "instr_loc": 325, "instr_file": "drivers/char/lp.c", "instr": "if (copy_from_user(kbuf, buf, copy_size)) {"}, {"instr_func": "parport_yield_blocking", "instr_loc": 441, "instr_file": "./include/linux/parport.h", "instr": "  %8 = load i64, i64* %7, align 8, !dbg !5049"}], "at_file": "./include/linux/parport.h", "by": "IntegerOverflowDetector says:", "at_func": "parport_yield_blocking"}, "warn_no": 2}]}]}