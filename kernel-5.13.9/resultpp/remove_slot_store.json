{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.device_driver*, align 8"}, {"lineno": 1198, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "err = str_to_slot(buf, &domain, &bus, &slot, &func);"}],
"warnings":[{"warn_data": {"at_line": 1021, "warn_str": "Trying to read from a user pointer.", "at": "if (parsed && !buf[parsed])", "inst_trace": [{"instr_func": "remove_slot_store", "instr_loc": -1, "instr": "  %4 = alloca %struct.device_driver*, align 8"}, {"instr_func": "str_to_slot", "instr_loc": 1010, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "switch (sscanf(buf, \" %x:%x:%x.%x %n\", domain, bus, slot, func,"}, {"instr_func": "str_to_slot", "instr_loc": 1021, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}, {"instr_func": "str_to_slot", "instr_loc": 1021, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "str_to_slot"}, "warn_no": 1},
{"warn_data": {"at_line": 1036, "warn_str": "Trying to read from a user pointer.", "at": "if (parsed && !buf[parsed])", "inst_trace": [{"instr_func": "remove_slot_store", "instr_loc": -1, "instr": "  %4 = alloca %struct.device_driver*, align 8"}, {"instr_func": "str_to_slot", "instr_loc": 1010, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "switch (sscanf(buf, \" %x:%x:%x.%x %n\", domain, bus, slot, func,"}, {"instr_func": "str_to_slot", "instr_loc": 1036, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}, {"instr_func": "str_to_slot", "instr_loc": 1036, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "if (parsed && !buf[parsed])"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "str_to_slot"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.device_driver*, align 8"}, {"lineno": 1202, "file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "err = pcistub_device_id_remove(domain, bus, slot, func);"}],
"warnings":[{"warn_data": {"at_line": 1108, "warn_str": "Trying to use a global variable without locking.", "at": "spin_lock_irqsave(&device_ids_lock, flags);", "inst_trace": [{"instr_func": "remove_slot_store", "instr_loc": -1, "instr": "  %4 = alloca %struct.device_driver*, align 8"}, {"instr_func": "remove_slot_store", "instr_loc": 1202, "instr_file": "drivers/xen/xen-pciback/pci_stub.c", "instr": "err = pcistub_device_id_remove(domain, bus, slot, func);"}], "at_file": "drivers/xen/xen-pciback/pci_stub.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pcistub_device_id_remove"}, "warn_no": 1}]}]}