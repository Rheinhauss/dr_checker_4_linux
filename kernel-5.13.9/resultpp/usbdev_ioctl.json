{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 2526, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&dev->dev, \"%s: REAPURBNDELAY32\\n\", __func__);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usbdev_do_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2527, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2167, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&ps->dev->dev, \"reap %px\\n\", as->userurb);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2527, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_reapurbnonblock_compat"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2527, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}, {"lineno": 2168, "file": "drivers/usb/core/devio.c", "instr": "retval = processcompl_compat(as, (void __user * __user *)arg);"}, {"lineno": 2117, "file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}],
"warnings":[{"warn_data": {"at_line": 543, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(userbuffer, urb->transfer_buffer, len))", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 549, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2527, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}, {"lineno": 2168, "file": "drivers/usb/core/devio.c", "instr": "retval = processcompl_compat(as, (void __user * __user *)arg);"}, {"lineno": 2117, "file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}, {"lineno": 550, "file": "drivers/usb/core/devio.c", "instr": "if (copy_to_user(userbuffer, sg_virt(&urb->sg[i]), size))"}],
"warnings":[{"warn_data": {"at_line": 251, "warn_str": "Trying to use a global variable without locking.", "at": "  %7 = load i64, i64* @vmemmap_base, align 8, !dbg !6241", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2527, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}, {"instr_func": "proc_reapurbnonblock_compat", "instr_loc": 2168, "instr_file": "drivers/usb/core/devio.c", "instr": "retval = processcompl_compat(as, (void __user * __user *)arg);"}, {"instr_func": "processcompl_compat", "instr_loc": 2117, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}, {"instr_func": "copy_urb_data_to_user", "instr_loc": 550, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_to_user(userbuffer, sg_virt(&urb->sg[i]), size))"}], "at_file": "./include/linux/scatterlist.h", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2522, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb_compat(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2150, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&ps->dev->dev, \"reap %px\\n\", as->userurb);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2522, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb_compat(ps, p);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_reapurb_compat"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2527, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}, {"lineno": 2169, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 413, "file": "drivers/usb/core/devio.c", "instr": "usbfs_decrease_memory_usage(as->mem_usage);"}],
"warnings":[{"warn_data": {"at_line": 163, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2527, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock_compat(ps, p);"}, {"instr_func": "proc_reapurbnonblock_compat", "instr_loc": 2169, "instr_file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"instr_func": "free_async", "instr_loc": 413, "instr_file": "drivers/usb/core/devio.c", "instr": "usbfs_decrease_memory_usage(as->mem_usage);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usbfs_decrease_memory_usage"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2615, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_disconnectsignal_compat(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2061, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_disconnectsignal_compat"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2522, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb_compat(ps, p);"}, {"lineno": 2151, "file": "drivers/usb/core/devio.c", "instr": "retval = processcompl_compat(as, (void __user * __user *)arg);"}, {"lineno": 2117, "file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}],
"warnings":[{"warn_data": {"at_line": 543, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(userbuffer, urb->transfer_buffer, len))", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 549, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2516, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2022, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&ps->dev->dev, \"reap %px\\n\", as->userurb);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2516, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock(ps, p);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_reapurbnonblock"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2516, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurbnonblock(ps, p);"}, {"lineno": 2023, "file": "drivers/usb/core/devio.c", "instr": "retval = processcompl(as, (void __user * __user *)arg);"}, {"lineno": 1946, "file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}],
"warnings":[{"warn_data": {"at_line": 549, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 543, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(userbuffer, urb->transfer_buffer, len))", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2511, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2005, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&ps->dev->dev, \"reap %px\\n\", as->userurb);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2511, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb(ps, p);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_reapurb"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2511, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_reapurb(ps, p);"}, {"lineno": 2006, "file": "drivers/usb/core/devio.c", "instr": "retval = processcompl(as, (void __user * __user *)arg);"}, {"lineno": 1946, "file": "drivers/usb/core/devio.c", "instr": "if (copy_urb_data_to_user(as->userbuffer, urb))"}],
"warnings":[{"warn_data": {"at_line": 543, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(userbuffer, urb->transfer_buffer, len))", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 549, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "copy_urb_data_to_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2678, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_drop_privileges(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2432, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_drop_privileges"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2675, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_free_streams(ps, p);"}, {"lineno": 2419, "file": "drivers/usb/core/devio.c", "instr": "r = parse_usbdevfs_streams(ps, arg, NULL, &num_eps, &eps, &intf);"}, {"lineno": 948, "file": "drivers/usb/core/devio.c", "instr": "eps = kmalloc_array(num_eps, sizeof(*eps), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %278 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %277, !dbg !6521", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2675, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_free_streams(ps, p);"}, {"instr_func": "proc_free_streams", "instr_loc": 2419, "instr_file": "drivers/usb/core/devio.c", "instr": "r = parse_usbdevfs_streams(ps, arg, NULL, &num_eps, &eps, &intf);"}, {"instr_func": "parse_usbdevfs_streams", "instr_loc": 948, "instr_file": "drivers/usb/core/devio.c", "instr": "eps = kmalloc_array(num_eps, sizeof(*eps), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2669, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_disconnect_claim(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2358, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_disconnect_claim"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2669, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_disconnect_claim(ps, p);"}, {"lineno": 2389, "file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"lineno": 766, "file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_disconnect_claim", "instr_loc": 2358, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_disconnect_claim", "instr_loc": 2389, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"instr_func": "proc_disconnect_claim", "instr_loc": 2389, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"instr_func": "claimintf", "instr_loc": 758, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "claimintf", "instr_loc": 766, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "claimintf", "instr_loc": 766, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2669, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_disconnect_claim(ps, p);"}, {"lineno": 2389, "file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"lineno": 770, "file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_disconnect_claim", "instr_loc": 2358, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_disconnect_claim", "instr_loc": 2389, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"instr_func": "proc_disconnect_claim", "instr_loc": 2389, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, dc.interface);"}, {"instr_func": "claimintf", "instr_loc": 758, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "claimintf", "instr_loc": 770, "instr_file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}, {"instr_func": "claimintf", "instr_loc": 770, "instr_file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2658, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_claim_port(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2324, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&ps->dev->dev, \"port %d claimed by process %d: %s\\n\",", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2658, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_claim_port(ps, p);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_claim_port"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2653, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_ioctl_default(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2292, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl_default"}, "warn_no": 1}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2653, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_ioctl_default(ps, p);"}, {"lineno": 2297, "file": "drivers/usb/core/devio.c", "instr": "return proc_ioctl(ps, &ctrl);"}],
"warnings":[{"warn_data": {"at_line": 2230, "warn_str": "Trying to use a global variable without locking.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2653, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_ioctl_default(ps, p);"}, {"instr_func": "proc_ioctl_default", "instr_loc": 2297, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_ioctl(ps, &ctrl);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_default", "instr_loc": 2292, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_default", "instr_loc": 2292, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_default", "instr_loc": 2292, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_default", "instr_loc": 2292, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_default", "instr_loc": 2292, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 2234, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, ctl->data, size)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 2284, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "&& copy_to_user(ctl->data, buf, size) != 0)", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl"}, "warn_no": 8}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2638, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_disconnectsignal(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2180, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_disconnectsignal"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2627, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_ioctl_compat(ps, ptr_to_compat(p));"}],
"warnings":[{"warn_data": {"at_line": 2302, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl_compat"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2627, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_ioctl_compat(ps, ptr_to_compat(p));"}, {"lineno": 2311, "file": "drivers/usb/core/devio.c", "instr": "return proc_ioctl(ps, &ctrl);"}],
"warnings":[{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_compat", "instr_loc": 2302, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_compat", "instr_loc": 2302, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_compat", "instr_loc": 2302, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_compat", "instr_loc": 2302, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 2230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf = kmalloc(size, GFP_KERNEL);", "inst_trace": [{"instr_func": "proc_ioctl_compat", "instr_loc": 2302, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl_compat", "instr_loc": 2309, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl.ioctl_code = ioc32.ioctl_code;"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2228, "instr_file": "drivers/usb/core/devio.c", "instr": "size = _IOC_SIZE(ctl->ioctl_code);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}, {"instr_func": "proc_ioctl", "instr_loc": 2230, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(size, GFP_KERNEL);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 2234, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, ctl->data, size)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 2284, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "&& copy_to_user(ctl->data, buf, size) != 0)", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_ioctl"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2097, "file": "drivers/usb/core/devio.c", "instr": "if (get_urb32(&uurb, (struct usbdevfs_urb32 __user *)arg))"}],
"warnings":[{"warn_data": {"at_line": 2073, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "get_urb32"}, "warn_no": 1}]},
{"num_warnings": 32,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}],
"warnings":[{"warn_data": {"at_line": 1822, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(uurb_start - as->usbm->vm_start);", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1822, "instr_file": "drivers/usb/core/devio.c", "instr": "(uurb_start - as->usbm->vm_start);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 1},
{"warn_data": {"at_line": 1565, "warn_str": "Trying to use a global variable without locking.", "at": "if (uurb->buffer_length < 8)", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 2},
{"warn_data": {"at_line": 1570, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(dr, uurb->buffer, 8)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 3},
{"warn_data": {"at_line": 1694, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(as->usbm ? 0 : uurb->buffer_length) +", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 4},
{"warn_data": {"at_line": 1574, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (uurb->buffer_length < (le16_to_cpu(dr->wLength) + 8)) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1574, "instr_file": "drivers/usb/core/devio.c", "instr": "if (uurb->buffer_length < (le16_to_cpu(dr->wLength) + 8)) {"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 5},
{"warn_data": {"at_line": 1693, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u += sizeof(struct async) + sizeof(struct urb) +", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 6},
{"warn_data": {"at_line": 1693, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u += sizeof(struct async) + sizeof(struct urb) +", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 7},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 8},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 9},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 10},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 11},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 12},
{"warn_data": {"at_line": 1745, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(as->urb->transfer_buffer,", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 13},
{"warn_data": {"at_line": 1736, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(uurb_start - as->usbm->vm_start);", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1736, "instr_file": "drivers/usb/core/devio.c", "instr": "(uurb_start - as->usbm->vm_start);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 14},
{"warn_data": {"at_line": 1729, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "totlen -= u;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 15},
{"warn_data": {"at_line": 1713, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < as->urb->num_sgs; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1713, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1713, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 16},
{"warn_data": {"at_line": 1723, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(buf, uurb->buffer, u)) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 17},
{"warn_data": {"at_line": 1714, "warn_str": "Loop is bounded by a tainted value.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 18},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 19},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 20},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 21},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 22},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 23},
{"warn_data": {"at_line": 1723, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, uurb->buffer, u)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 24},
{"warn_data": {"at_line": 1808, "warn_str": "Trying to write to a user pointer.", "at": "as->urb->iso_frame_desc[u].offset = totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 25},
{"warn_data": {"at_line": 1807, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (totlen = u = 0; u < number_of_packets; u++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 26},
{"warn_data": {"at_line": 1809, "warn_str": "Trying to read from a user pointer.", "at": "as->urb->iso_frame_desc[u].length = isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 27},
{"warn_data": {"at_line": 1809, "warn_str": "Trying to write to a user pointer.", "at": "as->urb->iso_frame_desc[u].length = isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 28},
{"warn_data": {"at_line": 1810, "warn_str": "Trying to read from a user pointer.", "at": "totlen += isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 29},
{"warn_data": {"at_line": 1810, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "totlen += isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 30},
{"warn_data": {"at_line": 1807, "warn_str": "Loop is bounded by a tainted value.", "at": "for (totlen = u = 0; u < number_of_packets; u++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 31},
{"warn_data": {"at_line": 1821, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_dma = as->usbm->dma_handle +", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1821, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_dma = as->usbm->dma_handle +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 32}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1578, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"lineno": 887, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1579, "instr_file": "drivers/usb/core/devio.c", "instr": "le16_to_cpu(dr->wIndex));"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1578, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1578, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"lineno": 897, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1579, "instr_file": "drivers/usb/core/devio.c", "instr": "le16_to_cpu(dr->wIndex));"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1578, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1670, "file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !6244", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 32, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !6243"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 29, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !6241", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 29, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !6241"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1674, "file": "drivers/usb/core/devio.c", "instr": "as = alloc_async(number_of_packets);"}, {"lineno": 382, "file": "drivers/usb/core/devio.c", "instr": "as = kzalloc(sizeof(struct async), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !6499", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1674, "instr_file": "drivers/usb/core/devio.c", "instr": "as = alloc_async(number_of_packets);"}, {"instr_func": "alloc_async", "instr_loc": 382, "instr_file": "drivers/usb/core/devio.c", "instr": "as = kzalloc(sizeof(struct async), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1696, "file": "drivers/usb/core/devio.c", "instr": "ret = usbfs_increase_memory_usage(u);"}],
"warnings":[{"warn_data": {"at_line": 148, "warn_str": "Trying to use a global variable without locking.", "at": "lim = READ_ONCE(usbfs_memory_mb);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1696, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbfs_increase_memory_usage(u);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usbfs_increase_memory_usage"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1720, "file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}],
"warnings":[{"warn_data": {"at_line": 139, "warn_str": "Trying to use a global variable without locking.", "at": "  %28 = load i64, i64* @vmemmap_base, align 8, !dbg !6255", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}], "at_file": "./include/linux/scatterlist.h", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_set_buf"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1720, "file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"lineno": 139, "file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}],
"warnings":[{"warn_data": {"at_line": 114, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %11, i32* %13, align 8, !dbg !6244", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "sg_set_buf", "instr_loc": 135, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %4, align 8"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  %27 = load %struct.scatterlist*, %struct.scatterlist** %4, align 8, !dbg !6254"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}, {"instr_func": "sg_set_page", "instr_loc": 112, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %5, align 8"}, {"instr_func": "sg_set_page", "instr_loc": 114, "instr_file": "./include/linux/scatterlist.h", "instr": "  %12 = load %struct.scatterlist*, %struct.scatterlist** %5, align 8, !dbg !6242"}, {"instr_func": "sg_set_page", "instr_loc": 114, "instr_file": "./include/linux/scatterlist.h", "instr": "  %13 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %12, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_set_page"}, "warn_no": 1},
{"warn_data": {"at_line": 115, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %14, i32* %16, align 4, !dbg !6248", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "sg_set_buf", "instr_loc": 135, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %4, align 8"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  %27 = load %struct.scatterlist*, %struct.scatterlist** %4, align 8, !dbg !6254"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}, {"instr_func": "sg_set_page", "instr_loc": 112, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %5, align 8"}, {"instr_func": "sg_set_page", "instr_loc": 115, "instr_file": "./include/linux/scatterlist.h", "instr": "  %15 = load %struct.scatterlist*, %struct.scatterlist** %5, align 8, !dbg !6246"}, {"instr_func": "sg_set_page", "instr_loc": 115, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %15, i32 0, i32 2, !dbg !6247"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_set_page"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1829, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}],
"warnings":[{"warn_data": {"at_line": 476, "warn_str": "Trying to use a global variable without locking.", "at": "if (!usbfs_snoop)", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1829, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "snoop_urb"}, "warn_no": 1},
{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1829, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1829, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1833, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"lineno": 528, "file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "  %18 = load i32, i32* %17, align 8, !dbg !6243", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "sg_virt", "instr_loc": 251, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %3, align 8"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = load %struct.scatterlist*, %struct.scatterlist** %3, align 8, !dbg !6242"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %17 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %16, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1833, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}],
"warnings":[{"warn_data": {"at_line": 515, "warn_str": "Trying to use a global variable without locking.", "at": "len = min(len, usbfs_snoop_max);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2620, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"instr_func": "proc_submiturb_compat", "instr_loc": 2103, "instr_file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "snoop_urb_data"}, "warn_no": 1},
{"warn_data": {"at_line": 529, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "len -= size;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "snoop_urb_data", "instr_loc": 512, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 529, "instr_file": "drivers/usb/core/devio.c", "instr": "len -= size;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "snoop_urb_data"}, "warn_no": 2},
{"warn_data": {"at_line": 525, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < urb->num_sgs && len; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "snoop_urb_data", "instr_loc": 512, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb_data", "instr_loc": 525, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < urb->num_sgs && len; i++) {"}, {"instr_func": "snoop_urb_data", "instr_loc": 525, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < urb->num_sgs && len; i++) {"}, {"instr_func": "snoop_urb_data", "instr_loc": 0, "instr_file": "drivers/usb/core/devio.c", "instr": "  %58 = phi i1 [ false, %53 ], [ %56, %54 ], !dbg !6272"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "snoop_urb_data"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1871, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1871, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1871, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}],
"warnings":[{"warn_data": {"at_line": 400, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < as->urb->num_sgs; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "free_async", "instr_loc": 400, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}, {"instr_func": "free_async", "instr_loc": 400, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "free_async"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 402, "file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "  %18 = load i32, i32* %17, align 8, !dbg !6243", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "sg_virt", "instr_loc": 251, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %3, align 8"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = load %struct.scatterlist*, %struct.scatterlist** %3, align 8, !dbg !6242"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %17 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %16, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 401, "file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}],
"warnings":[{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i64, i64* %5, align 8, !dbg !6233", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "sg_page", "instr_loc": 119, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %2, align 8"}, {"instr_func": "sg_page", "instr_loc": 121, "instr_file": "./include/linux/scatterlist.h", "instr": "  %4 = load %struct.scatterlist*, %struct.scatterlist** %2, align 8, !dbg !6233"}, {"instr_func": "sg_page", "instr_loc": 121, "instr_file": "./include/linux/scatterlist.h", "instr": "  %5 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %4, i32 0, i32 0, !dbg !6233"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_page"}, "warn_no": 1},
{"warn_data": {"at_line": 123, "warn_str": "Trying to read from a user pointer.", "at": "  %26 = load i64, i64* %25, align 8, !dbg !6251", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "sg_page", "instr_loc": 119, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %2, align 8"}, {"instr_func": "sg_page", "instr_loc": 123, "instr_file": "./include/linux/scatterlist.h", "instr": "  %24 = load %struct.scatterlist*, %struct.scatterlist** %2, align 8, !dbg !6250"}, {"instr_func": "sg_page", "instr_loc": 123, "instr_file": "./include/linux/scatterlist.h", "instr": "  %25 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %24, i32 0, i32 0, !dbg !6251"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_page"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2620, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb_compat(ps, p);"}, {"lineno": 2103, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 409, "file": "drivers/usb/core/devio.c", "instr": "dec_usb_memory_use_count(as->usbm, &as->usbm->urb_use_count);"}],
"warnings":[{"warn_data": {"at_line": 179, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "--*count;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 179, "instr_file": "drivers/usb/core/devio.c", "instr": "--*count;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 1},
{"warn_data": {"at_line": 184, "warn_str": "Trying to read from a user pointer.", "at": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 175, "instr_file": "drivers/usb/core/devio.c", "instr": "struct usb_dev_state *ps = usbm->ps;"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 175, "instr_file": "drivers/usb/core/devio.c", "instr": "struct usb_dev_state *ps = usbm->ps;"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 184, "instr_file": "drivers/usb/core/devio.c", "instr": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 184, "instr_file": "drivers/usb/core/devio.c", "instr": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 2},
{"warn_data": {"at_line": 187, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "usbm->size + sizeof(struct usb_memory));", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 187, "instr_file": "drivers/usb/core/devio.c", "instr": "usbm->size + sizeof(struct usb_memory));"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2608, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk_compat(ps, p);"}, {"lineno": 2057, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}],
"warnings":[{"warn_data": {"at_line": 1226, "warn_str": "Trying to use a global variable without locking.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2608, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk_compat(ps, p);"}, {"instr_func": "proc_bulk_compat", "instr_loc": 2057, "instr_file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 1},
{"warn_data": {"at_line": 1248, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(tbuf, bulk->data, len1)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 2},
{"warn_data": {"at_line": 1241, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(bulk->data, tbuf, len2)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2601, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control_compat(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 2034, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_control_compat"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2601, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control_compat(ps, p);"}, {"lineno": 2042, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}],
"warnings":[{"warn_data": {"at_line": 1131, "warn_str": "Trying to use a global variable without locking.", "at": "snoop(&dev->dev, \"control urb: bRequestType=%02x \"", "inst_trace": [{"instr_func": "usbdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "usbdev_ioctl", "instr_loc": 2713, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"instr_func": "usbdev_do_ioctl", "instr_loc": 2601, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = proc_control_compat(ps, p);"}, {"instr_func": "proc_control_compat", "instr_loc": 2042, "instr_file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}], "at_file": "drivers/usb/core/devio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "do_proc_control"}, "warn_no": 1},
{"warn_data": {"at_line": 1148, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(ctrl->data, tbuf, i)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_control"}, "warn_no": 2},
{"warn_data": {"at_line": 1155, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(tbuf, ctrl->data, ctrl->wLength)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_control"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2601, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control_compat(ps, p);"}, {"lineno": 2042, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}, {"lineno": 1114, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"lineno": 887, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_control_compat", "instr_loc": 2034, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_control", "instr_loc": 1115, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl->wIndex);"}, {"instr_func": "do_proc_control", "instr_loc": 1114, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2601, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control_compat(ps, p);"}, {"lineno": 2042, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}, {"lineno": 1114, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"lineno": 897, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_control_compat", "instr_loc": 2034, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_control", "instr_loc": 1115, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl->wIndex);"}, {"instr_func": "do_proc_control", "instr_loc": 1114, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1887, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_submiturb"}, "warn_no": 1}]},
{"num_warnings": 41,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}],
"warnings":[{"warn_data": {"at_line": 1650, "warn_str": "Loop is bounded by a tainted value.", "at": "for (totlen = u = 0; u < number_of_packets; u++) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1641, "instr_file": "drivers/usb/core/devio.c", "instr": "number_of_packets = uurb->number_of_packets;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1641, "instr_file": "drivers/usb/core/devio.c", "instr": "number_of_packets = uurb->number_of_packets;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1650, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1650, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 1},
{"warn_data": {"at_line": 1617, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 2},
{"warn_data": {"at_line": 1617, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 3},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "if (num_sgs == 1 || num_sgs > ps->dev->bus->sg_tablesize)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1735, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = as->usbm->mem +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1735, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = as->usbm->mem +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1735, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = as->usbm->mem +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1618, "instr_file": "drivers/usb/core/devio.c", "instr": "if (num_sgs == 1 || num_sgs > ps->dev->bus->sg_tablesize)"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1618, "instr_file": "drivers/usb/core/devio.c", "instr": "if (num_sgs == 1 || num_sgs > ps->dev->bus->sg_tablesize)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 4},
{"warn_data": {"at_line": 1620, "warn_str": "Trying to read from a user pointer.", "at": "if (ep->streams)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1620, "instr_file": "drivers/usb/core/devio.c", "instr": "if (ep->streams)"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1620, "instr_file": "drivers/usb/core/devio.c", "instr": "if (ep->streams)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 5},
{"warn_data": {"at_line": 1574, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (uurb->buffer_length < (le16_to_cpu(dr->wLength) + 8)) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1574, "instr_file": "drivers/usb/core/devio.c", "instr": "if (uurb->buffer_length < (le16_to_cpu(dr->wLength) + 8)) {"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 6},
{"warn_data": {"at_line": 1570, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(dr, uurb->buffer, 8)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 7},
{"warn_data": {"at_line": 1694, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(as->usbm ? 0 : uurb->buffer_length) +", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 8},
{"warn_data": {"at_line": 1693, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u += sizeof(struct async) + sizeof(struct urb) +", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 9},
{"warn_data": {"at_line": 1693, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u += sizeof(struct async) + sizeof(struct urb) +", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 10},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 11},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 12},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 13},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 14},
{"warn_data": {"at_line": 1738, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1738, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer = kmalloc(uurb->buffer_length,"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 15},
{"warn_data": {"at_line": 1745, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(as->urb->transfer_buffer,", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 16},
{"warn_data": {"at_line": 1736, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(uurb_start - as->usbm->vm_start);", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1733, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1733, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1733, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1736, "instr_file": "drivers/usb/core/devio.c", "instr": "(uurb_start - as->usbm->vm_start);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 17},
{"warn_data": {"at_line": 1729, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "totlen -= u;", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 18},
{"warn_data": {"at_line": 1713, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < as->urb->num_sgs; i++) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1709, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->num_sgs = num_sgs;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1709, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->num_sgs = num_sgs;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1713, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1713, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 19},
{"warn_data": {"at_line": 1723, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(buf, uurb->buffer, u)) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 20},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 21},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 22},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 23},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 24},
{"warn_data": {"at_line": 1714, "warn_str": "Loop is bounded by a tainted value.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 25},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1715, "instr_file": "drivers/usb/core/devio.c", "instr": "buf = kmalloc(u, GFP_KERNEL);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 26},
{"warn_data": {"at_line": 1723, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, uurb->buffer, u)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 27},
{"warn_data": {"at_line": 1795, "warn_str": "Trying to read from a user pointer.", "at": "if (ep->desc.bInterval) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 917, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1795, "instr_file": "drivers/usb/core/devio.c", "instr": "if (ep->desc.bInterval) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1795, "instr_file": "drivers/usb/core/devio.c", "instr": "if (ep->desc.bInterval) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1795, "instr_file": "drivers/usb/core/devio.c", "instr": "if (ep->desc.bInterval) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 28},
{"warn_data": {"at_line": 1802, "warn_str": "Trying to read from a user pointer.", "at": "as->urb->interval = ep->desc.bInterval;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1802, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->interval = ep->desc.bInterval;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1802, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->interval = ep->desc.bInterval;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1802, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->interval = ep->desc.bInterval;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 29},
{"warn_data": {"at_line": 1800, "warn_str": "Trying to read from a user pointer.", "at": "min(15, ep->desc.bInterval - 1);", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 30},
{"warn_data": {"at_line": 1800, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "min(15, ep->desc.bInterval - 1);", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1800, "instr_file": "drivers/usb/core/devio.c", "instr": "min(15, ep->desc.bInterval - 1);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 31},
{"warn_data": {"at_line": 1807, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (totlen = u = 0; u < number_of_packets; u++) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 32},
{"warn_data": {"at_line": 1808, "warn_str": "Trying to write to a user pointer.", "at": "as->urb->iso_frame_desc[u].offset = totlen;", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 33},
{"warn_data": {"at_line": 1809, "warn_str": "Trying to read from a user pointer.", "at": "as->urb->iso_frame_desc[u].length = isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 34},
{"warn_data": {"at_line": 1809, "warn_str": "Trying to write to a user pointer.", "at": "as->urb->iso_frame_desc[u].length = isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1809, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].length = isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 35},
{"warn_data": {"at_line": 1810, "warn_str": "Trying to read from a user pointer.", "at": "totlen += isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 36},
{"warn_data": {"at_line": 1810, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "totlen += isopkt[u].length;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 37},
{"warn_data": {"at_line": 1807, "warn_str": "Loop is bounded by a tainted value.", "at": "for (totlen = u = 0; u < number_of_packets; u++) {", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1617, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs = DIV_ROUND_UP(uurb->buffer_length, USB_SG_SIZE);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1695, "instr_file": "drivers/usb/core/devio.c", "instr": "num_sgs * sizeof(struct scatterlist);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 38},
{"warn_data": {"at_line": 1822, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(uurb_start - as->usbm->vm_start);", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1694, "instr_file": "drivers/usb/core/devio.c", "instr": "(as->usbm ? 0 : uurb->buffer_length) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1693, "instr_file": "drivers/usb/core/devio.c", "instr": "u += sizeof(struct async) + sizeof(struct urb) +"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1727, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer += u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1818, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1822, "instr_file": "drivers/usb/core/devio.c", "instr": "(uurb_start - as->usbm->vm_start);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 39},
{"warn_data": {"at_line": 1821, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "as->urb->transfer_dma = as->usbm->dma_handle +", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1821, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_dma = as->usbm->dma_handle +"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "proc_do_submiturb"}, "warn_no": 40},
{"warn_data": {"at_line": 1845, "warn_str": "Trying to read from a user pointer.", "at": "((ep->desc.bEndpointAddress & USB_ENDPOINT_DIR_MASK)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1845, "instr_file": "drivers/usb/core/devio.c", "instr": "((ep->desc.bEndpointAddress & USB_ENDPOINT_DIR_MASK)"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1845, "instr_file": "drivers/usb/core/devio.c", "instr": "((ep->desc.bEndpointAddress & USB_ENDPOINT_DIR_MASK)"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1845, "instr_file": "drivers/usb/core/devio.c", "instr": "((ep->desc.bEndpointAddress & USB_ENDPOINT_DIR_MASK)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "proc_do_submiturb"}, "warn_no": 41}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1547, "file": "drivers/usb/core/devio.c", "instr": "ifnum = findintfep(ps->dev, uurb->endpoint);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1547, "instr_file": "drivers/usb/core/devio.c", "instr": "ifnum = findintfep(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1547, "instr_file": "drivers/usb/core/devio.c", "instr": "ifnum = findintfep(ps->dev, uurb->endpoint);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1},
{"warn_data": {"at_line": 843, "warn_str": "Trying to read from a user pointer.", "at": "intf = dev->actconfig->interface[i];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 2},
{"warn_data": {"at_line": 842, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 3},
{"warn_data": {"at_line": 842, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 4},
{"warn_data": {"at_line": 845, "warn_str": "Trying to read from a user pointer.", "at": "alts = &intf->altsetting[j];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 5},
{"warn_data": {"at_line": 844, "warn_str": "Trying to read from a user pointer.", "at": "for (j = 0; j < intf->num_altsetting; j++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 6},
{"warn_data": {"at_line": 849, "warn_str": "Trying to read from a user pointer.", "at": "return alts->desc.bInterfaceNumber;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1550, "file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, ifnum);"}, {"lineno": 822, "file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 854, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1547, "instr_file": "drivers/usb/core/devio.c", "instr": "ifnum = findintfep(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1547, "instr_file": "drivers/usb/core/devio.c", "instr": "ifnum = findintfep(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1550, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, ifnum);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1550, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, ifnum);"}, {"instr_func": "checkintf", "instr_loc": 817, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "checkintf", "instr_loc": 822, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "checkintf", "instr_loc": 822, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1554, "file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}],
"warnings":[{"warn_data": {"at_line": 921, "warn_str": "Trying to read from a user pointer.", "at": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 917, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ep_to_host_endpoint"}, "warn_no": 1},
{"warn_data": {"at_line": 919, "warn_str": "Trying to read from a user pointer.", "at": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 917, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ep_to_host_endpoint"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1639, "file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_isoc(&ep->desc))"}],
"warnings":[{"warn_data": {"at_line": 559, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1639, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_isoc(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1639, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_isoc(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1639, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_isoc(&ep->desc))"}, {"instr_func": "usb_endpoint_xfer_isoc", "instr_loc": 558, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_xfer_isoc", "instr_loc": 559, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_xfer_isoc", "instr_loc": 559, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_xfer_isoc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1625, "file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_int(&ep->desc))"}],
"warnings":[{"warn_data": {"at_line": 545, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1625, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_int(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1625, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_int(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1625, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_int(&ep->desc))"}, {"instr_func": "usb_endpoint_xfer_int", "instr_loc": 544, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_xfer_int", "instr_loc": 545, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_xfer_int", "instr_loc": 545, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_xfer_int"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1608, "file": "drivers/usb/core/devio.c", "instr": "switch (usb_endpoint_type(&ep->desc)) {"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1608, "instr_file": "drivers/usb/core/devio.c", "instr": "switch (usb_endpoint_type(&ep->desc)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1608, "instr_file": "drivers/usb/core/devio.c", "instr": "switch (usb_endpoint_type(&ep->desc)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1608, "instr_file": "drivers/usb/core/devio.c", "instr": "switch (usb_endpoint_type(&ep->desc)) {"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1562, "file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_control(&ep->desc))"}],
"warnings":[{"warn_data": {"at_line": 531, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1562, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_control(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1562, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_control(&ep->desc))"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1562, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_endpoint_xfer_control(&ep->desc))"}, {"instr_func": "usb_endpoint_xfer_control", "instr_loc": 530, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_xfer_control", "instr_loc": 531, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_xfer_control", "instr_loc": 531, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_xfer_control"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1578, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"lineno": 887, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1579, "instr_file": "drivers/usb/core/devio.c", "instr": "le16_to_cpu(dr->wIndex));"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1578, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1},
{"warn_data": {"at_line": 843, "warn_str": "Trying to read from a user pointer.", "at": "intf = dev->actconfig->interface[i];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 2},
{"warn_data": {"at_line": 842, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 3},
{"warn_data": {"at_line": 842, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 4},
{"warn_data": {"at_line": 845, "warn_str": "Trying to read from a user pointer.", "at": "alts = &intf->altsetting[j];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 5},
{"warn_data": {"at_line": 844, "warn_str": "Trying to read from a user pointer.", "at": "for (j = 0; j < intf->num_altsetting; j++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 6},
{"warn_data": {"at_line": 849, "warn_str": "Trying to read from a user pointer.", "at": "return alts->desc.bInterfaceNumber;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 7}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1578, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"lineno": 897, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1579, "instr_file": "drivers/usb/core/devio.c", "instr": "le16_to_cpu(dr->wIndex));"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1578, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, dr->bRequestType, dr->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1},
{"warn_data": {"at_line": 843, "warn_str": "Trying to read from a user pointer.", "at": "intf = dev->actconfig->interface[i];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 2},
{"warn_data": {"at_line": 842, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 3},
{"warn_data": {"at_line": 842, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}, {"instr_func": "findintfep", "instr_loc": 842, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < dev->actconfig->desc.bNumInterfaces; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 4},
{"warn_data": {"at_line": 845, "warn_str": "Trying to read from a user pointer.", "at": "alts = &intf->altsetting[j];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 5},
{"warn_data": {"at_line": 844, "warn_str": "Trying to read from a user pointer.", "at": "for (j = 0; j < intf->num_altsetting; j++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}, {"instr_func": "findintfep", "instr_loc": 844, "instr_file": "drivers/usb/core/devio.c", "instr": "for (j = 0; j < intf->num_altsetting; j++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 6},
{"warn_data": {"at_line": 849, "warn_str": "Trying to read from a user pointer.", "at": "return alts->desc.bInterfaceNumber;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 843, "instr_file": "drivers/usb/core/devio.c", "instr": "intf = dev->actconfig->interface[i];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 845, "instr_file": "drivers/usb/core/devio.c", "instr": "alts = &intf->altsetting[j];"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}, {"instr_func": "findintfep", "instr_loc": 849, "instr_file": "drivers/usb/core/devio.c", "instr": "return alts->desc.bInterfaceNumber;"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "findintfep"}, "warn_no": 7}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1670, "file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !6244", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 32, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !6243"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 29, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !6241", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1670, "instr_file": "drivers/usb/core/devio.c", "instr": "!access_ok(uurb->buffer, uurb->buffer_length)) {"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 29, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !6241"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1680, "file": "drivers/usb/core/devio.c", "instr": "as->usbm = find_memory_area(ps, uurb);"}],
"warnings":[{"warn_data": {"at_line": 1497, "warn_str": "Loop is bounded by a tainted value.", "at": "if (uurb_start >= iter->vm_start &&", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1498, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb_start < iter->vm_start + iter->size) {"}, {"instr_func": "find_memory_area", "instr_loc": 1498, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb_start < iter->vm_start + iter->size) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "find_memory_area"}, "warn_no": 1},
{"warn_data": {"at_line": 1499, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (uurb->buffer_length > iter->vm_start + iter->size -", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1493, "instr_file": "drivers/usb/core/devio.c", "instr": "unsigned long uurb_start = (unsigned long)uurb->buffer;"}, {"instr_func": "find_memory_area", "instr_loc": 1500, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb_start) {"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "find_memory_area"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2583, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_setintf(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1424, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_setintf"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1720, "file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"lineno": 139, "file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}],
"warnings":[{"warn_data": {"at_line": 114, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %11, i32* %13, align 8, !dbg !6244", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "sg_set_buf", "instr_loc": 135, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %4, align 8"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  %27 = load %struct.scatterlist*, %struct.scatterlist** %4, align 8, !dbg !6254"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}, {"instr_func": "sg_set_page", "instr_loc": 112, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %5, align 8"}, {"instr_func": "sg_set_page", "instr_loc": 114, "instr_file": "./include/linux/scatterlist.h", "instr": "  %12 = load %struct.scatterlist*, %struct.scatterlist** %5, align 8, !dbg !6242"}, {"instr_func": "sg_set_page", "instr_loc": 114, "instr_file": "./include/linux/scatterlist.h", "instr": "  %13 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %12, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_set_page"}, "warn_no": 1},
{"warn_data": {"at_line": 115, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %14, i32* %16, align 4, !dbg !6248", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1720, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_set_buf(&as->urb->sg[i], buf, u);"}, {"instr_func": "sg_set_buf", "instr_loc": 135, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %4, align 8"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  %27 = load %struct.scatterlist*, %struct.scatterlist** %4, align 8, !dbg !6254"}, {"instr_func": "sg_set_buf", "instr_loc": 139, "instr_file": "./include/linux/scatterlist.h", "instr": "  call void @sg_set_page(%struct.scatterlist* %27, %struct.page* %37, i32 %38, i32 %45) #13, !dbg !6259"}, {"instr_func": "sg_set_page", "instr_loc": 112, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %5, align 8"}, {"instr_func": "sg_set_page", "instr_loc": 115, "instr_file": "./include/linux/scatterlist.h", "instr": "  %15 = load %struct.scatterlist*, %struct.scatterlist** %5, align 8, !dbg !6246"}, {"instr_func": "sg_set_page", "instr_loc": 115, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %15, i32 0, i32 2, !dbg !6247"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_set_page"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1833, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}],
"warnings":[{"warn_data": {"at_line": 529, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "len -= size;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "snoop_urb_data", "instr_loc": 512, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 526, "instr_file": "drivers/usb/core/devio.c", "instr": "size = (len > USB_SG_SIZE) ? USB_SG_SIZE : len;"}, {"instr_func": "snoop_urb_data", "instr_loc": 529, "instr_file": "drivers/usb/core/devio.c", "instr": "len -= size;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "snoop_urb_data"}, "warn_no": 1},
{"warn_data": {"at_line": 525, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < urb->num_sgs && len; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1788, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->transfer_buffer_length = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1833, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"instr_func": "snoop_urb_data", "instr_loc": 512, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 515, "instr_file": "drivers/usb/core/devio.c", "instr": "len = min(len, usbfs_snoop_max);"}, {"instr_func": "snoop_urb_data", "instr_loc": 525, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < urb->num_sgs && len; i++) {"}, {"instr_func": "snoop_urb_data", "instr_loc": 525, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < urb->num_sgs && len; i++) {"}, {"instr_func": "snoop_urb_data", "instr_loc": 0, "instr_file": "drivers/usb/core/devio.c", "instr": "  %58 = phi i1 [ false, %53 ], [ %56, %54 ], !dbg !6272"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "snoop_urb_data"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1833, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb_data(as->urb, as->urb->transfer_buffer_length);"}, {"lineno": 528, "file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "  %18 = load i32, i32* %17, align 8, !dbg !6243", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "snoop_urb_data", "instr_loc": 528, "instr_file": "drivers/usb/core/devio.c", "instr": "sg_virt(&urb->sg[i]), size, 1);"}, {"instr_func": "sg_virt", "instr_loc": 251, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %3, align 8"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = load %struct.scatterlist*, %struct.scatterlist** %3, align 8, !dbg !6242"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %17 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %16, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1829, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1774, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ISO_ASAP;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1778, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_ZERO_PACKET;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %7 = load i32, i32* %6, align 8, !dbg !6235"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %12 = shl i32 %7, 8, !dbg !6236"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1765, "instr_file": "drivers/usb/core/devio.c", "instr": "__create_pipe(ps->dev, uurb->endpoint & 0xf) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1764, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->pipe = (uurb->type << 30) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1765, "instr_file": "drivers/usb/core/devio.c", "instr": "__create_pipe(ps->dev, uurb->endpoint & 0xf) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1764, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->pipe = (uurb->type << 30) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1829, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1829, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1837, "file": "drivers/usb/core/devio.c", "instr": "if (usb_endpoint_xfer_bulk(&ep->desc)) {"}],
"warnings":[{"warn_data": {"at_line": 518, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_submiturb", "instr_loc": 1887, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 917, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 919, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_in[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1837, "instr_file": "drivers/usb/core/devio.c", "instr": "if (usb_endpoint_xfer_bulk(&ep->desc)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1837, "instr_file": "drivers/usb/core/devio.c", "instr": "if (usb_endpoint_xfer_bulk(&ep->desc)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1837, "instr_file": "drivers/usb/core/devio.c", "instr": "if (usb_endpoint_xfer_bulk(&ep->desc)) {"}, {"instr_func": "usb_endpoint_xfer_bulk", "instr_loc": 517, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_xfer_bulk", "instr_loc": 518, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_xfer_bulk", "instr_loc": 518, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_xfer_bulk"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1871, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1582, "instr_file": "drivers/usb/core/devio.c", "instr": "uurb->buffer_length = le16_to_cpu(dr->wLength);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1712, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen = uurb->buffer_length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1729, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen -= u;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1714, "instr_file": "drivers/usb/core/devio.c", "instr": "u = (totlen > USB_SG_SIZE) ? USB_SG_SIZE : totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1776, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_SHORT_NOT_OK;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1780, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_NO_INTERRUPT;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1780, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_NO_INTERRUPT;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1780, "instr_file": "drivers/usb/core/devio.c", "instr": "u |= URB_NO_INTERRUPT;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1807, "instr_file": "drivers/usb/core/devio.c", "instr": "for (totlen = u = 0; u < number_of_packets; u++) {"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1810, "instr_file": "drivers/usb/core/devio.c", "instr": "totlen += isopkt[u].length;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1808, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->iso_frame_desc[u].offset = totlen;"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %7 = load i32, i32* %6, align 8, !dbg !6235"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %12 = shl i32 %7, 8, !dbg !6236"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1765, "instr_file": "drivers/usb/core/devio.c", "instr": "__create_pipe(ps->dev, uurb->endpoint & 0xf) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1764, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->pipe = (uurb->type << 30) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1765, "instr_file": "drivers/usb/core/devio.c", "instr": "__create_pipe(ps->dev, uurb->endpoint & 0xf) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1764, "instr_file": "drivers/usb/core/devio.c", "instr": "as->urb->pipe = (uurb->type << 30) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1871, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1871, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(ps->dev, as->userurb, as->urb->pipe,"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}],
"warnings":[{"warn_data": {"at_line": 400, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < as->urb->num_sgs; i++) {", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "free_async", "instr_loc": 400, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}, {"instr_func": "free_async", "instr_loc": 400, "instr_file": "drivers/usb/core/devio.c", "instr": "for (i = 0; i < as->urb->num_sgs; i++) {"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "free_async"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1844, "file": "drivers/usb/core/devio.c", "instr": "as->bulk_addr = usb_endpoint_num(&ep->desc) |"}],
"warnings":[{"warn_data": {"at_line": 471, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !6235", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 921, "instr_file": "drivers/usb/core/devio.c", "instr": "return dev->ep_out[ep & USB_ENDPOINT_NUMBER_MASK];"}, {"instr_func": "ep_to_host_endpoint", "instr_loc": 922, "instr_file": "drivers/usb/core/devio.c", "instr": "}"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1554, "instr_file": "drivers/usb/core/devio.c", "instr": "ep = ep_to_host_endpoint(ps->dev, uurb->endpoint);"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1844, "instr_file": "drivers/usb/core/devio.c", "instr": "as->bulk_addr = usb_endpoint_num(&ep->desc) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1844, "instr_file": "drivers/usb/core/devio.c", "instr": "as->bulk_addr = usb_endpoint_num(&ep->desc) |"}, {"instr_func": "proc_do_submiturb", "instr_loc": 1844, "instr_file": "drivers/usb/core/devio.c", "instr": "as->bulk_addr = usb_endpoint_num(&ep->desc) |"}, {"instr_func": "usb_endpoint_num", "instr_loc": 470, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_num", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_num", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !6235"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_num"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 402, "file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "  %18 = load i32, i32* %17, align 8, !dbg !6243", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "free_async", "instr_loc": 402, "instr_file": "drivers/usb/core/devio.c", "instr": "kfree(sg_virt(&as->urb->sg[i]));"}, {"instr_func": "sg_virt", "instr_loc": 251, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %3, align 8"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %16 = load %struct.scatterlist*, %struct.scatterlist** %3, align 8, !dbg !6242"}, {"instr_func": "sg_virt", "instr_loc": 252, "instr_file": "./include/linux/scatterlist.h", "instr": "  %17 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %16, i32 0, i32 1, !dbg !6243"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 401, "file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}],
"warnings":[{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i64, i64* %5, align 8, !dbg !6233", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "sg_page", "instr_loc": 119, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %2, align 8"}, {"instr_func": "sg_page", "instr_loc": 121, "instr_file": "./include/linux/scatterlist.h", "instr": "  %4 = load %struct.scatterlist*, %struct.scatterlist** %2, align 8, !dbg !6233"}, {"instr_func": "sg_page", "instr_loc": 121, "instr_file": "./include/linux/scatterlist.h", "instr": "  %5 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %4, i32 0, i32 0, !dbg !6233"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_page"}, "warn_no": 1},
{"warn_data": {"at_line": 123, "warn_str": "Trying to read from a user pointer.", "at": "  %26 = load i64, i64* %25, align 8, !dbg !6251", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1723, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(buf, uurb->buffer, u)) {"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "free_async", "instr_loc": 401, "instr_file": "drivers/usb/core/devio.c", "instr": "if (sg_page(&as->urb->sg[i]))"}, {"instr_func": "sg_page", "instr_loc": 119, "instr_file": "./include/linux/scatterlist.h", "instr": "  store %struct.scatterlist* %0, %struct.scatterlist** %2, align 8"}, {"instr_func": "sg_page", "instr_loc": 123, "instr_file": "./include/linux/scatterlist.h", "instr": "  %24 = load %struct.scatterlist*, %struct.scatterlist** %2, align 8, !dbg !6250"}, {"instr_func": "sg_page", "instr_loc": 123, "instr_file": "./include/linux/scatterlist.h", "instr": "  %25 = getelementptr inbounds %struct.scatterlist, %struct.scatterlist* %24, i32 0, i32 0, !dbg !6251"}], "at_file": "./include/linux/scatterlist.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_page"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2593, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_submiturb(ps, p);"}, {"lineno": 1897, "file": "drivers/usb/core/devio.c", "instr": "return proc_do_submiturb(ps, &uurb,"}, {"lineno": 1882, "file": "drivers/usb/core/devio.c", "instr": "free_async(as);"}, {"lineno": 409, "file": "drivers/usb/core/devio.c", "instr": "dec_usb_memory_use_count(as->usbm, &as->usbm->urb_use_count);"}],
"warnings":[{"warn_data": {"at_line": 184, "warn_str": "Trying to read from a user pointer.", "at": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1745, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(as->urb->transfer_buffer,"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 175, "instr_file": "drivers/usb/core/devio.c", "instr": "struct usb_dev_state *ps = usbm->ps;"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 175, "instr_file": "drivers/usb/core/devio.c", "instr": "struct usb_dev_state *ps = usbm->ps;"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 184, "instr_file": "drivers/usb/core/devio.c", "instr": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 184, "instr_file": "drivers/usb/core/devio.c", "instr": "usb_free_coherent(ps->dev, usbm->size, usbm->mem,"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 1},
{"warn_data": {"at_line": 187, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "usbm->size + sizeof(struct usb_memory));", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 187, "instr_file": "drivers/usb/core/devio.c", "instr": "usbm->size + sizeof(struct usb_memory));"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 2},
{"warn_data": {"at_line": 179, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "--*count;", "inst_trace": [{"instr_func": "proc_do_submiturb", "instr_loc": 1570, "instr_file": "drivers/usb/core/devio.c", "instr": "if (copy_from_user(dr, uurb->buffer, 8)) {"}, {"instr_func": "dec_usb_memory_use_count", "instr_loc": 179, "instr_file": "drivers/usb/core/devio.c", "instr": "--*count;"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "dec_usb_memory_use_count"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2578, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_connectinfo(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1351, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_connectinfo"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2583, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_setintf(ps, p);"}, {"lineno": 1430, "file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"lineno": 822, "file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_setintf", "instr_loc": 1424, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "checkintf", "instr_loc": 817, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "checkintf", "instr_loc": 822, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "checkintf", "instr_loc": 822, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2583, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_setintf(ps, p);"}, {"lineno": 1430, "file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"lineno": 828, "file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"lineno": 766, "file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_setintf", "instr_loc": 1424, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "checkintf", "instr_loc": 817, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "checkintf", "instr_loc": 828, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"instr_func": "checkintf", "instr_loc": 828, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"instr_func": "claimintf", "instr_loc": 758, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "claimintf", "instr_loc": 766, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "claimintf", "instr_loc": 766, "instr_file": "drivers/usb/core/devio.c", "instr": "if (test_bit(ifnum, &ps->ifclaimed))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2583, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_setintf(ps, p);"}, {"lineno": 1430, "file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"lineno": 828, "file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"lineno": 770, "file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !6277", "inst_trace": [{"instr_func": "proc_setintf", "instr_loc": 1424, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "proc_setintf", "instr_loc": 1430, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = checkintf(ps, setintf.interface);"}, {"instr_func": "checkintf", "instr_loc": 817, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "checkintf", "instr_loc": 828, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"instr_func": "checkintf", "instr_loc": 828, "instr_file": "drivers/usb/core/devio.c", "instr": "return claimintf(ps, ifnum);"}, {"instr_func": "claimintf", "instr_loc": 758, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "claimintf", "instr_loc": 770, "instr_file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}, {"instr_func": "claimintf", "instr_loc": 770, "instr_file": "drivers/usb/core/devio.c", "instr": "!test_bit(ifnum, &ps->interface_allowed_mask))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !6273"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !6278"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !6279"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !6277"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2573, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_getdriver(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1332, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_getdriver"}, "warn_no": 1},
{"warn_data": {"at_line": 1343, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "strlcpy(gd.driver, intf->dev.driver->name,", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_getdriver"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1268, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_bulk"}, "warn_no": 1}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}],
"warnings":[{"warn_data": {"at_line": 1218, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret = usbfs_increase_memory_usage(len1 + sizeof(struct urb));", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1218, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = usbfs_increase_memory_usage(len1 + sizeof(struct urb));"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 1},
{"warn_data": {"at_line": 1226, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 2},
{"warn_data": {"at_line": 1226, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 3},
{"warn_data": {"at_line": 1226, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 4},
{"warn_data": {"at_line": 1226, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 5},
{"warn_data": {"at_line": 1226, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1226, "instr_file": "drivers/usb/core/devio.c", "instr": "tbuf = kmalloc(len1, GFP_KERNEL | __GFP_NOWARN);"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 6},
{"warn_data": {"at_line": 1263, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "usbfs_decrease_memory_usage(len1 + sizeof(struct urb));", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1215, "instr_file": "drivers/usb/core/devio.c", "instr": "len1 = bulk->len;"}, {"instr_func": "do_proc_bulk", "instr_loc": 1263, "instr_file": "drivers/usb/core/devio.c", "instr": "usbfs_decrease_memory_usage(len1 + sizeof(struct urb));"}], "at_file": "drivers/usb/core/devio.c", "by": "IntegerOverflowDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 7},
{"warn_data": {"at_line": 1248, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(tbuf, bulk->data, len1)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 8},
{"warn_data": {"at_line": 1241, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(bulk->data, tbuf, len2)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_bulk"}, "warn_no": 9}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1203, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, bulk->ep);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1203, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, bulk->ep);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1203, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, bulk->ep);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1213, "file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}],
"warnings":[{"warn_data": {"at_line": 2001, "warn_str": "Trying to read from a user pointer.", "at": "  %91 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %90, align 8, !dbg !6290", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "usb_maxpacket", "instr_loc": 1992, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %6, align 4"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %14 = load i32, i32* %6, align 4, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %19 = ashr i32 %14, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %20 = and i32 %19, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %20, i32* %9, align 4, !dbg !6239"}, {"instr_func": "usb_maxpacket", "instr_loc": 2001, "instr_file": "./include/linux/usb.h", "instr": "  %88 = load i32, i32* %9, align 4, !dbg !6292"}, {"instr_func": "usb_maxpacket", "instr_loc": 2001, "instr_file": "./include/linux/usb.h", "instr": "  %90 = getelementptr [16 x %struct.usb_host_endpoint*], [16 x %struct.usb_host_endpoint*]* %87, i64 0, i64 %89, !dbg !6290"}], "at_file": "./include/linux/usb.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_maxpacket"}, "warn_no": 1},
{"warn_data": {"at_line": 1998, "warn_str": "Trying to read from a user pointer.", "at": "  %56 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %55, align 8, !dbg !6265", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "usb_maxpacket", "instr_loc": 1992, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %6, align 4"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %14 = load i32, i32* %6, align 4, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %19 = ashr i32 %14, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %20 = and i32 %19, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %20, i32* %9, align 4, !dbg !6239"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  %53 = load i32, i32* %9, align 4, !dbg !6267"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  %55 = getelementptr [16 x %struct.usb_host_endpoint*], [16 x %struct.usb_host_endpoint*]* %52, i64 0, i64 %54, !dbg !6265"}], "at_file": "./include/linux/usb.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_maxpacket"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1213, "file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"lineno": 2007, "file": "./include/linux/usb.h", "instr": "  %99 = call i32 @usb_endpoint_maxp(%struct.usb_endpoint_descriptor* %98) #13, !dbg !6300"}],
"warnings":[{"warn_data": {"at_line": 649, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i16, i16* %4, align 1, !dbg !6234", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1210, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_rcvbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "do_proc_bulk", "instr_loc": 1213, "instr_file": "drivers/usb/core/devio.c", "instr": "if (!usb_maxpacket(dev, pipe, !(bulk->ep & USB_DIR_IN)))"}, {"instr_func": "usb_maxpacket", "instr_loc": 1992, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %6, align 4"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %14 = load i32, i32* %6, align 4, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %19 = ashr i32 %14, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  %20 = and i32 %19, 15, !dbg !6240"}, {"instr_func": "usb_maxpacket", "instr_loc": 1994, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %20, i32* %9, align 4, !dbg !6239"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  %53 = load i32, i32* %9, align 4, !dbg !6267"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  %55 = getelementptr [16 x %struct.usb_host_endpoint*], [16 x %struct.usb_host_endpoint*]* %52, i64 0, i64 %54, !dbg !6265"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  %56 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %55, align 8, !dbg !6265"}, {"instr_func": "usb_maxpacket", "instr_loc": 1998, "instr_file": "./include/linux/usb.h", "instr": "  store %struct.usb_host_endpoint* %56, %struct.usb_host_endpoint** %8, align 8, !dbg !6268"}, {"instr_func": "usb_maxpacket", "instr_loc": 2007, "instr_file": "./include/linux/usb.h", "instr": "  %97 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %8, align 8, !dbg !6298"}, {"instr_func": "usb_maxpacket", "instr_loc": 2007, "instr_file": "./include/linux/usb.h", "instr": "  %98 = getelementptr inbounds %struct.usb_host_endpoint, %struct.usb_host_endpoint* %97, i32 0, i32 0, !dbg !6299"}, {"instr_func": "usb_maxpacket", "instr_loc": 2007, "instr_file": "./include/linux/usb.h", "instr": "  %99 = call i32 @usb_endpoint_maxp(%struct.usb_endpoint_descriptor* %98) #13, !dbg !6300"}, {"instr_func": "usb_endpoint_maxp", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !6234"}, {"instr_func": "usb_endpoint_maxp", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !6234"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2540, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control(ps, p);"}],
"warnings":[{"warn_data": {"at_line": 1186, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_control"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1253, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, tbuf, len1);"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1253, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, tbuf, len1);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1253, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, tbuf, len1);"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1258, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, NULL, 0);"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1258, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, NULL, 0);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1258, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, NULL, 0);"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1233, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, NULL, 0);"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1233, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, NULL, 0);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1233, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len1, tmo, SUBMIT, NULL, 0);"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2547, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_bulk(ps, p);"}, {"lineno": 1273, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_bulk(ps, &bulk);"}, {"lineno": 1238, "file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, tbuf, len2);"}],
"warnings":[{"warn_data": {"at_line": 480, "warn_str": "Trying to read from a user pointer.", "at": "t = types[usb_pipetype(pipe)];", "inst_trace": [{"instr_func": "proc_bulk", "instr_loc": 1268, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "__create_pipe", "instr_loc": 1958, "instr_file": "./include/linux/usb.h", "instr": "  store i32 %1, i32* %4, align 4"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %13 = load i32, i32* %4, align 4, !dbg !6238"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %18 = shl i32 %13, 15, !dbg !6239"}, {"instr_func": "__create_pipe", "instr_loc": 1959, "instr_file": "./include/linux/usb.h", "instr": "  %19 = or i32 %12, %18, !dbg !6240"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1212, "instr_file": "drivers/usb/core/devio.c", "instr": "pipe = usb_sndbulkpipe(dev, bulk->ep & 0x7f);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1238, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, tbuf, len2);"}, {"instr_func": "do_proc_bulk", "instr_loc": 1238, "instr_file": "drivers/usb/core/devio.c", "instr": "snoop_urb(dev, NULL, pipe, len2, i, COMPLETE, tbuf, len2);"}, {"instr_func": "snoop_urb", "instr_loc": 470, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}, {"instr_func": "snoop_urb", "instr_loc": 480, "instr_file": "drivers/usb/core/devio.c", "instr": "t = types[usb_pipetype(pipe)];"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "snoop_urb"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2540, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control(ps, p);"}, {"lineno": 1191, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}],
"warnings":[{"warn_data": {"at_line": 1148, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(ctrl->data, tbuf, i)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_control"}, "warn_no": 1},
{"warn_data": {"at_line": 1155, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(tbuf, ctrl->data, ctrl->wLength)) {", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "do_proc_control"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2540, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control(ps, p);"}, {"lineno": 1191, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}, {"lineno": 1114, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"lineno": 887, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_control", "instr_loc": 1186, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_control", "instr_loc": 1115, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl->wIndex);"}, {"instr_func": "do_proc_control", "instr_loc": 1114, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 887, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2540, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_control(ps, p);"}, {"lineno": 1191, "file": "drivers/usb/core/devio.c", "instr": "return do_proc_control(ps, &ctrl);"}, {"lineno": 1114, "file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"lineno": 897, "file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}],
"warnings":[{"warn_data": {"at_line": 848, "warn_str": "Loop is bounded by a tainted value.", "at": "if (endpt->bEndpointAddress == ep)", "inst_trace": [{"instr_func": "proc_control", "instr_loc": 1186, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "do_proc_control", "instr_loc": 1115, "instr_file": "drivers/usb/core/devio.c", "instr": "ctrl->wIndex);"}, {"instr_func": "do_proc_control", "instr_loc": 1114, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = check_ctrlrecip(ps, ctrl->bRequestType, ctrl->bRequest,"}, {"instr_func": "check_ctrlrecip", "instr_loc": 858, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "check_ctrlrecip", "instr_loc": 897, "instr_file": "drivers/usb/core/devio.c", "instr": "ret = findintfep(ps->dev, index ^ 0x80);"}, {"instr_func": "findintfep", "instr_loc": 832, "instr_file": "drivers/usb/core/devio.c", "instr": "{"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}, {"instr_func": "findintfep", "instr_loc": 848, "instr_file": "drivers/usb/core/devio.c", "instr": "if (endpt->bEndpointAddress == ep)"}], "at_file": "drivers/usb/core/devio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "findintfep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2713, "file": "drivers/usb/core/devio.c", "instr": "ret = usbdev_do_ioctl(file, cmd, (void __user *)arg);"}, {"lineno": 2697, "file": "drivers/usb/core/devio.c", "instr": "ret = proc_conninfo_ex(ps, p, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1390, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &ci, min(sizeof(ci), size)))", "inst_trace": [], "at_file": "drivers/usb/core/devio.c", "by": "TaintedSizeDetector says:", "at_func": "proc_conninfo_ex"}, "warn_no": 1}]}]}