{"all_contexts":[
{"num_warnings": 35,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 653, "warn_str": "Trying to use a global variable without locking.", "at": "TW_Device_Extension *tw_dev = twa_device_extension_list[iminor(inode)];", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "GlobalVariableRaceDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 676, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 666, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))", "inst_trace": [], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedSizeDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 679, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "cpu_addr = dma_alloc_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, &dma_handle, GFP_KERNEL);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 679, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "cpu_addr = dma_alloc_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, &dma_handle, GFP_KERNEL);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 679, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "cpu_addr = dma_alloc_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, &dma_handle, GFP_KERNEL);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 679, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "cpu_addr = dma_alloc_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, &dma_handle, GFP_KERNEL);"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 679, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "cpu_addr = dma_alloc_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, &dma_handle, GFP_KERNEL);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 688, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_from_user(tw_ioctl, argp, driver_command.buffer_length + sizeof(TW_Ioctl_Buf_Apache) - 1))", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 688, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(tw_ioctl, argp, driver_command.buffer_length + sizeof(TW_Ioctl_Buf_Apache) - 1))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 688, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(tw_ioctl, argp, driver_command.buffer_length + sizeof(TW_Ioctl_Buf_Apache) - 1))"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 688, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_from_user(tw_ioctl, argp, driver_command.buffer_length + sizeof(TW_Ioctl_Buf_Apache) - 1))", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 688, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(tw_ioctl, argp, driver_command.buffer_length + sizeof(TW_Ioctl_Buf_Apache) - 1))"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 830, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 685, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;", "inst_trace": [], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedSizeDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 830, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 830, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 832, "warn_str": "Trying to read from a user pointer.", "at": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 832, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 832, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 12},
{"warn_data": {"at_line": 832, "warn_str": "Trying to read from a user pointer.", "at": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 832, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 832, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 832, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id < sequence_id)) {"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 13},
{"warn_data": {"at_line": 838, "warn_str": "Trying to read from a user pointer.", "at": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 838, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 838, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 14},
{"warn_data": {"at_line": 839, "warn_str": "Trying to read from a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 839, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 839, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 15},
{"warn_data": {"at_line": 839, "warn_str": "Trying to write to a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 839, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 839, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 839, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 16},
{"warn_data": {"at_line": 801, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 17},
{"warn_data": {"at_line": 801, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 18},
{"warn_data": {"at_line": 801, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 801, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id + 1) % TW_Q_LENGTH;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 19},
{"warn_data": {"at_line": 803, "warn_str": "Trying to read from a user pointer.", "at": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 803, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 803, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 20},
{"warn_data": {"at_line": 803, "warn_str": "Trying to read from a user pointer.", "at": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 803, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 803, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 803, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (!(tw_dev->event_queue[event_index]->sequence_id > sequence_id)) {"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 21},
{"warn_data": {"at_line": 809, "warn_str": "Trying to read from a user pointer.", "at": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 809, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 809, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 22},
{"warn_data": {"at_line": 810, "warn_str": "Trying to read from a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 810, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 810, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 23},
{"warn_data": {"at_line": 810, "warn_str": "Trying to write to a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 810, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 810, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 810, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 24},
{"warn_data": {"at_line": 780, "warn_str": "Trying to read from a user pointer.", "at": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 780, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 780, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 25},
{"warn_data": {"at_line": 781, "warn_str": "Trying to read from a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 781, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 781, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 26},
{"warn_data": {"at_line": 781, "warn_str": "Trying to write to a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 781, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 781, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 781, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 27},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 761, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 761, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "memcpy(tw_ioctl->data_buffer, tw_dev->event_queue[event_index], sizeof(TW_Event));"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 28},
{"warn_data": {"at_line": 762, "warn_str": "Trying to read from a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 762, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 762, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 29},
{"warn_data": {"at_line": 762, "warn_str": "Trying to write to a user pointer.", "at": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 814, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sequence_id = event->sequence_id;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 830, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "event_index = (start_index + sequence_id - tw_dev->event_queue[start_index]->sequence_id - 1) % TW_Q_LENGTH;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 762, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 762, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 762, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->event_queue[event_index]->retrieved = TW_AEN_RETRIEVED;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 30},
{"warn_data": {"at_line": 870, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 870, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 31},
{"warn_data": {"at_line": 870, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 870, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 870, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 32},
{"warn_data": {"at_line": 870, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, tw_ioctl, sizeof(TW_Ioctl_Buf_Apache) + driver_command.buffer_length - 1) == 0)", "inst_trace": [], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedSizeDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 33},
{"warn_data": {"at_line": 874, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma_free_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, cpu_addr, dma_handle);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 874, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "dma_free_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, cpu_addr, dma_handle);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 34},
{"warn_data": {"at_line": 874, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma_free_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, cpu_addr, dma_handle);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 666, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "if (copy_from_user(&driver_command, argp, sizeof(TW_Ioctl_Driver_Command)))"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 676, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "data_buffer_length_adjusted = (driver_command.buffer_length + 511) & ~511;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 874, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "dma_free_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, cpu_addr, dma_handle);"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 874, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "dma_free_coherent(&tw_dev->tw_pci_dev->dev, data_buffer_length_adjusted+sizeof(TW_Ioctl_Buf_Apache) - 1, cpu_addr, dma_handle);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_chrdev_ioctl"}, "warn_no": 35}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 848, "file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->ioctl_time = ktime_add_ms(current_time, tw_lock->timeout_msec);"}],
"warnings":[{"warn_data": {"at_line": 186, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %8 = add i64 %5, %7, !dbg !7101", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 848, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->ioctl_time = ktime_add_ms(current_time, tw_lock->timeout_msec);"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 848, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_dev->ioctl_time = ktime_add_ms(current_time, tw_lock->timeout_msec);"}, {"instr_func": "ktime_add_ms", "instr_loc": 185, "instr_file": "./include/linux/ktime.h", "instr": "  store i64 %1, i64* %4, align 8"}, {"instr_func": "ktime_add_ms", "instr_loc": 186, "instr_file": "./include/linux/ktime.h", "instr": "  %6 = load i64, i64* %4, align 8, !dbg !7101"}, {"instr_func": "ktime_add_ms", "instr_loc": 186, "instr_file": "./include/linux/ktime.h", "instr": "  %7 = mul i64 %6, 1000000, !dbg !7101"}], "at_file": "./include/linux/ktime.h", "by": "IntegerOverflowDetector says:", "at_func": "ktime_add_ms"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 706, "file": "drivers/scsi/3w-9xxx.c", "instr": "twa_load_sgl(tw_dev, full_command_packet, request_id, dma_handle, data_buffer_length_adjusted);"}],
"warnings":[{"warn_data": {"at_line": 1410, "warn_str": "Trying to write to a user pointer.", "at": "sgl->address = TW_CPU_TO_SGL(dma_handle + sizeof(TW_Ioctl_Buf_Apache) - 1);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1410, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl->address = TW_CPU_TO_SGL(dma_handle + sizeof(TW_Ioctl_Buf_Apache) - 1);"}, {"instr_func": "twa_load_sgl", "instr_loc": 1410, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl->address = TW_CPU_TO_SGL(dma_handle + sizeof(TW_Ioctl_Buf_Apache) - 1);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_load_sgl"}, "warn_no": 1},
{"warn_data": {"at_line": 1411, "warn_str": "Trying to write to a user pointer.", "at": "sgl->length = cpu_to_le32(length);", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1409, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl = (TW_SG_Entry *)((u32 *)oldcommand+TW_SGL_OUT(oldcommand->opcode__sgloffset));"}, {"instr_func": "twa_load_sgl", "instr_loc": 1411, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl->length = cpu_to_le32(length);"}, {"instr_func": "twa_load_sgl", "instr_loc": 1411, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "sgl->length = cpu_to_le32(length);"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "twa_load_sgl"}, "warn_no": 2},
{"warn_data": {"at_line": 1413, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "oldcommand->size += pae;", "inst_trace": [{"instr_func": "twa_chrdev_ioctl", "instr_loc": 685, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_ioctl = (TW_Ioctl_Buf_Apache *)cpu_addr;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 850, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_lock->time_remaining_msec = tw_lock->timeout_msec;"}, {"instr_func": "twa_chrdev_ioctl", "instr_loc": 850, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "tw_lock->time_remaining_msec = tw_lock->timeout_msec;"}, {"instr_func": "twa_load_sgl", "instr_loc": 1413, "instr_file": "drivers/scsi/3w-9xxx.c", "instr": "oldcommand->size += pae;"}], "at_file": "drivers/scsi/3w-9xxx.c", "by": "IntegerOverflowDetector says:", "at_func": "twa_load_sgl"}, "warn_no": 3}]}]}