{"all_contexts":[
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1237, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct ne_enclave_start_info enclave_start_info = {};", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1311, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "mutex_unlock(&ne_enclave->enclave_info_mutex);", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1200, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct ne_user_memory_region mem_region = {};", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1193, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, &image_load_info, sizeof(image_load_info)))", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1164, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct ne_image_load_info image_load_info = {};", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1095, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "int rc = -EINVAL;", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1155, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "mutex_unlock(&ne_enclave->enclave_info_mutex);", "inst_trace": [], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedSizeDetector says:", "at_func": "ne_enclave_ioctl"}, "warn_no": 7}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1224, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_set_user_memory_region_ioctl(ne_enclave, mem_region);"}],
"warnings":[{"warn_data": {"at_line": 914, "warn_str": "Loop is bounded by a tainted value.", "at": "} while (memory_size < mem_region.memory_size);", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 914, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "} while (memory_size < mem_region.memory_size);"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 914, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "} while (memory_size < mem_region.memory_size);"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_set_user_memory_region_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 889, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "gup_rc = get_user_pages(mem_region.userspace_addr + memory_size, 1, FOLL_GET,", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 889, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "gup_rc = get_user_pages(mem_region.userspace_addr + memory_size, 1, FOLL_GET,"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ne_set_user_memory_region_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 880, "warn_str": "Loop is bounded by a tainted value.", "at": "if (i == max_nr_pages) {", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 859, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "max_nr_pages = mem_region.memory_size / NE_MIN_MEM_REGION_SIZE;"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 859, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "max_nr_pages = mem_region.memory_size / NE_MIN_MEM_REGION_SIZE;"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 859, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "max_nr_pages = mem_region.memory_size / NE_MIN_MEM_REGION_SIZE;"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 880, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (i == max_nr_pages) {"}, {"instr_func": "ne_set_user_memory_region_ioctl", "instr_loc": 880, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (i == max_nr_pages) {"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_set_user_memory_region_ioctl"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1224, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_set_user_memory_region_ioctl(ne_enclave, mem_region);"}, {"lineno": 851, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_sanity_check_user_mem_region(ne_enclave, mem_region);"}],
"warnings":[{"warn_data": {"at_line": 776, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(mem_region.userspace_addr + mem_region.memory_size) > userspace_addr)) {", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 776, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "(mem_region.userspace_addr + mem_region.memory_size) > userspace_addr)) {"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ne_sanity_check_user_mem_region"}, "warn_no": 1},
{"warn_data": {"at_line": 773, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((userspace_addr <= mem_region.userspace_addr &&", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 776, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "(mem_region.userspace_addr + mem_region.memory_size) > userspace_addr)) {"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 776, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "(mem_region.userspace_addr + mem_region.memory_size) > userspace_addr)) {"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 776, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "(mem_region.userspace_addr + mem_region.memory_size) > userspace_addr)) {"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_sanity_check_user_mem_region"}, "warn_no": 2},
{"warn_data": {"at_line": 774, "warn_str": "Loop is bounded by a tainted value.", "at": "mem_region.userspace_addr < (userspace_addr + memory_size)) ||", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 774, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "mem_region.userspace_addr < (userspace_addr + memory_size)) ||"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 774, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "mem_region.userspace_addr < (userspace_addr + memory_size)) ||"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_sanity_check_user_mem_region"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1224, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_set_user_memory_region_ioctl(ne_enclave, mem_region);"}, {"lineno": 851, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_sanity_check_user_mem_region(ne_enclave, mem_region);"}, {"lineno": 760, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "!access_ok((void __user *)(unsigned long)mem_region.userspace_addr,"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !41985", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 760, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "!access_ok((void __user *)(unsigned long)mem_region.userspace_addr,"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 760, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "!access_ok((void __user *)(unsigned long)mem_region.userspace_addr,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 32, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !41984"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 29, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !41982", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1200, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "struct ne_user_memory_region mem_region = {};"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 760, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "!access_ok((void __user *)(unsigned long)mem_region.userspace_addr,"}, {"instr_func": "ne_sanity_check_user_mem_region", "instr_loc": 760, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "!access_ok((void __user *)(unsigned long)mem_region.userspace_addr,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 29, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !41982"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1136, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}],
"warnings":[{"warn_data": {"at_line": 659, "warn_str": "Loop is bounded by a tainted value.", "at": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1095, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "int rc = -EINVAL;"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 642, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 343, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %3, align 4, !dbg !41975"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_check", "instr_loc": 114, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "cpumask_check", "instr_loc": 116, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %2, align 4, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !42016"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !42017"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !42015"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %39 = and i64 %33, %38, !dbg !42018"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %40 = icmp ne i64 %39, 0, !dbg !42019"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %57 = phi i32 [ %41, %28 ], [ %55, %53 ], !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %58 = icmp ne i32 %57, 0, !dbg !42011"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_check_cpu_in_cpu_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1136, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"lineno": 647, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (ne_donated_cpu(ne_enclave, vcpu_id)) {"}, {"lineno": 471, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(cpu, ne_enclave->vcpu_ids))"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !42015", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1095, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "int rc = -EINVAL;"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 642, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 647, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (ne_donated_cpu(ne_enclave, vcpu_id)) {"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 647, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (ne_donated_cpu(ne_enclave, vcpu_id)) {"}, {"instr_func": "ne_donated_cpu", "instr_loc": 470, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_donated_cpu", "instr_loc": 471, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(cpu, ne_enclave->vcpu_ids))"}, {"instr_func": "ne_donated_cpu", "instr_loc": 471, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(cpu, ne_enclave->vcpu_ids))"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 343, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %3, align 4, !dbg !41975"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_check", "instr_loc": 114, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "cpumask_check", "instr_loc": 116, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %2, align 4, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !42016"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !42017"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !42015"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1136, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"lineno": 659, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !42015", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1095, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "int rc = -EINVAL;"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 642, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 659, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_enclave->threads_per_core[i]))"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 343, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %3, align 4, !dbg !41975"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_check", "instr_loc": 114, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "cpumask_check", "instr_loc": 116, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %2, align 4, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !42016"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !42017"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !42015"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1136, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"lineno": 669, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}],
"warnings":[{"warn_data": {"at_line": 621, "warn_str": "Loop is bounded by a tainted value.", "at": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1095, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "int rc = -EINVAL;"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 642, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 669, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 669, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 616, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 343, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %3, align 4, !dbg !41975"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_check", "instr_loc": 114, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "cpumask_check", "instr_loc": 116, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %2, align 4, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !42016"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !42017"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !42015"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %39 = and i64 %33, %38, !dbg !42018"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %40 = icmp ne i64 %39, 0, !dbg !42019"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %57 = phi i32 [ %41, %28 ], [ %55, %53 ], !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %58 = icmp ne i32 %57, 0, !dbg !42011"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}], "at_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ne_get_vcpu_core_from_cpu_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1136, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"lineno": 669, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}, {"lineno": 621, "file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !42015", "inst_trace": [{"instr_func": "ne_enclave_ioctl", "instr_loc": 1095, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "int rc = -EINVAL;"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_enclave_ioctl", "instr_loc": 1136, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "rc = ne_check_cpu_in_cpu_pool(ne_enclave, vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 642, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 669, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}, {"instr_func": "ne_check_cpu_in_cpu_pool", "instr_loc": 669, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "core_id = ne_get_vcpu_core_from_cpu_pool(vcpu_id);"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 616, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "{"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"instr_func": "ne_get_vcpu_core_from_cpu_pool", "instr_loc": 621, "instr_file": "drivers/virt/nitro_enclaves/ne_misc_dev.c", "instr": "if (cpumask_test_cpu(vcpu_id, ne_cpu_pool.avail_threads_per_core[i])) {"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 343, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %3, align 4, !dbg !41975"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_check", "instr_loc": 114, "instr_file": "./include/linux/cpumask.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "cpumask_check", "instr_loc": 116, "instr_file": "./include/linux/cpumask.h", "instr": "  %5 = load i32, i32* %2, align 4, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #14, !dbg !41976"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %11 = call zeroext i1 @test_bit(i64 %7, i64* %10) #14, !dbg !41978"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !42011"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !42016"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !42017"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !42015"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]}]}