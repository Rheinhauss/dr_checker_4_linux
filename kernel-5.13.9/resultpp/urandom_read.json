{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1822, "warn_str": "Trying to use a global variable without locking.", "at": "if (!crng_ready() && maxwarn > 0) {", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "urandom_read"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 1832, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}],
"warnings":[{"warn_data": {"at_line": 1079, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nbytes -= i;", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "extract_crng_user"}, "warn_no": 1},
{"warn_data": {"at_line": 1062, "warn_str": "Loop is bounded by a tainted value.", "at": "while (nbytes) {", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1062, "instr_file": "drivers/char/random.c", "instr": "while (nbytes) {"}, {"instr_func": "extract_crng_user", "instr_loc": 1062, "instr_file": "drivers/char/random.c", "instr": "while (nbytes) {"}], "at_file": "drivers/char/random.c", "by": "TaintedLoopBoundDetector says:", "at_func": "extract_crng_user"}, "warn_no": 2},
{"warn_data": {"at_line": 1074, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(buf, tmp, i)) {", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1074, "instr_file": "drivers/char/random.c", "instr": "if (copy_to_user(buf, tmp, i)) {"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1074, "instr_file": "drivers/char/random.c", "instr": "if (copy_to_user(buf, tmp, i)) {"}], "at_file": "drivers/char/random.c", "by": "TaintedLoopBoundDetector says:", "at_func": "extract_crng_user"}, "warn_no": 3},
{"warn_data": {"at_line": 1081, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret += i;", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1081, "instr_file": "drivers/char/random.c", "instr": "ret += i;"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "extract_crng_user"}, "warn_no": 4},
{"warn_data": {"at_line": 1073, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);", "inst_trace": [], "at_file": "drivers/char/random.c", "by": "TaintedSizeDetector says:", "at_func": "extract_crng_user"}, "warn_no": 5}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 1832, "file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"lineno": 1811, "file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"lineno": 1083, "file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"lineno": 1053, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}],
"warnings":[{"warn_data": {"at_line": 1030, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "used = round_up(used, sizeof(__u32));", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 1},
{"warn_data": {"at_line": 1030, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "used = round_up(used, sizeof(__u32));", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1030, "instr_file": "drivers/char/random.c", "instr": "used = round_up(used, sizeof(__u32));"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 2},
{"warn_data": {"at_line": 1031, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (used + CHACHA_KEY_SIZE > CHACHA_BLOCK_SIZE) {", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1031, "instr_file": "drivers/char/random.c", "instr": "if (used + CHACHA_KEY_SIZE > CHACHA_BLOCK_SIZE) {"}], "at_file": "drivers/char/random.c", "by": "IntegerOverflowDetector says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 3},
{"warn_data": {"at_line": 1039, "warn_str": "Trying to read from a user pointer.", "at": "*d++ ^= *s++;", "inst_trace": [{"instr_func": "urandom_read", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "urandom_read", "instr_loc": 1818, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read", "instr_loc": 1832, "instr_file": "drivers/char/random.c", "instr": "return urandom_read_nowarn(file, buf, nbytes, ppos);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1807, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1810, "instr_file": "drivers/char/random.c", "instr": "nbytes = min_t(size_t, nbytes, INT_MAX >> (ENTROPY_SHIFT + 3));"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "urandom_read_nowarn", "instr_loc": 1811, "instr_file": "drivers/char/random.c", "instr": "ret = extract_crng_user(buf, nbytes);"}, {"instr_func": "extract_crng_user", "instr_loc": 1057, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "nbytes -= i;"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1073, "instr_file": "drivers/char/random.c", "instr": "i = min_t(int, nbytes, CHACHA_BLOCK_SIZE);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "extract_crng_user", "instr_loc": 1083, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, i);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1044, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "crng_backtrack_protect", "instr_loc": 1053, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(crng, tmp, used);"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1025, "instr_file": "drivers/char/random.c", "instr": "{"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1036, "instr_file": "drivers/char/random.c", "instr": "s = (__u32 *) &tmp[used];"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1039, "instr_file": "drivers/char/random.c", "instr": "*d++ ^= *s++;"}], "at_file": "drivers/char/random.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_crng_backtrack_protect"}, "warn_no": 4}]}]}