{"all_contexts":[
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 2253, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_insn insn;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 2229, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_insnlist insnlist;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 2242, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(insns, insnlist.insns,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 2216, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_cmd cmd;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 2224, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_to_user((void __user *)arg, &cmd, sizeof(cmd)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 2203, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_cmd cmd;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 2211, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_to_user((void __user *)arg, &cmd, sizeof(cmd)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 2180, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_rangeinfo it;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 2171, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct comedi_chaninfo it;", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "comedi_unlocked_ioctl"}, "warn_no": 9}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2258, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insn_ioctl(dev, &insn, file);"}],
"warnings":[{"warn_data": {"at_line": 1625, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insn_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1636, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(insn->data,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insn_ioctl"}, "warn_no": 2}]},
{"num_warnings": 25,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2258, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insn_ioctl(dev, &insn, file);"}, {"lineno": 1632, "file": "drivers/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, insn, data, file);"}],
"warnings":[{"warn_data": {"at_line": 1411, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 1},
{"warn_data": {"at_line": 1403, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1403, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "parse_insn", "instr_loc": 1403, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 2},
{"warn_data": {"at_line": 1411, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 3},
{"warn_data": {"at_line": 1424, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1424, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "parse_insn", "instr_loc": 1424, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 4},
{"warn_data": {"at_line": 1429, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = parse_insn;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1429, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}, {"instr_func": "parse_insn", "instr_loc": 1429, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 5},
{"warn_data": {"at_line": 1472, "warn_str": "Trying to read from a user pointer.", "at": "if (s->n_chan <= 32) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1472, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}, {"instr_func": "parse_insn", "instr_loc": 1472, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 6},
{"warn_data": {"at_line": 1490, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_config(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1490, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1490, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 7},
{"warn_data": {"at_line": 1480, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_bits(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1480, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1480, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 8},
{"warn_data": {"at_line": 1440, "warn_str": "Trying to read from a user pointer.", "at": "maxdata = s->maxdata_list", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 9},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": ": s->maxdata;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/comedi/comedi_fops.c", "instr": ": s->maxdata;"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/comedi/comedi_fops.c", "instr": ": s->maxdata;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 10},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 11},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 12},
{"warn_data": {"at_line": 1444, "warn_str": "Loop is bounded by a tainted value.", "at": "if (data[i] > maxdata) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1625, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(data,"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 13},
{"warn_data": {"at_line": 1443, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insn->n; ++i) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 14},
{"warn_data": {"at_line": 1452, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_write(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1452, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1452, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 15},
{"warn_data": {"at_line": 1454, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1454, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1454, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 16},
{"warn_data": {"at_line": 1432, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_read(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1432, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1432, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 17},
{"warn_data": {"at_line": 1434, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1434, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1434, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 18},
{"warn_data": {"at_line": 1497, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1497, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "parse_insn", "instr_loc": 1497, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 19},
{"warn_data": {"at_line": 1359, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 20},
{"warn_data": {"at_line": 1378, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data[1] = (insn->n - 2) / 2;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1378, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "data[1] = (insn->n - 2) / 2;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "parse_insn"}, "warn_no": 21},
{"warn_data": {"at_line": 1354, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1354, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async) {"}, {"instr_func": "parse_insn", "instr_loc": 1354, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 22},
{"warn_data": {"at_line": 1364, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 23},
{"warn_data": {"at_line": 1359, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 24},
{"warn_data": {"at_line": 1364, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2253, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insn insn;"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 25}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2248, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}],
"warnings":[{"warn_data": {"at_line": 1535, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < n_insns; ++i) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2229, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insnlist insnlist;"}, {"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2248, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}, {"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2248, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1526, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1535, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < n_insns; ++i) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1535, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < n_insns; ++i) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1536, "warn_str": "Loop is bounded by a tainted value.", "at": "if (insns[i].n > MAX_SAMPLES) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1536, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (insns[i].n > MAX_SAMPLES) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1536, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (insns[i].n > MAX_SAMPLES) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1553, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < n_insns; ++i) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2229, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_insnlist insnlist;"}, {"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2248, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}, {"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2248, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1526, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1553, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < n_insns; ++i) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1553, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < n_insns; ++i) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1567, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(insns[i].data, data,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1568, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1568, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1567, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1567, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1567, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1555, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(data, insns[i].data,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1556, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1556, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1555, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1555, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1555, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1567, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(insns[i].data, data,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1555, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data, insns[i].data,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 7}]},
{"num_warnings": 25,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2248, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev, insns, insnlist.n_insns, file);"}, {"lineno": 1563, "file": "drivers/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, insns + i, data, file);"}],
"warnings":[{"warn_data": {"at_line": 1411, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 1},
{"warn_data": {"at_line": 1403, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1403, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "parse_insn", "instr_loc": 1403, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 2},
{"warn_data": {"at_line": 1411, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1411, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 3},
{"warn_data": {"at_line": 1424, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1424, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "parse_insn", "instr_loc": 1424, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 4},
{"warn_data": {"at_line": 1429, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = parse_insn;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1429, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}, {"instr_func": "parse_insn", "instr_loc": 1429, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 5},
{"warn_data": {"at_line": 1472, "warn_str": "Trying to read from a user pointer.", "at": "if (s->n_chan <= 32) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1472, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}, {"instr_func": "parse_insn", "instr_loc": 1472, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 6},
{"warn_data": {"at_line": 1490, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_config(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1490, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1490, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 7},
{"warn_data": {"at_line": 1480, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_bits(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1480, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1480, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 8},
{"warn_data": {"at_line": 1440, "warn_str": "Trying to read from a user pointer.", "at": "maxdata = s->maxdata_list", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 9},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": ": s->maxdata;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/comedi/comedi_fops.c", "instr": ": s->maxdata;"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/comedi/comedi_fops.c", "instr": ": s->maxdata;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 10},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 11},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 12},
{"warn_data": {"at_line": 1444, "warn_str": "Loop is bounded by a tainted value.", "at": "if (data[i] > maxdata) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1440, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 13},
{"warn_data": {"at_line": 1443, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insn->n; ++i) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 14},
{"warn_data": {"at_line": 1452, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_write(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1452, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1452, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 15},
{"warn_data": {"at_line": 1454, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1454, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1454, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 16},
{"warn_data": {"at_line": 1432, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_read(dev, s, insn, data);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1432, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1432, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 17},
{"warn_data": {"at_line": 1434, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1434, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1434, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 18},
{"warn_data": {"at_line": 1497, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1497, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "parse_insn", "instr_loc": 1497, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 19},
{"warn_data": {"at_line": 1359, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 20},
{"warn_data": {"at_line": 1378, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data[1] = (insn->n - 2) / 2;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1378, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "data[1] = (insn->n - 2) / 2;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "parse_insn"}, "warn_no": 21},
{"warn_data": {"at_line": 1354, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1354, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async) {"}, {"instr_func": "parse_insn", "instr_loc": 1354, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 22},
{"warn_data": {"at_line": 1364, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 23},
{"warn_data": {"at_line": 1359, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1359, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 24},
{"warn_data": {"at_line": 1364, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2242, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1401, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1364, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 25}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2223, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmdtest_ioctl(dev, &cmd, &copy, file);"}],
"warnings":[{"warn_data": {"at_line": 1875, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->do_cmdtest(dev, s, cmd);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmdtest_ioctl", "instr_loc": 1865, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmdtest_ioctl", "instr_loc": 1865, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmdtest_ioctl", "instr_loc": 1865, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmdtest_ioctl", "instr_loc": 1875, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmdtest(dev, s, cmd);"}, {"instr_func": "do_cmdtest_ioctl", "instr_loc": 1875, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmdtest(dev, s, cmd);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmdtest_ioctl"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2223, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmdtest_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1858, "file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_cmd(dev, cmd);"}],
"warnings":[{"warn_data": {"at_line": 1664, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1664, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1664, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 1678, "warn_str": "Trying to read from a user pointer.", "at": "if (cmd->chanlist_len > s->len_chanlist) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 5},
{"warn_data": {"at_line": 1688, "warn_str": "Trying to read from a user pointer.", "at": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 6},
{"warn_data": {"at_line": 1679, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\",", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2216, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1679, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1679, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 7}]},
{"num_warnings": 14,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}],
"warnings":[{"warn_data": {"at_line": 1762, "warn_str": "Trying to read from a user pointer.", "at": "async = s->async;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1765, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1765, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1765, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1765, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1765, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1765, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1771, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1771, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1771, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1784, "warn_str": "Trying to write to a user pointer.", "at": "async->cmd.data = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1784, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.data = NULL;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1784, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.data = NULL;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1784, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.data = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1791, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->do_cmdtest(dev, s, &async->cmd);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1791, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmdtest(dev, s, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1791, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmdtest(dev, s, &async->cmd);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1793, "warn_str": "Trying to read from a user pointer.", "at": "if (async->cmd.flags & CMDF_BOGUS || ret) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1793, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_BOGUS || ret) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1793, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_BOGUS || ret) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1793, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_BOGUS || ret) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1804, "warn_str": "Trying to read from a user pointer.", "at": "if (!async->prealloc_bufsz) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1804, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!async->prealloc_bufsz) {"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1804, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!async->prealloc_bufsz) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1812, "warn_str": "Trying to write to a user pointer.", "at": "async->cb_mask = COMEDI_CB_BLOCK | COMEDI_CB_CANCEL_MASK;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1812, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask = COMEDI_CB_BLOCK | COMEDI_CB_CANCEL_MASK;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1812, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask = COMEDI_CB_BLOCK | COMEDI_CB_CANCEL_MASK;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 1813, "warn_str": "Trying to read from a user pointer.", "at": "if (async->cmd.flags & CMDF_WAKE_EOS)", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1813, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_WAKE_EOS)"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1813, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_WAKE_EOS)"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1813, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (async->cmd.flags & CMDF_WAKE_EOS)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 1814, "warn_str": "Trying to read from a user pointer.", "at": "async->cb_mask |= COMEDI_CB_EOS;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1814, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask |= COMEDI_CB_EOS;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1814, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask |= COMEDI_CB_EOS;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 1814, "warn_str": "Trying to write to a user pointer.", "at": "async->cb_mask |= COMEDI_CB_EOS;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1814, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask |= COMEDI_CB_EOS;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1814, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cb_mask |= COMEDI_CB_EOS;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 12},
{"warn_data": {"at_line": 1824, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->do_cmd(dev, s);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1824, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmd(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1824, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = s->do_cmd(dev, s);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 13},
{"warn_data": {"at_line": 1823, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = file;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1823, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = file;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1823, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = file;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_cmd_ioctl"}, "warn_no": 14}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1754, "file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_cmd(dev, cmd);"}],
"warnings":[{"warn_data": {"at_line": 1664, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1664, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1664, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 1670, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1670, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 1678, "warn_str": "Trying to read from a user pointer.", "at": "if (cmd->chanlist_len > s->len_chanlist) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 5},
{"warn_data": {"at_line": 1688, "warn_str": "Trying to read from a user pointer.", "at": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 6},
{"warn_data": {"at_line": 1679, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\",", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1662, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1679, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1679, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 7}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1787, "file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}],
"warnings":[{"warn_data": {"at_line": 1713, "warn_str": "Trying to read from a user pointer.", "at": "cmd->chanlist_len * sizeof(unsigned int));", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1706, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1713, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist_len * sizeof(unsigned int));"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1713, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist_len * sizeof(unsigned int));"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_chanlist"}, "warn_no": 1},
{"warn_data": {"at_line": 1711, "warn_str": "Trying to write to a user pointer.", "at": "cmd->chanlist = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1706, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1711, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist = NULL;"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1711, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_chanlist"}, "warn_no": 2},
{"warn_data": {"at_line": 1724, "warn_str": "Trying to write to a user pointer.", "at": "cmd->chanlist = chanlist;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1706, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1724, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist = chanlist;"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1724, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "cmd->chanlist = chanlist;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_chanlist"}, "warn_no": 3},
{"warn_data": {"at_line": 1718, "warn_str": "Trying to read from a user pointer.", "at": "ret = comedi_check_chanlist(s, cmd->chanlist_len, chanlist);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1762, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1787, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_chanlist(dev, s, user_chanlist, &async->cmd);"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1706, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1718, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, cmd->chanlist_len, chanlist);"}, {"instr_func": "__comedi_get_user_chanlist", "instr_loc": 1718, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, cmd->chanlist_len, chanlist);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_chanlist"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1816, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"lineno": 633, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}],
"warnings":[{"warn_data": {"at_line": 617, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 617, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1816, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"lineno": 634, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}],
"warnings":[{"warn_data": {"at_line": 623, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 623, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1816, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_BUSY_MASK,"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1829, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}],
"warnings":[{"warn_data": {"at_line": 734, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 1},
{"warn_data": {"at_line": 748, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 748, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 748, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 2},
{"warn_data": {"at_line": 740, "warn_str": "Trying to write to a user pointer.", "at": "async->inttrig = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 3},
{"warn_data": {"at_line": 741, "warn_str": "Trying to read from a user pointer.", "at": "kfree(async->cmd.chanlist);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 4},
{"warn_data": {"at_line": 742, "warn_str": "Trying to write to a user pointer.", "at": "async->cmd.chanlist = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 5},
{"warn_data": {"at_line": 743, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 743, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 743, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1829, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 737, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 633, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}],
"warnings":[{"warn_data": {"at_line": 617, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 617, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2210, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, &cmd, &copy, file);"}, {"lineno": 1829, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 737, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 634, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}],
"warnings":[{"warn_data": {"at_line": 623, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 623, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2203, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_cmd cmd;"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1761, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_cmd_ioctl", "instr_loc": 1829, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 1115, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&bi, arg, sizeof(bi)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1123, "warn_str": "Trying to read from a user pointer.", "at": "async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1125, "warn_str": "Trying to read from a user pointer.", "at": "if (!async || s->busy != file)", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1125, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!async || s->busy != file)"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1125, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!async || s->busy != file)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1129, "warn_str": "Trying to read from a user pointer.", "at": "if (!(async->cmd.flags & CMDF_WRITE)) {", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1129, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1129, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1129, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1164, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_write_count = async->buf_write_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1164, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_write_count = async->buf_write_count;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1164, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_write_count = async->buf_write_count;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1165, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_write_ptr = async->buf_write_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1165, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_write_ptr = async->buf_write_ptr;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1165, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_write_ptr = async->buf_write_ptr;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1166, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_read_count = async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1166, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_read_count = async->buf_read_count;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1166, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_read_count = async->buf_read_count;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1167, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_read_ptr = async->buf_read_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1123, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1167, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_read_ptr = async->buf_read_ptr;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1167, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bi.buf_read_ptr = async->buf_read_ptr;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1175, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &bi, sizeof(bi)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 9}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1128, "file": "drivers/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"lineno": 649, "file": "drivers/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}],
"warnings":[{"warn_data": {"at_line": 640, "warn_str": "Trying to read from a user pointer.", "at": "return s->runflags;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1128, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1128, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 644, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 649, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 649, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 639, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 640, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "return s->runflags;"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 640, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "return s->runflags;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_subdevice_runflags"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1170, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}],
"warnings":[{"warn_data": {"at_line": 734, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 1},
{"warn_data": {"at_line": 748, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 748, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 748, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 2},
{"warn_data": {"at_line": 740, "warn_str": "Trying to write to a user pointer.", "at": "async->inttrig = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 3},
{"warn_data": {"at_line": 741, "warn_str": "Trying to read from a user pointer.", "at": "kfree(async->cmd.chanlist);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 4},
{"warn_data": {"at_line": 742, "warn_str": "Trying to write to a user pointer.", "at": "async->cmd.chanlist = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 734, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 742, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 5},
{"warn_data": {"at_line": 743, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 743, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 743, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1170, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 737, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 633, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}],
"warnings":[{"warn_data": {"at_line": 617, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 617, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 633, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 616, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 617, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2189, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1170, "file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 737, "file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 634, "file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}],
"warnings":[{"warn_data": {"at_line": 623, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 623, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1115, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1121, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1170, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 733, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 629, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 634, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 622, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 623, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2176, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_chaninfo_ioctl(dev, &it);"}],
"warnings":[{"warn_data": {"at_line": 1063, "warn_str": "Trying to read from a user pointer.", "at": "if (s->maxdata || !s->maxdata_list)", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1063, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1063, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1063, "warn_str": "Trying to read from a user pointer.", "at": "if (s->maxdata || !s->maxdata_list)", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1063, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1063, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1065, "warn_str": "Trying to read from a user pointer.", "at": "if (copy_to_user(it->maxdata_list, s->maxdata_list,", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1065, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_to_user(it->maxdata_list, s->maxdata_list,"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1065, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_to_user(it->maxdata_list, s->maxdata_list,"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1066, "warn_str": "Trying to read from a user pointer.", "at": "s->n_chan * sizeof(unsigned int)))", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1066, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->n_chan * sizeof(unsigned int)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1066, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s->n_chan * sizeof(unsigned int)))"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1076, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->range_table_list)", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1076, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->range_table_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1076, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (!s->range_table_list)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1065, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(it->maxdata_list, s->maxdata_list,", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1082, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1082, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1082, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1082, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 1078, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < s->n_chan; i++) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1078, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1078, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 1078, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < s->n_chan; i++) {", "inst_trace": [{"instr_func": "comedi_unlocked_ioctl", "instr_loc": 2171, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_chaninfo it;"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1060, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it->subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1078, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1078, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1078, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 11}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2166, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_subdinfo_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 1030, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = copy_to_user(arg, tmp, dev->n_subdevices * sizeof(*tmp));", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_subdinfo_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2162, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_devinfo_ioctl(dev, (struct comedi_devinfo __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 957, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &devinfo, sizeof(devinfo)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_devinfo_ioctl"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2158, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 883, "warn_str": "Trying to read from a user pointer.", "at": "async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 876, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&bc, arg, sizeof(bc)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 897, "warn_str": "Trying to write to a user pointer.", "at": "async->max_bufsize = bc.maximum_size;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 897, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->max_bufsize = bc.maximum_size;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 897, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async->max_bufsize = bc.maximum_size;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 906, "warn_str": "Trying to read from a user pointer.", "at": "bc.size = async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 906, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bc.size = async->prealloc_bufsz;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 906, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bc.size = async->prealloc_bufsz;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 907, "warn_str": "Trying to read from a user pointer.", "at": "bc.maximum_size = async->max_bufsize;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 883, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 907, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bc.maximum_size = async->max_bufsize;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 907, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "bc.maximum_size = async->max_bufsize;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 909, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "copyback:", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2131, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_devconfig_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 835, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&it, arg, sizeof(it)))", "inst_trace": [], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_devconfig_ioctl"}, "warn_no": 1}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2158, "file": "drivers/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 901, "file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}],
"warnings":[{"warn_data": {"at_line": 341, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 1},
{"warn_data": {"at_line": 346, "warn_str": "Trying to read from a user pointer.", "at": "if (new_size > async->max_bufsize)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 346, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (new_size > async->max_bufsize)"}, {"instr_func": "resize_async_buffer", "instr_loc": 346, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (new_size > async->max_bufsize)"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 2},
{"warn_data": {"at_line": 349, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 349, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 349, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 3},
{"warn_data": {"at_line": 361, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "resize_async_buffer"}, "warn_no": 4},
{"warn_data": {"at_line": 361, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "resize_async_buffer"}, "warn_no": 5},
{"warn_data": {"at_line": 367, "warn_str": "Trying to read from a user pointer.", "at": "if (s->buf_change) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 367, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->buf_change) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 367, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (s->buf_change) {"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 6},
{"warn_data": {"at_line": 368, "warn_str": "Trying to read from a user pointer.", "at": "retval = s->buf_change(dev, s);", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 368, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = s->buf_change(dev, s);"}, {"instr_func": "resize_async_buffer", "instr_loc": 368, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = s->buf_change(dev, s);"}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 7},
{"warn_data": {"at_line": 373, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\",", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 373, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}, {"instr_func": "resize_async_buffer", "instr_loc": 373, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 8},
{"warn_data": {"at_line": 373, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\",", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 876, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 882, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 901, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 340, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 341, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 373, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}, {"instr_func": "resize_async_buffer", "instr_loc": 373, "instr_file": "drivers/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}], "at_file": "drivers/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 9}]}]}