{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}],
"warnings":[{"warn_data": {"at_line": 189, "warn_str": "Trying to use a global variable without locking.", "at": "gru_dbg(grudev, \"file %p, req 0x%x, 0x%lx\\n\", file, req, arg);", "inst_trace": [{"instr_func": "gru_file_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gru_file_unlocked_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 217, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_get_config_info(arg);"}],
"warnings":[{"warn_data": {"at_line": 171, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "info.blades = info.nodes / nodesperblade;", "inst_trace": [], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "TaintedSizeDetector says:", "at_func": "gru_get_config_info"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 217, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_get_config_info(arg);"}, {"lineno": 163, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "if (num_online_nodes() > 1 &&"}],
"warnings":[{"warn_data": {"at_line": 431, "warn_str": "Trying to use a global variable without locking.", "at": "  %5 = getelementptr [6 x %struct.nodemask_t], [6 x %struct.nodemask_t]* @node_states, i64 0, i64 %4, !dbg !7198", "inst_trace": [{"instr_func": "gru_file_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "gru_file_unlocked_ioctl", "instr_loc": 217, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_get_config_info(arg);"}, {"instr_func": "gru_get_config_info", "instr_loc": 163, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "if (num_online_nodes() > 1 &&"}], "at_file": "./include/linux/nodemask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "num_node_state"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 217, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_get_config_info(arg);"}, {"lineno": 169, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "info.cpus = num_online_cpus();"}],
"warnings":[{"warn_data": {"at_line": 886, "warn_str": "Trying to use a global variable without locking.", "at": "  store %struct.atomic_t* @__num_online_cpus, %struct.atomic_t** %4, align 8", "inst_trace": [{"instr_func": "gru_file_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "gru_file_unlocked_ioctl", "instr_loc": 217, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_get_config_info(arg);"}, {"instr_func": "gru_get_config_info", "instr_loc": 169, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "info.cpus = num_online_cpus();"}], "at_file": "./include/linux/cpumask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "num_online_cpus"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 193, "file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_create_new_context(arg);"}],
"warnings":[{"warn_data": {"at_line": 131, "warn_str": "Trying to use a global variable without locking.", "at": "if (req.data_segment_bytes > max_user_dsr_bytes)", "inst_trace": [{"instr_func": "gru_file_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "gru_file_unlocked_ioctl", "instr_loc": 193, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "err = gru_create_new_context(arg);"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 1},
{"warn_data": {"at_line": 122, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "TaintedSizeDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 2},
{"warn_data": {"at_line": 145, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "GRU_DS_BYTES_TO_AU(req.data_segment_bytes);", "inst_trace": [{"instr_func": "gru_create_new_context", "instr_loc": 122, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "{"}, {"instr_func": "gru_create_new_context", "instr_loc": 145, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "GRU_DS_BYTES_TO_AU(req.data_segment_bytes);"}, {"instr_func": "gru_create_new_context", "instr_loc": 145, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "GRU_DS_BYTES_TO_AU(req.data_segment_bytes);"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "IntegerOverflowDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 3},
{"warn_data": {"at_line": 145, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "GRU_DS_BYTES_TO_AU(req.data_segment_bytes);", "inst_trace": [{"instr_func": "gru_create_new_context", "instr_loc": 122, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "{"}, {"instr_func": "gru_create_new_context", "instr_loc": 145, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "GRU_DS_BYTES_TO_AU(req.data_segment_bytes);"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "IntegerOverflowDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 4},
{"warn_data": {"at_line": 146, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "vdata->vd_cbr_au_count = GRU_CB_COUNT_TO_AU(req.control_blocks);", "inst_trace": [{"instr_func": "gru_create_new_context", "instr_loc": 122, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "{"}, {"instr_func": "gru_create_new_context", "instr_loc": 146, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "vdata->vd_cbr_au_count = GRU_CB_COUNT_TO_AU(req.control_blocks);"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "IntegerOverflowDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 5},
{"warn_data": {"at_line": 146, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "vdata->vd_cbr_au_count = GRU_CB_COUNT_TO_AU(req.control_blocks);", "inst_trace": [{"instr_func": "gru_create_new_context", "instr_loc": 122, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "{"}, {"instr_func": "gru_create_new_context", "instr_loc": 146, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "vdata->vd_cbr_au_count = GRU_CB_COUNT_TO_AU(req.control_blocks);"}, {"instr_func": "gru_create_new_context", "instr_loc": 146, "instr_file": "drivers/misc/sgi-gru/grufile.c", "instr": "vdata->vd_cbr_au_count = GRU_CB_COUNT_TO_AU(req.control_blocks);"}], "at_file": "drivers/misc/sgi-gru/grufile.c", "by": "IntegerOverflowDetector says:", "at_func": "gru_create_new_context"}, "warn_no": 6}]}]}