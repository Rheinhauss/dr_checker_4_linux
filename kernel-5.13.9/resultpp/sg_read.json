{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 535, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(buf, old_hdr, SZ_SG_HEADER)) {", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_read"}, "warn_no": 1},
{"warn_data": {"at_line": 461, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(3, sg_printk(KERN_INFO, sdp,", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_read"}, "warn_no": 2},
{"warn_data": {"at_line": 543, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 442, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_read"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 455, "file": "drivers/scsi/sg.c", "instr": "retval = sg_check_file_access(filp, __func__);"}],
"warnings":[{"warn_data": {"at_line": 223, "warn_str": "Trying to use a global variable without locking.", "at": "pr_err_once(\"%s: process %d (%s) changed security contexts after opening file descriptor, this is not allowed.\\n\",", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 455, "instr_file": "drivers/scsi/sg.c", "instr": "retval = sg_check_file_access(filp, __func__);"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_check_file_access"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 488, "file": "drivers/scsi/sg.c", "instr": "old_hdr = kzalloc(SZ_SG_HEADER, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !7218", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 488, "instr_file": "drivers/scsi/sg.c", "instr": "old_hdr = kzalloc(SZ_SG_HEADER, GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 543, "file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}],
"warnings":[{"warn_data": {"at_line": 1995, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 1},
{"warn_data": {"at_line": 2012, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num_read_xfer -= num;", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 442, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read_oxfer", "instr_loc": 1991, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read_oxfer", "instr_loc": 2012, "instr_file": "drivers/scsi/sg.c", "instr": "num_read_xfer -= num;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 2},
{"warn_data": {"at_line": 2013, "warn_str": "Loop is bounded by a tainted value.", "at": "if (num_read_xfer <= 0)", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 442, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read_oxfer", "instr_loc": 1991, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read_oxfer", "instr_loc": 2013, "instr_file": "drivers/scsi/sg.c", "instr": "if (num_read_xfer <= 0)"}, {"instr_func": "sg_read_oxfer", "instr_loc": 2013, "instr_file": "drivers/scsi/sg.c", "instr": "if (num_read_xfer <= 0)"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 3},
{"warn_data": {"at_line": 2003, "warn_str": "Loop is bounded by a tainted value.", "at": "if (num > num_read_xfer) {", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 442, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read", "instr_loc": 543, "instr_file": "drivers/scsi/sg.c", "instr": "if (sg_read_oxfer(srp, buf, count - SZ_SG_HEADER)) {"}, {"instr_func": "sg_read_oxfer", "instr_loc": 1991, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_read_oxfer", "instr_loc": 2003, "instr_file": "drivers/scsi/sg.c", "instr": "if (num > num_read_xfer) {"}, {"instr_func": "sg_read_oxfer", "instr_loc": 2003, "instr_file": "drivers/scsi/sg.c", "instr": "if (num > num_read_xfer) {"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 4},
{"warn_data": {"at_line": 2009, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(outp, page_address(schp->pages[k]),", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 5},
{"warn_data": {"at_line": 2004, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(outp, page_address(schp->pages[k]),", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_read_oxfer"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 550, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}],
"warnings":[{"warn_data": {"at_line": 1856, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 550, "instr_file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_finish_rem_req"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 550, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1870, "file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}],
"warnings":[{"warn_data": {"at_line": 1969, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 550, "instr_file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1870, "instr_file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_remove_scat"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 550, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1868, "file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}],
"warnings":[{"warn_data": {"at_line": 2076, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "sg_read", "instr_loc": 550, "instr_file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1868, "instr_file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_unlink_reserve"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 485, "file": "drivers/scsi/sg.c", "instr": "return sg_new_read(sfp, buf, count, srp);"}],
"warnings":[{"warn_data": {"at_line": 581, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "len = (len > sb_len) ? sb_len : len;", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_new_read"}, "warn_no": 1}]}]}