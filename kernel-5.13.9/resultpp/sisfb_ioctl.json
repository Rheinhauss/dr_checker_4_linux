{"all_contexts":[
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1839, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if(copy_from_user(&ivideo->sisfb_command, (void __user *)arg,", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1777, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ivideo->sisfb_infoblock.sisfb_heapsize = ivideo->sisfb_heap_size / 1024;", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1843, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sisfb_handle_command(ivideo, &ivideo->sisfb_command);", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1725, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "memset(&sisvbblank, 0, sizeof(struct fb_vblank));", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1702, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1705, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sis_malloc(&sismemreq);", "inst_trace": [], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedSizeDetector says:", "at_func": "sisfb_ioctl"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1843, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_handle_command(ivideo, &ivideo->sisfb_command);"}, {"lineno": 3964, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(sisfb_reset_mode(ivideo)) {"}, {"lineno": 3920, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(sisfb_set_mode(ivideo, 0))"}, {"lineno": 1201, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_pre_setmode(ivideo);"}],
"warnings":[{"warn_data": {"at_line": 3650, "warn_str": "Trying to use a global variable without locking.", "at": "cr33 |= (sisbios_mode[ivideo->sisfb_mode_idx].rate_idx << 4);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1843, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_handle_command(ivideo, &ivideo->sisfb_command);"}, {"instr_func": "sisfb_handle_command", "instr_loc": 3964, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(sisfb_reset_mode(ivideo)) {"}, {"instr_func": "sisfb_reset_mode", "instr_loc": 3920, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(sisfb_set_mode(ivideo, 0))"}, {"instr_func": "sisfb_set_mode", "instr_loc": 1201, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_pre_setmode(ivideo);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sisfb_pre_setmode"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1720, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free(gpu32);"}],
"warnings":[{"warn_data": {"at_line": 3470, "warn_str": "Trying to use a global variable without locking.", "at": "struct sis_video_info *ivideo = sisfb_heap->vinfo;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1720, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free(gpu32);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sis_free"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1705, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_malloc(&sismemreq);"}],
"warnings":[{"warn_data": {"at_line": 3433, "warn_str": "Trying to use a global variable without locking.", "at": "struct sis_video_info *ivideo = sisfb_heap->vinfo;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1705, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_malloc(&sismemreq);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sis_malloc"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1705, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_malloc(&sismemreq);"}, {"lineno": 3436, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_malloc(ivideo, req);"}, {"lineno": 3417, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}],
"warnings":[{"warn_data": {"at_line": 3276, "warn_str": "Loop is bounded by a tainted value.", "at": "if(size <= pohThis->size) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3262, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3276, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(size <= pohThis->size) {"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3276, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(size <= pohThis->size) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sisfb_poh_allocate"}, "warn_no": 1},
{"warn_data": {"at_line": 3301, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pohThis->size -= size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3262, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3301, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis->size -= size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_allocate"}, "warn_no": 2},
{"warn_data": {"at_line": 3300, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pohThis->offset += size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3262, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3300, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis->offset += size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_allocate"}, "warn_no": 3},
{"warn_data": {"at_line": 3304, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "memheap->max_freesize -= size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3262, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3304, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "memheap->max_freesize -= size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_allocate"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1705, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_malloc(&sismemreq);"}, {"lineno": 3436, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_malloc(ivideo, req);"}, {"lineno": 3417, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"lineno": 3293, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohRoot = sisfb_poh_new_node(memheap);"}],
"warnings":[{"warn_data": {"at_line": 3234, "warn_str": "Trying to use a global variable without locking.", "at": "if(memheap->poh_freelist == NULL) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1705, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_malloc(&sismemreq);"}, {"instr_func": "sis_malloc", "instr_loc": 3436, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_malloc(ivideo, req);"}, {"instr_func": "sis_int_malloc", "instr_loc": 3417, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_allocate(&ivideo->sisfb_heap, (u32)req->size);"}, {"instr_func": "sisfb_poh_allocate", "instr_loc": 3293, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohRoot = sisfb_poh_new_node(memheap);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sisfb_poh_new_node"}, "warn_no": 1}]},
{"num_warnings": 19,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1708, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free((u32)sismemreq.offset);"}, {"lineno": 3472, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_free(ivideo, base);"}, {"lineno": 3459, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_free(&ivideo->sisfb_heap, base);"}],
"warnings":[{"warn_data": {"at_line": 3345, "warn_str": "Loop is bounded by a tainted value.", "at": "if(poh_freed->offset == base) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1708, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free((u32)sismemreq.offset);"}, {"instr_func": "sisfb_ioctl", "instr_loc": 1708, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free((u32)sismemreq.offset);"}, {"instr_func": "sis_free", "instr_loc": 3469, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sis_free", "instr_loc": 3472, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_free(ivideo, base);"}, {"instr_func": "sis_free", "instr_loc": 3472, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_free(ivideo, base);"}, {"instr_func": "sis_int_free", "instr_loc": 3453, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sis_int_free", "instr_loc": 3459, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_free(&ivideo->sisfb_heap, base);"}, {"instr_func": "sis_int_free", "instr_loc": 3459, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_free(&ivideo->sisfb_heap, base);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3333, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3345, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(poh_freed->offset == base) {"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3345, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(poh_freed->offset == base) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 1},
{"warn_data": {"at_line": 3367, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "} else if((pohThis->offset + pohThis->size) == ulLower) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3367, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "} else if((pohThis->offset + pohThis->size) == ulLower) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 2},
{"warn_data": {"at_line": 3365, "warn_str": "Trying to read from a user pointer.", "at": "if(pohThis->offset == ulUpper) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3365, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(pohThis->offset == ulUpper) {"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3365, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(pohThis->offset == ulUpper) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 3},
{"warn_data": {"at_line": 3364, "warn_str": "Loop is bounded by a tainted value.", "at": "while(pohThis != &memheap->oh_free) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3364, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "while(pohThis != &memheap->oh_free) {"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3364, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "while(pohThis != &memheap->oh_free) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 4},
{"warn_data": {"at_line": 3367, "warn_str": "Trying to read from a user pointer.", "at": "} else if((pohThis->offset + pohThis->size) == ulLower) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3367, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "} else if((pohThis->offset + pohThis->size) == ulLower) {"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3367, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "} else if((pohThis->offset + pohThis->size) == ulLower) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 5},
{"warn_data": {"at_line": 3367, "warn_str": "Trying to read from a user pointer.", "at": "} else if((pohThis->offset + pohThis->size) == ulLower) {", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3367, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "} else if((pohThis->offset + pohThis->size) == ulLower) {"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3367, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "} else if((pohThis->offset + pohThis->size) == ulLower) {"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 6},
{"warn_data": {"at_line": 3370, "warn_str": "Trying to read from a user pointer.", "at": "pohThis = pohThis->poh_next;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 7},
{"warn_data": {"at_line": 3390, "warn_str": "Trying to read from a user pointer.", "at": "poh_next->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 8},
{"warn_data": {"at_line": 3390, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "poh_next->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 9},
{"warn_data": {"at_line": 3390, "warn_str": "Trying to write to a user pointer.", "at": "poh_next->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3390, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 10},
{"warn_data": {"at_line": 3391, "warn_str": "Trying to write to a user pointer.", "at": "poh_next->offset = poh_freed->offset;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3391, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->offset = poh_freed->offset;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3391, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next->offset = poh_freed->offset;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 11},
{"warn_data": {"at_line": 3384, "warn_str": "Trying to read from a user pointer.", "at": "poh_prev->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 12},
{"warn_data": {"at_line": 3384, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "poh_prev->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 13},
{"warn_data": {"at_line": 3384, "warn_str": "Trying to write to a user pointer.", "at": "poh_prev->size += poh_freed->size;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3384, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += poh_freed->size;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 14},
{"warn_data": {"at_line": 3376, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "poh_prev->size += (poh_freed->size + poh_next->size);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 15},
{"warn_data": {"at_line": 3376, "warn_str": "Trying to read from a user pointer.", "at": "poh_prev->size += (poh_freed->size + poh_next->size);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 16},
{"warn_data": {"at_line": 3376, "warn_str": "Trying to read from a user pointer.", "at": "poh_prev->size += (poh_freed->size + poh_next->size);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 17},
{"warn_data": {"at_line": 3376, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "poh_prev->size += (poh_freed->size + poh_next->size);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "IntegerOverflowDetector says:", "at_func": "sisfb_poh_free"}, "warn_no": 18},
{"warn_data": {"at_line": 3376, "warn_str": "Trying to write to a user pointer.", "at": "poh_prev->size += (poh_freed->size + poh_next->size);", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3368, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3376, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_prev->size += (poh_freed->size + poh_next->size);"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_poh_free"}, "warn_no": 19}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1708, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free((u32)sismemreq.offset);"}, {"lineno": 3472, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_free(ivideo, base);"}, {"lineno": 3459, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_free(&ivideo->sisfb_heap, base);"}, {"lineno": 3377, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}],
"warnings":[{"warn_data": {"at_line": 3315, "warn_str": "Trying to read from a user pointer.", "at": "poh->poh_prev->poh_next = poh->poh_next;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 1},
{"warn_data": {"at_line": 3315, "warn_str": "Trying to read from a user pointer.", "at": "poh->poh_prev->poh_next = poh->poh_next;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 2},
{"warn_data": {"at_line": 3315, "warn_str": "Trying to write to a user pointer.", "at": "poh->poh_prev->poh_next = poh->poh_next;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 3},
{"warn_data": {"at_line": 3316, "warn_str": "Trying to read from a user pointer.", "at": "poh->poh_next->poh_prev = poh->poh_prev;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 4},
{"warn_data": {"at_line": 3316, "warn_str": "Trying to read from a user pointer.", "at": "poh->poh_next->poh_prev = poh->poh_prev;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 5},
{"warn_data": {"at_line": 3316, "warn_str": "Trying to write to a user pointer.", "at": "poh->poh_next->poh_prev = poh->poh_prev;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3377, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_delete_node(poh_next);"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3314, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3315, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_prev->poh_next = poh->poh_next;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}, {"instr_func": "sisfb_delete_node", "instr_loc": 3316, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next->poh_prev = poh->poh_prev;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_delete_node"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1708, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_free((u32)sismemreq.offset);"}, {"lineno": 3472, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sis_int_free(ivideo, base);"}, {"lineno": 3459, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh = sisfb_poh_free(&ivideo->sisfb_heap, base);"}, {"lineno": 3379, "file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_free_node(memheap, poh_next);"}],
"warnings":[{"warn_data": {"at_line": 3407, "warn_str": "Trying to write to a user pointer.", "at": "poh->poh_next = memheap->poh_freelist;", "inst_trace": [{"instr_func": "sisfb_ioctl", "instr_loc": 1702, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "if(copy_from_user(&sismemreq, (void __user *)arg, sizeof(sismemreq)))"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3370, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "pohThis = pohThis->poh_next;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3366, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh_next = pohThis;"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3379, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_free_node(memheap, poh_next);"}, {"instr_func": "sisfb_poh_free", "instr_loc": 3379, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "sisfb_free_node(memheap, poh_next);"}, {"instr_func": "sisfb_free_node", "instr_loc": 3403, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "{"}, {"instr_func": "sisfb_free_node", "instr_loc": 3407, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next = memheap->poh_freelist;"}, {"instr_func": "sisfb_free_node", "instr_loc": 3407, "instr_file": "drivers/video/fbdev/sis/sis_main.c", "instr": "poh->poh_next = memheap->poh_freelist;"}], "at_file": "drivers/video/fbdev/sis/sis_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sisfb_free_node"}, "warn_no": 1}]}]}