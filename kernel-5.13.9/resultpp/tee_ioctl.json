{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 839, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_send(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 787, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&buf, ubuf, sizeof(buf)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_supp_send"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 839, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_send(ctx, uarg);"}, {"lineno": 802, "file": "drivers/tee/tee_core.c", "instr": "params = kcalloc(num_params, sizeof(struct tee_param), GFP_KERNEL);"}, {"lineno": 625, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #14, !dbg !5189"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %278 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %277, !dbg !5471", "inst_trace": [{"instr_func": "tee_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "tee_ioctl", "instr_loc": 839, "instr_file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_send(ctx, uarg);"}, {"instr_func": "tee_ioctl_supp_send", "instr_loc": 802, "instr_file": "drivers/tee/tee_core.c", "instr": "params = kcalloc(num_params, sizeof(struct tee_param), GFP_KERNEL);"}, {"instr_func": "kcalloc", "instr_loc": 625, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #14, !dbg !5189"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 839, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_send(ctx, uarg);"}, {"lineno": 806, "file": "drivers/tee/tee_core.c", "instr": "rc = params_from_supp(params, num_params, uarg->params);"}],
"warnings":[{"warn_data": {"at_line": 733, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct tee_param *p = params + n;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "params_from_supp"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 837, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_recv(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 689, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&buf, ubuf, sizeof(buf)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_supp_recv"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 837, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_recv(ctx, uarg);"}, {"lineno": 707, "file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, num_params, uarg->params);"}],
"warnings":[{"warn_data": {"at_line": 362, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct tee_shm *shm;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "params_from_user"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 837, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_supp_recv(ctx, uarg);"}, {"lineno": 721, "file": "drivers/tee/tee_core.c", "instr": "rc = params_to_supp(ctx, uarg->params, num_params, params);"}],
"warnings":[{"warn_data": {"at_line": 669, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uparams + n, &ip, sizeof(ip)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "params_to_supp"}, "warn_no": 1},
{"warn_data": {"leaked_struct": "  %24 = alloca %struct.tee_ioctl_param, align 8", "at_line": 669, "warn_str": "Potentially leaking memory on kernel stack (via padded fields) into user space", "at": "if (copy_to_user(uparams + n, &ip, sizeof(ip)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "KernelUninitMemoryLeakDetector says:", "at_func": "params_to_supp"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 835, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_close_session(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&arg, uarg, sizeof(arg)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_close_session"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 833, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_cancel(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 610, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&arg, uarg, sizeof(arg)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_cancel"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 831, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_invoke(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 555, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&buf, ubuf, sizeof(buf)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_invoke"}, "warn_no": 1},
{"warn_data": {"at_line": 566, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)", "inst_trace": [{"instr_func": "tee_ioctl_invoke", "instr_loc": 562, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 566, "instr_file": "drivers/tee/tee_core.c", "instr": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 566, "instr_file": "drivers/tee/tee_core.c", "instr": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)"}], "at_file": "drivers/tee/tee_core.c", "by": "IntegerOverflowDetector says:", "at_func": "tee_ioctl_invoke"}, "warn_no": 2},
{"warn_data": {"at_line": 562, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "uarg = u64_to_user_ptr(buf.buf_ptr);", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_invoke"}, "warn_no": 3},
{"warn_data": {"at_line": 593, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < arg.num_params; n++)", "inst_trace": [{"instr_func": "tee_ioctl_invoke", "instr_loc": 562, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 593, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < arg.num_params; n++)"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 593, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < arg.num_params; n++)"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "tee_ioctl_invoke"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 831, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_invoke(ctx, uarg);"}, {"lineno": 575, "file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}],
"warnings":[{"warn_data": {"at_line": 361, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < num_params; n++) {", "inst_trace": [{"instr_func": "tee_ioctl_invoke", "instr_loc": 562, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 575, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 575, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}, {"instr_func": "params_from_user", "instr_loc": 358, "instr_file": "drivers/tee/tee_core.c", "instr": "{"}, {"instr_func": "params_from_user", "instr_loc": 361, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}, {"instr_func": "params_from_user", "instr_loc": 361, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "params_from_user"}, "warn_no": 1},
{"warn_data": {"at_line": 362, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct tee_shm *shm;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "params_from_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 831, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_invoke(ctx, uarg);"}, {"lineno": 589, "file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}],
"warnings":[{"warn_data": {"at_line": 439, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < num_params; n++) {", "inst_trace": [{"instr_func": "tee_ioctl_invoke", "instr_loc": 562, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 589, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}, {"instr_func": "tee_ioctl_invoke", "instr_loc": 589, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}, {"instr_func": "params_to_user", "instr_loc": 436, "instr_file": "drivers/tee/tee_core.c", "instr": "{"}, {"instr_func": "params_to_user", "instr_loc": 439, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}, {"instr_func": "params_to_user", "instr_loc": 439, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "params_to_user"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 829, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_open_session(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 477, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&buf, ubuf, sizeof(buf)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_open_session"}, "warn_no": 1},
{"warn_data": {"at_line": 484, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "uarg = u64_to_user_ptr(buf.buf_ptr);", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_open_session"}, "warn_no": 2},
{"warn_data": {"at_line": 488, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)", "inst_trace": [{"instr_func": "tee_ioctl_open_session", "instr_loc": 484, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 488, "instr_file": "drivers/tee/tee_core.c", "instr": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 488, "instr_file": "drivers/tee/tee_core.c", "instr": "if (sizeof(arg) + TEE_IOCTL_PARAM_SIZE(arg.num_params) != buf.buf_len)"}], "at_file": "drivers/tee/tee_core.c", "by": "IntegerOverflowDetector says:", "at_func": "tee_ioctl_open_session"}, "warn_no": 3},
{"warn_data": {"at_line": 531, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < arg.num_params; n++)", "inst_trace": [{"instr_func": "tee_ioctl_open_session", "instr_loc": 484, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 531, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < arg.num_params; n++)"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 531, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < arg.num_params; n++)"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "tee_ioctl_open_session"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 829, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_open_session(ctx, uarg);"}, {"lineno": 497, "file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}],
"warnings":[{"warn_data": {"at_line": 361, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < num_params; n++) {", "inst_trace": [{"instr_func": "tee_ioctl_open_session", "instr_loc": 484, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 497, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 497, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_from_user(ctx, params, arg.num_params, uparams);"}, {"instr_func": "params_from_user", "instr_loc": 358, "instr_file": "drivers/tee/tee_core.c", "instr": "{"}, {"instr_func": "params_from_user", "instr_loc": 361, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}, {"instr_func": "params_from_user", "instr_loc": 361, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "params_from_user"}, "warn_no": 1},
{"warn_data": {"at_line": 362, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct tee_shm *shm;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "params_from_user"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 829, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_open_session(ctx, uarg);"}, {"lineno": 520, "file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}],
"warnings":[{"warn_data": {"at_line": 439, "warn_str": "Loop is bounded by a tainted value.", "at": "for (n = 0; n < num_params; n++) {", "inst_trace": [{"instr_func": "tee_ioctl_open_session", "instr_loc": 484, "instr_file": "drivers/tee/tee_core.c", "instr": "uarg = u64_to_user_ptr(buf.buf_ptr);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 520, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}, {"instr_func": "tee_ioctl_open_session", "instr_loc": 520, "instr_file": "drivers/tee/tee_core.c", "instr": "rc = params_to_user(uparams, arg.num_params, params);"}, {"instr_func": "params_to_user", "instr_loc": 436, "instr_file": "drivers/tee/tee_core.c", "instr": "{"}, {"instr_func": "params_to_user", "instr_loc": 439, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}, {"instr_func": "params_to_user", "instr_loc": 439, "instr_file": "drivers/tee/tee_core.c", "instr": "for (n = 0; n < num_params; n++) {"}], "at_file": "drivers/tee/tee_core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "params_to_user"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 827, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_shm_register(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 321, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_shm_register"}, "warn_no": 1},
{"warn_data": {"at_line": 338, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "data.id = shm->id;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_shm_register"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 825, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_shm_alloc(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 284, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_shm_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 300, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "data.id = shm->id;", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_shm_alloc"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 823, "file": "drivers/tee/tee_core.c", "instr": "return tee_ioctl_version(ctx, uarg);"}],
"warnings":[{"warn_data": {"at_line": 276, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uvers, &vers, sizeof(vers)))", "inst_trace": [], "at_file": "drivers/tee/tee_core.c", "by": "TaintedSizeDetector says:", "at_func": "tee_ioctl_version"}, "warn_no": 1}]}]}