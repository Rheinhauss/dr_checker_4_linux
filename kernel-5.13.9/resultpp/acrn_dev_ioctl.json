{"all_contexts":[
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}],
"warnings":[{"warn_data": {"at_line": 323, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&notify, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 353, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&irqfd, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 343, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ioeventfd, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 336, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&cstate_cmd, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 295, "warn_str": "Trying to use a global variable without locking.", "at": "ret = hcall_vm_intr_monitor(vm->vmid, page_to_phys(page));", "inst_trace": [{"instr_func": "acrn_dev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}], "at_file": "drivers/virt/acrn/hsm.c", "by": "GlobalVariableRaceDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 214, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&memmap, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 207, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&memmap, (void __user *)ioctl_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 147, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)ioctl_param, vm_param,", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "acrn_dev_ioctl"}, "warn_no": 8}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 340, "file": "drivers/virt/acrn/hsm.c", "instr": "ret = pmcmd_ioctl(cstate_cmd, (void __user *)ioctl_param);"}],
"warnings":[{"warn_data": {"at_line": 49, "warn_str": "Trying to use a global variable without locking.", "at": "switch (cmd & PMCMD_TYPE_MASK) {", "inst_trace": [{"instr_func": "acrn_dev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "acrn_dev_ioctl", "instr_loc": 340, "instr_file": "drivers/virt/acrn/hsm.c", "instr": "ret = pmcmd_ioctl(cstate_cmd, (void __user *)ioctl_param);"}], "at_file": "drivers/virt/acrn/hsm.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pmcmd_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 92, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uptr, cx_data, sizeof(*cx_data)))", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "pmcmd_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 77, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uptr, px_data, sizeof(*px_data)))", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "pmcmd_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 62, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(uptr, pm_info, sizeof(u64)))", "inst_trace": [], "at_file": "drivers/virt/acrn/hsm.c", "by": "TaintedSizeDetector says:", "at_func": "pmcmd_ioctl"}, "warn_no": 4}]}]}