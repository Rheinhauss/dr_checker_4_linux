{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 714, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_reset_system(arg);"}],
"warnings":[{"warn_data": {"at_line": 536, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_reset_system"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 711, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}],
"warnings":[{"warn_data": {"at_line": 613, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "capsules = kcalloc(qcaps.capsule_count + 1,", "inst_trace": [{"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 596, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 613, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "IntegerOverflowDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 1},
{"warn_data": {"at_line": 596, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 2},
{"warn_data": {"at_line": 618, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < qcaps.capsule_count; i++) {", "inst_trace": [{"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 596, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 618, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "for (i = 0; i < qcaps.capsule_count; i++) {"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 618, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "for (i = 0; i < qcaps.capsule_count; i++) {"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedLoopBoundDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 3},
{"warn_data": {"at_line": 629, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&capsules[i], c,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 711, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}, {"lineno": 613, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}, {"lineno": 625, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #14, !dbg !5032"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %278 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %277, !dbg !5314", "inst_trace": [{"instr_func": "efi_test_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "efi_test_ioctl", "instr_loc": 711, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 613, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}, {"instr_func": "kcalloc", "instr_loc": 625, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #14, !dbg !5032"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 708, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_variableinfo(arg);"}],
"warnings":[{"warn_data": {"at_line": 560, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_variableinfo"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 705, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nexthighmonocount(arg);"}],
"warnings":[{"warn_data": {"at_line": 505, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nexthighmonocount"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 702, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}],
"warnings":[{"warn_data": {"at_line": 494, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getnextvariablename.vendor_guid, vd,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 1},
{"warn_data": {"at_line": 404, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 2},
{"warn_data": {"at_line": 428, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 702, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}, {"lineno": 479, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (copy_ucs2_to_user_len(getnextvariablename.variable_name,"}],
"warnings":[{"warn_data": {"at_line": 136, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(dst, src, len);", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "copy_ucs2_to_user_len"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 699, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_waketime(arg);"}],
"warnings":[{"warn_data": {"at_line": 389, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&efi_time, setwakeuptime.time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_waketime"}, "warn_no": 1},
{"warn_data": {"at_line": 374, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_waketime"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 696, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_waketime(arg);"}],
"warnings":[{"warn_data": {"at_line": 337, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_waketime"}, "warn_no": 1},
{"warn_data": {"at_line": 365, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getwakeuptime.time, &efi_time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_waketime"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 693, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_time(arg);"}],
"warnings":[{"warn_data": {"at_line": 325, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&efi_time, settime.time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_time"}, "warn_no": 1},
{"warn_data": {"at_line": 316, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_time"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 690, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_time(arg);"}],
"warnings":[{"warn_data": {"at_line": 278, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_time"}, "warn_no": 1},
{"warn_data": {"at_line": 308, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(gettime.time, &efi_time, sizeof(efi_time_t)))", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_time"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 687, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_variable(arg);"}],
"warnings":[{"warn_data": {"at_line": 230, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_variable"}, "warn_no": 1},
{"warn_data": {"at_line": 243, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid, setvariable.vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_variable"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 684, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}],
"warnings":[{"warn_data": {"at_line": 209, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getvariable.data, data, datasize)) {", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 1},
{"warn_data": {"at_line": 140, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 2},
{"warn_data": {"at_line": 160, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid, getvariable.vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 3},
{"warn_data": {"at_line": 176, "warn_str": "Trying to use a global variable without locking.", "at": "data = kmalloc(datasize, GFP_KERNEL);", "inst_trace": [{"instr_func": "efi_test_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "efi_test_ioctl", "instr_loc": 684, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "GlobalVariableRaceDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 4}]}]}