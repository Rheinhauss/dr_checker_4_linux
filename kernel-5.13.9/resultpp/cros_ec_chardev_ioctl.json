{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 354, "file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "return cros_ec_chardev_ioctl_readmem(ec, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 327, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&s_mem, arg, sizeof(s_mem)))", "inst_trace": [], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "TaintedSizeDetector says:", "at_func": "cros_ec_chardev_ioctl_readmem"}, "warn_no": 1},
{"warn_data": {"at_line": 335, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, &s_mem, sizeof(s_mem)))", "inst_trace": [], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "TaintedSizeDetector says:", "at_func": "cros_ec_chardev_ioctl_readmem"}, "warn_no": 2}]},
{"num_warnings": 13,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 352, "file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "return cros_ec_chardev_ioctl_xcmd(ec, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 1},
{"warn_data": {"at_line": 275, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "TaintedSizeDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 2},
{"warn_data": {"at_line": 287, "warn_str": "Trying to use a global variable without locking.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "cros_ec_chardev_ioctl", "instr_loc": 352, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "return cros_ec_chardev_ioctl_xcmd(ec, (void __user *)arg);"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 3},
{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 4},
{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 5},
{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 6},
{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 7},
{"warn_data": {"at_line": 287, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 287, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd = kmalloc(sizeof(*s_cmd) + max(u_cmd.outsize, u_cmd.insize),"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 8},
{"warn_data": {"at_line": 292, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_from_user(s_cmd, arg, sizeof(*s_cmd) + u_cmd.outsize)) {", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 275, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "{"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 292, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "if (copy_from_user(s_cmd, arg, sizeof(*s_cmd) + u_cmd.outsize)) {"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 9},
{"warn_data": {"at_line": 303, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s_cmd->command += ec->cmd_offset;", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 292, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "if (copy_from_user(s_cmd, arg, sizeof(*s_cmd) + u_cmd.outsize)) {"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 303, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "s_cmd->command += ec->cmd_offset;"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 10},
{"warn_data": {"at_line": 292, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(s_cmd, arg, sizeof(*s_cmd) + u_cmd.outsize)) {", "inst_trace": [], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "TaintedSizeDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 11},
{"warn_data": {"at_line": 309, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (copy_to_user(arg, s_cmd, sizeof(*s_cmd) + s_cmd->insize))", "inst_trace": [{"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 292, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "if (copy_from_user(s_cmd, arg, sizeof(*s_cmd) + u_cmd.outsize)) {"}, {"instr_func": "cros_ec_chardev_ioctl_xcmd", "instr_loc": 309, "instr_file": "drivers/platform/chrome/cros_ec_chardev.c", "instr": "if (copy_to_user(arg, s_cmd, sizeof(*s_cmd) + s_cmd->insize))"}], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 12},
{"warn_data": {"at_line": 309, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, s_cmd, sizeof(*s_cmd) + s_cmd->insize))", "inst_trace": [], "at_file": "drivers/platform/chrome/cros_ec_chardev.c", "by": "TaintedSizeDetector says:", "at_func": "cros_ec_chardev_ioctl_xcmd"}, "warn_no": 13}]}]}