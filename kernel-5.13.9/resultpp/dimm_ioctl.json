{"all_contexts":[
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1257, "file": "drivers/nvdimm/bus.c", "instr": "return nd_ioctl(file, cmd, arg, DIMM_IOCTL);"}, {"lineno": 1240, "file": "drivers/nvdimm/bus.c", "instr": "rc = __nd_ioctl(nvdimm_bus, nvdimm, ro, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 1093, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_from_user(&in_env[in_len], p + in_len, copy)) {", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1034, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "unsigned long *mask;", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1129, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_from_user(&out_env[out_len],", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1083, "warn_str": "Loop is bounded by a tainted value.", "at": "if (in_size == UINT_MAX) {", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1093, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&in_env[in_len], p + in_len, copy)) {"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 858, "instr_file": "drivers/nvdimm/bus.c", "instr": "return hdr->in_length;"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 858, "instr_file": "drivers/nvdimm/bus.c", "instr": "return hdr->in_length;"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 866, "instr_file": "drivers/nvdimm/bus.c", "instr": "}"}, {"instr_func": "__nd_ioctl", "instr_loc": 1082, "instr_file": "drivers/nvdimm/bus.c", "instr": "in_size = nd_cmd_in_size(nvdimm, cmd, desc, i, in_env);"}, {"instr_func": "__nd_ioctl", "instr_loc": 1082, "instr_file": "drivers/nvdimm/bus.c", "instr": "in_size = nd_cmd_in_size(nvdimm, cmd, desc, i, in_env);"}, {"instr_func": "__nd_ioctl", "instr_loc": 1083, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (in_size == UINT_MAX) {"}, {"instr_func": "__nd_ioctl", "instr_loc": 1083, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (in_size == UINT_MAX) {"}], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1119, "warn_str": "Loop is bounded by a tainted value.", "at": "if (out_size == UINT_MAX) {", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1129, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 882, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1];"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 882, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1];"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 908, "instr_file": "drivers/nvdimm/bus.c", "instr": "}"}, {"instr_func": "__nd_ioctl", "instr_loc": 1115, "instr_file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}, {"instr_func": "__nd_ioctl", "instr_loc": 1115, "instr_file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}, {"instr_func": "__nd_ioctl", "instr_loc": 1119, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_size == UINT_MAX) {"}, {"instr_func": "__nd_ioctl", "instr_loc": 1119, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_size == UINT_MAX) {"}], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1173, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(p, buf, buf_len))", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1151, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, p, buf_len)) {", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1257, "file": "drivers/nvdimm/bus.c", "instr": "return nd_ioctl(file, cmd, arg, DIMM_IOCTL);"}, {"lineno": 1240, "file": "drivers/nvdimm/bus.c", "instr": "rc = __nd_ioctl(nvdimm_bus, nvdimm, ro, cmd, arg);"}, {"lineno": 1049, "file": "drivers/nvdimm/bus.c", "instr": "if (!test_bit(pkg.nd_family, mask))"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Trying to read from a user pointer.", "at": "  %38 = load volatile i64, i64* %37, align 8, !dbg !43221", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1034, "instr_file": "drivers/nvdimm/bus.c", "instr": "unsigned long *mask;"}, {"instr_func": "__nd_ioctl", "instr_loc": 1049, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (!test_bit(pkg.nd_family, mask))"}, {"instr_func": "__nd_ioctl", "instr_loc": 1049, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (!test_bit(pkg.nd_family, mask))"}, {"instr_func": "test_bit", "instr_loc": 133, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %0, i64* %10, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %29 = load i64, i64* %10, align 8, !dbg !43217"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  store i64 %29, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %35 = load i64, i64* %6, align 8, !dbg !43222"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %36 = ashr i64 %35, 6, !dbg !43223"}, {"instr_func": "test_bit", "instr_loc": 135, "instr_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "instr": "  %37 = getelementptr i64, i64* %34, i64 %36, !dbg !43221"}], "at_file": "./include/asm-generic/bitops/instrumented-non-atomic.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1257, "file": "drivers/nvdimm/bus.c", "instr": "return nd_ioctl(file, cmd, arg, DIMM_IOCTL);"}, {"lineno": 1240, "file": "drivers/nvdimm/bus.c", "instr": "rc = __nd_ioctl(nvdimm_bus, nvdimm, ro, cmd, arg);"}, {"lineno": 1115, "file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}],
"warnings":[{"warn_data": {"at_line": 897, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (out_field[1] - 4 == remainder)", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1129, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 897, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_field[1] - 4 == remainder)"}], "at_file": "drivers/nvdimm/bus.c", "by": "IntegerOverflowDetector says:", "at_func": "nd_cmd_out_size"}, "warn_no": 1},
{"warn_data": {"at_line": 899, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return out_field[1] - 8;", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1129, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 899, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1] - 8;"}], "at_file": "drivers/nvdimm/bus.c", "by": "IntegerOverflowDetector says:", "at_func": "nd_cmd_out_size"}, "warn_no": 2}]}]}