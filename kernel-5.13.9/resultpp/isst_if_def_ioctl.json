{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 526, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}],
"warnings":[{"warn_data": {"at_line": 457, "warn_str": "Trying to use a global variable without locking.", "at": "cmd_ptr = kmalloc(cb->cmd_size, GFP_KERNEL);", "inst_trace": [{"instr_func": "isst_if_def_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "isst_if_def_ioctl", "instr_loc": 526, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "GlobalVariableRaceDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 443, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 481, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!wr_only && copy_to_user(ptr, cmd_ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 464, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < cmd_count; ++i) {", "inst_trace": [{"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 443, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "{"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedLoopBoundDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 472, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd_ptr, ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 5}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 520, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, cb);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!wr_only && copy_to_user(ptr, cmd_ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 464, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < cmd_count; ++i) {", "inst_trace": [{"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 443, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "{"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedLoopBoundDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 443, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 472, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd_ptr, ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 526, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"lineno": 477, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}],
"warnings":[{"warn_data": {"at_line": 412, "warn_str": "Trying to use a global variable without locking.", "at": "if (msr_cmd->logical_cpu >= nr_cpu_ids)", "inst_trace": [{"instr_func": "isst_if_def_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "isst_if_def_ioctl", "instr_loc": 526, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 477, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "GlobalVariableRaceDetector says:", "at_func": "isst_if_msr_cmd_req"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 526, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"lineno": 477, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}, {"lineno": 409, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "if (!match_punit_msr_white_list(msr_cmd->msr))"}],
"warnings":[{"warn_data": {"at_line": 395, "warn_str": "Trying to use a global variable without locking.", "at": "if (punit_msr_white_list[i] == msr)", "inst_trace": [{"instr_func": "isst_if_def_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "isst_if_def_ioctl", "instr_loc": 526, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 477, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}, {"instr_func": "isst_if_msr_cmd_req", "instr_loc": 409, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "if (!match_punit_msr_white_list(msr_cmd->msr))"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "GlobalVariableRaceDetector says:", "at_func": "match_punit_msr_white_list"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 515, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, cb);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!wr_only && copy_to_user(ptr, cmd_ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 464, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < cmd_count; ++i) {", "inst_trace": [{"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 443, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "{"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedLoopBoundDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 443, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 472, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd_ptr, ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 510, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!wr_only && copy_to_user(ptr, cmd_ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 464, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < cmd_count; ++i) {", "inst_trace": [{"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 443, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "{"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 464, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "for (i = 0; i < cmd_count; ++i) {"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedLoopBoundDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 443, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 472, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd_ptr, ptr, cb->cmd_size)) {", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_exec_multi_cmd"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 510, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"lineno": 477, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}],
"warnings":[{"warn_data": {"at_line": 380, "warn_str": "Trying to use a global variable without locking.", "at": "if (cpu_map->logical_cpu >= nr_cpu_ids ||", "inst_trace": [{"instr_func": "isst_if_def_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "isst_if_def_ioctl", "instr_loc": 510, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 477, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "GlobalVariableRaceDetector says:", "at_func": "isst_if_proc_phyid_req"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 510, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"lineno": 477, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}, {"lineno": 381, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "cpu_map->logical_cpu >= num_possible_cpus())"}],
"warnings":[{"warn_data": {"at_line": 540, "warn_str": "Trying to use a global variable without locking.", "at": "  %12 = load i32, i32* @nr_cpu_ids, align 4, !dbg !5246", "inst_trace": [{"instr_func": "isst_if_def_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "isst_if_def_ioctl", "instr_loc": 510, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_exec_multi_cmd(argp, &cmd_cb);"}, {"instr_func": "isst_if_exec_multi_cmd", "instr_loc": 477, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = cb->cmd_callback(cmd_ptr, &wr_only, 0);"}, {"instr_func": "isst_if_proc_phyid_req", "instr_loc": 381, "instr_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "cpu_map->logical_cpu >= num_possible_cpus())"}], "at_file": "./include/linux/cpumask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "cpumask_weight"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 504, "file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "instr": "ret = isst_if_get_platform_info(argp);"}],
"warnings":[{"warn_data": {"at_line": 265, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/platform/x86/intel_speed_select_if/isst_if_common.c", "by": "TaintedSizeDetector says:", "at_func": "isst_if_get_platform_info"}, "warn_no": 1}]}]}