{"all_contexts":[
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 7909, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = copy_to_user(ubuf, info->spare + info->read, size);", "inst_trace": [], "at_file": "kernel/trace/trace.c", "by": "TaintedSizeDetector says:", "at_func": "tracing_buffers_read"}, "warn_no": 1},
{"warn_data": {"at_line": 7913, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size -= ret;", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7850, "instr_file": "kernel/trace/trace.c", "instr": "{"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7909, "instr_file": "kernel/trace/trace.c", "instr": "ret = copy_to_user(ubuf, info->spare + info->read, size);"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7909, "instr_file": "kernel/trace/trace.c", "instr": "ret = copy_to_user(ubuf, info->spare + info->read, size);"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7909, "instr_file": "kernel/trace/trace.c", "instr": "ret = copy_to_user(ubuf, info->spare + info->read, size);"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7909, "instr_file": "kernel/trace/trace.c", "instr": "ret = copy_to_user(ubuf, info->spare + info->read, size);"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7913, "instr_file": "kernel/trace/trace.c", "instr": "size -= ret;"}], "at_file": "kernel/trace/trace.c", "by": "IntegerOverflowDetector says:", "at_func": "tracing_buffers_read"}, "warn_no": 2},
{"warn_data": {"at_line": 7915, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*ppos += size;", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7850, "instr_file": "kernel/trace/trace.c", "instr": "{"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7915, "instr_file": "kernel/trace/trace.c", "instr": "*ppos += size;"}], "at_file": "kernel/trace/trace.c", "by": "IntegerOverflowDetector says:", "at_func": "tracing_buffers_read"}, "warn_no": 3},
{"warn_data": {"at_line": 7916, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info->read += size;", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7850, "instr_file": "kernel/trace/trace.c", "instr": "{"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7907, "instr_file": "kernel/trace/trace.c", "instr": "size = count;"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7916, "instr_file": "kernel/trace/trace.c", "instr": "info->read += size;"}], "at_file": "kernel/trace/trace.c", "by": "IntegerOverflowDetector says:", "at_func": "tracing_buffers_read"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 7890, "file": "kernel/trace/trace.c", "instr": "if (trace_empty(iter)) {"}],
"warnings":[{"warn_data": {"at_line": 4400, "warn_str": "Trying to use a global variable without locking.", "at": "for_each_tracing_cpu(cpu) {", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7890, "instr_file": "kernel/trace/trace.c", "instr": "if (trace_empty(iter)) {"}], "at_file": "kernel/trace/trace.c", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_empty"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 7882, "file": "kernel/trace/trace.c", "instr": "trace_access_lock(iter->cpu_file);"}],
"warnings":[{"warn_data": {"at_line": 865, "warn_str": "Trying to use a global variable without locking.", "at": "mutex_lock(&per_cpu(cpu_access_lock, cpu));", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7882, "instr_file": "kernel/trace/trace.c", "instr": "trace_access_lock(iter->cpu_file);"}], "at_file": "kernel/trace/trace.c", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_access_lock"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 7887, "file": "kernel/trace/trace.c", "instr": "trace_access_unlock(iter->cpu_file);"}],
"warnings":[{"warn_data": {"at_line": 874, "warn_str": "Trying to use a global variable without locking.", "at": "mutex_unlock(&per_cpu(cpu_access_lock, cpu));", "inst_trace": [{"instr_func": "tracing_buffers_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "tracing_buffers_read", "instr_loc": 7887, "instr_file": "kernel/trace/trace.c", "instr": "trace_access_unlock(iter->cpu_file);"}], "at_file": "kernel/trace/trace.c", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_access_unlock"}, "warn_no": 1}]}]}