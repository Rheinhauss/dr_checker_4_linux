{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 1397, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))", "inst_trace": [], "at_file": "drivers/ide/ide-tape.c", "by": "TaintedSizeDetector says:", "at_func": "do_idetape_chrdev_ioctl"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}, {"lineno": 1418, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_blkdev_ioctl(drive, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 1052, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "memset(&config, 0, sizeof(config));", "inst_trace": [], "at_file": "drivers/ide/ide-tape.c", "by": "TaintedSizeDetector says:", "at_func": "idetape_blkdev_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1047, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&config, argp, sizeof(config)))", "inst_trace": [], "at_file": "drivers/ide/ide-tape.c", "by": "TaintedSizeDetector says:", "at_func": "idetape_blkdev_ioctl"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}, {"lineno": 1411, "file": "drivers/ide/ide-tape.c", "instr": "return put_user_mtget(argp, &mtget);"}],
"warnings":[{"warn_data": {"at_line": 47, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "  %257 = call i64 @_copy_to_user(i8* %254, i8* %255, i64 %256) #15, !dbg !7769", "inst_trace": [], "at_file": "./include/linux/mtio.h", "by": "TaintedSizeDetector says:", "at_func": "put_user_mtget"}, "warn_no": 1},
{"warn_data": {"at_line": 45, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "  %160 = call i64 @_copy_to_user(i8* %157, i8* %158, i64 %159) #15, !dbg !7720", "inst_trace": [], "at_file": "./include/linux/mtio.h", "by": "TaintedSizeDetector says:", "at_func": "put_user_mtget"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}, {"lineno": 1399, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}],
"warnings":[{"warn_data": {"at_line": 1282, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < mt_count; i++) {", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1282, "instr_file": "drivers/ide/ide-tape.c", "instr": "for (i = 0; i < mt_count; i++) {"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1282, "instr_file": "drivers/ide/ide-tape.c", "instr": "for (i = 0; i < mt_count; i++) {"}], "at_file": "drivers/ide/ide-tape.c", "by": "TaintedLoopBoundDetector says:", "at_func": "idetape_mtioctop"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}, {"lineno": 1399, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"lineno": 1272, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}],
"warnings":[{"warn_data": {"at_line": 1081, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "mt_count = -mt_count;", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1081, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count = -mt_count;"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 1},
{"warn_data": {"at_line": 1103, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "mt_count - count);", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 2},
{"warn_data": {"at_line": 1095, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idetape_create_space_cmd(&pc, mt_count - count,", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1081, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count = -mt_count;"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1081, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count = -mt_count;"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1081, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count = -mt_count;"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1095, "instr_file": "drivers/ide/ide-tape.c", "instr": "idetape_create_space_cmd(&pc, mt_count - count,"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1427, "file": "drivers/ide/ide-tape.c", "instr": "ret = do_idetape_chrdev_ioctl(file, cmd, arg);"}, {"lineno": 1399, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"lineno": 1272, "file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"lineno": 1102, "file": "drivers/ide/ide-tape.c", "instr": "retval = idetape_space_over_filemarks(drive, MTFSF,"}],
"warnings":[{"warn_data": {"at_line": 1081, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "mt_count = -mt_count;", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1102, "instr_file": "drivers/ide/ide-tape.c", "instr": "retval = idetape_space_over_filemarks(drive, MTFSF,"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1081, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count = -mt_count;"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 1},
{"warn_data": {"at_line": 1103, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "mt_count - count);", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1102, "instr_file": "drivers/ide/ide-tape.c", "instr": "retval = idetape_space_over_filemarks(drive, MTFSF,"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 2},
{"warn_data": {"at_line": 1095, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idetape_create_space_cmd(&pc, mt_count - count,", "inst_trace": [{"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1397, "instr_file": "drivers/ide/ide-tape.c", "instr": "if (copy_from_user(&mtop, argp, sizeof(struct mtop)))"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "do_idetape_chrdev_ioctl", "instr_loc": 1399, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_mtioctop(drive, mtop.mt_op, mtop.mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1256, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_mtioctop", "instr_loc": 1272, "instr_file": "drivers/ide/ide-tape.c", "instr": "return idetape_space_over_filemarks(drive, mt_op, mt_count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1103, "instr_file": "drivers/ide/ide-tape.c", "instr": "mt_count - count);"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1102, "instr_file": "drivers/ide/ide-tape.c", "instr": "retval = idetape_space_over_filemarks(drive, MTFSF,"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1066, "instr_file": "drivers/ide/ide-tape.c", "instr": "{"}, {"instr_func": "idetape_space_over_filemarks", "instr_loc": 1095, "instr_file": "drivers/ide/ide-tape.c", "instr": "idetape_create_space_cmd(&pc, mt_count - count,"}], "at_file": "drivers/ide/ide-tape.c", "by": "IntegerOverflowDetector says:", "at_func": "idetape_space_over_filemarks"}, "warn_no": 3}]}]}