{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 280, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = set_ctxt_pkey(uctxt, arg);"}],
"warnings":[{"warn_data": {"at_line": 1602, "warn_str": "Trying to use a global variable without locking.", "at": "if (!HFI1_CAP_IS_USET(PKEY_CHECK))", "inst_trace": [{"instr_func": "hfi1_file_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "hfi1_file_ioctl", "instr_loc": 280, "instr_file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = set_ctxt_pkey(uctxt, arg);"}], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "GlobalVariableRaceDetector says:", "at_func": "set_ctxt_pkey"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 262, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = user_exp_rcv_invalid(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&tinfo, (void __user *)arg, (sizeof(tinfo))))", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_invalid"}, "warn_no": 1},
{"warn_data": {"at_line": 1432, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "addr = arg + offsetof(struct hfi1_tid_info, tidcnt);", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_invalid"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 258, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = user_exp_rcv_clear(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1389, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&tinfo, (void __user *)arg, (sizeof(tinfo))))", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_clear"}, "warn_no": 1},
{"warn_data": {"at_line": 1394, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "addr = arg + offsetof(struct hfi1_tid_info, tidcnt);", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_clear"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 254, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = user_exp_rcv_setup(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1346, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&tinfo, (void __user *)arg, (sizeof(tinfo))))", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_setup"}, "warn_no": 1},
{"warn_data": {"at_line": 1355, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "addr = arg + offsetof(struct hfi1_tid_info, tidcnt);", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_setup"}, "warn_no": 2},
{"warn_data": {"at_line": 1360, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "addr = arg + offsetof(struct hfi1_tid_info, length);", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "user_exp_rcv_setup"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 245, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = get_base_info(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1306, "warn_str": "Trying to use a global variable without locking.", "at": "if (HFI1_CAP_IS_USET(DMA_RTAIL))", "inst_trace": [{"instr_func": "hfi1_file_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "hfi1_file_ioctl", "instr_loc": 245, "instr_file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = get_base_info(fd, arg, _IOC_SIZE(cmd));"}], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "GlobalVariableRaceDetector says:", "at_func": "get_base_info"}, "warn_no": 1},
{"warn_data": {"at_line": 1321, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, &binfo, len))", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "get_base_info"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 245, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = get_base_info(fd, arg, _IOC_SIZE(cmd));"}, {"lineno": 1257, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "trace_hfi1_uctxtdata(uctxt->dd, uctxt, fd->subctxt);"}, {"lineno": 61, "file": "drivers/infiniband/hw/hfi1/trace_ctxts.h", "instr": "  %65 = call zeroext i1 @cpu_online(i32 %64) #12, !dbg !17300"}, {"lineno": 895, "file": "./include/linux/cpumask.h", "instr": "  %4 = call i32 @cpumask_test_cpu(i32 %3, %struct.cpumask* @__cpu_online_mask) #12, !dbg !17232"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #12, !dbg !17234"}],
"warnings":[{"warn_data": {"at_line": 115, "warn_str": "Trying to use a global variable without locking.", "at": "  %4 = load i32, i32* @nr_cpu_ids, align 4, !dbg !17232", "inst_trace": [{"instr_func": "hfi1_file_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "hfi1_file_ioctl", "instr_loc": 245, "instr_file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = get_base_info(fd, arg, _IOC_SIZE(cmd));"}, {"instr_func": "get_base_info", "instr_loc": 1257, "instr_file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "trace_hfi1_uctxtdata(uctxt->dd, uctxt, fd->subctxt);"}, {"instr_func": "trace_hfi1_uctxtdata", "instr_loc": 61, "instr_file": "drivers/infiniband/hw/hfi1/trace_ctxts.h", "instr": "  %65 = call zeroext i1 @cpu_online(i32 %64) #12, !dbg !17300"}, {"instr_func": "cpu_online", "instr_loc": 895, "instr_file": "./include/linux/cpumask.h", "instr": "  %4 = call i32 @cpumask_test_cpu(i32 %3, %struct.cpumask* @__cpu_online_mask) #12, !dbg !17232"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #12, !dbg !17234"}], "at_file": "./include/linux/cpumask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "cpumask_check"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 241, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = get_ctxt_info(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 1166, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "cinfo.rcvhdrq_entsize = get_hdrqentsize(uctxt) << 2;", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "get_ctxt_info"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 237, "file": "drivers/infiniband/hw/hfi1/file_ops.c", "instr": "ret = assign_ctxt(fd, arg, _IOC_SIZE(cmd));"}],
"warnings":[{"warn_data": {"at_line": 796, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&uinfo, (void __user *)arg, sizeof(uinfo)))", "inst_trace": [], "at_file": "drivers/infiniband/hw/hfi1/file_ops.c", "by": "TaintedSizeDetector says:", "at_func": "assign_ctxt"}, "warn_no": 1}]}]}