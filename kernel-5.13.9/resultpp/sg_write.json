{"all_contexts":[
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}],
"warnings":[{"warn_data": {"at_line": 618, "warn_str": "Trying to use a global variable without locking.", "at": "SCSI_LOG_TIMEOUT(3, sg_printk(KERN_INFO, sdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_write"}, "warn_no": 1},
{"warn_data": {"at_line": 659, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "input_size = count - cmd_size;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_write"}, "warn_no": 2},
{"warn_data": {"at_line": 628, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_write"}, "warn_no": 3},
{"warn_data": {"at_line": 661, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "mxsize -= SZ_SG_HEADER;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_write"}, "warn_no": 4},
{"warn_data": {"at_line": 662, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "input_size -= SZ_SG_HEADER;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 662, "instr_file": "drivers/scsi/sg.c", "instr": "input_size -= SZ_SG_HEADER;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_write"}, "warn_no": 5},
{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "printk_ratelimited(KERN_WARNING", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 698, "instr_file": "drivers/scsi/sg.c", "instr": "printk_ratelimited(KERN_WARNING"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_write"}, "warn_no": 6},
{"warn_data": {"at_line": 683, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "hp->sbp = NULL;", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_write"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 612, "file": "drivers/scsi/sg.c", "instr": "retval = sg_check_file_access(filp, __func__);"}],
"warnings":[{"warn_data": {"at_line": 223, "warn_str": "Trying to use a global variable without locking.", "at": "pr_err_once(\"%s: process %d (%s) changed security contexts after opening file descriptor, this is not allowed.\\n\",", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 612, "instr_file": "drivers/scsi/sg.c", "instr": "retval = sg_check_file_access(filp, __func__);"}], "at_file": "drivers/scsi/sg.c", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_check_file_access"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}],
"warnings":[{"warn_data": {"at_line": 830, "warn_str": "Trying to write to a user pointer.", "at": "srp->rq->timeout = timeout;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 830, "instr_file": "drivers/scsi/sg.c", "instr": "srp->rq->timeout = timeout;"}, {"instr_func": "sg_common_write", "instr_loc": 830, "instr_file": "drivers/scsi/sg.c", "instr": "srp->rq->timeout = timeout;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_common_write"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}],
"warnings":[{"warn_data": {"at_line": 1732, "warn_str": "Trying to read from a user pointer.", "at": "struct request_queue *q = sfp->parentdp->device->request_queue;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1732, "warn_str": "Trying to read from a user pointer.", "at": "struct request_queue *q = sfp->parentdp->device->request_queue;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1737, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1737, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1780, "file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}],
"warnings":[{"warn_data": {"at_line": 1619, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i32, i32* %11, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1618, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %4, align 8"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %10 = load %struct.request_queue*, %struct.request_queue** %4, align 8, !dbg !6959"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %11 = getelementptr inbounds %struct.request_queue, %struct.request_queue* %10, i32 0, i32 22, !dbg !6960"}], "at_file": "./include/linux/blkdev.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "blk_rq_aligned"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1780, "file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"lineno": 1619, "file": "./include/linux/blkdev.h", "instr": "  %9 = call i32 @queue_dma_alignment(%struct.request_queue* %8) #14, !dbg !6958"}],
"warnings":[{"warn_data": {"at_line": 1613, "warn_str": "Trying to read from a user pointer.", "at": "  %8 = load i32, i32* %7, align 4, !dbg !6955", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1618, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %4, align 8"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %8 = load %struct.request_queue*, %struct.request_queue** %4, align 8, !dbg !6957"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %9 = call i32 @queue_dma_alignment(%struct.request_queue* %8) #14, !dbg !6958"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1612, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %2, align 8"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1613, "instr_file": "./include/linux/blkdev.h", "instr": "  %6 = load %struct.request_queue*, %struct.request_queue** %2, align 8, !dbg !6954"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1613, "instr_file": "./include/linux/blkdev.h", "instr": "  %7 = getelementptr inbounds %struct.request_queue, %struct.request_queue* %6, i32 0, i32 23, !dbg !6955"}], "at_file": "./include/linux/blkdev.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "queue_dma_alignment"}, "warn_no": 1}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1790, "file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}],
"warnings":[{"warn_data": {"at_line": 2048, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2048, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 2},
{"warn_data": {"at_line": 2052, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 3},
{"warn_data": {"at_line": 2063, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rem -= num;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2063, "instr_file": "drivers/scsi/sg.c", "instr": "rem -= num;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 4},
{"warn_data": {"at_line": 2054, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rem <= num) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1790, "instr_file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1790, "instr_file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2042, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2050, "instr_file": "drivers/scsi/sg.c", "instr": "rem = size;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2050, "instr_file": "drivers/scsi/sg.c", "instr": "rem = size;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2054, "instr_file": "drivers/scsi/sg.c", "instr": "if (rem <= num) {"}, {"instr_func": "sg_link_reserve", "instr_loc": 2054, "instr_file": "drivers/scsi/sg.c", "instr": "if (rem <= num) {"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 5},
{"warn_data": {"at_line": 2053, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < rsv_schp->k_use_sg; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2053, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < rsv_schp->k_use_sg; k++) {"}, {"instr_func": "sg_link_reserve", "instr_loc": 2053, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < rsv_schp->k_use_sg; k++) {"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 6},
{"warn_data": {"at_line": 2067, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 7},
{"warn_data": {"at_line": 2067, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 8}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1798, "file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}],
"warnings":[{"warn_data": {"at_line": 1892, "warn_str": "Trying to read from a user pointer.", "at": "int sg_tablesize = sfp->parentdp->sg_tablesize;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 1},
{"warn_data": {"at_line": 1899, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "++blk_size;\t/* don't know why */", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1899, "instr_file": "drivers/scsi/sg.c", "instr": "++blk_size;\t/* don't know why */"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 2},
{"warn_data": {"at_line": 1901, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blk_size = ALIGN(blk_size, SG_SECTOR_SZ);", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1901, "instr_file": "drivers/scsi/sg.c", "instr": "blk_size = ALIGN(blk_size, SG_SECTOR_SZ);"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 3},
{"warn_data": {"at_line": 1902, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 4},
{"warn_data": {"at_line": 1902, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 5},
{"warn_data": {"at_line": 1941, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 6},
{"warn_data": {"at_line": 1941, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 7},
{"warn_data": {"at_line": 1925, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "k++, rem_sz -= ret_sz) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1899, "instr_file": "drivers/scsi/sg.c", "instr": "++blk_size;\t/* don't know why */"}, {"instr_func": "sg_build_indirect", "instr_loc": 1899, "instr_file": "drivers/scsi/sg.c", "instr": "++blk_size;\t/* don't know why */"}, {"instr_func": "sg_build_indirect", "instr_loc": 1899, "instr_file": "drivers/scsi/sg.c", "instr": "++blk_size;\t/* don't know why */"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1925, "instr_file": "drivers/scsi/sg.c", "instr": "k++, rem_sz -= ret_sz) {"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 8},
{"warn_data": {"at_line": 1924, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1885, "instr_file": "drivers/scsi/sg.c", "instr": "return tablesize;\t/* number of scat_gath elements allocated */"}, {"instr_func": "sg_build_sgat", "instr_loc": 1885, "instr_file": "drivers/scsi/sg.c", "instr": "return tablesize;\t/* number of scat_gath elements allocated */"}, {"instr_func": "sg_build_sgat", "instr_loc": 1886, "instr_file": "drivers/scsi/sg.c", "instr": "}"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %185 = phi i1 [ false, %179 ], [ %183, %180 ], !dbg !7096"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 9},
{"warn_data": {"at_line": 1948, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 10},
{"warn_data": {"at_line": 1948, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 11}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1798, "file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"lineno": 1907, "file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"lineno": 1881, "file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}],
"warnings":[{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %69 = add i64 %68, -1, !dbg !7030", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7000"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7009"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7011"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %68 = load i64, i64* %10, align 8, !dbg !7030"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 1},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %44 = sub i64 %43, 1, !dbg !7026", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7000"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7009"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7011"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %43 = load i64, i64* %10, align 8, !dbg !7026"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 2},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %61 = sub i64 %60, 1, !dbg !7026", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7000"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7009"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7011"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %60 = load i64, i64* %10, align 8, !dbg !7026"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 3},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %48 = sub i64 %47, 1, !dbg !7026", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7000"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7009"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7011"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %47 = load i64, i64* %10, align 8, !dbg !7026"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 4},
{"warn_data": {"at_line": 549, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %53 = sub i64 %52, 1, !dbg !7026", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1878, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_bufflen = tablesize * sizeof(struct page *);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1881, "instr_file": "drivers/scsi/sg.c", "instr": "schp->pages = kzalloc(sg_bufflen, gfp_flags);"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %0, i64* %18, align 8"}, {"instr_func": "kzalloc", "instr_loc": 686, "instr_file": "./include/linux/slab.h", "instr": "  %20 = load i64, i64* %18, align 8, !dbg !7000"}, {"instr_func": "kzalloc", "instr_loc": 685, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %20, i64* %15, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %29 = load i64, i64* %15, align 8, !dbg !7009"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %29, i64* %11, align 8"}, {"instr_func": "kzalloc", "instr_loc": 484, "instr_file": "./include/linux/slab.h", "instr": "  %31 = load i64, i64* %11, align 8, !dbg !7011"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  store i64 %31, i64* %10, align 8"}, {"instr_func": "kzalloc", "instr_loc": 549, "instr_file": "./include/linux/slab.h", "instr": "  %52 = load i64, i64* %10, align 8, !dbg !7026"}], "at_file": "./include/linux/slab.h", "by": "IntegerOverflowDetector says:", "at_func": "kzalloc"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 813, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}],
"warnings":[{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1863, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1870, "file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}],
"warnings":[{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 1},
{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 2},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 3},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 4},
{"warn_data": {"at_line": 1975, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %81 = phi i1 [ false, %70 ], [ %79, %71 ], !dbg !6990"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_remove_scat"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1868, "file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}],
"warnings":[{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}],
"warnings":[{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1863, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1870, "file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}],
"warnings":[{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 1},
{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 2},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 3},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 4},
{"warn_data": {"at_line": 1975, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %81 = phi i1 [ false, %70 ], [ %79, %71 ], !dbg !6990"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_remove_scat"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 707, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, sfp->timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1868, "file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}],
"warnings":[{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}],
"warnings":[{"warn_data": {"at_line": 762, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmnd, hp->cmdp, hp->cmd_len)) {", "inst_trace": [], "at_file": "drivers/scsi/sg.c", "by": "TaintedSizeDetector says:", "at_func": "sg_new_write"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 756, "file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}],
"warnings":[{"warn_data": {"at_line": 310, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %5 = add i64 %4, 4, !dbg !6953", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "_msecs_to_jiffies", "instr_loc": 309, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !6952"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies"}, "warn_no": 1},
{"warn_data": {"at_line": 310, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %6 = sub i64 %5, 1, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "sg_new_write", "instr_loc": 756, "instr_file": "drivers/scsi/sg.c", "instr": "ul_timeout = msecs_to_jiffies(srp->header.timeout);"}, {"instr_func": "_msecs_to_jiffies", "instr_loc": 309, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !6952"}, {"instr_func": "_msecs_to_jiffies", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  %5 = add i64 %4, 4, !dbg !6953"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}],
"warnings":[{"warn_data": {"at_line": 830, "warn_str": "Trying to write to a user pointer.", "at": "srp->rq->timeout = timeout;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 830, "instr_file": "drivers/scsi/sg.c", "instr": "srp->rq->timeout = timeout;"}, {"instr_func": "sg_common_write", "instr_loc": 830, "instr_file": "drivers/scsi/sg.c", "instr": "srp->rq->timeout = timeout;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_common_write"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}],
"warnings":[{"warn_data": {"at_line": 1732, "warn_str": "Trying to read from a user pointer.", "at": "struct request_queue *q = sfp->parentdp->device->request_queue;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1732, "warn_str": "Trying to read from a user pointer.", "at": "struct request_queue *q = sfp->parentdp->device->request_queue;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1737, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1737, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_start_req", "instr_loc": 1737, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_start_req"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1780, "file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}],
"warnings":[{"warn_data": {"at_line": 1619, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i32, i32* %11, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1618, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %4, align 8"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %10 = load %struct.request_queue*, %struct.request_queue** %4, align 8, !dbg !6959"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %11 = getelementptr inbounds %struct.request_queue, %struct.request_queue* %10, i32 0, i32 22, !dbg !6960"}], "at_file": "./include/linux/blkdev.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "blk_rq_aligned"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1780, "file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"lineno": 1619, "file": "./include/linux/blkdev.h", "instr": "  %9 = call i32 @queue_dma_alignment(%struct.request_queue* %8) #14, !dbg !6958"}],
"warnings":[{"warn_data": {"at_line": 1613, "warn_str": "Trying to read from a user pointer.", "at": "  %8 = load i32, i32* %7, align 4, !dbg !6955", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1732, "instr_file": "drivers/scsi/sg.c", "instr": "struct request_queue *q = sfp->parentdp->device->request_queue;"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "sg_start_req", "instr_loc": 1780, "instr_file": "drivers/scsi/sg.c", "instr": "blk_rq_aligned(q, (unsigned long)hp->dxferp, dxfer_len))"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1618, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %4, align 8"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %8 = load %struct.request_queue*, %struct.request_queue** %4, align 8, !dbg !6957"}, {"instr_func": "blk_rq_aligned", "instr_loc": 1619, "instr_file": "./include/linux/blkdev.h", "instr": "  %9 = call i32 @queue_dma_alignment(%struct.request_queue* %8) #14, !dbg !6958"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1612, "instr_file": "./include/linux/blkdev.h", "instr": "  store %struct.request_queue* %0, %struct.request_queue** %2, align 8"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1613, "instr_file": "./include/linux/blkdev.h", "instr": "  %6 = load %struct.request_queue*, %struct.request_queue** %2, align 8, !dbg !6954"}, {"instr_func": "queue_dma_alignment", "instr_loc": 1613, "instr_file": "./include/linux/blkdev.h", "instr": "  %7 = getelementptr inbounds %struct.request_queue, %struct.request_queue* %6, i32 0, i32 23, !dbg !6955"}], "at_file": "./include/linux/blkdev.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "queue_dma_alignment"}, "warn_no": 1}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1790, "file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}],
"warnings":[{"warn_data": {"at_line": 2048, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2048, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2048, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 2},
{"warn_data": {"at_line": 2052, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 3},
{"warn_data": {"at_line": 2063, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rem -= num;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2052, "instr_file": "drivers/scsi/sg.c", "instr": "num = 1 << (PAGE_SHIFT + rsv_schp->page_order);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2063, "instr_file": "drivers/scsi/sg.c", "instr": "rem -= num;"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 4},
{"warn_data": {"at_line": 2054, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rem <= num) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1790, "instr_file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1790, "instr_file": "drivers/scsi/sg.c", "instr": "sg_link_reserve(sfp, srp, dxfer_len);"}, {"instr_func": "sg_link_reserve", "instr_loc": 2042, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2050, "instr_file": "drivers/scsi/sg.c", "instr": "rem = size;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2050, "instr_file": "drivers/scsi/sg.c", "instr": "rem = size;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2054, "instr_file": "drivers/scsi/sg.c", "instr": "if (rem <= num) {"}, {"instr_func": "sg_link_reserve", "instr_loc": 2054, "instr_file": "drivers/scsi/sg.c", "instr": "if (rem <= num) {"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 5},
{"warn_data": {"at_line": 2053, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < rsv_schp->k_use_sg; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2053, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < rsv_schp->k_use_sg; k++) {"}, {"instr_func": "sg_link_reserve", "instr_loc": 2053, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < rsv_schp->k_use_sg; k++) {"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_link_reserve"}, "warn_no": 6},
{"warn_data": {"at_line": 2067, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_link_reserve", "instr_loc": 2056, "instr_file": "drivers/scsi/sg.c", "instr": "req_schp->sglist_len = rsv_schp->sglist_len;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2056, "instr_file": "drivers/scsi/sg.c", "instr": "req_schp->sglist_len = rsv_schp->sglist_len;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 7},
{"warn_data": {"at_line": 2067, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_link_reserve", "instr_loc": 2056, "instr_file": "drivers/scsi/sg.c", "instr": "req_schp->sglist_len = rsv_schp->sglist_len;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2056, "instr_file": "drivers/scsi/sg.c", "instr": "req_schp->sglist_len = rsv_schp->sglist_len;"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_link_reserve", "instr_loc": 2067, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(1, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_link_reserve"}, "warn_no": 8}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 803, "file": "drivers/scsi/sg.c", "instr": "k = sg_start_req(srp, cmnd);"}, {"lineno": 1798, "file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}],
"warnings":[{"warn_data": {"at_line": 1892, "warn_str": "Trying to read from a user pointer.", "at": "int sg_tablesize = sfp->parentdp->sg_tablesize;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 1},
{"warn_data": {"at_line": 1899, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "++blk_size;\t/* don't know why */", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1899, "instr_file": "drivers/scsi/sg.c", "instr": "++blk_size;\t/* don't know why */"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 2},
{"warn_data": {"at_line": 1901, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blk_size = ALIGN(blk_size, SG_SECTOR_SZ);", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1901, "instr_file": "drivers/scsi/sg.c", "instr": "blk_size = ALIGN(blk_size, SG_SECTOR_SZ);"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 3},
{"warn_data": {"at_line": 1902, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 4},
{"warn_data": {"at_line": 1902, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1902, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 5},
{"warn_data": {"at_line": 1941, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 6},
{"warn_data": {"at_line": 1941, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1941, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 7},
{"warn_data": {"at_line": 1925, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "k++, rem_sz -= ret_sz) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 659, "instr_file": "drivers/scsi/sg.c", "instr": "input_size = count - cmd_size;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 660, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize = (input_size > old_hdr.reply_len) ? input_size : old_hdr.reply_len;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 661, "instr_file": "drivers/scsi/sg.c", "instr": "mxsize -= SZ_SG_HEADER;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_write", "instr_loc": 677, "instr_file": "drivers/scsi/sg.c", "instr": "hp->dxfer_len = mxsize;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1727, "instr_file": "drivers/scsi/sg.c", "instr": "int dxfer_len = (int) hp->dxfer_len;"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_start_req", "instr_loc": 1798, "instr_file": "drivers/scsi/sg.c", "instr": "res = sg_build_indirect(req_schp, sfp, dxfer_len);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1890, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1893, "instr_file": "drivers/scsi/sg.c", "instr": "int blk_size = buff_size, order;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1925, "instr_file": "drivers/scsi/sg.c", "instr": "k++, rem_sz -= ret_sz) {"}], "at_file": "drivers/scsi/sg.c", "by": "IntegerOverflowDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 8},
{"warn_data": {"at_line": 1948, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 9},
{"warn_data": {"at_line": 1924, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1892, "instr_file": "drivers/scsi/sg.c", "instr": "int sg_tablesize = sfp->parentdp->sg_tablesize;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_sgat", "instr_loc": 1877, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_sgat", "instr_loc": 1885, "instr_file": "drivers/scsi/sg.c", "instr": "return tablesize;\t/* number of scat_gath elements allocated */"}, {"instr_func": "sg_build_sgat", "instr_loc": 1885, "instr_file": "drivers/scsi/sg.c", "instr": "return tablesize;\t/* number of scat_gath elements allocated */"}, {"instr_func": "sg_build_sgat", "instr_loc": 1886, "instr_file": "drivers/scsi/sg.c", "instr": "}"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1907, "instr_file": "drivers/scsi/sg.c", "instr": "mx_sc_elems = sg_build_sgat(schp, sfp, sg_tablesize);"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 1924, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0, rem_sz = blk_size; rem_sz > 0 && k < mx_sc_elems;"}, {"instr_func": "sg_build_indirect", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %185 = phi i1 [ false, %179 ], [ %183, %180 ], !dbg !7096"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_build_indirect"}, "warn_no": 10},
{"warn_data": {"at_line": 1948, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_build_indirect", "instr_loc": 1948, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_build_indirect"}, "warn_no": 11}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 813, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_common_write", "instr_loc": 813, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}],
"warnings":[{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1863, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1870, "file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}],
"warnings":[{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 1},
{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 2},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 3},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 4},
{"warn_data": {"at_line": 1975, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %81 = phi i1 [ false, %70 ], [ %79, %71 ], !dbg !6990"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_remove_scat"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 818, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1868, "file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}],
"warnings":[{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}],
"warnings":[{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1856, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1856, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_finish_rem_req"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1863, "file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}],
"warnings":[{"warn_data": {"at_line": 27, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !6954", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 27, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %3, i32 0, i32 1, !dbg !6954"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 28, "warn_str": "Trying to read from a user pointer.", "at": "  %14 = load i8*, i8** %13, align 8, !dbg !6960", "inst_trace": [{"instr_func": "sg_write", "instr_loc": 628, "instr_file": "drivers/scsi/sg.c", "instr": "if (copy_from_user(&old_hdr, buf, SZ_SG_HEADER))"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_write", "instr_loc": 684, "instr_file": "drivers/scsi/sg.c", "instr": "hp->timeout = old_hdr.reply_len;\t/* structure abuse ... */"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req", "instr_loc": 21, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 586, "instr_file": "./include/linux/blk-mq.h", "instr": "  store %struct.request* %0, %struct.request** %2, align 8"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %3 = load %struct.request*, %struct.request** %2, align 8, !dbg !6951"}, {"instr_func": "blk_mq_rq_to_pdu", "instr_loc": 587, "instr_file": "./include/linux/blk-mq.h", "instr": "  %4 = getelementptr %struct.request, %struct.request* %3, i64 1, !dbg !6952"}, {"instr_func": "scsi_req", "instr_loc": 22, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %4 = call i8* @blk_mq_rq_to_pdu(%struct.request* %3) #14, !dbg !6953"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "sg_finish_rem_req", "instr_loc": 1863, "instr_file": "drivers/scsi/sg.c", "instr": "scsi_req_free_cmd(scsi_req(srp->rq));"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 26, "instr_file": "./include/scsi/scsi_request.h", "instr": "  store %struct.scsi_request* %0, %struct.scsi_request** %2, align 8"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %12 = load %struct.scsi_request*, %struct.scsi_request** %2, align 8, !dbg !6959"}, {"instr_func": "scsi_req_free_cmd", "instr_loc": 28, "instr_file": "./include/scsi/scsi_request.h", "instr": "  %13 = getelementptr inbounds %struct.scsi_request, %struct.scsi_request* %12, i32 0, i32 1, !dbg !6960"}], "at_file": "./include/scsi/scsi_request.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "scsi_req_free_cmd"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1870, "file": "drivers/scsi/sg.c", "instr": "sg_remove_scat(sfp, req_schp);"}],
"warnings":[{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 1},
{"warn_data": {"at_line": 1969, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1969, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, sfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 2},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 3},
{"warn_data": {"at_line": 1976, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(5,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}, {"instr_func": "sg_remove_scat", "instr_loc": 1976, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(5,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_remove_scat"}, "warn_no": 4},
{"warn_data": {"at_line": 1975, "warn_str": "Loop is bounded by a tainted value.", "at": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 1975, "instr_file": "drivers/scsi/sg.c", "instr": "for (k = 0; k < schp->k_use_sg && schp->pages[k]; k++) {"}, {"instr_func": "sg_remove_scat", "instr_loc": 0, "instr_file": "drivers/scsi/sg.c", "instr": "  %81 = phi i1 [ false, %70 ], [ %79, %71 ], !dbg !6990"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedLoopBoundDetector says:", "at_func": "sg_remove_scat"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"lineno": 632, "file": "drivers/scsi/sg.c", "instr": "return sg_new_write(sfp, filp, buf, count,"}, {"lineno": 770, "file": "drivers/scsi/sg.c", "instr": "k = sg_common_write(sfp, srp, cmnd, timeout, blocking);"}, {"lineno": 807, "file": "drivers/scsi/sg.c", "instr": "sg_finish_rem_req(srp);"}, {"lineno": 1868, "file": "drivers/scsi/sg.c", "instr": "sg_unlink_reserve(sfp, srp);"}],
"warnings":[{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 1},
{"warn_data": {"at_line": 2076, "warn_str": "Trying to read from a user pointer.", "at": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,", "inst_trace": [{"instr_func": "sg_write", "instr_loc": -1, "instr": "  %5 = alloca %struct.task_struct*, align 8"}, {"instr_func": "sg_write", "instr_loc": 600, "instr_file": "drivers/scsi/sg.c", "instr": "{"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}, {"instr_func": "sg_unlink_reserve", "instr_loc": 2076, "instr_file": "drivers/scsi/sg.c", "instr": "SCSI_LOG_TIMEOUT(4, sg_printk(KERN_INFO, srp->parentfp->parentdp,"}], "at_file": "drivers/scsi/sg.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "sg_unlink_reserve"}, "warn_no": 2}]}]}