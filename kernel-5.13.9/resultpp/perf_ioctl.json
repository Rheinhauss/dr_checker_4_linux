{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 5692, "file": "kernel/events/core.c", "instr": "ret = _perf_ioctl(event, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 5610, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "u64 id = primary_event_id(event);", "inst_trace": [], "at_file": "kernel/events/core.c", "by": "TaintedSizeDetector says:", "at_func": "_perf_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 5601, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "u64 value;", "inst_trace": [], "at_file": "kernel/events/core.c", "by": "TaintedSizeDetector says:", "at_func": "_perf_ioctl"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 5691, "file": "kernel/events/core.c", "instr": "ctx = perf_event_ctx_lock(event);"}, {"lineno": 1369, "file": "kernel/events/core.c", "instr": "return perf_event_ctx_lock_nested(event, 0);"}],
"warnings":[{"warn_data": {"at_line": 1347, "warn_str": "Trying to use a global variable without locking.", "at": "again:", "inst_trace": [{"instr_func": "perf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "perf_ioctl", "instr_loc": 5691, "instr_file": "kernel/events/core.c", "instr": "ctx = perf_event_ctx_lock(event);"}, {"instr_func": "perf_event_ctx_lock", "instr_loc": 1369, "instr_file": "kernel/events/core.c", "instr": "return perf_event_ctx_lock_nested(event, 0);"}], "at_file": "kernel/events/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "perf_event_ctx_lock_nested"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 5692, "file": "kernel/events/core.c", "instr": "ret = _perf_ioctl(event, cmd, arg);"}, {"lineno": 5660, "file": "kernel/events/core.c", "instr": "int err = perf_copy_attr((struct perf_event_attr __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 11670, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = copy_struct_from_user(attr, sizeof(*attr), uattr, size);", "inst_trace": [], "at_file": "kernel/events/core.c", "by": "TaintedSizeDetector says:", "at_func": "perf_copy_attr"}, "warn_no": 1},
{"warn_data": {"at_line": 11746, "warn_str": "Trying to use a global variable without locking.", "at": "attr->sample_max_stack = sysctl_perf_event_max_stack;", "inst_trace": [{"instr_func": "perf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "perf_ioctl", "instr_loc": 5692, "instr_file": "kernel/events/core.c", "instr": "ret = _perf_ioctl(event, cmd, arg);"}, {"instr_func": "_perf_ioctl", "instr_loc": 5660, "instr_file": "kernel/events/core.c", "instr": "int err = perf_copy_attr((struct perf_event_attr __user *)arg,"}], "at_file": "kernel/events/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "perf_copy_attr"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 5692, "file": "kernel/events/core.c", "instr": "ret = _perf_ioctl(event, cmd, arg);"}, {"lineno": 5660, "file": "kernel/events/core.c", "instr": "int err = perf_copy_attr((struct perf_event_attr __user *)arg,"}, {"lineno": 11718, "file": "kernel/events/core.c", "instr": "ret = perf_allow_kernel(attr);"}],
"warnings":[{"warn_data": {"at_line": 1322, "warn_str": "Trying to use a global variable without locking.", "at": "  %4 = load i32, i32* @sysctl_perf_event_paranoid, align 4, !dbg !11455", "inst_trace": [{"instr_func": "perf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "perf_ioctl", "instr_loc": 5692, "instr_file": "kernel/events/core.c", "instr": "ret = _perf_ioctl(event, cmd, arg);"}, {"instr_func": "_perf_ioctl", "instr_loc": 5660, "instr_file": "kernel/events/core.c", "instr": "int err = perf_copy_attr((struct perf_event_attr __user *)arg,"}, {"instr_func": "perf_copy_attr", "instr_loc": 11718, "instr_file": "kernel/events/core.c", "instr": "ret = perf_allow_kernel(attr);"}], "at_file": "./include/linux/perf_event.h", "by": "GlobalVariableRaceDetector says:", "at_func": "perf_allow_kernel"}, "warn_no": 1}]}]}