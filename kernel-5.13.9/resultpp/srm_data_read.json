{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca %struct.file*, align 8"}],
"warnings":[{"warn_data": {"at_line": 555, "warn_str": "Trying to read from a user pointer.", "at": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "srm_data_read"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"lineno": 553, "file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, true);"}],
"warnings":[{"warn_data": {"at_line": 156, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < work->max_link; i++) {", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 553, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, true);"}, {"instr_func": "srm_data_read", "instr_loc": 553, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, true);"}, {"instr_func": "link_lock", "instr_loc": 152, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "link_lock"}, "warn_no": 1},
{"warn_data": {"at_line": 156, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < work->max_link; i++) {", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 553, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, true);"}, {"instr_func": "srm_data_read", "instr_loc": 553, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, true);"}, {"instr_func": "link_lock", "instr_loc": 152, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedLoopBoundDetector says:", "at_func": "link_lock"}, "warn_no": 2}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"lineno": 555, "file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}],
"warnings":[{"warn_data": {"at_line": 82, "warn_str": "Trying to read from a user pointer.", "at": "if (!psp->hdcp_context.hdcp_initialized) {", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 82, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "if (!psp->hdcp_context.hdcp_initialized) {"}, {"instr_func": "psp_get_srm", "instr_loc": 82, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "if (!psp->hdcp_context.hdcp_initialized) {"}, {"instr_func": "psp_get_srm", "instr_loc": 82, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "if (!psp->hdcp_context.hdcp_initialized) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 1},
{"warn_data": {"at_line": 87, "warn_str": "Trying to read from a user pointer.", "at": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 2},
{"warn_data": {"at_line": 90, "warn_str": "Trying to write to a user pointer.", "at": "hdcp_cmd->cmd_id = TA_HDCP_COMMAND__HDCP_GET_SRM;", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 90, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd->cmd_id = TA_HDCP_COMMAND__HDCP_GET_SRM;"}, {"instr_func": "psp_get_srm", "instr_loc": 90, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd->cmd_id = TA_HDCP_COMMAND__HDCP_GET_SRM;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 3},
{"warn_data": {"at_line": 91, "warn_str": "Trying to read from a user pointer.", "at": "psp_hdcp_invoke(psp, hdcp_cmd->cmd_id);", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 91, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "psp_hdcp_invoke(psp, hdcp_cmd->cmd_id);"}, {"instr_func": "psp_get_srm", "instr_loc": 91, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "psp_hdcp_invoke(psp, hdcp_cmd->cmd_id);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 4},
{"warn_data": {"at_line": 93, "warn_str": "Trying to read from a user pointer.", "at": "if (hdcp_cmd->hdcp_status != TA_HDCP_STATUS__SUCCESS)", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 93, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "if (hdcp_cmd->hdcp_status != TA_HDCP_STATUS__SUCCESS)"}, {"instr_func": "psp_get_srm", "instr_loc": 93, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "if (hdcp_cmd->hdcp_status != TA_HDCP_STATUS__SUCCESS)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 5},
{"warn_data": {"at_line": 96, "warn_str": "Trying to read from a user pointer.", "at": "*srm_version = hdcp_cmd->out_msg.hdcp_get_srm.srm_version;", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 96, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_version = hdcp_cmd->out_msg.hdcp_get_srm.srm_version;"}, {"instr_func": "psp_get_srm", "instr_loc": 96, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_version = hdcp_cmd->out_msg.hdcp_get_srm.srm_version;"}, {"instr_func": "psp_get_srm", "instr_loc": 96, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_version = hdcp_cmd->out_msg.hdcp_get_srm.srm_version;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 6},
{"warn_data": {"at_line": 97, "warn_str": "Trying to read from a user pointer.", "at": "*srm_size = hdcp_cmd->out_msg.hdcp_get_srm.srm_buf_size;", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "srm_data_read", "instr_loc": 555, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "srm = psp_get_srm(work->hdcp.config.psp.handle, &srm_version, &srm_size);"}, {"instr_func": "psp_get_srm", "instr_loc": 78, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 87, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "hdcp_cmd = (struct ta_hdcp_shared_memory *)psp->hdcp_context.hdcp_shared_buf;"}, {"instr_func": "psp_get_srm", "instr_loc": 97, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_size = hdcp_cmd->out_msg.hdcp_get_srm.srm_buf_size;"}, {"instr_func": "psp_get_srm", "instr_loc": 97, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_size = hdcp_cmd->out_msg.hdcp_get_srm.srm_buf_size;"}, {"instr_func": "psp_get_srm", "instr_loc": 97, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "*srm_size = hdcp_cmd->out_msg.hdcp_get_srm.srm_buf_size;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "psp_get_srm"}, "warn_no": 7}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"lineno": 574, "file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, false);"}],
"warnings":[{"warn_data": {"at_line": 156, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < work->max_link; i++) {", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 574, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, false);"}, {"instr_func": "srm_data_read", "instr_loc": 574, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, false);"}, {"instr_func": "link_lock", "instr_loc": 152, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "link_lock"}, "warn_no": 1},
{"warn_data": {"at_line": 156, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < work->max_link; i++) {", "inst_trace": [{"instr_func": "srm_data_read", "instr_loc": -1, "instr": "  %7 = alloca %struct.file*, align 8"}, {"instr_func": "srm_data_read", "instr_loc": 544, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 551, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "work = container_of(bin_attr, struct hdcp_workqueue, attr);"}, {"instr_func": "srm_data_read", "instr_loc": 574, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, false);"}, {"instr_func": "srm_data_read", "instr_loc": 574, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "link_lock(work, false);"}, {"instr_func": "link_lock", "instr_loc": 152, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "{"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}, {"instr_func": "link_lock", "instr_loc": 156, "instr_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "instr": "for (i = 0; i < work->max_link; i++) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/../display/amdgpu_dm/amdgpu_dm_hdcp.c", "by": "TaintedLoopBoundDetector says:", "at_func": "link_lock"}, "warn_no": 2}]}]}