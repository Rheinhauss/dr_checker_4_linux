{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"lineno": 192, "file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}],
"warnings":[{"warn_data": {"at_line": 131, "warn_str": "Trying to use a global variable without locking.", "at": "struct goldfish_tty *qtty = &goldfish_ttys[line];", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}], "at_file": "drivers/tty/goldfish.c", "by": "GlobalVariableRaceDetector says:", "at_func": "goldfish_tty_do_write"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"lineno": 192, "file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"lineno": 134, "file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}],
"warnings":[{"warn_data": {"at_line": 90, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned long addr_end = addr + count;", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 191, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 130, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 80, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 90, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long addr_end = addr + count;"}], "at_file": "drivers/tty/goldfish.c", "by": "IntegerOverflowDetector says:", "at_func": "goldfish_tty_rw"}, "warn_no": 1},
{"warn_data": {"at_line": 117, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "addr += avail;", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 191, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 130, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 80, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 117, "instr_file": "drivers/tty/goldfish.c", "instr": "addr += avail;"}], "at_file": "drivers/tty/goldfish.c", "by": "IntegerOverflowDetector says:", "at_func": "goldfish_tty_rw"}, "warn_no": 2},
{"warn_data": {"at_line": 96, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned long avail = next - addr;", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 191, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 130, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 80, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 90, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long addr_end = addr + count;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 90, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long addr_end = addr + count;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 90, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long addr_end = addr + count;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 95, "instr_file": "drivers/tty/goldfish.c", "instr": "pg_end < addr_end ? pg_end : addr_end;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 95, "instr_file": "drivers/tty/goldfish.c", "instr": "pg_end < addr_end ? pg_end : addr_end;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 94, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long next ="}, {"instr_func": "goldfish_tty_rw", "instr_loc": 96, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long avail = next - addr;"}], "at_file": "drivers/tty/goldfish.c", "by": "IntegerOverflowDetector says:", "at_func": "goldfish_tty_rw"}, "warn_no": 3},
{"warn_data": {"at_line": 92, "warn_str": "Loop is bounded by a tainted value.", "at": "while (addr < addr_end) {", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 191, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 130, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 80, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 92, "instr_file": "drivers/tty/goldfish.c", "instr": "while (addr < addr_end) {"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 92, "instr_file": "drivers/tty/goldfish.c", "instr": "while (addr < addr_end) {"}], "at_file": "drivers/tty/goldfish.c", "by": "TaintedLoopBoundDetector says:", "at_func": "goldfish_tty_rw"}, "warn_no": 4},
{"warn_data": {"at_line": 93, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned long pg_end = (addr & PAGE_MASK) + PAGE_SIZE;", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 191, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 130, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 132, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long address = (unsigned long)(void *)buf;"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 80, "instr_file": "drivers/tty/goldfish.c", "instr": "{"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 117, "instr_file": "drivers/tty/goldfish.c", "instr": "addr += avail;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 117, "instr_file": "drivers/tty/goldfish.c", "instr": "addr += avail;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 117, "instr_file": "drivers/tty/goldfish.c", "instr": "addr += avail;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 93, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long pg_end = (addr & PAGE_MASK) + PAGE_SIZE;"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 93, "instr_file": "drivers/tty/goldfish.c", "instr": "unsigned long pg_end = (addr & PAGE_MASK) + PAGE_SIZE;"}], "at_file": "drivers/tty/goldfish.c", "by": "IntegerOverflowDetector says:", "at_func": "goldfish_tty_rw"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"lineno": 192, "file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"lineno": 134, "file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"lineno": 102, "file": "drivers/tty/goldfish.c", "instr": "dma_handle = dma_map_single(qtty->dev, (void *)addr,"}],
"warnings":[{"warn_data": {"at_line": 318, "warn_str": "Trying to use a global variable without locking.", "at": "  %25 = load i8, i8* @dma_map_single_attrs.__warned, align 1, !dbg !5737", "inst_trace": [{"instr_func": "goldfish_tty_write", "instr_loc": -1, "instr": "  %4 = alloca %struct.tty_struct*, align 8"}, {"instr_func": "goldfish_tty_write", "instr_loc": 192, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_do_write(tty->index, buf, count);"}, {"instr_func": "goldfish_tty_do_write", "instr_loc": 134, "instr_file": "drivers/tty/goldfish.c", "instr": "goldfish_tty_rw(qtty, address, count, 1);"}, {"instr_func": "goldfish_tty_rw", "instr_loc": 102, "instr_file": "drivers/tty/goldfish.c", "instr": "dma_handle = dma_map_single(qtty->dev, (void *)addr,"}], "at_file": "./include/linux/dma-mapping.h", "by": "GlobalVariableRaceDetector says:", "at_func": "dma_map_single_attrs"}, "warn_no": 1}]}]}