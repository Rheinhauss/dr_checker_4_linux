{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}],
"warnings":[{"warn_data": {"at_line": 1581, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (transfersize + USBTMC_HEADER_SIZE > buflen) {", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1581, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (transfersize + USBTMC_HEADER_SIZE > buflen) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1585, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "aligned = (transfersize + (USBTMC_HEADER_SIZE + 3)) & ~3;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1585, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "aligned = (transfersize + (USBTMC_HEADER_SIZE + 3)) & ~3;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1588, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1613, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "remaining -= transfersize;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_write"}, "warn_no": 4},
{"warn_data": {"at_line": 1629, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "done += transfersize;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1629, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "done += transfersize;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_write"}, "warn_no": 5}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 472, "warn_str": "Trying to read from a user pointer.", "at": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 1},
{"warn_data": {"at_line": 452, "warn_str": "Trying to read from a user pointer.", "at": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 2},
{"warn_data": {"at_line": 478, "warn_str": "Loop is bounded by a tainted value.", "at": "if (sg->length % max)", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 3},
{"warn_data": {"at_line": 445, "warn_str": "Trying to read from a user pointer.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 4},
{"warn_data": {"at_line": 445, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 5},
{"warn_data": {"at_line": 446, "warn_str": "Trying to read from a user pointer.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 6},
{"warn_data": {"at_line": 446, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 7},
{"warn_data": {"at_line": 456, "warn_str": "Trying to read from a user pointer.", "at": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 8},
{"warn_data": {"at_line": 493, "warn_str": "Trying to read from a user pointer.", "at": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\",", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 9},
{"warn_data": {"at_line": 467, "warn_str": "Loop is bounded by a tainted value.", "at": "if (len < 0 || len > max)", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 448, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= mult;"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 10}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 401, "file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 411, "file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 506, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 505, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_dir_out.662"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 425, "file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 649, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i16, i16* %4, align 1, !dbg !70482", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !70482"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp.663"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 461, "file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 661, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i16, i16* %5, align 1, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 1},
{"warn_data": {"at_line": 663, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %18 = add i32 %17, 1, !dbg !70487", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %6 = load i16, i16* %5, align 1, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = zext i16 %6 to i32, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store i32 %7, i32* %3, align 4, !dbg !70483"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %12 = and i32 %8, 6144, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %17 = ashr i32 %12, 11, !dbg !70485"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "IntegerOverflowDetector says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 2}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}],
"warnings":[{"warn_data": {"at_line": 1223, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "remaining -= this_part;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1223, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1224, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "done += this_part;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1224, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "done += this_part;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1201, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "aligned = (this_part + 3) & ~3;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1201, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "aligned = (this_part + 3) & ~3;"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "IntegerOverflowDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1149, "warn_str": "Loop is bounded by a tainted value.", "at": "while (remaining > 0) {", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1579, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1579, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1149, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (remaining > 0) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1149, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "while (remaining > 0) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 4},
{"warn_data": {"at_line": 1189, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(buffer, user_buffer + done, this_part)) {", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1561, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "transfersize = count;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1613, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining -= transfersize;"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_write", "instr_loc": 1622, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1109, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1142, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "remaining = transfer_size;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1187, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "this_part = remaining;"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}, {"instr_func": "usbtmc_generic_write", "instr_loc": 1189, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(buffer, user_buffer + done, this_part)) {"}], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 5},
{"warn_data": {"at_line": 1189, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buffer, user_buffer + done, this_part)) {", "inst_trace": [], "at_file": "drivers/usb/class/usbtmc.c", "by": "TaintedSizeDetector says:", "at_func": "usbtmc_generic_write"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}],
"warnings":[{"warn_data": {"at_line": 210, "warn_str": "Trying to read from a user pointer.", "at": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_pipe_type_check"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}, {"lineno": 210, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1606, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 427, "file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}],
"warnings":[{"warn_data": {"at_line": 471, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 470, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_num.664"}, "warn_no": 1}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 472, "warn_str": "Trying to read from a user pointer.", "at": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}, {"instr_func": "usb_submit_urb", "instr_loc": 472, "instr_file": "drivers/usb/core/urb.c", "instr": "} else if (urb->num_sgs && !urb->dev->bus->no_sg_constraint &&"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 1},
{"warn_data": {"at_line": 478, "warn_str": "Loop is bounded by a tainted value.", "at": "if (sg->length % max)", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i16, i16* %4, align 1, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 2047, !dbg !70483"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 478, "instr_file": "drivers/usb/core/urb.c", "instr": "if (sg->length % max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 2},
{"warn_data": {"at_line": 445, "warn_str": "Trying to read from a user pointer.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 3},
{"warn_data": {"at_line": 445, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 4},
{"warn_data": {"at_line": 446, "warn_str": "Trying to read from a user pointer.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 5},
{"warn_data": {"at_line": 446, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}, {"instr_func": "usb_submit_urb", "instr_loc": 446, "instr_file": "drivers/usb/core/urb.c", "instr": "int     mult = USB_SS_MULT(ep->ss_ep_comp.bmAttributes);"}], "at_file": "drivers/usb/core/urb.c", "by": "IntegerOverflowDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 6},
{"warn_data": {"at_line": 452, "warn_str": "Trying to read from a user pointer.", "at": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}, {"instr_func": "usb_submit_urb", "instr_loc": 452, "instr_file": "drivers/usb/core/urb.c", "instr": "USB_SS_SSP_ISOC_COMP(ep->ss_ep_comp.bmAttributes)) {"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 7},
{"warn_data": {"at_line": 456, "warn_str": "Trying to read from a user pointer.", "at": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 455, "instr_file": "drivers/usb/core/urb.c", "instr": "isoc_ep_comp = &ep->ssp_isoc_ep_comp;"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}, {"instr_func": "usb_submit_urb", "instr_loc": 456, "instr_file": "drivers/usb/core/urb.c", "instr": "max = le32_to_cpu(isoc_ep_comp->dwBytesPerInterval);"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 8},
{"warn_data": {"at_line": 467, "warn_str": "Loop is bounded by a tainted value.", "at": "if (len < 0 || len > max)", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 445, "instr_file": "drivers/usb/core/urb.c", "instr": "int     burst = 1 + ep->ss_ep_comp.bMaxBurst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 447, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= burst;"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}, {"instr_func": "usb_submit_urb", "instr_loc": 467, "instr_file": "drivers/usb/core/urb.c", "instr": "if (len < 0 || len > max)"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 9},
{"warn_data": {"at_line": 493, "warn_str": "Trying to read from a user pointer.", "at": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\",", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"instr_func": "usb_submit_urb", "instr_loc": 493, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_submit_urb"}, "warn_no": 10}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 401, "file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 401, "instr_file": "drivers/usb/core/urb.c", "instr": "xfertype = usb_endpoint_type(&ep->desc);"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 411, "file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 506, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 411, "instr_file": "drivers/usb/core/urb.c", "instr": "is_out = usb_endpoint_dir_out(&ep->desc);"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 505, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_dir_out.662", "instr_loc": 506, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_dir_out.662"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 425, "file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 649, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i16, i16* %4, align 1, !dbg !70482", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 425, "instr_file": "drivers/usb/core/urb.c", "instr": "max = usb_endpoint_maxp(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 648, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_maxp.663", "instr_loc": 649, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 4, !dbg !70482"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp.663"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 461, "file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}],
"warnings":[{"warn_data": {"at_line": 661, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i16, i16* %5, align 1, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 1},
{"warn_data": {"at_line": 663, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %18 = add i32 %17, 1, !dbg !70487", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_submit_urb", "instr_loc": 461, "instr_file": "drivers/usb/core/urb.c", "instr": "max *= usb_endpoint_maxp_mult(&ep->desc);"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 660, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %4, i32 0, i32 4, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %6 = load i16, i16* %5, align 1, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = zext i16 %6 to i32, !dbg !70484"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 661, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store i32 %7, i32* %3, align 4, !dbg !70483"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %12 = and i32 %8, 6144, !dbg !70485"}, {"instr_func": "usb_endpoint_maxp_mult", "instr_loc": 663, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %17 = ashr i32 %12, 11, !dbg !70485"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "IntegerOverflowDetector says:", "at_func": "usb_endpoint_maxp_mult"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}],
"warnings":[{"warn_data": {"at_line": 210, "warn_str": "Trying to read from a user pointer.", "at": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %5 = load i8, i8* %4, align 1, !dbg !70483"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %7 = and i32 %6, 3, !dbg !70484"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}], "at_file": "drivers/usb/core/urb.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_pipe_type_check"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 492, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipe_type_check(urb->dev, urb->pipe))"}, {"lineno": 210, "file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}],
"warnings":[{"warn_data": {"at_line": 483, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 207, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, pipe);"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_pipe_type_check", "instr_loc": 210, "instr_file": "drivers/usb/core/urb.c", "instr": "if (usb_pipetype(pipe) != pipetypes[usb_endpoint_type(&ep->desc)])"}, {"instr_func": "usb_endpoint_type", "instr_loc": 482, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_type", "instr_loc": 483, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 3, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_type"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 493, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": 1588, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "if (copy_from_user(&buffer[USBTMC_HEADER_SIZE], buf, transfersize)) {"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}],
"warnings":[{"warn_data": {"at_line": 2043, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name : dev_bus_name(dev);", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2042, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}, {"instr_func": "dev_driver_string", "instr_loc": 2043, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 517, "file": "drivers/usb/core/urb.c", "instr": "dev_WARN(&dev->dev, \"BOGUS urb flags, %x --> %x\\n\","}, {"lineno": 2043, "file": "drivers/base/core.c", "instr": "return drv ? drv->name : dev_bus_name(dev);"}],
"warnings":[{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load i8*, i8** %22, align 8, !dbg !70489", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %21 = load %struct.class*, %struct.class** %20, align 8, !dbg !70488"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %22 = getelementptr inbounds %struct.class, %struct.class* %21, i32 0, i32 0, !dbg !70489"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 1},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "  %12 = load i8*, i8** %11, align 8, !dbg !70484", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %10 = load %struct.bus_type*, %struct.bus_type** %9, align 8, !dbg !70483"}, {"instr_func": "dev_bus_name", "instr_loc": 626, "instr_file": "./include/linux/device.h", "instr": "  %11 = getelementptr inbounds %struct.bus_type, %struct.bus_type* %10, i32 0, i32 0, !dbg !70484"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_bus_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 1622, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usbtmc_generic_write(file_data, buf + transfersize, remaining,"}, {"lineno": 1213, "file": "drivers/usb/class/usbtmc.c", "instr": "retval = usb_submit_urb(urb, GFP_KERNEL);"}, {"lineno": 427, "file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}],
"warnings":[{"warn_data": {"at_line": 471, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 1, !dbg !70483", "inst_trace": [{"instr_func": "usbtmc_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "usbtmc_write", "instr_loc": 1512, "instr_file": "drivers/usb/class/usbtmc.c", "instr": "{"}, {"instr_func": "usb_pipe_endpoint.661", "instr_loc": 1985, "instr_file": "./include/linux/usb.h", "instr": "  %29 = load %struct.usb_host_endpoint*, %struct.usb_host_endpoint** %28, align 8, !dbg !70491"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 390, "instr_file": "drivers/usb/core/urb.c", "instr": "ep = usb_pipe_endpoint(dev, urb->pipe);"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_submit_urb", "instr_loc": 427, "instr_file": "drivers/usb/core/urb.c", "instr": "dev_dbg(&dev->dev,"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 470, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  store %struct.usb_endpoint_descriptor* %0, %struct.usb_endpoint_descriptor** %2, align 8"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %3 = load %struct.usb_endpoint_descriptor*, %struct.usb_endpoint_descriptor** %2, align 8, !dbg !70482"}, {"instr_func": "usb_endpoint_num.664", "instr_loc": 471, "instr_file": "./include/uapi/linux/usb/ch9.h", "instr": "  %4 = getelementptr inbounds %struct.usb_endpoint_descriptor, %struct.usb_endpoint_descriptor* %3, i32 0, i32 2, !dbg !70483"}], "at_file": "./include/uapi/linux/usb/ch9.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usb_endpoint_num.664"}, "warn_no": 1}]}]}