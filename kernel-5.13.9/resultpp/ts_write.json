{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}],
"warnings":[{"warn_data": {"at_line": 43, "warn_str": "Loop is bounded by a tainted value.", "at": "if (wait_event_interruptible(dev->tsout_rbuf.queue,", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 43, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "if (wait_event_interruptible(dev->tsout_rbuf.queue,"}, {"instr_func": "ts_write", "instr_loc": 43, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "if (wait_event_interruptible(dev->tsout_rbuf.queue,"}], "at_file": "drivers/media/pci/ngene/ngene-dvb.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ts_write"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 48, "file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}],
"warnings":[{"warn_data": {"at_line": 214, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "split = (rbuf->pwrite + len > rbuf->size) ? rbuf->size - rbuf->pwrite : 0;", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 209, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "{"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 214, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "split = (rbuf->pwrite + len > rbuf->size) ? rbuf->size - rbuf->pwrite : 0;"}], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 1},
{"warn_data": {"at_line": 221, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "todo -= split;", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 209, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "{"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 211, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "size_t todo = len;"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 211, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "size_t todo = len;"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 221, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "todo -= split;"}], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 2},
{"warn_data": {"at_line": 217, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "status = copy_from_user(rbuf->data+rbuf->pwrite, buf, split);", "inst_trace": [], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "TaintedSizeDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 3},
{"warn_data": {"at_line": 233, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "smp_store_release(&rbuf->pwrite, (rbuf->pwrite + todo) % rbuf->size);", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 209, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "{"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 211, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "size_t todo = len;"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 211, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "size_t todo = len;"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 233, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "smp_store_release(&rbuf->pwrite, (rbuf->pwrite + todo) % rbuf->size);"}], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 4},
{"warn_data": {"at_line": 229, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "status = copy_from_user(rbuf->data+rbuf->pwrite, buf, todo);", "inst_trace": [], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "TaintedSizeDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 5},
{"warn_data": {"at_line": 231, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return len - todo;", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 209, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "{"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 231, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "return len - todo;"}], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 6},
{"warn_data": {"at_line": 219, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return len - todo;", "inst_trace": [{"instr_func": "ts_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "ts_write", "instr_loc": 38, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "{"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "ts_write", "instr_loc": 48, "instr_file": "drivers/media/pci/ngene/ngene-dvb.c", "instr": "dvb_ringbuffer_write_user(&dev->tsout_rbuf, buf, count);"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 209, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "{"}, {"instr_func": "dvb_ringbuffer_write_user", "instr_loc": 219, "instr_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "instr": "return len - todo;"}], "at_file": "drivers/media/dvb-core/dvb_ringbuffer.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ringbuffer_write_user"}, "warn_no": 7}]}]}