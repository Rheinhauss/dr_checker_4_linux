{"all_contexts":[
{"num_warnings": 15,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}],
"warnings":[{"warn_data": {"at_line": 334, "warn_str": "Trying to use a global variable without locking.", "at": "usbip_dbg_vhci_sysfs(\"port(%u) pdev(%d) rhport(%u)\\n\",", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "GlobalVariableRaceDetector says:", "at_func": "attach_store"}, "warn_no": 1},
{"warn_data": {"at_line": 350, "warn_str": "Trying to read from a user pointer.", "at": "vhci = vhci_hcd->vhci;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 2},
{"warn_data": {"at_line": 343, "warn_str": "Trying to read from a user pointer.", "at": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 3},
{"warn_data": {"at_line": 355, "warn_str": "Trying to read from a user pointer.", "at": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 4},
{"warn_data": {"at_line": 353, "warn_str": "Trying to read from a user pointer.", "at": "vdev = &vhci->vhci_hcd_ss->vdev[rhport];", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 353, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_ss->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 353, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_ss->vdev[rhport];"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 5},
{"warn_data": {"at_line": 397, "warn_str": "Trying to read from a user pointer.", "at": "if (vdev->ud.status != VDEV_ST_NULL) {", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 397, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (vdev->ud.status != VDEV_ST_NULL) {"}, {"instr_func": "attach_store", "instr_loc": 397, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (vdev->ud.status != VDEV_ST_NULL) {"}, {"instr_func": "attach_store", "instr_loc": 397, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (vdev->ud.status != VDEV_ST_NULL) {"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 6},
{"warn_data": {"at_line": 421, "warn_str": "Trying to write to a user pointer.", "at": "vdev->speed         = speed;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 421, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->speed         = speed;"}, {"instr_func": "attach_store", "instr_loc": 421, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->speed         = speed;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 7},
{"warn_data": {"at_line": 420, "warn_str": "Trying to write to a user pointer.", "at": "vdev->devid         = devid;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 420, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->devid         = devid;"}, {"instr_func": "attach_store", "instr_loc": 420, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->devid         = devid;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 8},
{"warn_data": {"at_line": 423, "warn_str": "Trying to write to a user pointer.", "at": "vdev->ud.tcp_socket = socket;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 423, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_socket = socket;"}, {"instr_func": "attach_store", "instr_loc": 423, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_socket = socket;"}, {"instr_func": "attach_store", "instr_loc": 423, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_socket = socket;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 9},
{"warn_data": {"at_line": 422, "warn_str": "Trying to write to a user pointer.", "at": "vdev->ud.sockfd     = sockfd;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 422, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.sockfd     = sockfd;"}, {"instr_func": "attach_store", "instr_loc": 422, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.sockfd     = sockfd;"}, {"instr_func": "attach_store", "instr_loc": 422, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.sockfd     = sockfd;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 10},
{"warn_data": {"at_line": 424, "warn_str": "Trying to write to a user pointer.", "at": "vdev->ud.tcp_rx     = tcp_rx;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 424, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_rx     = tcp_rx;"}, {"instr_func": "attach_store", "instr_loc": 424, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_rx     = tcp_rx;"}, {"instr_func": "attach_store", "instr_loc": 424, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_rx     = tcp_rx;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 11},
{"warn_data": {"at_line": 425, "warn_str": "Trying to write to a user pointer.", "at": "vdev->ud.tcp_tx     = tcp_tx;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 425, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_tx     = tcp_tx;"}, {"instr_func": "attach_store", "instr_loc": 425, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_tx     = tcp_tx;"}, {"instr_func": "attach_store", "instr_loc": 425, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.tcp_tx     = tcp_tx;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 12},
{"warn_data": {"at_line": 426, "warn_str": "Trying to write to a user pointer.", "at": "vdev->ud.status     = VDEV_ST_NOTASSIGNED;", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 426, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.status     = VDEV_ST_NOTASSIGNED;"}, {"instr_func": "attach_store", "instr_loc": 426, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.status     = VDEV_ST_NOTASSIGNED;"}, {"instr_func": "attach_store", "instr_loc": 426, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev->ud.status     = VDEV_ST_NOTASSIGNED;"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 13},
{"warn_data": {"at_line": 434, "warn_str": "Trying to read from a user pointer.", "at": "wake_up_process(vdev->ud.tcp_tx);", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 434, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_tx);"}, {"instr_func": "attach_store", "instr_loc": 434, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_tx);"}, {"instr_func": "attach_store", "instr_loc": 434, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_tx);"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 14},
{"warn_data": {"at_line": 433, "warn_str": "Trying to read from a user pointer.", "at": "wake_up_process(vdev->ud.tcp_rx);", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 433, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_rx);"}, {"instr_func": "attach_store", "instr_loc": 433, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_rx);"}, {"instr_func": "attach_store", "instr_loc": 433, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "wake_up_process(vdev->ud.tcp_rx);"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "attach_store"}, "warn_no": 15}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 340, "file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (!valid_args(&pdev_nr, &rhport, speed))"}, {"lineno": 276, "file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (!valid_port(pdev_nr, rhport)) {"}],
"warnings":[{"warn_data": {"at_line": 218, "warn_str": "Trying to use a global variable without locking.", "at": "if (*pdev_nr >= vhci_num_controllers) {", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 340, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (!valid_args(&pdev_nr, &rhport, speed))"}, {"instr_func": "valid_args", "instr_loc": 276, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (!valid_port(pdev_nr, rhport)) {"}], "at_file": "drivers/usb/usbip/vhci_sysfs.c", "by": "GlobalVariableRaceDetector says:", "at_func": "valid_port"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 343, "file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"lineno": 242, "file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}],
"warnings":[{"warn_data": {"at_line": 668, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !5174", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_get_drvdata"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"lineno": 427, "file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "usbip_kcov_handle_init(&vdev->ud);"}],
"warnings":[{"warn_data": {"at_line": 352, "warn_str": "Trying to write to a user pointer.", "at": "  store i64 %3, i64* %5, align 8, !dbg !5172", "inst_trace": [{"instr_func": "attach_store", "instr_loc": -1, "instr": "  %5 = alloca %struct.spinlock*, align 8"}, {"instr_func": "attach_store", "instr_loc": 329, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "if (sscanf(buf, \"%u %u %u %u\", &port, &sockfd, &devid, &speed) != 4)"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 145, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !5171"}, {"instr_func": "port_to_pdev_nr", "instr_loc": 146, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %8 = udiv i32 %3, 16, !dbg !5172"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 331, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "pdev_nr = port_to_pdev_nr(port);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "platform_get_drvdata", "instr_loc": 241, "instr_file": "./include/linux/platform_device.h", "instr": "  store %struct.platform_device* %0, %struct.platform_device** %2, align 8"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %3 = load %struct.platform_device*, %struct.platform_device** %2, align 8, !dbg !5173"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %4 = getelementptr inbounds %struct.platform_device, %struct.platform_device* %3, i32 0, i32 3, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "dev_get_drvdata", "instr_loc": 667, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !5173"}, {"instr_func": "dev_get_drvdata", "instr_loc": 668, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 8, !dbg !5174"}, {"instr_func": "platform_get_drvdata", "instr_loc": 242, "instr_file": "./include/linux/platform_device.h", "instr": "  %5 = call i8* @dev_get_drvdata(%struct.device* %4) #9, !dbg !5175"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 343, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "hcd = platform_get_drvdata(vhcis[pdev_nr].pdev);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 150, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  store %struct.usb_hcd* %0, %struct.usb_hcd** %2, align 8"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %3 = load %struct.usb_hcd*, %struct.usb_hcd** %2, align 8, !dbg !5428"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %4 = getelementptr inbounds %struct.usb_hcd, %struct.usb_hcd* %3, i32 0, i32 29, !dbg !5429"}, {"instr_func": "hcd_to_vhci_hcd", "instr_loc": 151, "instr_file": "drivers/usb/usbip/vhci.h", "instr": "  %5 = getelementptr inbounds [0 x i64], [0 x i64]* %4, i64 0, i64 0, !dbg !5430"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 349, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci_hcd = hcd_to_vhci_hcd(hcd);"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 350, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vhci = vhci_hcd->vhci;"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 355, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "vdev = &vhci->vhci_hcd_hs->vdev[rhport];"}, {"instr_func": "attach_store", "instr_loc": 427, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "usbip_kcov_handle_init(&vdev->ud);"}, {"instr_func": "attach_store", "instr_loc": 427, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "usbip_kcov_handle_init(&vdev->ud);"}, {"instr_func": "attach_store", "instr_loc": 427, "instr_file": "drivers/usb/usbip/vhci_sysfs.c", "instr": "usbip_kcov_handle_init(&vdev->ud);"}, {"instr_func": "usbip_kcov_handle_init", "instr_loc": 351, "instr_file": "drivers/usb/usbip/usbip_common.h", "instr": "  store %struct.usbip_device* %0, %struct.usbip_device** %2, align 8"}, {"instr_func": "usbip_kcov_handle_init", "instr_loc": 352, "instr_file": "drivers/usb/usbip/usbip_common.h", "instr": "  %4 = load %struct.usbip_device*, %struct.usbip_device** %2, align 8, !dbg !5170"}, {"instr_func": "usbip_kcov_handle_init", "instr_loc": 352, "instr_file": "drivers/usb/usbip/usbip_common.h", "instr": "  %5 = getelementptr inbounds %struct.usbip_device, %struct.usbip_device* %4, i32 0, i32 11, !dbg !5171"}], "at_file": "drivers/usb/usbip/usbip_common.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "usbip_kcov_handle_init"}, "warn_no": 1}]}]}