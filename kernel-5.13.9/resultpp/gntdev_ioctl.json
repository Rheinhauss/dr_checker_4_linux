{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}],
"warnings":[{"warn_data": {"at_line": 955, "warn_str": "Trying to use a global variable without locking.", "at": "return gntdev_ioctl_dmabuf_exp_from_refs(priv, use_ptemod, ptr);", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}], "at_file": "drivers/xen/gntdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gntdev_ioctl"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 951, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_grant_copy(priv, ptr);"}],
"warnings":[{"warn_data": {"at_line": 908, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < copy.count; i++) {", "inst_trace": [{"instr_func": "gntdev_ioctl_grant_copy", "instr_loc": 896, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_grant_copy", "instr_loc": 908, "instr_file": "drivers/xen/gntdev.c", "instr": "for (i = 0; i < copy.count; i++) {"}, {"instr_func": "gntdev_ioctl_grant_copy", "instr_loc": 908, "instr_file": "drivers/xen/gntdev.c", "instr": "for (i = 0; i < copy.count; i++) {"}], "at_file": "drivers/xen/gntdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gntdev_ioctl_grant_copy"}, "warn_no": 1},
{"warn_data": {"at_line": 896, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_grant_copy"}, "warn_no": 2},
{"warn_data": {"at_line": 909, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct gntdev_grant_copy_segment seg;", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_grant_copy"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 951, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_grant_copy(priv, ptr);"}, {"lineno": 916, "file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_grant_copy_seg(&batch, &seg, &copy.segments[i].status);"}, {"lineno": 856, "file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_get_page(batch, virt, &gfn);"}],
"warnings":[{"warn_data": {"at_line": 755, "warn_str": "Trying to use a global variable without locking.", "at": "xen_pfn = page_to_xen_pfn(page) + XEN_PFN_DOWN(addr & ~PAGE_MASK);", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 951, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_grant_copy(priv, ptr);"}, {"instr_func": "gntdev_ioctl_grant_copy", "instr_loc": 916, "instr_file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_grant_copy_seg(&batch, &seg, &copy.segments[i].status);"}, {"instr_func": "gntdev_grant_copy_seg", "instr_loc": 856, "instr_file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_get_page(batch, virt, &gfn);"}], "at_file": "drivers/xen/gntdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gntdev_get_page"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 951, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_grant_copy(priv, ptr);"}, {"lineno": 916, "file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_grant_copy_seg(&batch, &seg, &copy.segments[i].status);"}, {"lineno": 856, "file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_get_page(batch, virt, &gfn);"}, {"lineno": 756, "file": "drivers/xen/gntdev.c", "instr": "*gfn = pfn_to_gfn(xen_pfn);"}, {"lineno": 253, "file": "./arch/x86/include/asm/xen/page.h", "instr": "  %4 = call i32 @xen_feature(i32 2) #14, !dbg !5707"}],
"warnings":[{"warn_data": {"at_line": 21, "warn_str": "Trying to use a global variable without locking.", "at": "  %5 = getelementptr [32 x i8], [32 x i8]* @xen_features, i64 0, i64 %4, !dbg !5706", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 951, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_grant_copy(priv, ptr);"}, {"instr_func": "gntdev_ioctl_grant_copy", "instr_loc": 916, "instr_file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_grant_copy_seg(&batch, &seg, &copy.segments[i].status);"}, {"instr_func": "gntdev_grant_copy_seg", "instr_loc": 856, "instr_file": "drivers/xen/gntdev.c", "instr": "ret = gntdev_get_page(batch, virt, &gfn);"}, {"instr_func": "gntdev_get_page", "instr_loc": 756, "instr_file": "drivers/xen/gntdev.c", "instr": "*gfn = pfn_to_gfn(xen_pfn);"}, {"instr_func": "pfn_to_gfn", "instr_loc": 253, "instr_file": "./arch/x86/include/asm/xen/page.h", "instr": "  %4 = call i32 @xen_feature(i32 2) #14, !dbg !5707"}], "at_file": "./include/xen/features.h", "by": "GlobalVariableRaceDetector says:", "at_func": "xen_feature"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 948, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_notify(priv, ptr);"}],
"warnings":[{"warn_data": {"at_line": 698, "warn_str": "Loop is bounded by a tainted value.", "at": "if (op.index >= begin && op.index < end)", "inst_trace": [{"instr_func": "gntdev_ioctl_notify", "instr_loc": 665, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_notify", "instr_loc": 698, "instr_file": "drivers/xen/gntdev.c", "instr": "if (op.index >= begin && op.index < end)"}, {"instr_func": "gntdev_ioctl_notify", "instr_loc": 698, "instr_file": "drivers/xen/gntdev.c", "instr": "if (op.index >= begin && op.index < end)"}], "at_file": "drivers/xen/gntdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gntdev_ioctl_notify"}, "warn_no": 1},
{"warn_data": {"at_line": 665, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_notify"}, "warn_no": 2},
{"warn_data": {"at_line": 715, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map->notify.addr = op.index - (map->index << PAGE_SHIFT);", "inst_trace": [{"instr_func": "gntdev_ioctl_notify", "instr_loc": 665, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_notify", "instr_loc": 715, "instr_file": "drivers/xen/gntdev.c", "instr": "map->notify.addr = op.index - (map->index << PAGE_SHIFT);"}], "at_file": "drivers/xen/gntdev.c", "by": "IntegerOverflowDetector says:", "at_func": "gntdev_ioctl_notify"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 945, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_get_offset_for_vaddr(priv, ptr);"}],
"warnings":[{"warn_data": {"at_line": 659, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (rv == 0 && copy_to_user(u, &op, sizeof(op)) != 0)", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_get_offset_for_vaddr"}, "warn_no": 1},
{"warn_data": {"at_line": 633, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_get_offset_for_vaddr"}, "warn_no": 2},
{"warn_data": {"at_line": 645, "warn_str": "Trying to use a global variable without locking.", "at": "if (!vma || vma->vm_ops != &gntdev_vmops)", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 945, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_get_offset_for_vaddr(priv, ptr);"}], "at_file": "drivers/xen/gntdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gntdev_ioctl_get_offset_for_vaddr"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 942, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_unmap_grant_ref(priv, ptr);"}],
"warnings":[{"warn_data": {"at_line": 610, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_unmap_grant_ref"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 939, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}],
"warnings":[{"warn_data": {"at_line": 575, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_map_grant_ref"}, "warn_no": 1},
{"warn_data": {"at_line": 599, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "op.index = map->index << PAGE_SHIFT;", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_map_grant_ref"}, "warn_no": 2},
{"warn_data": {"at_line": 591, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(map->grants, &u->refs,", "inst_trace": [], "at_file": "drivers/xen/gntdev.c", "by": "TaintedSizeDetector says:", "at_func": "gntdev_ioctl_map_grant_ref"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 942, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_unmap_grant_ref(priv, ptr);"}, {"lineno": 620, "file": "drivers/xen/gntdev.c", "instr": "map = gntdev_find_map_index(priv, op.index >> PAGE_SHIFT, op.count);"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Loop is bounded by a tainted value.", "at": "if (count && map->count != count)", "inst_trace": [{"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 610, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 620, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_find_map_index(priv, op.index >> PAGE_SHIFT, op.count);"}, {"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 620, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_find_map_index(priv, op.index >> PAGE_SHIFT, op.count);"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 232, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 238, "instr_file": "drivers/xen/gntdev.c", "instr": "if (count && map->count != count)"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 238, "instr_file": "drivers/xen/gntdev.c", "instr": "if (count && map->count != count)"}], "at_file": "drivers/xen/gntdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gntdev_find_map_index"}, "warn_no": 1},
{"warn_data": {"at_line": 238, "warn_str": "Loop is bounded by a tainted value.", "at": "if (count && map->count != count)", "inst_trace": [{"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 610, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 620, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_find_map_index(priv, op.index >> PAGE_SHIFT, op.count);"}, {"instr_func": "gntdev_ioctl_unmap_grant_ref", "instr_loc": 620, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_find_map_index(priv, op.index >> PAGE_SHIFT, op.count);"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 232, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 238, "instr_file": "drivers/xen/gntdev.c", "instr": "if (count && map->count != count)"}, {"instr_func": "gntdev_find_map_index", "instr_loc": 238, "instr_file": "drivers/xen/gntdev.c", "instr": "if (count && map->count != count)"}], "at_file": "drivers/xen/gntdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gntdev_find_map_index"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 939, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"lineno": 583, "file": "drivers/xen/gntdev.c", "instr": "if (unlikely(gntdev_test_page_count(op.count)))"}],
"warnings":[{"warn_data": {"at_line": 74, "warn_str": "Trying to use a global variable without locking.", "at": "return !count || count > limit;", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 939, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 583, "instr_file": "drivers/xen/gntdev.c", "instr": "if (unlikely(gntdev_test_page_count(op.count)))"}], "at_file": "drivers/xen/gntdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gntdev_test_page_count"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 939, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"lineno": 587, "file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}],
"warnings":[{"warn_data": {"at_line": 148, "warn_str": "Trying to use a global variable without locking.", "at": "if (use_ptemod) {", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 939, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 587, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}], "at_file": "drivers/xen/gntdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "gntdev_alloc_map"}, "warn_no": 1},
{"warn_data": {"at_line": 191, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < count; i++) {", "inst_trace": [{"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 575, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 587, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}, {"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 587, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}, {"instr_func": "gntdev_alloc_map", "instr_loc": 128, "instr_file": "drivers/xen/gntdev.c", "instr": "{"}, {"instr_func": "gntdev_alloc_map", "instr_loc": 191, "instr_file": "drivers/xen/gntdev.c", "instr": "for (i = 0; i < count; i++) {"}, {"instr_func": "gntdev_alloc_map", "instr_loc": 191, "instr_file": "drivers/xen/gntdev.c", "instr": "for (i = 0; i < count; i++) {"}], "at_file": "drivers/xen/gntdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "gntdev_alloc_map"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 939, "file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"lineno": 587, "file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}, {"lineno": 132, "file": "drivers/xen/gntdev.c", "instr": "add = kzalloc(sizeof(*add), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !5973", "inst_trace": [{"instr_func": "gntdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i1, align 1"}, {"instr_func": "gntdev_ioctl", "instr_loc": 939, "instr_file": "drivers/xen/gntdev.c", "instr": "return gntdev_ioctl_map_grant_ref(priv, ptr);"}, {"instr_func": "gntdev_ioctl_map_grant_ref", "instr_loc": 587, "instr_file": "drivers/xen/gntdev.c", "instr": "map = gntdev_alloc_map(priv, op.count, 0 /* This is not a dma-buf. */);"}, {"instr_func": "gntdev_alloc_map", "instr_loc": 132, "instr_file": "drivers/xen/gntdev.c", "instr": "add = kzalloc(sizeof(*add), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]}]}