{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 2265, "warn_str": "Loop is bounded by a tainted value.", "at": "} while (count >= bytes_read + sizeof(event));", "inst_trace": [{"instr_func": "lineinfo_watch_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2196, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2265, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "} while (count >= bytes_read + sizeof(event));"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2265, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "} while (count >= bytes_read + sizeof(event));"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "lineinfo_watch_read"}, "warn_no": 1},
{"warn_data": {"at_line": 2235, "warn_str": "Loop is bounded by a tainted value.", "at": "if (count < event_size) {", "inst_trace": [{"instr_func": "lineinfo_watch_read", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2196, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "{"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2235, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "if (count < event_size) {"}, {"instr_func": "lineinfo_watch_read", "instr_loc": 2235, "instr_file": "drivers/gpio/gpiolib-cdev.c", "instr": "if (count < event_size) {"}], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "lineinfo_watch_read"}, "warn_no": 2},
{"warn_data": {"at_line": 2253, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct gpioline_info_changed event_v1;", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_watch_read"}, "warn_no": 3},
{"warn_data": {"leaked_struct": "  %84 = alloca %struct.gpioline_info_changed, align 8", "at_line": 2253, "warn_str": "Potentially leaking memory on kernel stack (via padded fields) into user space", "at": "struct gpioline_info_changed event_v1;", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "KernelUninitMemoryLeakDetector says:", "at_func": "lineinfo_watch_read"}, "warn_no": 4},
{"warn_data": {"at_line": 2250, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(buf + bytes_read, &event, event_size))", "inst_trace": [], "at_file": "drivers/gpio/gpiolib-cdev.c", "by": "TaintedSizeDetector says:", "at_func": "lineinfo_watch_read"}, "warn_no": 5}]}]}