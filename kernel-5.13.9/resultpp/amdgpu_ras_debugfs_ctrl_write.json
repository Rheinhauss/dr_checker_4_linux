{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 366, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_debugfs_ctrl_parse_data(f, buf, size, pos, &data);"}],
"warnings":[{"warn_data": {"at_line": 224, "warn_str": "Tainted Data used in risky function", "at": "else if (strstr(str, \"retire_page\") != NULL)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "ImproperTaintedDataUseDetector says:", "tainted_obj": "  %42 = alloca [65 x i8], align 16", "at_func": "amdgpu_ras_debugfs_ctrl_parse_data"}, "warn_no": 1},
{"warn_data": {"at_line": 210, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*pos = size;", "inst_trace": [], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedSizeDetector says:", "at_func": "amdgpu_ras_debugfs_ctrl_parse_data"}, "warn_no": 2},
{"warn_data": {"at_line": 270, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data, buf, sizeof(*data)))", "inst_trace": [], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedSizeDetector says:", "at_func": "amdgpu_ras_debugfs_ctrl_parse_data"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 366, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_debugfs_ctrl_parse_data(f, buf, size, pos, &data);"}, {"lineno": 242, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_find_block_id_by_name(block_name, &block_id))"}],
"warnings":[{"warn_data": {"at_line": 189, "warn_str": "Trying to use a global variable without locking.", "at": "if (strcmp(name, ras_block_str(i)) == 0)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 366, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_debugfs_ctrl_parse_data(f, buf, size, pos, &data);"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 242, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_find_block_id_by_name(block_name, &block_id))"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_find_block_id_by_name"}, "warn_no": 1},
{"warn_data": {"at_line": 189, "warn_str": "Tainted Data used in risky function", "at": "if (strcmp(name, ras_block_str(i)) == 0)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 218, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"disable %32s\", block_name) == 1)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "ImproperTaintedDataUseDetector says:", "tainted_obj": "  %43 = alloca [33 x i8], align 16", "at_func": "amdgpu_ras_find_block_id_by_name"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 408, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}],
"warnings":[{"warn_data": {"at_line": 1020, "warn_str": "Trying to use a global variable without locking.", "at": "dev_info(adev->dev, \"%s error injection is not supported yet\\n\",", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 408, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_error_inject"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 408, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"lineno": 984, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": ".block_id =  amdgpu_ras_block_to_ta(info->head.block),"}],
"warnings":[{"warn_data": {"at_line": 541, "warn_str": "Trying to use a global variable without locking.", "at": "  %29 = load i8, i8* @amdgpu_ras_block_to_ta.__warned, align 1, !dbg !15529", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 408, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"instr_func": "amdgpu_ras_error_inject", "instr_loc": 984, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": ".block_id =  amdgpu_ras_block_to_ta(info->head.block),"}], "at_file": "./drivers/gpu/drm/amd/amdgpu/../amdgpu/amdgpu_ras.h", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_block_to_ta"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 408, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"lineno": 985, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": ".inject_error_type = amdgpu_ras_error_to_ta(info->head.type),"}],
"warnings":[{"warn_data": {"at_line": 560, "warn_str": "Trying to use a global variable without locking.", "at": "  %20 = load i8, i8* @amdgpu_ras_error_to_ta.__warned, align 1, !dbg !15520", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 408, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"instr_func": "amdgpu_ras_error_inject", "instr_loc": 985, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": ".inject_error_type = amdgpu_ras_error_to_ta(info->head.type),"}], "at_file": "./drivers/gpu/drm/amd/amdgpu/../amdgpu/amdgpu_ras.h", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_error_to_ta"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 408, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"lineno": 1017, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject_xgmi(adev, &block_info);"}, {"lineno": 966, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_intr_triggered())"}],
"warnings":[{"warn_data": {"at_line": 615, "warn_str": "Trying to use a global variable without locking.", "at": "  store %struct.atomic_t* @amdgpu_ras_in_intr, %struct.atomic_t** %4, align 8", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 408, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject(adev, &data.inject);"}, {"instr_func": "amdgpu_ras_error_inject", "instr_loc": 1017, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_error_inject_xgmi(adev, &block_info);"}, {"instr_func": "amdgpu_ras_error_inject_xgmi", "instr_loc": 966, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_intr_triggered())"}], "at_file": "./drivers/gpu/drm/amd/amdgpu/../amdgpu/amdgpu_ras.h", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_intr_triggered"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 386, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}],
"warnings":[{"warn_data": {"at_line": 713, "warn_str": "Trying to use a global variable without locking.", "at": "ras_block_str(head->block),", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 386, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_ras_feature_enable"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 386, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}, {"lineno": 684, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "info = kzalloc(sizeof(union ta_ras_cmd_input), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 557, "warn_str": "Trying to use a global variable without locking.", "at": "  %234 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %233, !dbg !15779", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 386, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}, {"instr_func": "amdgpu_ras_feature_enable", "instr_loc": 684, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "info = kzalloc(sizeof(union ta_ras_cmd_input), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 386, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}],
"warnings":[{"warn_data": {"at_line": 656, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "get_obj(obj);", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "__amdgpu_ras_feature_enable", "instr_loc": 656, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "get_obj(obj);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "__amdgpu_ras_feature_enable"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 386, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 1);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}, {"lineno": 651, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "obj = amdgpu_ras_create_obj(adev, head);"}],
"warnings":[{"warn_data": {"at_line": 548, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "get_obj(obj);", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_create_obj", "instr_loc": 548, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "get_obj(obj);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_create_obj"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 383, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 0);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}],
"warnings":[{"warn_data": {"at_line": 656, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "get_obj(obj);", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "__amdgpu_ras_feature_enable", "instr_loc": 656, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "get_obj(obj);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "__amdgpu_ras_feature_enable"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 383, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 0);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}, {"lineno": 636, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "struct ras_manager *obj = amdgpu_ras_find_obj(adev, head);"}],
"warnings":[{"warn_data": {"at_line": 577, "warn_str": "Loop is bounded by a tainted value.", "at": "if (alive_obj(obj)) {", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_find_obj", "instr_loc": 577, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (alive_obj(obj)) {"}, {"instr_func": "amdgpu_ras_find_obj", "instr_loc": 577, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (alive_obj(obj)) {"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedLoopBoundDetector says:", "at_func": "amdgpu_ras_find_obj"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 383, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 0);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}, {"lineno": 666, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "put_obj(obj);"}],
"warnings":[{"warn_data": {"at_line": 521, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (obj && (--obj->use == 0))", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "put_obj", "instr_loc": 521, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (obj && (--obj->use == 0))"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "put_obj"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 383, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_feature_enable(adev, &data.head, 0);"}, {"lineno": 725, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "__amdgpu_ras_feature_enable(adev, head, enable);"}, {"lineno": 651, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "obj = amdgpu_ras_create_obj(adev, head);"}],
"warnings":[{"warn_data": {"at_line": 548, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "get_obj(obj);", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_create_obj", "instr_loc": 548, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "get_obj(obj);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_create_obj"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}],
"warnings":[{"warn_data": {"at_line": 132, "warn_str": "Trying to use a global variable without locking.", "at": "if (amdgpu_bad_page_threshold != 0) {", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_write", "instr_loc": 371, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "GlobalVariableRaceDetector says:", "at_func": "amdgpu_reserve_page_direct"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}, {"lineno": 115, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_check_bad_page(adev, address)) {"}, {"lineno": 1874, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_ras_check_bad_page_unlock(con, addr);"}],
"warnings":[{"warn_data": {"at_line": 1853, "warn_str": "Trying to read from a user pointer.", "at": "if (addr == data->bps[i].retired_page)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 1},
{"warn_data": {"at_line": 1853, "warn_str": "Loop is bounded by a tainted value.", "at": "if (addr == data->bps[i].retired_page)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedLoopBoundDetector says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 2},
{"warn_data": {"at_line": 1852, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < data->count; i++)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1852, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "for (i = 0; i < data->count; i++)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1852, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "for (i = 0; i < data->count; i++)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedLoopBoundDetector says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}, {"lineno": 133, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "amdgpu_ras_add_bad_pages(adev, err_data.err_addr,"}],
"warnings":[{"warn_data": {"at_line": 1770, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data->count++;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_add_bad_pages"}, "warn_no": 1},
{"warn_data": {"at_line": 1771, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data->space_left--;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1771, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->space_left--;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_add_bad_pages"}, "warn_no": 2}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}, {"lineno": 133, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "amdgpu_ras_add_bad_pages(adev, err_data.err_addr,"}, {"lineno": 1759, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "amdgpu_ras_realloc_eh_data_space(adev, data, 256)) {"}],
"warnings":[{"warn_data": {"at_line": 1715, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned int old_space = data->count + data->space_left;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 1},
{"warn_data": {"at_line": 1716, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned int new_space = old_space + pages;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 2},
{"warn_data": {"at_line": 1717, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned int align_space = ALIGN(new_space, 512);", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 3},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "{", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 4},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "{", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 5},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "{", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 6},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "{", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 7},
{"warn_data": {"at_line": 1714, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "{", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1718, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "void *bps = kmalloc(align_space * sizeof(*data->bps), GFP_KERNEL);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1714, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "{"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 8},
{"warn_data": {"at_line": 1732, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data->space_left += align_space - old_space;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1732, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->space_left += align_space - old_space;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 9},
{"warn_data": {"at_line": 1732, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data->space_left += align_space - old_space;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1715, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int old_space = data->count + data->space_left;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1716, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int new_space = old_space + pages;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1717, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "unsigned int align_space = ALIGN(new_space, 512);"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1732, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->space_left += align_space - old_space;"}, {"instr_func": "amdgpu_ras_realloc_eh_data_space", "instr_loc": 1732, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->space_left += align_space - old_space;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_realloc_eh_data_space"}, "warn_no": 10}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}, {"lineno": 133, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "amdgpu_ras_add_bad_pages(adev, err_data.err_addr,"}, {"lineno": 1754, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (amdgpu_ras_check_bad_page_unlock(con,"}],
"warnings":[{"warn_data": {"at_line": 1853, "warn_str": "Trying to read from a user pointer.", "at": "if (addr == data->bps[i].retired_page)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 1},
{"warn_data": {"at_line": 1853, "warn_str": "Loop is bounded by a tainted value.", "at": "if (addr == data->bps[i].retired_page)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1853, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (addr == data->bps[i].retired_page)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedLoopBoundDetector says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 2},
{"warn_data": {"at_line": 1852, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < data->count; i++)", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_add_bad_pages", "instr_loc": 1770, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "data->count++;"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1852, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "for (i = 0; i < data->count; i++)"}, {"instr_func": "amdgpu_ras_check_bad_page_unlock", "instr_loc": 1852, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "for (i = 0; i < data->count; i++)"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "TaintedLoopBoundDetector says:", "at_func": "amdgpu_ras_check_bad_page_unlock"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 371, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "ret = amdgpu_reserve_page_direct(adev, data.inject.address);"}, {"lineno": 135, "file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "amdgpu_ras_save_bad_pages(adev);"}],
"warnings":[{"warn_data": {"at_line": 1795, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "save_count = data->count - control->num_recs;", "inst_trace": [{"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 210, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "*pos = size;"}, {"instr_func": "amdgpu_ras_debugfs_ctrl_parse_data", "instr_loc": 257, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "if (sscanf(str, \"%*s %*s %*s 0x%x 0x%llx 0x%llx\","}, {"instr_func": "amdgpu_ras_save_bad_pages", "instr_loc": 1795, "instr_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "instr": "save_count = data->count - control->num_recs;"}], "at_file": "drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c", "by": "IntegerOverflowDetector says:", "at_func": "amdgpu_ras_save_bad_pages"}, "warn_no": 1}]}]}