{"all_contexts":[
{"num_warnings": 17,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 582, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&hdr, buf, sizeof(hdr)))", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 1},
{"warn_data": {"at_line": 574, "warn_str": "Trying to use a global variable without locking.", "at": "pr_err_once(\"uverbs_write: process %d (%s) changed security contexts after opening file descriptor, this is not allowed.\\n\",", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 2},
{"warn_data": {"at_line": 589, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 589, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 589, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 3},
{"warn_data": {"at_line": 592, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ex_hdr, buf + sizeof(hdr), sizeof(ex_hdr)))", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 4},
{"warn_data": {"at_line": 608, "warn_str": "Trying to read from a user pointer.", "at": "if (!method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %32 = load i32, i32* %6, align 4, !dbg !15171"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %34 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %31, i64 %33, !dbg !15169"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %35 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %34, align 8, !dbg !15169"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %35, %struct.uverbs_api_write_method** %3, align 8, !dbg !15172"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 608, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!method_elm->is_ex) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 608, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 5},
{"warn_data": {"at_line": 609, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 6},
{"warn_data": {"at_line": 613, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_udata) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 613, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 613, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 7},
{"warn_data": {"at_line": 615, "warn_str": "Trying to read from a user pointer.", "at": "in_len - method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 615, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 615, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 8},
{"warn_data": {"at_line": 615, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "in_len - method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 609, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 615, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 9},
{"warn_data": {"at_line": 616, "warn_str": "Trying to read from a user pointer.", "at": "in_len = method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 616, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len = method_elm->req_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 616, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len = method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 10},
{"warn_data": {"at_line": 626, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_resp) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 626, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_resp) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 626, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_resp) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 11},
{"warn_data": {"at_line": 636, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_udata) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 12},
{"warn_data": {"at_line": 638, "warn_str": "Trying to read from a user pointer.", "at": "out_len - method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 638, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 638, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 13},
{"warn_data": {"at_line": 638, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "out_len - method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 638, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 14},
{"warn_data": {"at_line": 639, "warn_str": "Trying to read from a user pointer.", "at": "out_len = method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 639, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len = method_elm->resp_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 639, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len = method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 15},
{"warn_data": {"at_line": 642, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u64_to_user_ptr(response +", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 610, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 642, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "u64_to_user_ptr(response +"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 16},
{"warn_data": {"at_line": 670, "warn_str": "Trying to read from a user pointer.", "at": "ret = method_elm->handler(&bundle);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 670, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = method_elm->handler(&bundle);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 670, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = method_elm->handler(&bundle);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 17}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 585, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}],
"warnings":[{"warn_data": {"at_line": 184, "warn_str": "Trying to read from a user pointer.", "at": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}], "at_file": "drivers/infiniband/core/rdma_core.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_method"}, "warn_no": 1},
{"warn_data": {"at_line": 179, "warn_str": "Trying to read from a user pointer.", "at": "  %35 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %34, align 8, !dbg !15169", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %32 = load i32, i32* %6, align 4, !dbg !15171"}, {"instr_func": "uapi_get_method", "instr_loc": 179, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %34 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %31, i64 %33, !dbg !15169"}], "at_file": "drivers/infiniband/core/rdma_core.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_method"}, "warn_no": 2}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 596, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}],
"warnings":[{"warn_data": {"at_line": 506, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 506, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}, {"instr_func": "verify_hdr", "instr_loc": 506, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 1},
{"warn_data": {"at_line": 540, "warn_str": "Trying to read from a user pointer.", "at": "if (count < method_elm->req_size + sizeof(hdr)) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 540, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 540, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 2},
{"warn_data": {"at_line": 540, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (count < method_elm->req_size + sizeof(hdr)) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 540, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 540, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 540, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 3},
{"warn_data": {"at_line": 555, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->out_words * 4 < method_elm->resp_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 555, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 4 < method_elm->resp_size)"}, {"instr_func": "verify_hdr", "instr_loc": 555, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 4 < method_elm->resp_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 4},
{"warn_data": {"at_line": 507, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count -= sizeof(*hdr) + sizeof(*ex_hdr);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "ib_uverbs_write", "instr_loc": 563, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 507, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "count -= sizeof(*hdr) + sizeof(*ex_hdr);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 5},
{"warn_data": {"at_line": 509, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if ((hdr->in_words + ex_hdr->provider_in_words) * 8 != count)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 509, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if ((hdr->in_words + ex_hdr->provider_in_words) * 8 != count)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 6},
{"warn_data": {"at_line": 512, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->in_words * 8 < method_elm->req_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 512, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->in_words * 8 < method_elm->req_size)"}, {"instr_func": "verify_hdr", "instr_loc": 512, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->in_words * 8 < method_elm->req_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 7},
{"warn_data": {"at_line": 522, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->out_words * 8 < method_elm->resp_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 169, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !15148"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !15149"}, {"instr_func": "uapi_get_method", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !15147"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !15183"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %48, i64 %50, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %51, align 8, !dbg !15181"}, {"instr_func": "uapi_get_method", "instr_loc": 184, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method* %52, %struct.uverbs_api_write_method** %3, align 8, !dbg !15184"}, {"instr_func": "uapi_get_method", "instr_loc": 185, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method*, %struct.uverbs_api_write_method** %3, align 8, !dbg !15185"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 585, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 596, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 505, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 522, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 8 < method_elm->resp_size)"}, {"instr_func": "verify_hdr", "instr_loc": 522, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 8 < method_elm->resp_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 8},
{"warn_data": {"at_line": 525, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 9}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 596, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"lineno": 525, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !15154", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 32, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !15153"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 29, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !15151", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 582, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 525, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 20, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 29, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !15151"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]}]}