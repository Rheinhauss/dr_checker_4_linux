{"all_contexts":[
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.spinlock*, align 8"}],
"warnings":[{"warn_data": {"at_line": 160, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "u32 m;", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 169, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < m; i++)", "inst_trace": [{"instr_func": "phantom_ioctl", "instr_loc": 160, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m;"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 165, "instr_file": "drivers/misc/phantom.c", "instr": "m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 169, "instr_file": "drivers/misc/phantom.c", "instr": "for (i = 0; i < m; i++)"}, {"instr_func": "phantom_ioctl", "instr_loc": 169, "instr_file": "drivers/misc/phantom.c", "instr": "for (i = 0; i < m; i++)"}], "at_file": "drivers/misc/phantom.c", "by": "TaintedLoopBoundDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 172, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "atomic_set(&dev->counter, 0);", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 147, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&r, argp, sizeof(r)))", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 153, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "r.value = ioread32(dev->iaddr + r.reg);", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 129, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&rs, argp, sizeof(rs)))", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 138, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < m; i++)", "inst_trace": [{"instr_func": "phantom_ioctl", "instr_loc": 160, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m;"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 137, "instr_file": "drivers/misc/phantom.c", "instr": "u32 m = min(rs.count, 8U);"}, {"instr_func": "phantom_ioctl", "instr_loc": 138, "instr_file": "drivers/misc/phantom.c", "instr": "for (i = 0; i < m; i++)"}, {"instr_func": "phantom_ioctl", "instr_loc": 138, "instr_file": "drivers/misc/phantom.c", "instr": "for (i = 0; i < m; i++)"}], "at_file": "drivers/misc/phantom.c", "by": "TaintedLoopBoundDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 98, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&r, argp, sizeof(r)))", "inst_trace": [], "at_file": "drivers/misc/phantom.c", "by": "TaintedSizeDetector says:", "at_func": "phantom_ioctl"}, "warn_no": 8}]}]}