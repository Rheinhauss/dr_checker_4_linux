{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}],
"warnings":[{"warn_data": {"at_line": 785, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {", "inst_trace": [], "at_file": "drivers/infiniband/core/user_mad.c", "by": "TaintedSizeDetector says:", "at_func": "ib_umad_reg_agent2"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}],
"warnings":[{"warn_data": {"at_line": 436, "warn_str": "Trying to read from a user pointer.", "at": "mgmt_class_version].class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 438, "warn_str": "Trying to read from a user pointer.", "at": "method = class->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 2},
{"warn_data": {"at_line": 450, "warn_str": "Trying to read from a user pointer.", "at": "mgmt_class_version].vendor;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 3},
{"warn_data": {"at_line": 453, "warn_str": "Trying to read from a user pointer.", "at": "vendor_class = vendor->vendor_class[vclass];", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 409, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = ib_mad_agent_security_setup(&mad_agent_priv->agent, qp_type);"}, {"lineno": 701, "file": "drivers/infiniband/core/security.c", "instr": "if (!rdma_protocol_ib(agent->device, agent->port_num))"}],
"warnings":[{"warn_data": {"at_line": 2928, "warn_str": "Trying to read from a user pointer.", "at": "  %13 = load i32, i32* %12, align 8, !dbg !545969", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %7 = load %struct.ib_port_data*, %struct.ib_port_data** %6, align 8, !dbg !545966"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %10 = getelementptr %struct.ib_port_data, %struct.ib_port_data* %7, i64 %9, !dbg !545965"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %11 = getelementptr inbounds %struct.ib_port_data, %struct.ib_port_data* %10, i32 0, i32 1, !dbg !545968"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %12 = getelementptr inbounds %struct.ethtool_pauseparam, %struct.ethtool_pauseparam* %11, i32 0, i32 2, !dbg !545969"}], "at_file": "./include/rdma/ib_verbs.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_protocol_ib.2178"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 440, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(&method,"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 2}]},
{"num_warnings": 14,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}],
"warnings":[{"warn_data": {"at_line": 1524, "warn_str": "Trying to read from a user pointer.", "at": "if (!*class) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1524, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*class) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1526, "warn_str": "Trying to write to a user pointer.", "at": "*class = kzalloc(sizeof **class, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1526, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*class = kzalloc(sizeof **class, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1527, "warn_str": "Trying to read from a user pointer.", "at": "if (!*class) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1527, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*class) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1533, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*class)->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 4},
{"warn_data": {"at_line": 1567, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*class);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1567, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*class);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 5},
{"warn_data": {"at_line": 1568, "warn_str": "Trying to write to a user pointer.", "at": "*class = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1568, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*class = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 6},
{"warn_data": {"at_line": 1537, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*class)->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 7},
{"warn_data": {"at_line": 1538, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1538, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 8},
{"warn_data": {"at_line": 1551, "warn_str": "Trying to write to a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 9},
{"warn_data": {"at_line": 1551, "warn_str": "Trying to read from a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 10},
{"warn_data": {"at_line": 1557, "warn_str": "Trying to read from a user pointer.", "at": "remove_methods_mad_agent(*method, agent_priv);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 11},
{"warn_data": {"at_line": 1559, "warn_str": "Trying to read from a user pointer.", "at": "if (!check_method_table(*method)) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 12},
{"warn_data": {"at_line": 1562, "warn_str": "Trying to write to a user pointer.", "at": "*method = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1562, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 13},
{"warn_data": {"at_line": 1561, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*method);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1561, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*method);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 14}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1534, "file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1540, "file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1546, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 2},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1557, "file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1508, "warn_str": "Trying to write to a user pointer.", "at": "method->agent[i] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 1507, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i] == agent) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1559, "file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}],
"warnings":[{"warn_data": {"at_line": 1448, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "check_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1448, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "check_method_table"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 452, "file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}],
"warnings":[{"warn_data": {"at_line": 172, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 452, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 452, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "IntegerOverflowDetector says:", "at_func": "vendor_class_index"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 455, "file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}],
"warnings":[{"warn_data": {"at_line": 199, "warn_str": "Trying to read from a user pointer.", "at": "method = vendor_class->method_table[i];", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 200, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 200, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method) {"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 200, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "is_vendor_method_in_use"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 455, "file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"lineno": 201, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(&method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 2}]},
{"num_warnings": 27,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1589, "warn_str": "Trying to read from a user pointer.", "at": "if (!*vendor_table) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1589, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*vendor_table) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1595, "warn_str": "Trying to write to a user pointer.", "at": "*vendor_table = vendor;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1595, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*vendor_table = vendor;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1597, "warn_str": "Trying to read from a user pointer.", "at": "if (!(*vendor_table)->vendor_class[vclass]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1597, "warn_str": "Trying to read from a user pointer.", "at": "if (!(*vendor_table)->vendor_class[vclass]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 4},
{"warn_data": {"at_line": 1603, "warn_str": "Trying to read from a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = vendor_class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 5},
{"warn_data": {"at_line": 1603, "warn_str": "Trying to write to a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = vendor_class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 6},
{"warn_data": {"at_line": 1607, "warn_str": "Trying to read from a user pointer.", "at": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 7},
{"warn_data": {"at_line": 1607, "warn_str": "Trying to read from a user pointer.", "at": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 8},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "if (!is_vendor_oui((*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 9},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "if (!is_vendor_oui((*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 10},
{"warn_data": {"at_line": 1620, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 11},
{"warn_data": {"at_line": 1620, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 12},
{"warn_data": {"at_line": 1623, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1623, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 13},
{"warn_data": {"at_line": 1628, "warn_str": "Trying to read from a user pointer.", "at": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 14},
{"warn_data": {"at_line": 1628, "warn_str": "Trying to read from a user pointer.", "at": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 15},
{"warn_data": {"at_line": 1609, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 16},
{"warn_data": {"at_line": 1609, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 17},
{"warn_data": {"at_line": 1611, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method)", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1611, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method)"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 18},
{"warn_data": {"at_line": 1643, "warn_str": "Trying to read from a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 19},
{"warn_data": {"at_line": 1643, "warn_str": "Trying to write to a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 20},
{"warn_data": {"at_line": 1649, "warn_str": "Trying to read from a user pointer.", "at": "remove_methods_mad_agent(*method, agent_priv);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 21},
{"warn_data": {"at_line": 1651, "warn_str": "Trying to read from a user pointer.", "at": "if (!check_method_table(*method)) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 22},
{"warn_data": {"at_line": 1653, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*method);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1653, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*method);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 23},
{"warn_data": {"at_line": 1654, "warn_str": "Trying to write to a user pointer.", "at": "*method = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1654, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 24},
{"warn_data": {"at_line": 1659, "warn_str": "Trying to read from a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 25},
{"warn_data": {"at_line": 1659, "warn_str": "Trying to write to a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 26},
{"warn_data": {"at_line": 1664, "warn_str": "Trying to write to a user pointer.", "at": "*vendor_table = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1664, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*vendor_table = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 27}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1585, "file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}],
"warnings":[{"warn_data": {"at_line": 172, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "IntegerOverflowDetector says:", "at_func": "vendor_class_index"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1618, "file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}],
"warnings":[{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 1},
{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 2},
{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1624, "file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1638, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 825, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 2},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1649, "file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1508, "warn_str": "Trying to write to a user pointer.", "at": "method->agent[i] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 1507, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i] == agent) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1651, "file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}],
"warnings":[{"warn_data": {"at_line": 1448, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent2", "instr_loc": 826, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "check_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1448, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "check_method_table"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 939, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent2(filp->private_data, (void __user *) arg);"}, {"lineno": 841, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 476, "file": "drivers/infiniband/core/mad.c", "instr": "ib_mad_agent_security_cleanup(&mad_agent_priv->agent);"}, {"lineno": 733, "file": "drivers/infiniband/core/security.c", "instr": "if (!rdma_protocol_ib(agent->device, agent->port_num))"}],
"warnings":[{"warn_data": {"at_line": 2928, "warn_str": "Trying to read from a user pointer.", "at": "  %13 = load i32, i32* %12, align 8, !dbg !545969", "inst_trace": [{"instr_func": "ib_umad_reg_agent2", "instr_loc": 785, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof(ureq))) {"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %7 = load %struct.ib_port_data*, %struct.ib_port_data** %6, align 8, !dbg !545966"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %10 = getelementptr %struct.ib_port_data, %struct.ib_port_data* %7, i64 %9, !dbg !545965"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %11 = getelementptr inbounds %struct.ib_port_data, %struct.ib_port_data* %10, i32 0, i32 1, !dbg !545968"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %12 = getelementptr inbounds %struct.ethtool_pauseparam, %struct.ethtool_pauseparam* %11, i32 0, i32 2, !dbg !545969"}], "at_file": "./include/rdma/ib_verbs.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_protocol_ib.2178"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}],
"warnings":[{"warn_data": {"at_line": 683, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ureq, arg, sizeof ureq)) {", "inst_trace": [], "at_file": "drivers/infiniband/core/user_mad.c", "by": "TaintedSizeDetector says:", "at_func": "ib_umad_reg_agent"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}],
"warnings":[{"warn_data": {"at_line": 436, "warn_str": "Trying to read from a user pointer.", "at": "mgmt_class_version].class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 438, "warn_str": "Trying to read from a user pointer.", "at": "method = class->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 2},
{"warn_data": {"at_line": 450, "warn_str": "Trying to read from a user pointer.", "at": "mgmt_class_version].vendor;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 3},
{"warn_data": {"at_line": 453, "warn_str": "Trying to read from a user pointer.", "at": "vendor_class = vendor->vendor_class[vclass];", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_register_mad_agent"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 409, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = ib_mad_agent_security_setup(&mad_agent_priv->agent, qp_type);"}, {"lineno": 701, "file": "drivers/infiniband/core/security.c", "instr": "if (!rdma_protocol_ib(agent->device, agent->port_num))"}],
"warnings":[{"warn_data": {"at_line": 2928, "warn_str": "Trying to read from a user pointer.", "at": "  %13 = load i32, i32* %12, align 8, !dbg !545969", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %7 = load %struct.ib_port_data*, %struct.ib_port_data** %6, align 8, !dbg !545966"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %10 = getelementptr %struct.ib_port_data, %struct.ib_port_data* %7, i64 %9, !dbg !545965"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %11 = getelementptr inbounds %struct.ib_port_data, %struct.ib_port_data* %10, i32 0, i32 1, !dbg !545968"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %12 = getelementptr inbounds %struct.ethtool_pauseparam, %struct.ethtool_pauseparam* %11, i32 0, i32 2, !dbg !545969"}], "at_file": "./include/rdma/ib_verbs.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_protocol_ib.2178"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 440, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(&method,"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 435, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 438, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = class->method_table[mgmt_class];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 2}]},
{"num_warnings": 14,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}],
"warnings":[{"warn_data": {"at_line": 1524, "warn_str": "Trying to read from a user pointer.", "at": "if (!*class) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1524, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*class) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1526, "warn_str": "Trying to write to a user pointer.", "at": "*class = kzalloc(sizeof **class, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1526, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*class = kzalloc(sizeof **class, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1527, "warn_str": "Trying to read from a user pointer.", "at": "if (!*class) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1527, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*class) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1533, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*class)->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 4},
{"warn_data": {"at_line": 1567, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*class);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1567, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*class);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 5},
{"warn_data": {"at_line": 1568, "warn_str": "Trying to write to a user pointer.", "at": "*class = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1568, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*class = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 6},
{"warn_data": {"at_line": 1537, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*class)->method_table[mgmt_class];", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 7},
{"warn_data": {"at_line": 1538, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1538, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 8},
{"warn_data": {"at_line": 1551, "warn_str": "Trying to write to a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 9},
{"warn_data": {"at_line": 1551, "warn_str": "Trying to read from a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1551, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 10},
{"warn_data": {"at_line": 1557, "warn_str": "Trying to read from a user pointer.", "at": "remove_methods_mad_agent(*method, agent_priv);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 11},
{"warn_data": {"at_line": 1559, "warn_str": "Trying to read from a user pointer.", "at": "if (!check_method_table(*method)) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 12},
{"warn_data": {"at_line": 1561, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*method);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1561, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*method);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 13},
{"warn_data": {"at_line": 1562, "warn_str": "Trying to write to a user pointer.", "at": "*method = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1562, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_nonoui_reg_req"}, "warn_no": 14}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1534, "file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1534, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1540, "file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1522, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1523, "instr_file": "drivers/infiniband/core/mad.c", "instr": "class = &port_priv->version[mad_reg_req->mgmt_class_version].class;"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1540, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((ret = allocate_method_table(method)))"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1546, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 2},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1546, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1557, "file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1508, "warn_str": "Trying to write to a user pointer.", "at": "method->agent[i] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 1507, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i] == agent) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1533, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1557, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 445, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"lineno": 1559, "file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}],
"warnings":[{"warn_data": {"at_line": 1448, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "check_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1448, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 446, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 445, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_nonoui_reg_req(mad_reg_req, mad_agent_priv,"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1516, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1537, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*class)->method_table[mgmt_class];"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_nonoui_reg_req", "instr_loc": 1559, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "check_method_table"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 452, "file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}],
"warnings":[{"warn_data": {"at_line": 172, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "convert_mgmt_class", "instr_loc": 151, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "convert_mgmt_class", "instr_loc": 154, "instr_file": "drivers/infiniband/core/mad.c", "instr": "0 : mgmt_class;"}, {"instr_func": "convert_mgmt_class", "instr_loc": 153, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class == IB_MGMT_CLASS_SUBN_DIRECTED_ROUTE ?"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 433, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class = convert_mgmt_class(mad_reg_req->mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 452, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 452, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "IntegerOverflowDetector says:", "at_func": "vendor_class_index"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 455, "file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}],
"warnings":[{"warn_data": {"at_line": 199, "warn_str": "Trying to read from a user pointer.", "at": "method = vendor_class->method_table[i];", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 200, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 200, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method) {"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 200, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "is_vendor_method_in_use"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 455, "file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"lineno": 201, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(&method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 450, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mgmt_class_version].vendor;"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 449, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor = port_priv->version[mad_reg_req->"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 453, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class = vendor->vendor_class[vclass];"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 456, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_class,"}, {"instr_func": "ib_register_mad_agent", "instr_loc": 455, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (is_vendor_method_in_use("}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 193, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "is_vendor_method_in_use", "instr_loc": 199, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = vendor_class->method_table[i];"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 2}]},
{"num_warnings": 27,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1589, "warn_str": "Trying to read from a user pointer.", "at": "if (!*vendor_table) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1589, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*vendor_table) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 1},
{"warn_data": {"at_line": 1595, "warn_str": "Trying to write to a user pointer.", "at": "*vendor_table = vendor;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1595, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*vendor_table = vendor;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 2},
{"warn_data": {"at_line": 1597, "warn_str": "Trying to read from a user pointer.", "at": "if (!(*vendor_table)->vendor_class[vclass]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 3},
{"warn_data": {"at_line": 1597, "warn_str": "Trying to read from a user pointer.", "at": "if (!(*vendor_table)->vendor_class[vclass]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1597, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!(*vendor_table)->vendor_class[vclass]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 4},
{"warn_data": {"at_line": 1603, "warn_str": "Trying to read from a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = vendor_class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 5},
{"warn_data": {"at_line": 1603, "warn_str": "Trying to write to a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = vendor_class;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1603, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = vendor_class;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 6},
{"warn_data": {"at_line": 1607, "warn_str": "Trying to read from a user pointer.", "at": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 7},
{"warn_data": {"at_line": 1607, "warn_str": "Trying to read from a user pointer.", "at": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1607, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!memcmp((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 8},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "if (!is_vendor_oui((*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 9},
{"warn_data": {"at_line": 1618, "warn_str": "Trying to read from a user pointer.", "at": "if (!is_vendor_oui((*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 10},
{"warn_data": {"at_line": 1620, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 11},
{"warn_data": {"at_line": 1620, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 12},
{"warn_data": {"at_line": 1623, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1623, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 13},
{"warn_data": {"at_line": 1628, "warn_str": "Trying to read from a user pointer.", "at": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 14},
{"warn_data": {"at_line": 1628, "warn_str": "Trying to read from a user pointer.", "at": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1628, "instr_file": "drivers/infiniband/core/mad.c", "instr": "memcpy((*vendor_table)->vendor_class[vclass]->oui[i],"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 15},
{"warn_data": {"at_line": 1609, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 16},
{"warn_data": {"at_line": 1609, "warn_str": "Trying to read from a user pointer.", "at": "method = &(*vendor_table)->vendor_class[", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 17},
{"warn_data": {"at_line": 1611, "warn_str": "Trying to read from a user pointer.", "at": "if (!*method)", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1611, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!*method)"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 18},
{"warn_data": {"at_line": 1643, "warn_str": "Trying to read from a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 19},
{"warn_data": {"at_line": 1643, "warn_str": "Trying to write to a user pointer.", "at": "(*method)->agent[i] = agent_priv;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1643, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*method)->agent[i] = agent_priv;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 20},
{"warn_data": {"at_line": 1649, "warn_str": "Trying to read from a user pointer.", "at": "remove_methods_mad_agent(*method, agent_priv);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 21},
{"warn_data": {"at_line": 1651, "warn_str": "Trying to read from a user pointer.", "at": "if (!check_method_table(*method)) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 22},
{"warn_data": {"at_line": 1653, "warn_str": "Trying to read from a user pointer.", "at": "kfree(*method);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1653, "instr_file": "drivers/infiniband/core/mad.c", "instr": "kfree(*method);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 23},
{"warn_data": {"at_line": 1654, "warn_str": "Trying to write to a user pointer.", "at": "*method = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1654, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 24},
{"warn_data": {"at_line": 1659, "warn_str": "Trying to read from a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 25},
{"warn_data": {"at_line": 1659, "warn_str": "Trying to write to a user pointer.", "at": "(*vendor_table)->vendor_class[vclass] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1659, "instr_file": "drivers/infiniband/core/mad.c", "instr": "(*vendor_table)->vendor_class[vclass] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 26},
{"warn_data": {"at_line": 1664, "warn_str": "Trying to write to a user pointer.", "at": "*vendor_table = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1664, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*vendor_table = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_oui_reg_req"}, "warn_no": 27}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1585, "file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}],
"warnings":[{"warn_data": {"at_line": 172, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "IntegerOverflowDetector says:", "at_func": "vendor_class_index"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1618, "file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}],
"warnings":[{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 1},
{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 2},
{"warn_data": {"at_line": 185, "warn_str": "Trying to read from a user pointer.", "at": "if (oui[0] || oui[1] || oui[2])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1619, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->oui[i])) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1618, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!is_vendor_oui((*vendor_table)->vendor_class["}, {"instr_func": "is_vendor_oui", "instr_loc": 184, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}, {"instr_func": "is_vendor_oui", "instr_loc": 185, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (oui[0] || oui[1] || oui[2])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_vendor_oui"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1624, "file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}],
"warnings":[{"warn_data": {"at_line": 1436, "warn_str": "Trying to write to a user pointer.", "at": "*method = kzalloc(sizeof **method, GFP_ATOMIC);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 709, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class         = ureq.mgmt_class;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "vendor_class_index", "instr_loc": 171, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "vendor_class_index", "instr_loc": 172, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return mgmt_class - IB_MGMT_CLASS_VENDOR_RANGE2_START;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1585, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass = vendor_class_index(mad_reg_req->mgmt_class);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1436, "instr_file": "drivers/infiniband/core/mad.c", "instr": "*method = kzalloc(sizeof **method, GFP_ATOMIC);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1437, "warn_str": "Trying to read from a user pointer.", "at": "return (*method) ? 0 : (-ENOMEM);", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1624, "instr_file": "drivers/infiniband/core/mad.c", "instr": "ret = allocate_method_table(method);"}, {"instr_func": "allocate_method_table", "instr_loc": 1434, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "allocate_method_table", "instr_loc": 1437, "instr_file": "drivers/infiniband/core/mad.c", "instr": "return (*method) ? 0 : (-ENOMEM);"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "allocate_method_table"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1638, "file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}],
"warnings":[{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 1},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "method_in_use"}, "warn_no": 2},
{"warn_data": {"at_line": 1425, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((*method)->agent[i]) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1586, "instr_file": "drivers/infiniband/core/mad.c", "instr": "port_priv = agent_priv->qp_info->port_priv;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1610, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1609, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1638, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method_in_use(method, mad_reg_req))"}, {"instr_func": "method_in_use", "instr_loc": 1421, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}, {"instr_func": "method_in_use", "instr_loc": 1425, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if ((*method)->agent[i]) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "method_in_use"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1649, "file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}],
"warnings":[{"warn_data": {"at_line": 1508, "warn_str": "Trying to write to a user pointer.", "at": "method->agent[i] = NULL;", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1508, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method->agent[i] = NULL;"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 1},
{"warn_data": {"at_line": 1507, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i] == agent) {", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1649, "instr_file": "drivers/infiniband/core/mad.c", "instr": "remove_methods_mad_agent(*method, agent_priv);"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1502, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}, {"instr_func": "remove_methods_mad_agent", "instr_loc": 1507, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i] == agent) {"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "remove_methods_mad_agent"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 461, "file": "drivers/infiniband/core/mad.c", "instr": "ret2 = add_oui_reg_req(mad_reg_req, mad_agent_priv);"}, {"lineno": 1651, "file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}],
"warnings":[{"warn_data": {"at_line": 1448, "warn_str": "Trying to read from a user pointer.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "check_method_table"}, "warn_no": 1},
{"warn_data": {"at_line": 1448, "warn_str": "Loop is bounded by a tainted value.", "at": "if (method->agent[i])", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "ib_umad_reg_agent", "instr_loc": 710, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "req.mgmt_class_version = ureq.mgmt_class_version;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1588, "instr_file": "drivers/infiniband/core/mad.c", "instr": "mad_reg_req->mgmt_class_version].vendor;"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1587, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vendor_table = &port_priv->version["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1621, "instr_file": "drivers/infiniband/core/mad.c", "instr": "vclass]->method_table[i];"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1620, "instr_file": "drivers/infiniband/core/mad.c", "instr": "method = &(*vendor_table)->vendor_class["}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "add_oui_reg_req", "instr_loc": 1651, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (!check_method_table(*method)) {"}, {"instr_func": "check_method_table", "instr_loc": 1444, "instr_file": "drivers/infiniband/core/mad.c", "instr": "{"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}, {"instr_func": "check_method_table", "instr_loc": 1448, "instr_file": "drivers/infiniband/core/mad.c", "instr": "if (method->agent[i])"}], "at_file": "drivers/infiniband/core/mad.c", "by": "TaintedLoopBoundDetector says:", "at_func": "check_method_table"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 933, "file": "drivers/infiniband/core/user_mad.c", "instr": "return ib_umad_reg_agent(filp->private_data, (void __user *) arg, 0);"}, {"lineno": 725, "file": "drivers/infiniband/core/user_mad.c", "instr": "agent = ib_register_mad_agent(file->port->ib_dev, file->port->port_num,"}, {"lineno": 476, "file": "drivers/infiniband/core/mad.c", "instr": "ib_mad_agent_security_cleanup(&mad_agent_priv->agent);"}, {"lineno": 733, "file": "drivers/infiniband/core/security.c", "instr": "if (!rdma_protocol_ib(agent->device, agent->port_num))"}],
"warnings":[{"warn_data": {"at_line": 2928, "warn_str": "Trying to read from a user pointer.", "at": "  %13 = load i32, i32* %12, align 8, !dbg !545969", "inst_trace": [{"instr_func": "ib_umad_reg_agent", "instr_loc": 683, "instr_file": "drivers/infiniband/core/user_mad.c", "instr": "if (copy_from_user(&ureq, arg, sizeof ureq)) {"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %7 = load %struct.ib_port_data*, %struct.ib_port_data** %6, align 8, !dbg !545966"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %10 = getelementptr %struct.ib_port_data, %struct.ib_port_data* %7, i64 %9, !dbg !545965"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %11 = getelementptr inbounds %struct.ib_port_data, %struct.ib_port_data* %10, i32 0, i32 1, !dbg !545968"}, {"instr_func": "rdma_protocol_ib.2178", "instr_loc": 2928, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %12 = getelementptr inbounds %struct.ethtool_pauseparam, %struct.ethtool_pauseparam* %11, i32 0, i32 2, !dbg !545969"}], "at_file": "./include/rdma/ib_verbs.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_protocol_ib.2178"}, "warn_no": 1}]}]}