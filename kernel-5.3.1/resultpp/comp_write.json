{"all_contexts":[
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 213, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);", "inst_trace": [], "at_file": "drivers/staging/most/cdev/cdev.c", "by": "TaintedSizeDetector says:", "at_func": "comp_write"}, "warn_no": 1},
{"warn_data": {"at_line": 220, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "c->mbo_offs += to_copy - left;", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 220, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "c->mbo_offs += to_copy - left;"}], "at_file": "drivers/staging/most/cdev/cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "comp_write"}, "warn_no": 2},
{"warn_data": {"at_line": 220, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "c->mbo_offs += to_copy - left;", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 220, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "c->mbo_offs += to_copy - left;"}, {"instr_func": "comp_write", "instr_loc": 220, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "c->mbo_offs += to_copy - left;"}], "at_file": "drivers/staging/most/cdev/cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "comp_write"}, "warn_no": 3},
{"warn_data": {"at_line": 230, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret = to_copy - left;", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 214, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "left = copy_from_user(mbo->virt_address + c->mbo_offs, buf, to_copy);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 213, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "to_copy = min(count, c->cfg->buffer_size - c->mbo_offs);"}, {"instr_func": "comp_write", "instr_loc": 214, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "left = copy_from_user(mbo->virt_address + c->mbo_offs, buf, to_copy);"}, {"instr_func": "comp_write", "instr_loc": 230, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "ret = to_copy - left;"}], "at_file": "drivers/staging/most/cdev/cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "comp_write"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 227, "file": "drivers/staging/most/cdev/cdev.c", "instr": "most_submit_mbo(mbo);"}, {"lineno": 1012, "file": "drivers/staging/most/core.c", "instr": "nq_hdm_mbo(mbo);"}, {"lineno": 847, "file": "drivers/staging/most/core.c", "instr": "list_add_tail(&mbo->list, &c->halt_fifo);"}, {"lineno": 93, "file": "./include/linux/list.h", "instr": "  call void @__list_add.374(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #14, !dbg !113182"}],
"warnings":[{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i64 %56, i64* %58, align 8, !dbg !113247", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !113180"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.374(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #14, !dbg !113182"}, {"instr_func": "__list_add.374", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %57 = load i8*, i8** %4, align 8, !dbg !113245"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.374"}, "warn_no": 1},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %50, i32* %52, align 4, !dbg !113240", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !113180"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.374(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #14, !dbg !113182"}, {"instr_func": "__list_add.374", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %51 = load i8*, i8** %4, align 8, !dbg !113238"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.374"}, "warn_no": 2},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i16 %44, i16* %46, align 2, !dbg !113233", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !113180"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.374(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #14, !dbg !113182"}, {"instr_func": "__list_add.374", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %45 = load i8*, i8** %4, align 8, !dbg !113231"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.374"}, "warn_no": 3},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i8 %39, i8* %40, align 1, !dbg !113226", "inst_trace": [{"instr_func": "comp_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "comp_write", "instr_loc": 191, "instr_file": "drivers/staging/most/cdev/cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !113180"}, {"instr_func": "list_add_tail.371", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.374(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #14, !dbg !113182"}, {"instr_func": "__list_add.374", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !113219"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.374", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %40 = load i8*, i8** %4, align 8, !dbg !113225"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.374"}, "warn_no": 4}]}]}