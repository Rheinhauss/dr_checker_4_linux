{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}],
"warnings":[{"warn_data": {"at_line": 1285, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (off + len >= size)", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1285, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "if (off + len >= size)"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "intel_th_msc_read"}, "warn_no": 1},
{"warn_data": {"at_line": 1291, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*ppos += ret;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1240, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "rem -= tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1240, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "rem -= tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1240, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "rem -= tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1253, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return len - rem;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1253, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return len - rem;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1253, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return len - rem;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1260, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "}"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1291, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "*ppos += ret;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "intel_th_msc_read"}, "warn_no": 2}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1298, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}],
"warnings":[{"warn_data": {"at_line": 497, "warn_str": "Loop is bounded by a tainted value.", "at": "} while (len);", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 497, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "} while (len);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 497, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "} while (len);"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "TaintedLoopBoundDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 1},
{"warn_data": {"at_line": 486, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "len -= copied;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 2},
{"warn_data": {"at_line": 472, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tocopy -= iter->block_off;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 3},
{"warn_data": {"at_line": 487, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "iter->block_off += copied;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 487, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "iter->block_off += copied;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 4},
{"warn_data": {"at_line": 485, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "copied = tocopy - remaining;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 5},
{"warn_data": {"at_line": 488, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "iter->offset += copied;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 486, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "len -= copied;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 472, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy -= iter->block_off;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 485, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "copied = tocopy - remaining;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 488, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "iter->offset += copied;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 6},
{"warn_data": {"at_line": 499, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return size - len;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 499, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return size - len;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_buffer_iterate"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1298, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"lineno": 494, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "if (msc_iter_block_advance(iter))"}, {"lineno": 398, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "if (!iter->wrap_count && msc_block_last_written(msc_iter_bdesc(iter)))"}, {"lineno": 283, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "return msc_win_block(iter->win, iter->block);"}, {"lineno": 145, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "return sg_virt(&win->sgt->sgl[block]);"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to use a global variable without locking.", "at": "  %7 = load i64, i64* @vmemmap_base, align 8, !dbg !70747", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 494, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "if (msc_iter_block_advance(iter))"}, {"instr_func": "msc_iter_block_advance", "instr_loc": 398, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "if (!iter->wrap_count && msc_block_last_written(msc_iter_bdesc(iter)))"}, {"instr_func": "msc_iter_bdesc", "instr_loc": 283, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return msc_win_block(iter->win, iter->block);"}, {"instr_func": "msc_win_block", "instr_loc": 145, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return sg_virt(&win->sgt->sgl[block]);"}], "at_file": "./include/linux/scatterlist.h", "by": "GlobalVariableRaceDetector says:", "at_func": "sg_virt"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1298, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"lineno": 480, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "remaining = fn(data, src, tocopy);"}],
"warnings":[{"warn_data": {"at_line": 1188, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->offset += len - ret;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 480, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "remaining = fn(data, src, tocopy);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 480, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "remaining = fn(data, src, tocopy);"}, {"instr_func": "msc_win_to_user", "instr_loc": 1183, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_win_to_user", "instr_loc": 1188, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "u->offset += len - ret;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_win_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 1183, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "TaintedSizeDetector says:", "at_func": "msc_win_to_user"}, "warn_no": 2},
{"warn_data": {"at_line": 1188, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->offset += len - ret;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1298, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_buffer_iterate(iter, len, &u, msc_win_to_user);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 432, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 434, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "size_t len = size;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 476, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = len;"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 480, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "remaining = fn(data, src, tocopy);"}, {"instr_func": "msc_buffer_iterate", "instr_loc": 480, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "remaining = fn(data, src, tocopy);"}, {"instr_func": "msc_win_to_user", "instr_loc": 1183, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_win_to_user", "instr_loc": 1188, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "u->offset += len - ret;"}, {"instr_func": "msc_win_to_user", "instr_loc": 1188, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "u->offset += len - ret;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_win_to_user"}, "warn_no": 3}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 1289, "file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}],
"warnings":[{"warn_data": {"at_line": 1256, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(buf, msc->base + start, rem))", "inst_trace": [], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "TaintedSizeDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 1240, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rem -= tocopy;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1240, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "rem -= tocopy;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 2},
{"warn_data": {"at_line": 1235, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "tocopy = min(rem, size - start);", "inst_trace": [], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "TaintedSizeDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 3},
{"warn_data": {"at_line": 1241, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "start += tocopy;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1241, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "start += tocopy;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 4},
{"warn_data": {"at_line": 1246, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tocopy = min(rem, msc->single_sz - start);", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1241, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "start += tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1241, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "start += tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1241, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "start += tocopy;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1246, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, msc->single_sz - start);"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 5},
{"warn_data": {"at_line": 1250, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "rem -= tocopy;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1229, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "unsigned long size = msc->nr_pages << PAGE_SHIFT, rem = len;"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1235, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "tocopy = min(rem, size - start);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1250, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "rem -= tocopy;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 6},
{"warn_data": {"at_line": 1246, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "tocopy = min(rem, msc->single_sz - start);", "inst_trace": [], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "TaintedSizeDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 7},
{"warn_data": {"at_line": 1253, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return len - rem;", "inst_trace": [{"instr_func": "intel_th_msc_read", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1264, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "intel_th_msc_read", "instr_loc": 1289, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "ret = msc_single_to_user(msc, buf, off, len);"}, {"instr_func": "msc_single_to_user", "instr_loc": 1228, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "{"}, {"instr_func": "msc_single_to_user", "instr_loc": 1253, "instr_file": "drivers/hwtracing/intel_th/msu.c", "instr": "return len - rem;"}], "at_file": "drivers/hwtracing/intel_th/msu.c", "by": "IntegerOverflowDetector says:", "at_func": "msc_single_to_user"}, "warn_no": 8}]}]}