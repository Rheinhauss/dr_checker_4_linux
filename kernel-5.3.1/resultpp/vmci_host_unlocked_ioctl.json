{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 944, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}],
"warnings":[{"warn_data": {"at_line": 892, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (!retval && copy_to_user(uptr, &info, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 1},
{"warn_data": {"at_line": 867, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&info, uptr, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 2},
{"warn_data": {"at_line": 880, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &info, sizeof(info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_recv_notifications"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 944, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}, {"lineno": 883, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "info.result = drv_cp_harray_to_user(ubuf, &info.db_handle_buf_size,"}],
"warnings":[{"warn_data": {"at_line": 205, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*retval = copy_to_user(user_buf_uva,", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "drv_cp_harray_to_user"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 944, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFICATIONS_RECEIVE, recv_notifications);"}, {"lineno": 887, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "info.result = drv_cp_harray_to_user(ubuf,"}],
"warnings":[{"warn_data": {"at_line": 205, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*retval = copy_to_user(user_buf_uva,", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "drv_cp_harray_to_user"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 942, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(NOTIFY_RESOURCE, notify_resource);"}],
"warnings":[{"warn_data": {"at_line": 843, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &info, sizeof(info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_notify_resource"}, "warn_no": 1},
{"warn_data": {"at_line": 813, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&info, uptr, sizeof(info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_notify_resource"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 940, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}],
"warnings":[{"warn_data": {"at_line": 792, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &notify_info, sizeof(notify_info)) ?", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_set_notify"}, "warn_no": 1},
{"warn_data": {"at_line": 780, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&notify_info, uptr, sizeof(notify_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_set_notify"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 940, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}, {"lineno": 785, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"lineno": 231, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "if (!access_ok((void __user *)uva, sizeof(u8)))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4821", "inst_trace": [{"instr_func": "vmci_host_do_set_notify", "instr_loc": 780, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "if (copy_from_user(&notify_info, uptr, sizeof(notify_info)))"}, {"instr_func": "vmci_host_do_set_notify", "instr_loc": 786, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "notify_info.notify_uva);"}, {"instr_func": "vmci_host_do_set_notify", "instr_loc": 785, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 218, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "{"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 231, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "if (!access_ok((void __user *)uva, sizeof(u8)))"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 231, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "if (!access_ok((void __user *)uva, sizeof(u8)))"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 231, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "if (!access_ok((void __user *)uva, sizeof(u8)))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4821"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 940, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}, {"lineno": 785, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"lineno": 246, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "context->notify = kmap(context->notify_page) + (uva & (PAGE_SIZE - 1));"}],
"warnings":[{"warn_data": {"at_line": 84, "warn_str": "Trying to use a global variable without locking.", "at": "  %10 = load i64, i64* @vmemmap_base, align 8, !dbg !4824", "inst_trace": [{"instr_func": "vmci_host_unlocked_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "vmci_host_unlocked_ioctl", "instr_loc": 940, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(SET_NOTIFY, set_notify);"}, {"instr_func": "vmci_host_do_set_notify", "instr_loc": 785, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "vmci_host_setup_notify(vmci_host_dev->context,"}, {"instr_func": "vmci_host_setup_notify", "instr_loc": 246, "instr_file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "context->notify = kmap(context->notify_page) + (uva & (PAGE_SIZE - 1));"}], "at_file": "./include/linux/highmem.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmap"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 936, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_SET_CPT_STATE, ctx_set_cpt_state);"}],
"warnings":[{"warn_data": {"at_line": 742, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&set_info, uptr, sizeof(set_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_set_cpt_state"}, "warn_no": 1},
{"warn_data": {"at_line": 750, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "cid = vmci_ctx_get_id(vmci_host_dev->context);", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_set_cpt_state"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 934, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_GET_CPT_STATE, ctx_get_cpt_state);"}],
"warnings":[{"warn_data": {"at_line": 710, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&get_info, uptr, sizeof(get_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 1},
{"warn_data": {"at_line": 717, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "void __user *ubuf = (void __user *)(uintptr_t)get_info.cpt_buf;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 2},
{"warn_data": {"at_line": 725, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &get_info, sizeof(get_info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_get_cpt_state"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 932, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_REMOVE_NOTIFICATION, ctx_remove_notify);"}],
"warnings":[{"warn_data": {"at_line": 686, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ar_info, uptr, sizeof(ar_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_remove_notify"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 930, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(CTX_ADD_NOTIFICATION, ctx_add_notify);"}],
"warnings":[{"warn_data": {"at_line": 663, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ar_info, uptr, sizeof(ar_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_ctx_add_notify"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 928, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_DETACH, qp_detach);"}],
"warnings":[{"warn_data": {"at_line": 636, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&detach_info, uptr, sizeof(detach_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_qp_detach"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 926, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_SETPAGEFILE, queuepair_setpf);"}],
"warnings":[{"warn_data": {"at_line": 565, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&page_file_info, uptr, sizeof(*info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_queuepair_setpf"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 924, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_SETVA, queuepair_setva);"}],
"warnings":[{"warn_data": {"at_line": 522, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&set_va_info, uptr, sizeof(set_va_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_queuepair_setva"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 922, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(QUEUEPAIR_ALLOC, alloc_queuepair);"}],
"warnings":[{"warn_data": {"at_line": 470, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vmci_qp_alloc_info alloc_info;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_alloc_queuepair"}, "warn_no": 1},
{"warn_data": {"at_line": 449, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vmci_qp_alloc_info_vmvm alloc_info;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_alloc_queuepair"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 920, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(DATAGRAM_RECEIVE, receive_datagram);"}],
"warnings":[{"warn_data": {"at_line": 417, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&recv_info, uptr, sizeof(recv_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 1},
{"warn_data": {"at_line": 425, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "void __user *ubuf = (void __user *)(uintptr_t)recv_info.addr;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 2},
{"warn_data": {"at_line": 432, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(uptr, &recv_info, sizeof(recv_info)) ? -EFAULT : 0;", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_receive_datagram"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 918, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(DATAGRAM_SEND, send_datagram);"}],
"warnings":[{"warn_data": {"at_line": 361, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&send_info, uptr, sizeof(send_info)))", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_send_datagram"}, "warn_no": 1},
{"warn_data": {"at_line": 390, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "pr_devel(\"Datagram dst (handle=0x%x:0x%x) src (handle=0x%x:0x%x), payload (size=%llu bytes)\\n\",", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_send_datagram"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 916, "file": "drivers/misc/vmw_vmci/vmci_host.c", "instr": "VMCI_DO_IOCTL(INIT_CONTEXT, init_context);"}],
"warnings":[{"warn_data": {"at_line": 289, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_init_context"}, "warn_no": 1},
{"warn_data": {"at_line": 329, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "init_block.cid = vmci_ctx_get_id(vmci_host_dev->context);", "inst_trace": [], "at_file": "drivers/misc/vmw_vmci/vmci_host.c", "by": "TaintedSizeDetector says:", "at_func": "vmci_host_do_init_context"}, "warn_no": 2}]}]}