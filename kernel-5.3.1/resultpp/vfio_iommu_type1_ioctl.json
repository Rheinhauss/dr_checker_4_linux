{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1813, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user((void __user *)arg, &unmap, minsz) ?", "inst_trace": [], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_iommu_type1_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1798, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_iommu_type1_dma_unmap unmap;", "inst_trace": [], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_iommu_type1_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1783, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_iommu_type1_dma_map map;", "inst_trace": [], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_iommu_type1_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1775, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "info.flags = VFIO_IOMMU_INFO_PGSIZES;", "inst_trace": [], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_iommu_type1_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1765, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_iommu_type1_info info;", "inst_trace": [], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_iommu_type1_ioctl"}, "warn_no": 5}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1809, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_dma_do_unmap(iommu, &unmap);"}],
"warnings":[{"warn_data": {"at_line": 869, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unmap->iova + unmap->size - 1 < unmap->iova ||", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 869, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (unmap->iova + unmap->size - 1 < unmap->iova ||"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 869, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (unmap->iova + unmap->size - 1 < unmap->iova ||"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 1},
{"warn_data": {"at_line": 869, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unmap->iova + unmap->size - 1 < unmap->iova ||", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 869, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (unmap->iova + unmap->size - 1 < unmap->iova ||"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 2},
{"warn_data": {"at_line": 922, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!iommu->v2 && unmap->iova > dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 922, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!iommu->v2 && unmap->iova > dma->iova)"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 922, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!iommu->v2 && unmap->iova > dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 3},
{"warn_data": {"at_line": 915, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 915, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 4},
{"warn_data": {"at_line": 915, "warn_str": "Loop is bounded by a tainted value.", "at": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 915, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 915, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 915, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova + dma->size != unmap->iova + unmap->size) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 5},
{"warn_data": {"at_line": 914, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 6},
{"warn_data": {"at_line": 914, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 7},
{"warn_data": {"at_line": 910, "warn_str": "Loop is bounded by a tainted value.", "at": "if (dma && dma->iova != unmap->iova) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 910, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova != unmap->iova) {"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 910, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (dma && dma->iova != unmap->iova) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_dma_do_unmap"}, "warn_no": 8}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1809, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_dma_do_unmap(iommu, &unmap);"}, {"lineno": 921, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while ((dma = vfio_find_dma(iommu, unmap->iova, unmap->size))) {"}],
"warnings":[{"warn_data": {"at_line": 137, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (start >= dma->iova + dma->size)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 921, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while ((dma = vfio_find_dma(iommu, unmap->iova, unmap->size))) {"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 921, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while ((dma = vfio_find_dma(iommu, unmap->iova, unmap->size))) {"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 135, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (start + size <= dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 921, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while ((dma = vfio_find_dma(iommu, unmap->iova, unmap->size))) {"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 921, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while ((dma = vfio_find_dma(iommu, unmap->iova, unmap->size))) {"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 135, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (start + size <= dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1809, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_dma_do_unmap(iommu, &unmap);"}, {"lineno": 914, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}],
"warnings":[{"warn_data": {"at_line": 137, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (start >= dma->iova + dma->size)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 135, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (start + size <= dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 914, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova + unmap->size - 1, 0);"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 135, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (start + size <= dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1809, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_dma_do_unmap(iommu, &unmap);"}, {"lineno": 909, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova, 1);"}],
"warnings":[{"warn_data": {"at_line": 135, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (start + size <= dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 909, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova, 1);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 909, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova, 1);"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 135, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (start + size <= dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 137, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (start >= dma->iova + dma->size)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1798, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_unmap unmap;"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 909, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova, 1);"}, {"instr_func": "vfio_dma_do_unmap", "instr_loc": 909, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma = vfio_find_dma(iommu, unmap->iova, 1);"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}],
"warnings":[{"warn_data": {"at_line": 1062, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_map"}, "warn_no": 1},
{"warn_data": {"at_line": 1062, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_map"}, "warn_no": 2},
{"warn_data": {"at_line": 1062, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_map"}, "warn_no": 3},
{"warn_data": {"at_line": 1062, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1062, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (iova + size - 1 < iova || vaddr + size - 1 < vaddr)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_dma_do_map"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1067, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_dma(iommu, iova, size)) {"}],
"warnings":[{"warn_data": {"at_line": 137, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (start >= dma->iova + dma->size)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1067, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_dma(iommu, iova, size)) {"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1067, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_dma(iommu, iova, size)) {"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}, {"instr_func": "vfio_find_dma", "instr_loc": 137, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (start >= dma->iova + dma->size)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 135, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (start + size <= dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1067, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_dma(iommu, iova, size)) {"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1067, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_dma(iommu, iova, size)) {"}, {"instr_func": "vfio_find_dma", "instr_loc": 129, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_dma", "instr_loc": 135, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (start + size <= dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_find_dma"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1120, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_link_dma(iommu, dma);"}],
"warnings":[{"warn_data": {"at_line": 155, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (new->iova + new->size <= dma->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_link_dma", "instr_loc": 155, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (new->iova + new->size <= dma->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_link_dma"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}],
"warnings":[{"warn_data": {"at_line": 1022, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size -= npage << PAGE_SHIFT;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 995, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_map_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 1014, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_map_dma"}, "warn_no": 2},
{"warn_data": {"at_line": 1005, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_map_dma"}, "warn_no": 3},
{"warn_data": {"at_line": 1003, "warn_str": "Loop is bounded by a tainted value.", "at": "while (size) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 995, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1003, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (size) {"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1003, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (size) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_pin_map_dma"}, "warn_no": 4},
{"warn_data": {"at_line": 1017, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_map_dma"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1014, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"lineno": 976, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}],
"warnings":[{"warn_data": {"at_line": 1845, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "iova += pgsize;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 971, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "iommu_map", "instr_loc": 1804, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_map", "instr_loc": 1845, "instr_file": "drivers/iommu/iommu.c", "instr": "iova += pgsize;"}], "at_file": "drivers/iommu/iommu.c", "by": "IntegerOverflowDetector says:", "at_func": "iommu_map"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1014, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"lineno": 976, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"lineno": 1836, "file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}],
"warnings":[{"warn_data": {"at_line": 1787, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgsize = (1UL << (pgsize_idx + 1)) - 1;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 971, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "iommu_map", "instr_loc": 1804, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1772, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1787, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize = (1UL << (pgsize_idx + 1)) - 1;"}], "at_file": "drivers/iommu/iommu.c", "by": "IntegerOverflowDetector says:", "at_func": "iommu_pgsize"}, "warn_no": 1},
{"warn_data": {"at_line": 1787, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgsize = (1UL << (pgsize_idx + 1)) - 1;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 971, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 976, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = iommu_map(d->domain, iova, (phys_addr_t)pfn << PAGE_SHIFT,"}, {"instr_func": "iommu_map", "instr_loc": 1804, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_map", "instr_loc": 1836, "instr_file": "drivers/iommu/iommu.c", "instr": "size_t pgsize = iommu_pgsize(domain, iova | paddr, size);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1772, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1782, "instr_file": "drivers/iommu/iommu.c", "instr": "unsigned int align_pgsize_idx = __ffs(addr_merge);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1783, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize_idx = min(pgsize_idx, align_pgsize_idx);"}, {"instr_func": "iommu_pgsize", "instr_loc": 1787, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize = (1UL << (pgsize_idx + 1)) - 1;"}, {"instr_func": "iommu_pgsize", "instr_loc": 1787, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize = (1UL << (pgsize_idx + 1)) - 1;"}, {"instr_func": "iommu_pgsize", "instr_loc": 1787, "instr_file": "drivers/iommu/iommu.c", "instr": "pgsize = (1UL << (pgsize_idx + 1)) - 1;"}], "at_file": "drivers/iommu/iommu.c", "by": "IntegerOverflowDetector says:", "at_func": "iommu_pgsize"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1014, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"lineno": 988, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "iommu_unmap(d->domain, iova, npage << PAGE_SHIFT);"}, {"lineno": 1926, "file": "drivers/iommu/iommu.c", "instr": "return __iommu_unmap(domain, iova, size, true);"}],
"warnings":[{"warn_data": {"at_line": 1912, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "iova += unmapped_page;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1014, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_iommu_map(iommu, iova + dma->size, pfn, npage,"}, {"instr_func": "vfio_iommu_map", "instr_loc": 971, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_iommu_map", "instr_loc": 988, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "iommu_unmap(d->domain, iova, npage << PAGE_SHIFT);"}, {"instr_func": "vfio_iommu_map", "instr_loc": 988, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "iommu_unmap(d->domain, iova, npage << PAGE_SHIFT);"}, {"instr_func": "iommu_unmap", "instr_loc": 1925, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "iommu_unmap", "instr_loc": 1926, "instr_file": "drivers/iommu/iommu.c", "instr": "return __iommu_unmap(domain, iova, size, true);"}, {"instr_func": "iommu_unmap", "instr_loc": 1926, "instr_file": "drivers/iommu/iommu.c", "instr": "return __iommu_unmap(domain, iova, size, true);"}, {"instr_func": "__iommu_unmap", "instr_loc": 1866, "instr_file": "drivers/iommu/iommu.c", "instr": "{"}, {"instr_func": "__iommu_unmap", "instr_loc": 1912, "instr_file": "drivers/iommu/iommu.c", "instr": "iova += unmapped_page;"}], "at_file": "drivers/iommu/iommu.c", "by": "IntegerOverflowDetector says:", "at_func": "__iommu_unmap"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}],
"warnings":[{"warn_data": {"at_line": 395, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 1},
{"warn_data": {"at_line": 395, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 2},
{"warn_data": {"at_line": 426, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 3},
{"warn_data": {"at_line": 426, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 4},
{"warn_data": {"at_line": 427, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 5},
{"warn_data": {"at_line": 427, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 6},
{"warn_data": {"at_line": 426, "warn_str": "Loop is bounded by a tainted value.", "at": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1039, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map->size;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1126, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 995, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 998, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size_t size = map_size;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1022, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size -= npage << PAGE_SHIFT;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1006, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size >> PAGE_SHIFT, &pfn, limit);"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1006, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "size >> PAGE_SHIFT, &pfn, limit);"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_pin_pages_remote"}, "warn_no": 7}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 401, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}],
"warnings":[{"warn_data": {"at_line": 371, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "vma = find_vma_intersection(mm, vaddr, vaddr + 1);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 371, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vma = find_vma_intersection(mm, vaddr, vaddr + 1);"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 1},
{"warn_data": {"at_line": 374, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 2},
{"warn_data": {"at_line": 374, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 401, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"lineno": 375, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}],
"warnings":[{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 1},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 2},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 3},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 401, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, pfn_base);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 4}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 412, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}],
"warnings":[{"warn_data": {"at_line": 183, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (iova > vpfn->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 412, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 412, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 174, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 1},
{"warn_data": {"at_line": 182, "warn_str": "Trying to read from a user pointer.", "at": "node = node->rb_left;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_find_vpfn"}, "warn_no": 2},
{"warn_data": {"at_line": 178, "warn_str": "Loop is bounded by a tainted value.", "at": "while (node) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 438, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}],
"warnings":[{"warn_data": {"at_line": 183, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (iova > vpfn->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 395, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = vaddr - dma->vaddr + dma->iova;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 438, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 438, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (!rsvd && !vfio_find_vpfn(dma, iova)) {"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 174, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 1},
{"warn_data": {"at_line": 182, "warn_str": "Trying to read from a user pointer.", "at": "node = node->rb_left;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_find_vpfn"}, "warn_no": 2},
{"warn_data": {"at_line": 178, "warn_str": "Loop is bounded by a tainted value.", "at": "while (node) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 428, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}],
"warnings":[{"warn_data": {"at_line": 371, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "vma = find_vma_intersection(mm, vaddr, vaddr + 1);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 371, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vma = find_vma_intersection(mm, vaddr, vaddr + 1);"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 1},
{"warn_data": {"at_line": 374, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 2},
{"warn_data": {"at_line": 374, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 426, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (vaddr += PAGE_SIZE, iova += PAGE_SIZE; pinned < npage;"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 427, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "pinned++, vaddr += PAGE_SIZE, iova += PAGE_SIZE) {"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vaddr_get_pfn"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1005, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"lineno": 428, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"lineno": 375, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}],
"warnings":[{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 1},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 2},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 3},
{"warn_data": {"at_line": 309, "warn_str": "Trying to read from a user pointer.", "at": "smp_rmb();", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1038, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = map->vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1085, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->vaddr = vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 997, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unsigned long vaddr = dma->vaddr;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1005, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "npage = vfio_pin_pages_remote(dma, vaddr + dma->size,"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 391, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vfio_pin_pages_remote", "instr_loc": 428, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vaddr_get_pfn(current->mm, vaddr, dma->prot, &pfn);"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 333, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 374, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*pfn = ((vaddr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "vaddr_get_pfn", "instr_loc": 375, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (is_invalid_reserved_pfn(*pfn))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 292, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 295, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct page *tail = pfn_to_page(pfn);"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 310, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (PageTail(tail))"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}, {"instr_func": "is_invalid_reserved_pfn", "instr_loc": 309, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "smp_rmb();"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "is_invalid_reserved_pfn"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1017, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}],
"warnings":[{"warn_data": {"at_line": 474, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (i = 0; i < npage; i++, iova += PAGE_SIZE) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_unpin_pages_remote", "instr_loc": 470, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_unpin_pages_remote", "instr_loc": 474, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "for (i = 0; i < npage; i++, iova += PAGE_SIZE) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_unpin_pages_remote"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1017, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"lineno": 477, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_vpfn(dma, iova))"}],
"warnings":[{"warn_data": {"at_line": 183, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (iova > vpfn->iova)", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 996, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova;"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_pin_map_dma", "instr_loc": 1017, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unpin_pages_remote(dma, iova + dma->size, pfn,"}, {"instr_func": "vfio_unpin_pages_remote", "instr_loc": 470, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_unpin_pages_remote", "instr_loc": 477, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_vpfn(dma, iova))"}, {"instr_func": "vfio_unpin_pages_remote", "instr_loc": 477, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "if (vfio_find_vpfn(dma, iova))"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 174, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "{"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 183, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "else if (iova > vpfn->iova)"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 1},
{"warn_data": {"at_line": 182, "warn_str": "Trying to read from a user pointer.", "at": "node = node->rb_left;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 182, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_left;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_find_vpfn"}, "warn_no": 2},
{"warn_data": {"at_line": 178, "warn_str": "Loop is bounded by a tainted value.", "at": "while (node) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 184, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "node = node->rb_right;"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}, {"instr_func": "vfio_find_vpfn", "instr_loc": 178, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (node) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_find_vpfn"}, "warn_no": 3}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1029, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_remove_dma(iommu, dma);"}, {"lineno": 822, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unmap_unpin(iommu, dma, true);"}],
"warnings":[{"warn_data": {"at_line": 787, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "!domain->fgsp && iova + len < end; len += PAGE_SIZE) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 787, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "!domain->fgsp && iova + len < end; len += PAGE_SIZE) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_unmap_unpin"}, "warn_no": 1},
{"warn_data": {"at_line": 744, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_unmap_unpin"}, "warn_no": 2},
{"warn_data": {"at_line": 788, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "next = iommu_iova_to_phys(domain->domain, iova + len);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 788, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "next = iommu_iova_to_phys(domain->domain, iova + len);"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_unmap_unpin"}, "warn_no": 3},
{"warn_data": {"at_line": 777, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "iova += PAGE_SIZE;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 777, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "iova += PAGE_SIZE;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_unmap_unpin"}, "warn_no": 4},
{"warn_data": {"at_line": 771, "warn_str": "Loop is bounded by a tainted value.", "at": "while (iova < end) {", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 771, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (iova < end) {"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 771, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "while (iova < end) {"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_unmap_unpin"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1029, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_remove_dma(iommu, dma);"}, {"lineno": 822, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unmap_unpin(iommu, dma, true);"}, {"lineno": 801, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unmapped = unmap_unpin_slow(domain, dma, &iova, len,"}],
"warnings":[{"warn_data": {"at_line": 735, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*iova += unmapped;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "unmap_unpin_slow", "instr_loc": 735, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*iova += unmapped;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "unmap_unpin_slow"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1029, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_remove_dma(iommu, dma);"}, {"lineno": 822, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unmap_unpin(iommu, dma, true);"}, {"lineno": 797, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "unmapped = unmap_unpin_fast(domain, dma, &iova, len, phys,"}],
"warnings":[{"warn_data": {"at_line": 705, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*iova += unmapped;", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "vfio_unmap_unpin", "instr_loc": 744, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = dma->iova, end = dma->iova + dma->size;"}, {"instr_func": "unmap_unpin_fast", "instr_loc": 705, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "*iova += unmapped;"}], "at_file": "drivers/vfio/vfio_iommu_type1.c", "by": "IntegerOverflowDetector says:", "at_func": "unmap_unpin_fast"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1029, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_remove_dma(iommu, dma);"}, {"lineno": 822, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unmap_unpin(iommu, dma, true);"}, {"lineno": 788, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "next = iommu_iova_to_phys(domain->domain, iova + len);"}],
"warnings":[{"warn_data": {"at_line": 1763, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(domain->ops->iova_to_phys == NULL))", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1763, "instr_file": "drivers/iommu/iommu.c", "instr": "if (unlikely(domain->ops->iova_to_phys == NULL))"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1763, "instr_file": "drivers/iommu/iommu.c", "instr": "if (unlikely(domain->ops->iova_to_phys == NULL))"}], "at_file": "drivers/iommu/iommu.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "iommu_iova_to_phys"}, "warn_no": 1},
{"warn_data": {"at_line": 1766, "warn_str": "Trying to read from a user pointer.", "at": "return domain->ops->iova_to_phys(domain, iova);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1766, "instr_file": "drivers/iommu/iommu.c", "instr": "return domain->ops->iova_to_phys(domain, iova);"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1766, "instr_file": "drivers/iommu/iommu.c", "instr": "return domain->ops->iova_to_phys(domain, iova);"}], "at_file": "drivers/iommu/iommu.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "iommu_iova_to_phys"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1795, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "return vfio_dma_do_map(iommu, &map);"}, {"lineno": 1126, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "ret = vfio_pin_map_dma(iommu, dma, size);"}, {"lineno": 1029, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_remove_dma(iommu, dma);"}, {"lineno": 822, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "vfio_unmap_unpin(iommu, dma, true);"}, {"lineno": 775, "file": "drivers/vfio/vfio_iommu_type1.c", "instr": "phys = iommu_iova_to_phys(domain->domain, iova);"}],
"warnings":[{"warn_data": {"at_line": 1763, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(domain->ops->iova_to_phys == NULL))", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1763, "instr_file": "drivers/iommu/iommu.c", "instr": "if (unlikely(domain->ops->iova_to_phys == NULL))"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1763, "instr_file": "drivers/iommu/iommu.c", "instr": "if (unlikely(domain->ops->iova_to_phys == NULL))"}], "at_file": "drivers/iommu/iommu.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "iommu_iova_to_phys"}, "warn_no": 1},
{"warn_data": {"at_line": 1766, "warn_str": "Trying to read from a user pointer.", "at": "return domain->ops->iova_to_phys(domain, iova);", "inst_trace": [{"instr_func": "vfio_iommu_type1_ioctl", "instr_loc": 1783, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "struct vfio_iommu_type1_dma_map map;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1037, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma_addr_t iova = map->iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "vfio_dma_do_map", "instr_loc": 1084, "instr_file": "drivers/vfio/vfio_iommu_type1.c", "instr": "dma->iova = iova;"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1766, "instr_file": "drivers/iommu/iommu.c", "instr": "return domain->ops->iova_to_phys(domain, iova);"}, {"instr_func": "iommu_iova_to_phys", "instr_loc": 1766, "instr_file": "drivers/iommu/iommu.c", "instr": "return domain->ops->iova_to_phys(domain, iova);"}], "at_file": "drivers/iommu/iommu.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "iommu_iova_to_phys"}, "warn_no": 2}]}]}