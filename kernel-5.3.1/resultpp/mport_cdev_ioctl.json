{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 2100, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, &data->event_mask,", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "mport_cdev_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 2083, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "md->properties.hdid = md->mport->host_deviceid;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "mport_cdev_ioctl"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2123, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1812, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_del_riodev"}, "warn_no": 1},
{"warn_data": {"at_line": 1834, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rdev && rdev->dev.parent == &mport->net->dev &&", "inst_trace": [{"instr_func": "rio_mport_del_riodev", "instr_loc": 1812, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1836, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev->hopcount == dev_info.hopcount)"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1836, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev->hopcount == dev_info.hopcount)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_del_riodev"}, "warn_no": 2},
{"warn_data": {"at_line": 1842, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(RDEV,", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2123, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_del_riodev"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2123, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"lineno": 1833, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = rio_get_comptag(dev_info.comptag, rdev);"}],
"warnings":[{"warn_data": {"at_line": 841, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2123, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1833, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = rio_get_comptag(dev_info.comptag, rdev);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_get_comptag"}, "warn_no": 1},
{"warn_data": {"at_line": 850, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rdev->comp_tag == comp_tag)", "inst_trace": [{"instr_func": "rio_mport_del_riodev", "instr_loc": 1812, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1833, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = rio_get_comptag(dev_info.comptag, rdev);"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1833, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = rio_get_comptag(dev_info.comptag, rdev);"}, {"instr_func": "rio_get_comptag", "instr_loc": 841, "instr_file": "drivers/rapidio/rio.c", "instr": "{"}, {"instr_func": "rio_get_comptag", "instr_loc": 850, "instr_file": "drivers/rapidio/rio.c", "instr": "if (rdev->comp_tag == comp_tag)"}, {"instr_func": "rio_get_comptag", "instr_loc": 850, "instr_file": "drivers/rapidio/rio.c", "instr": "if (rdev->comp_tag == comp_tag)"}], "at_file": "drivers/rapidio/rio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_get_comptag"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1674, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_add_riodev"}, "warn_no": 1},
{"warn_data": {"at_line": 1691, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(RDEV, \"name:%s ct:0x%x did:0x%x hc:0x%x\", dev_info.name,", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_add_riodev"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2123, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"lineno": 1851, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_del_device(rdev, RIO_DEVICE_SHUTDOWN);"}],
"warnings":[{"warn_data": {"at_line": 206, "warn_str": "Trying to use a global variable without locking.", "at": "atomic_set(&rdev->state, state);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2123, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1851, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_del_device(rdev, RIO_DEVICE_SHUTDOWN);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_del_device"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2123, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"lineno": 1854, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_free_net(net);"}],
"warnings":[{"warn_data": {"at_line": 139, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2123, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_del_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_del_riodev", "instr_loc": 1854, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_free_net(net);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_free_net"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1715, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = kzalloc(size, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !101763", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1715, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rdev = kzalloc(size, GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc.1023"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1722, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "net = rio_alloc_net(mport);"}, {"lineno": 110, "file": "drivers/rapidio/rio.c", "instr": "struct rio_net *net = kzalloc(sizeof(*net), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !101763", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1722, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "net = rio_alloc_net(mport);"}, {"instr_func": "rio_alloc_net", "instr_loc": 110, "instr_file": "drivers/rapidio/rio.c", "instr": "struct rio_net *net = kzalloc(sizeof(*net), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc.753"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1734, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}],
"warnings":[{"warn_data": {"at_line": 128, "warn_str": "Trying to use a global variable without locking.", "at": "if (err)", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1734, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_add_net"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1734, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"lineno": 127, "file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"lineno": 2237, "file": "drivers/base/core.c", "instr": "device_initialize(dev);"}],
"warnings":[{"warn_data": {"at_line": 1662, "warn_str": "Trying to use a global variable without locking.", "at": "dev->kobj.kset = devices_kset;", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1734, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"instr_func": "rio_add_net", "instr_loc": 127, "instr_file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"instr_func": "device_register", "instr_loc": 2237, "instr_file": "drivers/base/core.c", "instr": "device_initialize(dev);"}], "at_file": "drivers/base/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "device_initialize"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1734, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"lineno": 127, "file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"lineno": 2238, "file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"lineno": 2102, "file": "drivers/base/core.c", "instr": "kobj = get_device_parent(dev, parent);"}],
"warnings":[{"warn_data": {"at_line": 1755, "warn_str": "Trying to use a global variable without locking.", "at": "if (sysfs_deprecated && dev->class == &block_class) {", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1734, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"instr_func": "rio_add_net", "instr_loc": 127, "instr_file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"instr_func": "device_register", "instr_loc": 2238, "instr_file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"instr_func": "device_add", "instr_loc": 2102, "instr_file": "drivers/base/core.c", "instr": "kobj = get_device_parent(dev, parent);"}], "at_file": "drivers/base/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "get_device_parent"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1734, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"lineno": 127, "file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"lineno": 2238, "file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"lineno": 2123, "file": "drivers/base/core.c", "instr": "error = device_platform_notify(dev, KOBJ_ADD);"}],
"warnings":[{"warn_data": {"at_line": 890, "warn_str": "Trying to use a global variable without locking.", "at": "if (platform_notify && action == KOBJ_ADD)", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1734, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"instr_func": "rio_add_net", "instr_loc": 127, "instr_file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"instr_func": "device_register", "instr_loc": 2238, "instr_file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"instr_func": "device_add", "instr_loc": 2123, "instr_file": "drivers/base/core.c", "instr": "error = device_platform_notify(dev, KOBJ_ADD);"}], "at_file": "drivers/base/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "device_platform_notify"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1734, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"lineno": 127, "file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"lineno": 2238, "file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"lineno": 2131, "file": "drivers/base/core.c", "instr": "error = device_add_class_symlinks(dev);"}],
"warnings":[{"warn_data": {"at_line": 1918, "warn_str": "Trying to use a global variable without locking.", "at": "if (sysfs_deprecated && dev->class == &block_class)", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1734, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_net(net);"}, {"instr_func": "rio_add_net", "instr_loc": 127, "instr_file": "drivers/rapidio/rio.c", "instr": "err = device_register(&net->dev);"}, {"instr_func": "device_register", "instr_loc": 2238, "instr_file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"instr_func": "device_add", "instr_loc": 2131, "instr_file": "drivers/base/core.c", "instr": "error = device_add_class_symlinks(dev);"}], "at_file": "drivers/base/core.c", "by": "GlobalVariableRaceDetector says:", "at_func": "device_add_class_symlinks"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1794, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_attach_device(rdev);"}],
"warnings":[{"warn_data": {"at_line": 176, "warn_str": "Trying to use a global variable without locking.", "at": "rdev->dev.bus = &rio_bus_type;", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1794, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_attach_device(rdev);"}], "at_file": "drivers/rapidio/rio-driver.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_attach_device"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1800, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_device(rdev);"}],
"warnings":[{"warn_data": {"at_line": 178, "warn_str": "Trying to use a global variable without locking.", "at": "if (err)", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2121, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_riodev", "instr_loc": 1800, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_device(rdev);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_add_device"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1800, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_device(rdev);"}, {"lineno": 177, "file": "drivers/rapidio/rio.c", "instr": "err = device_register(&rdev->dev);"}, {"lineno": 2238, "file": "drivers/base/core.c", "instr": "return device_add(dev);"}, {"lineno": 2102, "file": "drivers/base/core.c", "instr": "kobj = get_device_parent(dev, parent);"}],
"warnings":[{"warn_data": {"at_line": 1779, "warn_str": "Loop is bounded by a tainted value.", "at": "if (k->parent == parent_kobj) {", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "get_device_parent", "instr_loc": 1779, "instr_file": "drivers/base/core.c", "instr": "if (k->parent == parent_kobj) {"}, {"instr_func": "get_device_parent", "instr_loc": 1779, "instr_file": "drivers/base/core.c", "instr": "if (k->parent == parent_kobj) {"}], "at_file": "drivers/base/core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "get_device_parent"}, "warn_no": 1},
{"warn_data": {"at_line": 1778, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "get_device_parent"}, "warn_no": 2},
{"warn_data": {"at_line": 1779, "warn_str": "Trying to read from a user pointer.", "at": "if (k->parent == parent_kobj) {", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1779, "instr_file": "drivers/base/core.c", "instr": "if (k->parent == parent_kobj) {"}, {"instr_func": "get_device_parent", "instr_loc": 1779, "instr_file": "drivers/base/core.c", "instr": "if (k->parent == parent_kobj) {"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "get_device_parent"}, "warn_no": 3},
{"warn_data": {"at_line": 1778, "warn_str": "Loop is bounded by a tainted value.", "at": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}, {"instr_func": "get_device_parent", "instr_loc": 1778, "instr_file": "drivers/base/core.c", "instr": "list_for_each_entry(k, &dev->class->p->glue_dirs.list, entry)"}], "at_file": "drivers/base/core.c", "by": "TaintedLoopBoundDetector says:", "at_func": "get_device_parent"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1800, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_device(rdev);"}, {"lineno": 184, "file": "drivers/rapidio/rio.c", "instr": "list_add_tail(&rdev->net_list, &rdev->net->devices);"}, {"lineno": 93, "file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}],
"warnings":[{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i64 %56, i64* %58, align 8, !dbg !101614", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %57 = load i8*, i8** %4, align 8, !dbg !101612"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 1},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %50, i32* %52, align 4, !dbg !101607", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %51 = load i8*, i8** %4, align 8, !dbg !101605"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 2},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i16 %44, i16* %46, align 2, !dbg !101600", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %45 = load i8*, i8** %4, align 8, !dbg !101598"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 3},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i8 %39, i8* %40, align 1, !dbg !101593", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %40 = load i8*, i8** %4, align 8, !dbg !101592"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2121, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_riodev(data, (void __user *)arg);"}, {"lineno": 1800, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "err = rio_add_device(rdev);"}, {"lineno": 186, "file": "drivers/rapidio/rio.c", "instr": "list_add_tail(&rdev->rswitch->node,"}, {"lineno": 93, "file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}],
"warnings":[{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i64 %56, i64* %58, align 8, !dbg !101614", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %57 = load i8*, i8** %4, align 8, !dbg !101612"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 1},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %50, i32* %52, align 4, !dbg !101607", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %51 = load i8*, i8** %4, align 8, !dbg !101605"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 2},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i16 %44, i16* %46, align 2, !dbg !101600", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %45 = load i8*, i8** %4, align 8, !dbg !101598"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 3},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i8 %39, i8* %40, align 1, !dbg !101593", "inst_trace": [{"instr_func": "rio_mport_add_riodev", "instr_loc": 1674, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.720", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.725(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.725", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.725", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %40 = load i8*, i8** %4, align 8, !dbg !101592"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.725"}, "warn_no": 4}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 959, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_transfer_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 980, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (unlikely(copy_from_user(transfer,", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_transfer_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 993, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (unlikely(copy_to_user((void __user *)(uintptr_t)transaction.block,", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_transfer_ioctl"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2117, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_wait_for_async_dma(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1024, "warn_str": "Trying to use a global variable without locking.", "at": "tmo = msecs_to_jiffies(dma_timeout);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2117, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_wait_for_async_dma(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_wait_for_async_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 1005, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_wait_for_async_dma"}, "warn_no": 2},
{"warn_data": {"at_line": 1028, "warn_str": "Loop is bounded by a tainted value.", "at": "if (req->cookie == cookie) {", "inst_trace": [{"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1005, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1020, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "cookie = w_param.token;"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1020, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "cookie = w_param.token;"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1028, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (req->cookie == cookie) {"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1028, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (req->cookie == cookie) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_wait_for_async_dma"}, "warn_no": 3}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}],
"warnings":[{"warn_data": {"at_line": 900, "warn_str": "Loop is bounded by a tainted value.", "at": "if (baddr >= map->phys_addr &&", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 896, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr = (dma_addr_t)xfer->handle;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 896, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr = (dma_addr_t)xfer->handle;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 901, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr < (map->phys_addr + map->size)) {"}, {"instr_func": "rio_dma_transfer", "instr_loc": 901, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr < (map->phys_addr + map->size)) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 1},
{"warn_data": {"at_line": 914, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (xfer->length + xfer->offset > map->size) {", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 914, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (xfer->length + xfer->offset > map->size) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 2},
{"warn_data": {"at_line": 926, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map->virt_addr + (baddr - map->phys_addr) +", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 896, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr = (dma_addr_t)xfer->handle;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 896, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "baddr = (dma_addr_t)xfer->handle;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 926, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "map->virt_addr + (baddr - map->phys_addr) +"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 3},
{"warn_data": {"at_line": 856, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 4},
{"warn_data": {"at_line": 856, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 5},
{"warn_data": {"at_line": 949, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < nr_pages; i++)", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 949, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < nr_pages; i++)"}, {"instr_func": "rio_dma_transfer", "instr_loc": 949, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < nr_pages; i++)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_dma_transfer"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}],
"warnings":[{"warn_data": {"at_line": 713, "warn_str": "Trying to read from a user pointer.", "at": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\",", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_dma_request"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 713, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}],
"warnings":[{"warn_data": {"at_line": 1100, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i8*, i8** %5, align 8, !dbg !101544", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "dev_name.1010", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %3, align 8"}, {"instr_func": "dev_name.1010", "instr_loc": 1100, "instr_file": "./include/linux/device.h", "instr": "  %4 = load %struct.device*, %struct.device** %3, align 8, !dbg !101542"}, {"instr_func": "dev_name.1010", "instr_loc": 1100, "instr_file": "./include/linux/device.h", "instr": "  %5 = getelementptr inbounds %struct.device, %struct.device* %4, i32 0, i32 3, !dbg !101544"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_name.1010"}, "warn_no": 1},
{"warn_data": {"at_line": 1101, "warn_str": "Trying to read from a user pointer.", "at": "  %11 = load i8*, i8** %10, align 8, !dbg !101547", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "dev_name.1010", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %3, align 8"}, {"instr_func": "dev_name.1010", "instr_loc": 1101, "instr_file": "./include/linux/device.h", "instr": "  %9 = load %struct.device*, %struct.device** %3, align 8, !dbg !101546"}, {"instr_func": "dev_name.1010", "instr_loc": 1101, "instr_file": "./include/linux/device.h", "instr": "  %10 = getelementptr inbounds %struct.device, %struct.device* %9, i32 0, i32 3, !dbg !101547"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_name.1010"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 713, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"lineno": 1103, "file": "./include/linux/device.h", "instr": "  %15 = call i8* @kobject_name.1013(%struct.kobject* %14) #13, !dbg !101551"}],
"warnings":[{"warn_data": {"at_line": 91, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !101545", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "do_dma_request", "instr_loc": 713, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rmcd_debug(DMA, \"%s(%d) uses %s for DMA_%s\","}, {"instr_func": "dev_name.1010", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %3, align 8"}, {"instr_func": "dev_name.1010", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %13 = load %struct.device*, %struct.device** %3, align 8, !dbg !101549"}, {"instr_func": "dev_name.1010", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %14 = getelementptr inbounds %struct.device, %struct.device* %13, i32 0, i32 0, !dbg !101550"}, {"instr_func": "dev_name.1010", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %15 = call i8* @kobject_name.1013(%struct.kobject* %14) #13, !dbg !101551"}, {"instr_func": "kobject_name.1013", "instr_loc": 90, "instr_file": "./include/linux/kobject.h", "instr": "  store %struct.kobject* %0, %struct.kobject** %2, align 8"}, {"instr_func": "kobject_name.1013", "instr_loc": 91, "instr_file": "./include/linux/kobject.h", "instr": "  %3 = load %struct.kobject*, %struct.kobject** %2, align 8, !dbg !101544"}, {"instr_func": "kobject_name.1013", "instr_loc": 91, "instr_file": "./include/linux/kobject.h", "instr": "  %4 = getelementptr inbounds %struct.kobject, %struct.kobject* %3, i32 0, i32 0, !dbg !101545"}], "at_file": "./include/linux/kobject.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "kobject_name.1013"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 719, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tx = prep_dma_xfer(chan, xfer, sgt, nents, dir,"}, {"lineno": 645, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_dma_prep_xfer(chan, transfer->rioid, &tx_data, dir, flags);"}],
"warnings":[{"warn_data": {"at_line": 1887, "warn_str": "Trying to read from a user pointer.", "at": "if (!dchan->device->device_prep_slave_sg) {", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 719, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tx = prep_dma_xfer(chan, xfer, sgt, nents, dir,"}, {"instr_func": "do_dma_request", "instr_loc": 719, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tx = prep_dma_xfer(chan, xfer, sgt, nents, dir,"}, {"instr_func": "prep_dma_xfer", "instr_loc": 619, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "prep_dma_xfer", "instr_loc": 645, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_dma_prep_xfer(chan, transfer->rioid, &tx_data, dir, flags);"}, {"instr_func": "prep_dma_xfer", "instr_loc": 645, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_dma_prep_xfer(chan, transfer->rioid, &tx_data, dir, flags);"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1884, "instr_file": "drivers/rapidio/rio.c", "instr": "{"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1887, "instr_file": "drivers/rapidio/rio.c", "instr": "if (!dchan->device->device_prep_slave_sg) {"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1887, "instr_file": "drivers/rapidio/rio.c", "instr": "if (!dchan->device->device_prep_slave_sg) {"}], "at_file": "drivers/rapidio/rio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rio_dma_prep_xfer"}, "warn_no": 1},
{"warn_data": {"at_line": 1887, "warn_str": "Trying to read from a user pointer.", "at": "if (!dchan->device->device_prep_slave_sg) {", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 719, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tx = prep_dma_xfer(chan, xfer, sgt, nents, dir,"}, {"instr_func": "do_dma_request", "instr_loc": 719, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tx = prep_dma_xfer(chan, xfer, sgt, nents, dir,"}, {"instr_func": "prep_dma_xfer", "instr_loc": 619, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "prep_dma_xfer", "instr_loc": 645, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_dma_prep_xfer(chan, transfer->rioid, &tx_data, dir, flags);"}, {"instr_func": "prep_dma_xfer", "instr_loc": 645, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_dma_prep_xfer(chan, transfer->rioid, &tx_data, dir, flags);"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1884, "instr_file": "drivers/rapidio/rio.c", "instr": "{"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1887, "instr_file": "drivers/rapidio/rio.c", "instr": "if (!dchan->device->device_prep_slave_sg) {"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1887, "instr_file": "drivers/rapidio/rio.c", "instr": "if (!dchan->device->device_prep_slave_sg) {"}, {"instr_func": "rio_dma_prep_xfer", "instr_loc": 1887, "instr_file": "drivers/rapidio/rio.c", "instr": "if (!dchan->device->device_prep_slave_sg) {"}], "at_file": "drivers/rapidio/rio.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rio_dma_prep_xfer"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 756, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_async_issue_pending(chan);"}],
"warnings":[{"warn_data": {"at_line": 1239, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load %struct.dma_device.1792*, %struct.dma_device.1792** %4, align 8, !dbg !101541", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 756, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_async_issue_pending(chan);"}, {"instr_func": "do_dma_request", "instr_loc": 756, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_async_issue_pending(chan);"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1238, "instr_file": "./include/linux/dmaengine.h", "instr": "  store %struct.dma_chan.1784* %0, %struct.dma_chan.1784** %2, align 8"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1239, "instr_file": "./include/linux/dmaengine.h", "instr": "  %3 = load %struct.dma_chan.1784*, %struct.dma_chan.1784** %2, align 8, !dbg !101540"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1239, "instr_file": "./include/linux/dmaengine.h", "instr": "  %4 = getelementptr inbounds %struct.dma_chan.1784, %struct.dma_chan.1784* %3, i32 0, i32 0, !dbg !101541"}], "at_file": "./include/linux/dmaengine.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dma_async_issue_pending.1123"}, "warn_no": 1},
{"warn_data": {"at_line": 1239, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load void (%struct.dma_chan.1784*)*, void (%struct.dma_chan.1784*)** %6, align 8, !dbg !101542", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 710, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "chan = priv->dmach;"}, {"instr_func": "do_dma_request", "instr_loc": 756, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_async_issue_pending(chan);"}, {"instr_func": "do_dma_request", "instr_loc": 756, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_async_issue_pending(chan);"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1238, "instr_file": "./include/linux/dmaengine.h", "instr": "  store %struct.dma_chan.1784* %0, %struct.dma_chan.1784** %2, align 8"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1239, "instr_file": "./include/linux/dmaengine.h", "instr": "  %3 = load %struct.dma_chan.1784*, %struct.dma_chan.1784** %2, align 8, !dbg !101540"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1239, "instr_file": "./include/linux/dmaengine.h", "instr": "  %4 = getelementptr inbounds %struct.dma_chan.1784, %struct.dma_chan.1784* %3, i32 0, i32 0, !dbg !101541"}, {"instr_func": "dma_async_issue_pending.1123", "instr_loc": 1239, "instr_file": "./include/linux/dmaengine.h", "instr": "  %6 = getelementptr inbounds %struct.dma_device.1792, %struct.dma_device.1792* %5, i32 0, i32 40, !dbg !101542"}], "at_file": "./include/linux/dmaengine.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dma_async_issue_pending.1123"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 760, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "list_add_tail(&req->node, &priv->async_list);"}, {"lineno": 93, "file": "./include/linux/list.h", "instr": "  call void @__list_add.1035(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}],
"warnings":[{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i64 %56, i64* %58, align 8, !dbg !101614", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.1035(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.1035", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %57 = load i8*, i8** %4, align 8, !dbg !101612"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.1035"}, "warn_no": 1},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %50, i32* %52, align 4, !dbg !101607", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.1035(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.1035", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %51 = load i8*, i8** %4, align 8, !dbg !101605"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.1035"}, "warn_no": 2},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i16 %44, i16* %46, align 2, !dbg !101600", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.1035(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.1035", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %45 = load i8*, i8** %4, align 8, !dbg !101598"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.1035"}, "warn_no": 3},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i8 %39, i8* %40, align 1, !dbg !101593", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  %8 = load %struct.list_head*, %struct.list_head** %7, align 8, !dbg !101547"}, {"instr_func": "list_add_tail.1033", "instr_loc": 93, "instr_file": "./include/linux/list.h", "instr": "  call void @__list_add.1035(%struct.list_head* %5, %struct.list_head* %8, %struct.list_head* %9) #13, !dbg !101549"}, {"instr_func": "__list_add.1035", "instr_loc": 59, "instr_file": "./include/linux/list.h", "instr": "  store %struct.list_head* %1, %struct.list_head** %8, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %30 = load %struct.list_head*, %struct.list_head** %8, align 8, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %31 = getelementptr inbounds %struct.list_head, %struct.list_head* %30, i32 0, i32 0, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 66, "instr_file": "./include/linux/list.h", "instr": "  %32 = bitcast %struct.list_head** %31 to i8*, !dbg !101586"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  store i8* %32, i8** %4, align 8"}, {"instr_func": "__list_add.1035", "instr_loc": 63, "instr_file": "./include/linux/list.h", "instr": "  %40 = load i8*, i8** %4, align 8, !dbg !101592"}], "at_file": "./include/linux/list.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__list_add.1035"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 938, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = do_dma_request(req, xfer, sync, nents);"}, {"lineno": 751, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "kref_put(&req->refcount, dma_req_free);"}, {"lineno": 65, "file": "./include/linux/kref.h", "instr": "  call void %10(%struct.qspinlock* %11) #13, !dbg !101550"}],
"warnings":[{"warn_data": {"at_line": 577, "warn_str": "Trying to read from a user pointer.", "at": "dma_unmap_sg(req->dmach->device->dev,", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "dma_req_free", "instr_loc": 577, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_unmap_sg(req->dmach->device->dev,"}, {"instr_func": "dma_req_free", "instr_loc": 577, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_unmap_sg(req->dmach->device->dev,"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dma_req_free"}, "warn_no": 1},
{"warn_data": {"at_line": 581, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < req->nr_pages; i++)", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "dma_req_free", "instr_loc": 581, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < req->nr_pages; i++)"}, {"instr_func": "dma_req_free", "instr_loc": 581, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < req->nr_pages; i++)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dma_req_free"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2119, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_transfer_ioctl(filp, (void __user *)arg);"}, {"lineno": 990, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_dma_transfer(filp, transaction.transfer_mode,"}, {"lineno": 954, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "kref_put(&req->refcount, dma_req_free);"}, {"lineno": 65, "file": "./include/linux/kref.h", "instr": "  call void %10(%struct.qspinlock* %11) #13, !dbg !101550"}],
"warnings":[{"warn_data": {"at_line": 577, "warn_str": "Trying to read from a user pointer.", "at": "dma_unmap_sg(req->dmach->device->dev,", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "dma_req_free", "instr_loc": 577, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_unmap_sg(req->dmach->device->dev,"}, {"instr_func": "dma_req_free", "instr_loc": 577, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "dma_unmap_sg(req->dmach->device->dev,"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dma_req_free"}, "warn_no": 1},
{"warn_data": {"at_line": 581, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < req->nr_pages; i++)", "inst_trace": [{"instr_func": "rio_mport_transfer_ioctl", "instr_loc": 980, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(transfer,"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 856, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "nr_pages = PAGE_ALIGN(xfer->length + offset) >> PAGE_SHIFT;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "rio_dma_transfer", "instr_loc": 891, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "req->nr_pages = nr_pages;"}, {"instr_func": "dma_req_free", "instr_loc": 581, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < req->nr_pages; i++)"}, {"instr_func": "dma_req_free", "instr_loc": 581, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < req->nr_pages; i++)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dma_req_free"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2117, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_wait_for_async_dma(filp, (void __user *)arg);"}, {"lineno": 1022, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}],
"warnings":[{"warn_data": {"at_line": 311, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %5 = add i64 %4, 4, !dbg !101544", "inst_trace": [{"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1005, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "_msecs_to_jiffies.1041", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies.1041", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !101543"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies.1041"}, "warn_no": 1},
{"warn_data": {"at_line": 311, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %6 = sub i64 %5, 1, !dbg !101545", "inst_trace": [{"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1005, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "rio_mport_wait_for_async_dma", "instr_loc": 1022, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "tmo = msecs_to_jiffies(w_param.timeout);"}, {"instr_func": "_msecs_to_jiffies.1041", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies.1041", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !101543"}, {"instr_func": "_msecs_to_jiffies.1041", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %5 = add i64 %4, 4, !dbg !101544"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies.1041"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2115, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_free_dma(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1148, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(EXIT, \"filp=%p\", filp);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2115, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_free_dma(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_free_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 1139, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_free_dma"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2113, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_alloc_dma(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1112, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_alloc_dma"}, "warn_no": 1},
{"warn_data": {"at_line": 1126, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "map.dma_handle = mapping->phys_addr;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_alloc_dma"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2111, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_inbound_free(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1328, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(IBW, \"%s filp=%p\", dev_name(&priv->md->dev), filp);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2111, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_inbound_free(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_inbound_free"}, "warn_no": 1},
{"warn_data": {"at_line": 1333, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&handle, arg, sizeof(handle)))", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_inbound_free"}, "warn_no": 2},
{"warn_data": {"at_line": 1338, "warn_str": "Loop is bounded by a tainted value.", "at": "if (map->dir == MAP_INBOUND && map->phys_addr == handle) {", "inst_trace": [{"instr_func": "rio_mport_inbound_free", "instr_loc": 1333, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (copy_from_user(&handle, arg, sizeof(handle)))"}, {"instr_func": "rio_mport_inbound_free", "instr_loc": 1338, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (map->dir == MAP_INBOUND && map->phys_addr == handle) {"}, {"instr_func": "rio_mport_inbound_free", "instr_loc": 1338, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (map->dir == MAP_INBOUND && map->phys_addr == handle) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_inbound_free"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2109, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_obw_free(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 472, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(OBW, \"h=0x%llx\", handle);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2109, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_obw_free(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_obw_free"}, "warn_no": 1},
{"warn_data": {"at_line": 469, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&handle, arg, sizeof(handle)))", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_obw_free"}, "warn_no": 2},
{"warn_data": {"at_line": 476, "warn_str": "Loop is bounded by a tainted value.", "at": "if (map->dir == MAP_OUTBOUND && map->phys_addr == handle) {", "inst_trace": [{"instr_func": "rio_mport_obw_free", "instr_loc": 469, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (copy_from_user(&handle, arg, sizeof(handle)))"}, {"instr_func": "rio_mport_obw_free", "instr_loc": 476, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (map->dir == MAP_OUTBOUND && map->phys_addr == handle) {"}, {"instr_func": "rio_mport_obw_free", "instr_loc": 476, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (map->dir == MAP_OUTBOUND && map->phys_addr == handle) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_obw_free"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2107, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_map_inbound(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1292, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(IBW, \"%s filp=%p\", dev_name(&priv->md->dev), filp);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2107, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_map_inbound(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_map_inbound"}, "warn_no": 1},
{"warn_data": {"at_line": 1289, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (unlikely(copy_from_user(&map, arg, sizeof(map))))", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_map_inbound"}, "warn_no": 2},
{"warn_data": {"at_line": 1299, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "map.handle = mapping->phys_addr;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_map_inbound"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2107, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_map_inbound(filp, (void __user *)arg);"}, {"lineno": 1294, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}],
"warnings":[{"warn_data": {"at_line": 1265, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(raddr + size) > map->rio_addr) {", "inst_trace": [{"instr_func": "rio_mport_map_inbound", "instr_loc": 1289, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(&map, arg, sizeof(map))))"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1294, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1294, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1248, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1265, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_get_inbound_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 1264, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (raddr < (map->rio_addr + map->size - 1) &&", "inst_trace": [{"instr_func": "rio_mport_map_inbound", "instr_loc": 1289, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(&map, arg, sizeof(map))))"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1294, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1294, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1248, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1265, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1265, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1265, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_get_inbound_mapping"}, "warn_no": 2},
{"warn_data": {"at_line": 1259, "warn_str": "Loop is bounded by a tainted value.", "at": "if (raddr == map->rio_addr && size == map->size) {", "inst_trace": [{"instr_func": "rio_mport_map_inbound", "instr_loc": 1289, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (unlikely(copy_from_user(&map, arg, sizeof(map))))"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1295, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "map.length, &mapping);"}, {"instr_func": "rio_mport_map_inbound", "instr_loc": 1294, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_inbound_mapping(md, filp, map.rio_addr,"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1248, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1259, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (raddr == map->rio_addr && size == map->size) {"}, {"instr_func": "rio_mport_get_inbound_mapping", "instr_loc": 1259, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "if (raddr == map->rio_addr && size == map->size) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_get_inbound_mapping"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2105, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_obw_map(filp, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 436, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(OBW, \"did=%d ra=0x%llx sz=0x%llx\",", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2105, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_obw_map(filp, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_mport_obw_map"}, "warn_no": 1},
{"warn_data": {"at_line": 426, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_obw_map"}, "warn_no": 2},
{"warn_data": {"at_line": 446, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "map.handle = paddr;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_obw_map"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2105, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_obw_map(filp, (void __user *)arg);"}, {"lineno": 439, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_outbound_mapping(data, filp, map.rioid,"}],
"warnings":[{"warn_data": {"at_line": 411, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(raddr + size) > map->rio_addr) {", "inst_trace": [{"instr_func": "rio_mport_obw_map", "instr_loc": 426, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 440, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "map.rio_addr, map.length, &paddr);"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 439, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_outbound_mapping(data, filp, map.rioid,"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 396, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 411, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_get_outbound_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 409, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (rioid == map->rioid &&", "inst_trace": [{"instr_func": "rio_mport_obw_map", "instr_loc": 426, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 440, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "map.rio_addr, map.length, &paddr);"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 439, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_outbound_mapping(data, filp, map.rioid,"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 396, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 411, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 411, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 411, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(raddr + size) > map->rio_addr) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_get_outbound_mapping"}, "warn_no": 2},
{"warn_data": {"at_line": 404, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rioid == map->rioid &&", "inst_trace": [{"instr_func": "rio_mport_obw_map", "instr_loc": 426, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 440, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "map.rio_addr, map.length, &paddr);"}, {"instr_func": "rio_mport_obw_map", "instr_loc": 439, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_mport_get_outbound_mapping(data, filp, map.rioid,"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 396, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 405, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "raddr == map->rio_addr && size == map->size) {"}, {"instr_func": "rio_mport_get_outbound_mapping", "instr_loc": 405, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "raddr == map->rio_addr && size == map->size) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_get_outbound_mapping"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2095, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_remove_pw_filter(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1604, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_remove_pw_filter"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2093, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_pw_filter(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1547, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_add_pw_filter"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2091, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_remove_db_filter(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1474, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_remove_db_filter"}, "warn_no": 1},
{"warn_data": {"at_line": 1488, "warn_str": "Loop is bounded by a tainted value.", "at": "if (db_filter->filter.rioid == filter.rioid &&", "inst_trace": [{"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1474, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1490, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "db_filter->filter.high == filter.high) {"}, {"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1490, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "db_filter->filter.high == filter.high) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_remove_db_filter"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2089, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_db_filter(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1428, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_add_db_filter"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2091, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_remove_db_filter(data, (void __user *)arg);"}, {"lineno": 1499, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(priv->md->mport, filter.low, filter.high);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((dbell->res->start == start) && (dbell->res->end == end)) {", "inst_trace": [{"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1474, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1499, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(priv->md->mport, filter.low, filter.high);"}, {"instr_func": "rio_mport_remove_db_filter", "instr_loc": 1499, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(priv->md->mport, filter.low, filter.high);"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 475, "instr_file": "drivers/rapidio/rio.c", "instr": "{"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 481, "instr_file": "drivers/rapidio/rio.c", "instr": "if ((dbell->res->start == start) && (dbell->res->end == end)) {"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 481, "instr_file": "drivers/rapidio/rio.c", "instr": "if ((dbell->res->start == start) && (dbell->res->end == end)) {"}], "at_file": "drivers/rapidio/rio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_release_inb_dbell"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2089, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_db_filter(data, (void __user *)arg);"}, {"lineno": 1441, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_request_inb_dbell(md->mport, md, filter.low, filter.high,"}, {"lineno": 455, "file": "drivers/rapidio/rio.c", "instr": "rc = rio_setup_inb_dbell(mport, dev_id, res, dinb);"}],
"warnings":[{"warn_data": {"at_line": 405, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2089, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_db_filter(data, (void __user *)arg);"}, {"instr_func": "rio_mport_add_db_filter", "instr_loc": 1441, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "ret = rio_request_inb_dbell(md->mport, md, filter.low, filter.high,"}, {"instr_func": "rio_request_inb_dbell", "instr_loc": 455, "instr_file": "drivers/rapidio/rio.c", "instr": "rc = rio_setup_inb_dbell(mport, dev_id, res, dinb);"}], "at_file": "drivers/rapidio/rio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "rio_setup_inb_dbell"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2089, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_add_db_filter(data, (void __user *)arg);"}, {"lineno": 1451, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(md->mport, filter.low, filter.high);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((dbell->res->start == start) && (dbell->res->end == end)) {", "inst_trace": [{"instr_func": "rio_mport_add_db_filter", "instr_loc": 1428, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_add_db_filter", "instr_loc": 1451, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(md->mport, filter.low, filter.high);"}, {"instr_func": "rio_mport_add_db_filter", "instr_loc": 1451, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "rio_release_inb_dbell(md->mport, filter.low, filter.high);"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 475, "instr_file": "drivers/rapidio/rio.c", "instr": "{"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 481, "instr_file": "drivers/rapidio/rio.c", "instr": "if ((dbell->res->start == start) && (dbell->res->end == end)) {"}, {"instr_func": "rio_release_inb_dbell", "instr_loc": 481, "instr_file": "drivers/rapidio/rio.c", "instr": "if ((dbell->res->start == start) && (dbell->res->end == end)) {"}], "at_file": "drivers/rapidio/rio.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_release_inb_dbell"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2081, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_port_idx_get(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1361, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(MPORT, \"port_index=%d\", port_idx);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2081, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_port_idx_get(data, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "maint_port_idx_get"}, "warn_no": 1},
{"warn_data": {"at_line": 1363, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &port_idx, sizeof(port_idx)))", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "maint_port_idx_get"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2079, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_comptag_set(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 518, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "maint_comptag_set"}, "warn_no": 1},
{"warn_data": {"at_line": 527, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(MPORT, \"Set host Component Tag to %d\", comptag);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2079, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_comptag_set(data, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "maint_comptag_set"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2077, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_hdid_set(data, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 507, "warn_str": "Trying to use a global variable without locking.", "at": "rmcd_debug(MPORT, \"Set host device Id to %d\", hdid);", "inst_trace": [{"instr_func": "mport_cdev_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "mport_cdev_ioctl", "instr_loc": 2077, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return maint_hdid_set(data, (void __user *)arg);"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "maint_hdid_set"}, "warn_no": 1},
{"warn_data": {"at_line": 496, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "maint_hdid_set"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2075, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_maint_wr(data, (void __user *)arg, 0);"}],
"warnings":[{"warn_data": {"at_line": 305, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 1},
{"warn_data": {"at_line": 318, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 318, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 2},
{"warn_data": {"at_line": 324, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "length = maint_io.length;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 3},
{"warn_data": {"at_line": 346, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "offset += 4;", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 332, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 332, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 346, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset += 4;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 4},
{"warn_data": {"at_line": 335, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < length; i++) {", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 335, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 335, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 5}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2073, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_maint_rd(data, (void __user *)arg, 0);"}],
"warnings":[{"warn_data": {"at_line": 260, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 1},
{"warn_data": {"at_line": 273, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 273, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 2},
{"warn_data": {"at_line": 292, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "offset += 4;", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 280, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 280, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 292, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset += 4;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 3},
{"warn_data": {"at_line": 282, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < length; i++) {", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 282, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 282, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 4},
{"warn_data": {"at_line": 295, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (unlikely(copy_to_user((void __user *)(uintptr_t)maint_io.buffer,", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 5}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2071, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_maint_wr(data, (void __user *)arg, 1);"}],
"warnings":[{"warn_data": {"at_line": 318, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 318, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 1},
{"warn_data": {"at_line": 305, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 2},
{"warn_data": {"at_line": 324, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "length = maint_io.length;", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 3},
{"warn_data": {"at_line": 346, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "offset += 4;", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 332, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 332, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 346, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset += 4;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 4},
{"warn_data": {"at_line": 335, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < length; i++) {", "inst_trace": [{"instr_func": "rio_mport_maint_wr", "instr_loc": 305, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 324, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length;"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 335, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}, {"instr_func": "rio_mport_maint_wr", "instr_loc": 335, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_maint_wr"}, "warn_no": 5}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 2069, "file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "return rio_mport_maint_rd(data, (void __user *)arg, 1);"}],
"warnings":[{"warn_data": {"at_line": 260, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 1},
{"warn_data": {"at_line": 273, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 273, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "(maint_io.length + maint_io.offset) > RIO_MAINT_SPACE_SZ)"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 2},
{"warn_data": {"at_line": 292, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "offset += 4;", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 280, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 280, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset = maint_io.offset;"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 292, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "offset += 4;"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "IntegerOverflowDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 3},
{"warn_data": {"at_line": 282, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < length; i++) {", "inst_trace": [{"instr_func": "rio_mport_maint_rd", "instr_loc": 260, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "{"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 279, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "length = maint_io.length/sizeof(u32);"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 282, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}, {"instr_func": "rio_mport_maint_rd", "instr_loc": 282, "instr_file": "drivers/rapidio/devices/rio_mport_cdev.c", "instr": "for (i = 0; i < length; i++) {"}], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 4},
{"warn_data": {"at_line": 295, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (unlikely(copy_to_user((void __user *)(uintptr_t)maint_io.buffer,", "inst_trace": [], "at_file": "drivers/rapidio/devices/rio_mport_cdev.c", "by": "TaintedSizeDetector says:", "at_func": "rio_mport_maint_rd"}, "warn_no": 5}]}]}