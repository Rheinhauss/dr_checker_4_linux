{"all_contexts":[
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2477, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}],
"warnings":[{"warn_data": {"at_line": 704, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < num_of_cmds; i++) {", "inst_trace": [{"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 681, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 704, "instr_file": "drivers/mmc/core/block.c", "instr": "for (i = 0; i < num_of_cmds; i++) {"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 704, "instr_file": "drivers/mmc/core/block.c", "instr": "for (i = 0; i < num_of_cmds; i++) {"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedLoopBoundDetector says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 681, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 746, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < num_of_cmds; i++) {", "inst_trace": [{"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 681, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 746, "instr_file": "drivers/mmc/core/block.c", "instr": "for (i = 0; i < num_of_cmds; i++) {"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 746, "instr_file": "drivers/mmc/core/block.c", "instr": "for (i = 0; i < num_of_cmds; i++) {"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedLoopBoundDetector says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 706, "warn_str": "Loop is bounded by a tainted value.", "at": "if (IS_ERR(idata[i])) {", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 706, "instr_file": "drivers/mmc/core/block.c", "instr": "if (IS_ERR(idata[i])) {"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 706, "instr_file": "drivers/mmc/core/block.c", "instr": "if (IS_ERR(idata[i])) {"}, {"instr_func": "IS_ERR", "instr_loc": 35, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %4 = ptrtoint i8* %3 to i64, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %5 = inttoptr i64 %4 to i8*, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %7 = icmp uge i64 %6, -4095, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %8 = xor i1 %7, true, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %9 = xor i1 %8, true, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %10 = zext i1 %9 to i32, !dbg !170422"}, {"instr_func": "IS_ERR", "instr_loc": 36, "instr_file": "./include/linux/err.h", "instr": "  %12 = icmp ne i64 %11, 0, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 706, "instr_file": "drivers/mmc/core/block.c", "instr": "if (IS_ERR(idata[i])) {"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedLoopBoundDetector says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 747, "warn_str": "Trying to read from a user pointer.", "at": "kfree(idata[i]->buf);", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 747, "instr_file": "drivers/mmc/core/block.c", "instr": "kfree(idata[i]->buf);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 747, "instr_file": "drivers/mmc/core/block.c", "instr": "kfree(idata[i]->buf);"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 5},
{"warn_data": {"at_line": 727, "warn_str": "Trying to read from a user pointer.", "at": "idata[0]->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 727, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[0]->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 727, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[0]->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 727, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[0]->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_multi_cmd"}, "warn_no": 6}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2472, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_cmd(rpmb->md,"}],
"warnings":[{"warn_data": {"at_line": 644, "warn_str": "Trying to write to a user pointer.", "at": "idata->rpmb = rpmb;", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 644, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->rpmb = rpmb;"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 644, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->rpmb = rpmb;"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 673, "warn_str": "Trying to read from a user pointer.", "at": "kfree(idata->buf);", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 673, "instr_file": "drivers/mmc/core/block.c", "instr": "kfree(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 673, "instr_file": "drivers/mmc/core/block.c", "instr": "kfree(idata->buf);"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 657, "warn_str": "Trying to read from a user pointer.", "at": "idata->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 657, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 657, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 657, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->ic.write_flag ? REQ_OP_DRV_OUT : REQ_OP_DRV_IN, 0);"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_cmd"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2477, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}, {"lineno": 700, "file": "drivers/mmc/core/block.c", "instr": "idata = kcalloc(num_of_cmds, sizeof(*idata), GFP_KERNEL);"}, {"lineno": 687, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.23(i64 %7, i64 %8, i32 %10) #15, !dbg !170429"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %221 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %220, !dbg !170663", "inst_trace": [{"instr_func": "mmc_rpmb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "mmc_rpmb_ioctl", "instr_loc": 2477, "instr_file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 700, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = kcalloc(num_of_cmds, sizeof(*idata), GFP_KERNEL);"}, {"instr_func": "kcalloc.22", "instr_loc": 687, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.23(i64 %7, i64 %8, i32 %10) #15, !dbg !170429"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array.23"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2477, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}, {"lineno": 705, "file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}],
"warnings":[{"warn_data": {"at_line": 362, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_from_user"}, "warn_no": 1},
{"warn_data": {"at_line": 352, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "mmc_rpmb_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "mmc_rpmb_ioctl", "instr_loc": 2477, "instr_file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}], "at_file": "drivers/mmc/core/block.c", "by": "GlobalVariableRaceDetector says:", "at_func": "mmc_blk_ioctl_copy_from_user"}, "warn_no": 2}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2477, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_multi_cmd(rpmb->md,"}, {"lineno": 741, "file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}],
"warnings":[{"warn_data": {"at_line": 395, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 402, "warn_str": "Trying to read from a user pointer.", "at": "if (!idata->ic.write_flag) {", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 2},
{"warn_data": {"at_line": 403, "warn_str": "Trying to read from a user pointer.", "at": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 403, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 403, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 3},
{"warn_data": {"at_line": 404, "warn_str": "Trying to read from a user pointer.", "at": "idata->buf, idata->buf_bytes))", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 4},
{"warn_data": {"at_line": 404, "warn_str": "Trying to read from a user pointer.", "at": "idata->buf, idata->buf_bytes))", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 705, "instr_file": "drivers/mmc/core/block.c", "instr": "idata[i] = mmc_blk_ioctl_copy_from_user(&cmds[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_multi_cmd", "instr_loc": 741, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(&cmds[i], idata[i]);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 5},
{"warn_data": {"at_line": 403, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2472, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_cmd(rpmb->md,"}, {"lineno": 640, "file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}],
"warnings":[{"warn_data": {"at_line": 362, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_from_user"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2472, "file": "drivers/mmc/core/block.c", "instr": "ret = mmc_blk_ioctl_cmd(rpmb->md,"}, {"lineno": 669, "file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}],
"warnings":[{"warn_data": {"at_line": 402, "warn_str": "Trying to read from a user pointer.", "at": "if (!idata->ic.write_flag) {", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 402, "instr_file": "drivers/mmc/core/block.c", "instr": "if (!idata->ic.write_flag) {"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 1},
{"warn_data": {"at_line": 395, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 2},
{"warn_data": {"at_line": 403, "warn_str": "Trying to read from a user pointer.", "at": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 396, "instr_file": "drivers/mmc/core/block.c", "instr": "struct mmc_ioc_cmd *ic = &idata->ic;"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 403, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 403, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 3},
{"warn_data": {"at_line": 404, "warn_str": "Trying to read from a user pointer.", "at": "idata->buf, idata->buf_bytes))", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 4},
{"warn_data": {"at_line": 404, "warn_str": "Trying to read from a user pointer.", "at": "idata->buf, idata->buf_bytes))", "inst_trace": [{"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 362, "instr_file": "drivers/mmc/core/block.c", "instr": "if (copy_from_user(&idata->ic, user, sizeof(idata->ic))) {"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "PTR_ERR", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 381, "instr_file": "drivers/mmc/core/block.c", "instr": "err = PTR_ERR(idata->buf);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "ERR_PTR", "instr_loc": 25, "instr_file": "./include/linux/err.h", "instr": "  store i64 %0, i64* %2, align 8"}, {"instr_func": "ERR_PTR", "instr_loc": 26, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i64, i64* %2, align 8, !dbg !170422"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 390, "instr_file": "drivers/mmc/core/block.c", "instr": "return ERR_PTR(err);"}, {"instr_func": "mmc_blk_ioctl_copy_from_user", "instr_loc": 391, "instr_file": "drivers/mmc/core/block.c", "instr": "}"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 640, "instr_file": "drivers/mmc/core/block.c", "instr": "idata = mmc_blk_ioctl_copy_from_user(ic_ptr);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_cmd", "instr_loc": 669, "instr_file": "drivers/mmc/core/block.c", "instr": "err = mmc_blk_ioctl_copy_to_user(ic_ptr, idata);"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 395, "instr_file": "drivers/mmc/core/block.c", "instr": "{"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}, {"instr_func": "mmc_blk_ioctl_copy_to_user", "instr_loc": 404, "instr_file": "drivers/mmc/core/block.c", "instr": "idata->buf, idata->buf_bytes))"}], "at_file": "drivers/mmc/core/block.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 5},
{"warn_data": {"at_line": 403, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)(unsigned long)ic->data_ptr,", "inst_trace": [], "at_file": "drivers/mmc/core/block.c", "by": "TaintedSizeDetector says:", "at_func": "mmc_blk_ioctl_copy_to_user"}, "warn_no": 6}]}]}