{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}],
"warnings":[{"warn_data": {"at_line": 2257, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_ioctl_main"}, "warn_no": 1},
{"warn_data": {"at_line": 2315, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&karg, arg, sizeof(karg))) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_ioctl_main"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2271, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_verify_adapter(ioctl_header.ioc_number,"}],
"warnings":[{"warn_data": {"at_line": 415, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "_ctl_mpt2_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "_ctl_mpt2_ioctl", "instr_loc": 2418, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"instr_func": "_ctl_ioctl_main", "instr_loc": 2271, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_verify_adapter(ioctl_header.ioc_number,"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_ctl_verify_adapter"}, "warn_no": 1}]},
{"num_warnings": 12,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2369, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_read_buffer(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 2068, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2068, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2068, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 1},
{"warn_data": {"at_line": 2033, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 2},
{"warn_data": {"at_line": 2062, "warn_str": "Trying to read from a user pointer.", "at": "if (karg.unique_id != ioc->unique_id[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2062, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2062, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 3},
{"warn_data": {"at_line": 2075, "warn_str": "Trying to read from a user pointer.", "at": "request_size = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 4},
{"warn_data": {"at_line": 2095, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "copy_size = request_size - karg.starting_offset;", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2075, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2095, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "copy_size = request_size - karg.starting_offset;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "IntegerOverflowDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 5},
{"warn_data": {"at_line": 2112, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2112, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2112, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 6},
{"warn_data": {"at_line": 2099, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)uarg->diagnostic_data,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 7},
{"warn_data": {"at_line": 2144, "warn_str": "Trying to read from a user pointer.", "at": "cpu_to_le32(ioc->diag_buffer_sz[buffer_type]);", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2144, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->diag_buffer_sz[buffer_type]);"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2144, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->diag_buffer_sz[buffer_type]);"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 8},
{"warn_data": {"at_line": 2146, "warn_str": "Trying to read from a user pointer.", "at": "cpu_to_le64(ioc->diag_buffer_dma[buffer_type]);", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2146, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le64(ioc->diag_buffer_dma[buffer_type]);"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2146, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le64(ioc->diag_buffer_dma[buffer_type]);"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 9},
{"warn_data": {"at_line": 2149, "warn_str": "Trying to read from a user pointer.", "at": "cpu_to_le32(ioc->product_specific[buffer_type][i]);", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2149, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2149, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2149, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 10},
{"warn_data": {"at_line": 2177, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2177, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2177, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 11},
{"warn_data": {"at_line": 2177, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2033, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2055, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2177, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_read_buffer", "instr_loc": 2177, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_read_buffer"}, "warn_no": 12}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2365, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_release(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1955, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_release"}, "warn_no": 1},
{"warn_data": {"at_line": 1978, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1978, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1978, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 2},
{"warn_data": {"at_line": 1985, "warn_str": "Trying to read from a user pointer.", "at": "if (karg.unique_id != ioc->unique_id[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1985, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1985, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 3},
{"warn_data": {"at_line": 1991, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1991, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1991, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 4},
{"warn_data": {"at_line": 1998, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1998, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1998, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 5},
{"warn_data": {"at_line": 2007, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2007, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2007, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 6},
{"warn_data": {"at_line": 2009, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2009, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_release", "instr_loc": 2009, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 7},
{"warn_data": {"at_line": 2009, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2009, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_release", "instr_loc": 2009, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 8},
{"warn_data": {"at_line": 2011, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2011, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_release", "instr_loc": 2011, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 9},
{"warn_data": {"at_line": 2011, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] &=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2011, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}, {"instr_func": "_ctl_diag_release", "instr_loc": 2011, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] &="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_release"}, "warn_no": 10}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2365, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_release(ioc, arg);"}, {"lineno": 2018, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}],
"warnings":[{"warn_data": {"at_line": 1929, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1855, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1929, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1929, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mpt3sas_send_diag_release"}, "warn_no": 1},
{"warn_data": {"at_line": 1929, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1855, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1929, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1929, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mpt3sas_send_diag_release"}, "warn_no": 2},
{"warn_data": {"at_line": 1871, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1855, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1871, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1871, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mpt3sas_send_diag_release"}, "warn_no": 3},
{"warn_data": {"at_line": 1873, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1855, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1873, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1873, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mpt3sas_send_diag_release"}, "warn_no": 4},
{"warn_data": {"at_line": 1873, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_release", "instr_loc": 1955, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 1971, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "_ctl_diag_release", "instr_loc": 2018, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = mpt3sas_send_diag_release(ioc, buffer_type, &issue_reset);"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1855, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1873, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "mpt3sas_send_diag_release", "instr_loc": 1873, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mpt3sas_send_diag_release"}, "warn_no": 5}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2361, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_query(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1774, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_query"}, "warn_no": 1},
{"warn_data": {"at_line": 1806, "warn_str": "Trying to read from a user pointer.", "at": "if (karg.unique_id != ioc->unique_id[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1806, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1806, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 2},
{"warn_data": {"at_line": 1798, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1798, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1798, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 3},
{"warn_data": {"at_line": 1813, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1813, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1813, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 4},
{"warn_data": {"at_line": 1820, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->diag_buffer_status[buffer_type] & MPT3_DIAG_BUFFER_IS_RELEASED)", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1820, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] & MPT3_DIAG_BUFFER_IS_RELEASED)"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1820, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] & MPT3_DIAG_BUFFER_IS_RELEASED)"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 5},
{"warn_data": {"at_line": 1830, "warn_str": "Trying to read from a user pointer.", "at": "ioc->product_specific[buffer_type][i];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1830, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1830, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1830, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->product_specific[buffer_type][i];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 6},
{"warn_data": {"at_line": 1832, "warn_str": "Trying to read from a user pointer.", "at": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1832, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1832, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 7},
{"warn_data": {"at_line": 1834, "warn_str": "Trying to read from a user pointer.", "at": "karg.unique_id = ioc->unique_id[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1834, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.unique_id = ioc->unique_id[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1834, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.unique_id = ioc->unique_id[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 8},
{"warn_data": {"at_line": 1835, "warn_str": "Trying to read from a user pointer.", "at": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_query", "instr_loc": 1774, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1790, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.buffer_type;"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1835, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];"}, {"instr_func": "_ctl_diag_query", "instr_loc": 1835, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "karg.diagnostic_flags = ioc->diagnostic_flags[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_query"}, "warn_no": 9},
{"warn_data": {"at_line": 1832, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.total_buffer_size = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_query"}, "warn_no": 10}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2357, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_unregister(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1705, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 1},
{"warn_data": {"at_line": 1728, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1728, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1728, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 2},
{"warn_data": {"at_line": 1734, "warn_str": "Trying to read from a user pointer.", "at": "if ((ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1734, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1734, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if ((ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 3},
{"warn_data": {"at_line": 1741, "warn_str": "Trying to read from a user pointer.", "at": "if (karg.unique_id != ioc->unique_id[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1741, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1741, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (karg.unique_id != ioc->unique_id[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 4},
{"warn_data": {"at_line": 1747, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1747, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1747, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 5},
{"warn_data": {"at_line": 1754, "warn_str": "Trying to read from a user pointer.", "at": "request_data_sz = ioc->diag_buffer_sz[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1754, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_sz = ioc->diag_buffer_sz[buffer_type];"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1754, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_sz = ioc->diag_buffer_sz[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 6},
{"warn_data": {"at_line": 1755, "warn_str": "Trying to read from a user pointer.", "at": "request_data_dma = ioc->diag_buffer_dma[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1755, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1755, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 7},
{"warn_data": {"at_line": 1759, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1759, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1759, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 8},
{"warn_data": {"at_line": 1758, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer[buffer_type] = NULL;", "inst_trace": [{"instr_func": "_ctl_diag_unregister", "instr_loc": 1705, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = karg.unique_id & 0x000000ff;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1758, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = NULL;"}, {"instr_func": "_ctl_diag_unregister", "instr_loc": 1758, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = NULL;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_unregister"}, "warn_no": 9}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2353, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_register(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1681, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_diag_register"}, "warn_no": 1}]},
{"num_warnings": 16,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2353, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_diag_register(ioc, arg);"}, {"lineno": 1691, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_diag_register_2(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1556, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1556, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1556, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = request_data_sz;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 1},
{"warn_data": {"at_line": 1500, "warn_str": "Trying to read from a user pointer.", "at": "if (ioc->diag_buffer_status[buffer_type] &", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1500, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1500, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (ioc->diag_buffer_status[buffer_type] &"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 2},
{"warn_data": {"at_line": 1526, "warn_str": "Trying to read from a user pointer.", "at": "request_data = ioc->diag_buffer[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1526, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1526, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data = ioc->diag_buffer[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 3},
{"warn_data": {"at_line": 1528, "warn_str": "Trying to write to a user pointer.", "at": "ioc->unique_id[buffer_type] = diag_register->unique_id;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1528, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] = diag_register->unique_id;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1528, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->unique_id[buffer_type] = diag_register->unique_id;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 4},
{"warn_data": {"at_line": 1529, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1529, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1529, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 5},
{"warn_data": {"at_line": 1532, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1532, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1532, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diagnostic_flags[buffer_type] = diag_register->diagnostic_flags;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 6},
{"warn_data": {"at_line": 1535, "warn_str": "Trying to read from a user pointer.", "at": "request_data_dma = ioc->diag_buffer_dma[buffer_type];", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1535, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1535, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "request_data_dma = ioc->diag_buffer_dma[buffer_type];"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 7},
{"warn_data": {"at_line": 1536, "warn_str": "Trying to read from a user pointer.", "at": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1536, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1536, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (request_data_sz != ioc->diag_buffer_sz[buffer_type]) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 8},
{"warn_data": {"at_line": 1538, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type],", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1538, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type],"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1538, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type],"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 9},
{"warn_data": {"at_line": 1545, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_sz[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1545, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1545, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_sz[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 10},
{"warn_data": {"at_line": 1546, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_dma[buffer_type] = 0;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1546, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = 0;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1546, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = 0;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 11},
{"warn_data": {"at_line": 1555, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer[buffer_type] = request_data;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1555, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = request_data;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1555, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer[buffer_type] = request_data;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 12},
{"warn_data": {"at_line": 1557, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1557, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1557, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_dma[buffer_type] = request_data_dma;"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 13},
{"warn_data": {"at_line": 1576, "warn_str": "Trying to read from a user pointer.", "at": "cpu_to_le32(ioc->product_specific[buffer_type][i]);", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1576, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1576, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1576, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "cpu_to_le32(ioc->product_specific[buffer_type][i]);"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 14},
{"warn_data": {"at_line": 1602, "warn_str": "Trying to write to a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1602, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1602, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 15},
{"warn_data": {"at_line": 1602, "warn_str": "Trying to read from a user pointer.", "at": "ioc->diag_buffer_status[buffer_type] |=", "inst_trace": [{"instr_func": "_ctl_diag_register", "instr_loc": 1681, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1493, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "buffer_type = diag_register->buffer_type;"}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1602, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}, {"instr_func": "_ctl_diag_register_2", "instr_loc": 1602, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ioc->diag_buffer_status[buffer_type] |="}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "_ctl_diag_register_2"}, "warn_no": 16}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2349, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1394, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_btdh_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 1413, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &karg, sizeof(karg))) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_btdh_mapping"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2349, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1407, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_btdh_search_sas_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1303, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == sas_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1304, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "sas_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1304, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "sas_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_sas_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1297, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1298, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == sas_device->handle) {"}, {"instr_func": "_ctl_btdh_search_sas_device", "instr_loc": 1298, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == sas_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_sas_device"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2349, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1409, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "rc = _ctl_btdh_search_pcie_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1333, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1334, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == pcie_device->handle) {"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1334, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == pcie_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_pcie_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1339, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == pcie_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1340, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "pcie_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_pcie_device", "instr_loc": 1340, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "pcie_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_pcie_device"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2349, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_btdh_mapping(ioc, arg);"}, {"lineno": 1411, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "_ctl_btdh_search_raid_device(ioc, &karg);"}],
"warnings":[{"warn_data": {"at_line": 1369, "warn_str": "Loop is bounded by a tainted value.", "at": "if (btdh->bus == 0xFFFFFFFF && btdh->id == 0xFFFFFFFF &&", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1370, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == raid_device->handle) {"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1370, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "btdh->handle == raid_device->handle) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_raid_device"}, "warn_no": 1},
{"warn_data": {"at_line": 1375, "warn_str": "Loop is bounded by a tainted value.", "at": "} else if (btdh->bus == raid_device->channel && btdh->id ==", "inst_trace": [{"instr_func": "_ctl_btdh_mapping", "instr_loc": 1394, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1376, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "raid_device->id && btdh->handle == 0xFFFF) {"}, {"instr_func": "_ctl_btdh_search_raid_device", "instr_loc": 1376, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "raid_device->id && btdh->handle == 0xFFFF) {"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "_ctl_btdh_search_raid_device"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2345, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_reset(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1257, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_reset"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2341, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventreport(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1227, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "number_bytes = karg.hdr.max_data_size -", "inst_trace": [{"instr_func": "_ctl_eventreport", "instr_loc": 1213, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "{"}, {"instr_func": "_ctl_eventreport", "instr_loc": 1227, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "number_bytes = karg.hdr.max_data_size -"}], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "IntegerOverflowDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 1},
{"warn_data": {"at_line": 1213, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 2},
{"warn_data": {"at_line": 1238, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "number_bytes = max * sizeof(struct MPT3_IOCTL_EVENTS);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventreport"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2338, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventenable(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1175, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventenable"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2334, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_eventquery(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1144, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventquery"}, "warn_no": 1},
{"warn_data": {"at_line": 1156, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.event_entries = MPT3SAS_CTL_EVENT_LOG_SIZE;", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_eventquery"}, "warn_no": 2}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}],
"warnings":[{"warn_data": {"at_line": 687, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 1},
{"warn_data": {"at_line": 741, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data_out, karg.data_out_buf_ptr,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 2},
{"warn_data": {"at_line": 995, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.data_in_buf_ptr, data_in,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 3},
{"warn_data": {"at_line": 1006, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 4},
{"warn_data": {"at_line": 1028, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_sense_bytes, sz_arg);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 2219, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "uarg = (struct mpt3_ioctl_command32 __user *) arg;", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_compat_mpt_command"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 898, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 898, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 898, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 842, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_set_task_mid(ioc, &karg, tm_request)) {"}],
"warnings":[{"warn_data": {"at_line": 615, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg->max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_set_task_mid"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 850, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 850, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 850, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 812, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 812, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 812, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2328, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 792, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 792, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 792, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2299, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_getiocinfo(ioc, arg);"}],
"warnings":[{"warn_data": {"at_line": 1127, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "karg.bios_version = le32_to_cpu(ioc->bios_pg3.BiosVersion);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_getiocinfo"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}],
"warnings":[{"warn_data": {"at_line": 687, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 1},
{"warn_data": {"at_line": 741, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data_out, karg.data_out_buf_ptr,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 2},
{"warn_data": {"at_line": 995, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(karg.data_in_buf_ptr, data_in,", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 3},
{"warn_data": {"at_line": 1006, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 4},
{"warn_data": {"at_line": 1028, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg.max_sense_bytes, sz_arg);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_do_mpt_command"}, "warn_no": 5}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 898, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 898, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 898, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 842, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (_ctl_set_task_mid(ioc, &karg, tm_request)) {"}],
"warnings":[{"warn_data": {"at_line": 615, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sz = min_t(u32, karg->max_reply_bytes, ioc->reply_sz);", "inst_trace": [], "at_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "by": "TaintedSizeDetector says:", "at_func": "_ctl_set_task_mid"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 850, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 850, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 850, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 812, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 812, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 812, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 2418, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_ioctl_main(file, cmd, (void __user *)arg, 0, MPI2_VERSION);"}, {"lineno": 2311, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "ret = _ctl_compat_mpt_command(ioc, cmd, arg);"}, {"lineno": 2241, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "return _ctl_do_mpt_command(ioc, karg, &uarg->mf);"}, {"lineno": 792, "file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !7776", "inst_trace": [{"instr_func": "_ctl_do_mpt_command", "instr_loc": 687, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (copy_from_user(mpi_request, mf, karg.data_sge_offset*4)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 721, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "device_handle = le16_to_cpu(mpi_request->FunctionDependent1);"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 792, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "_ctl_do_mpt_command", "instr_loc": 792, "instr_file": "drivers/scsi/mpt3sas/mpt3sas_ctl.c", "instr": "if (test_bit(device_handle, ioc->device_remove_in_progress)) {"}, {"instr_func": "test_bit", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !7772"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !7777"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !7778"}, {"instr_func": "test_bit", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !7776"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit"}, "warn_no": 1}]}]}