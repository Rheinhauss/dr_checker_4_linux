{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 363, "file": "drivers/usb/wusbcore/security.c", "instr": "hs = kcalloc(3, sizeof(hs[0]), GFP_KERNEL);"}, {"lineno": 687, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.1210(i64 %7, i64 %8, i32 %10) #15, !dbg !118312"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %221 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %220, !dbg !118546", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 363, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "hs = kcalloc(3, sizeof(hs[0]), GFP_KERNEL);"}, {"instr_func": "kcalloc.1189", "instr_loc": 687, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.1210(i64 %7, i64 %8, i32 %10) #15, !dbg !118312"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array.1210"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 369, "file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_set_encryption(usb_dev, 1);"}, {"lineno": 168, "file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg(usb_dev, usb_sndctrlpipe(usb_dev, 0),"}],
"warnings":[{"warn_data": {"at_line": 138, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 369, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_set_encryption(usb_dev, 1);"}, {"instr_func": "wusb_dev_set_encryption", "instr_loc": 168, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg(usb_dev, usb_sndctrlpipe(usb_dev, 0),"}], "at_file": "drivers/usb/core/message.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usb_control_msg"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 369, "file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_set_encryption(usb_dev, 1);"}, {"lineno": 168, "file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg(usb_dev, usb_sndctrlpipe(usb_dev, 0),"}, {"lineno": 152, "file": "drivers/usb/core/message.c", "instr": "ret = usb_internal_control_msg(dev, pipe, dr, data, size, timeout);"}, {"lineno": 94, "file": "drivers/usb/core/message.c", "instr": "urb = usb_alloc_urb(0, GFP_NOIO);"}],
"warnings":[{"warn_data": {"at_line": 70, "warn_str": "Trying to use a global variable without locking.", "at": "{", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 369, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_set_encryption(usb_dev, 1);"}, {"instr_func": "wusb_dev_set_encryption", "instr_loc": 168, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg(usb_dev, usb_sndctrlpipe(usb_dev, 0),"}, {"instr_func": "usb_control_msg", "instr_loc": 152, "instr_file": "drivers/usb/core/message.c", "instr": "ret = usb_internal_control_msg(dev, pipe, dr, data, size, timeout);"}, {"instr_func": "usb_internal_control_msg", "instr_loc": 94, "instr_file": "drivers/usb/core/message.c", "instr": "urb = usb_alloc_urb(0, GFP_NOIO);"}], "at_file": "drivers/usb/core/urb.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usb_alloc_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 380, "file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"lineno": 1729, "file": "drivers/char/random.c", "instr": "warn_unseeded_randomness(&previous);"}],
"warnings":[{"warn_data": {"at_line": 1682, "warn_str": "Trying to use a global variable without locking.", "at": "crng_ready() ||", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 380, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"instr_func": "get_random_bytes", "instr_loc": 1729, "instr_file": "drivers/char/random.c", "instr": "warn_unseeded_randomness(&previous);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_warn_unseeded_randomness"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 380, "file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"lineno": 1730, "file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"lineno": 1711, "file": "drivers/char/random.c", "instr": "extract_crng(buf);"}],
"warnings":[{"warn_data": {"at_line": 1074, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 380, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"instr_func": "get_random_bytes", "instr_loc": 1730, "instr_file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"instr_func": "_get_random_bytes", "instr_loc": 1711, "instr_file": "drivers/char/random.c", "instr": "extract_crng(buf);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 380, "file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"lineno": 1730, "file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"lineno": 1711, "file": "drivers/char/random.c", "instr": "extract_crng(buf);"}, {"lineno": 1079, "file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}],
"warnings":[{"warn_data": {"at_line": 1056, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_ready() &&", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 380, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"instr_func": "get_random_bytes", "instr_loc": 1730, "instr_file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"instr_func": "_get_random_bytes", "instr_loc": 1711, "instr_file": "drivers/char/random.c", "instr": "extract_crng(buf);"}, {"instr_func": "extract_crng", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 380, "file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"lineno": 1730, "file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"lineno": 1721, "file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, CHACHA_BLOCK_SIZE);"}],
"warnings":[{"warn_data": {"at_line": 1111, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 380, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "get_random_bytes(&hs[0].nonce, sizeof(hs[0].nonce));"}, {"instr_func": "get_random_bytes", "instr_loc": 1730, "instr_file": "drivers/char/random.c", "instr": "_get_random_bytes(buf, nbytes);"}, {"instr_func": "_get_random_bytes", "instr_loc": 1721, "instr_file": "drivers/char/random.c", "instr": "crng_backtrack_protect(tmp, CHACHA_BLOCK_SIZE);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "crng_backtrack_protect"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 383, "file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg("}, {"lineno": 152, "file": "drivers/usb/core/message.c", "instr": "ret = usb_internal_control_msg(dev, pipe, dr, data, size, timeout);"}, {"lineno": 101, "file": "drivers/usb/core/message.c", "instr": "retv = usb_start_wait_urb(urb, timeout, &length);"}, {"lineno": 57, "file": "drivers/usb/core/message.c", "instr": "retval = usb_submit_urb(urb, GFP_NOIO);"}],
"warnings":[{"warn_data": {"at_line": 477, "warn_str": "Trying to use a global variable without locking.", "at": "dev_WARN(&dev->dev, \"BOGUS urb xfer, pipe %x != type %x\\n\",", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 383, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = usb_control_msg("}, {"instr_func": "usb_control_msg", "instr_loc": 152, "instr_file": "drivers/usb/core/message.c", "instr": "ret = usb_internal_control_msg(dev, pipe, dr, data, size, timeout);"}, {"instr_func": "usb_internal_control_msg", "instr_loc": 101, "instr_file": "drivers/usb/core/message.c", "instr": "retv = usb_start_wait_urb(urb, timeout, &length);"}, {"instr_func": "usb_start_wait_urb", "instr_loc": 57, "instr_file": "drivers/usb/core/message.c", "instr": "retval = usb_submit_urb(urb, GFP_NOIO);"}], "at_file": "drivers/usb/core/urb.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usb_submit_urb"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 495, "file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_update_address(wusbhc, wusb_dev);"}, {"lineno": 320, "file": "drivers/usb/wusbcore/security.c", "instr": "usb_set_device_state(usb_dev, USB_STATE_DEFAULT);"}],
"warnings":[{"warn_data": {"at_line": 2024, "warn_str": "Trying to use a global variable without locking.", "at": "spin_lock_irqsave(&device_state_lock, flags);", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 495, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_update_address(wusbhc, wusb_dev);"}, {"instr_func": "wusb_dev_update_address", "instr_loc": 320, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "usb_set_device_state(usb_dev, USB_STATE_DEFAULT);"}], "at_file": "drivers/usb/core/hub.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usb_set_device_state"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i64, align 8"}, {"lineno": 88, "file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"lineno": 495, "file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_update_address(wusbhc, wusb_dev);"}, {"lineno": 321, "file": "drivers/usb/wusbcore/security.c", "instr": "usb_ep0_reinit(usb_dev);"}, {"lineno": 4420, "file": "drivers/usb/core/hub.c", "instr": "usb_disable_endpoint(udev, 0 + USB_DIR_IN, true);"}, {"lineno": 1148, "file": "drivers/usb/core/message.c", "instr": "usb_hcd_flush_endpoint(dev, ep);"}],
"warnings":[{"warn_data": {"at_line": 1763, "warn_str": "Trying to use a global variable without locking.", "at": "hcd = bus_to_hcd(udev->bus);", "inst_trace": [{"instr_func": "wusb_ck_store", "instr_loc": -1, "instr": "  %5 = alloca i64, align 8"}, {"instr_func": "wusb_ck_store", "instr_loc": 88, "instr_file": "drivers/usb/wusbcore/dev-sysfs.c", "instr": "result = wusb_dev_4way_handshake(wusbhc, usb_dev->wusb_dev, &ck);"}, {"instr_func": "wusb_dev_4way_handshake", "instr_loc": 495, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "result = wusb_dev_update_address(wusbhc, wusb_dev);"}, {"instr_func": "wusb_dev_update_address", "instr_loc": 321, "instr_file": "drivers/usb/wusbcore/security.c", "instr": "usb_ep0_reinit(usb_dev);"}, {"instr_func": "usb_ep0_reinit", "instr_loc": 4420, "instr_file": "drivers/usb/core/hub.c", "instr": "usb_disable_endpoint(udev, 0 + USB_DIR_IN, true);"}, {"instr_func": "usb_disable_endpoint", "instr_loc": 1148, "instr_file": "drivers/usb/core/message.c", "instr": "usb_hcd_flush_endpoint(dev, ep);"}], "at_file": "drivers/usb/core/hcd.c", "by": "GlobalVariableRaceDetector says:", "at_func": "usb_hcd_flush_endpoint"}, "warn_no": 1}]}]}