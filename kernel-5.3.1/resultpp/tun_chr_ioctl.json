{"all_contexts":[
{"num_warnings": 12,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}],
"warnings":[{"warn_data": {"at_line": 3044, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ifr, argp, ifreq_len))", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 3323, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = -EFAULT;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 3288, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = -EFAULT;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 3308, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = -EFAULT;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 3246, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vnet_hdr_sz, argp, sizeof(vnet_hdr_sz))) {", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 3240, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "vnet_hdr_sz = tun->vnet_hdr_sz;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 3220, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "sndbuf = tfile->socket.sk->sk_sndbuf;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 3226, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&sndbuf, argp, sizeof(sndbuf))) {", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 3115, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, &ifr, ifreq_len))", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 3205, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "memcpy(ifr.ifr_hwaddr.sa_data, tun->dev->dev_addr, ETH_ALEN);", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 3080, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, &ifr, ifreq_len))", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 3089, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = -EFAULT;", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "__tun_chr_ioctl"}, "warn_no": 12}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3319, "file": "drivers/net/tun.c", "instr": "ret = tun_set_ebpf(tun, &tun->filter_prog, argp);"}],
"warnings":[{"warn_data": {"at_line": 3007, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "tun_set_ebpf"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3315, "file": "drivers/net/tun.c", "instr": "ret = tun_set_ebpf(tun, &tun->steering_prog, argp);"}],
"warnings":[{"warn_data": {"at_line": 3007, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "tun_set_ebpf"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3236, "file": "drivers/net/tun.c", "instr": "tun_set_sndbuf(tun);"}],
"warnings":[{"warn_data": {"at_line": 2965, "warn_str": "Trying to write to a user pointer.", "at": "tfile->socket.sk->sk_sndbuf = tun->sndbuf;", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3226, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&sndbuf, argp, sizeof(sndbuf))) {"}, {"instr_func": "tun_set_sndbuf", "instr_loc": 2965, "instr_file": "drivers/net/tun.c", "instr": "tfile->socket.sk->sk_sndbuf = tun->sndbuf;"}, {"instr_func": "tun_set_sndbuf", "instr_loc": 2965, "instr_file": "drivers/net/tun.c", "instr": "tfile->socket.sk->sk_sndbuf = tun->sndbuf;"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_set_sndbuf"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3200, "file": "drivers/net/tun.c", "instr": "ret = update_filter(&tun->txflt, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 915, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/net/tun.c", "by": "TaintedSizeDetector says:", "at_func": "update_filter"}, "warn_no": 1},
{"warn_data": {"at_line": 949, "warn_str": "Loop is bounded by a tainted value.", "at": "for (; n < uf.count; n++) {", "inst_trace": [{"instr_func": "update_filter", "instr_loc": 915, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "update_filter", "instr_loc": 949, "instr_file": "drivers/net/tun.c", "instr": "for (; n < uf.count; n++) {"}, {"instr_func": "update_filter", "instr_loc": 949, "instr_file": "drivers/net/tun.c", "instr": "for (; n < uf.count; n++) {"}], "at_file": "drivers/net/tun.c", "by": "TaintedLoopBoundDetector says:", "at_func": "update_filter"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3075, "file": "drivers/net/tun.c", "instr": "ret = tun_set_iff(net, file, &ifr);"}, {"lineno": 2833, "file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, false, ifr->ifr_flags & IFF_NAPI,"}, {"lineno": 857, "file": "drivers/net/tun.c", "instr": "tun_enable_queue(tfile);"}],
"warnings":[{"warn_data": {"at_line": 648, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "--tun->numdisabled;", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2834, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, false);"}, {"instr_func": "tun_set_iff", "instr_loc": 2834, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, false);"}, {"instr_func": "tun_set_iff", "instr_loc": 2834, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, false);"}, {"instr_func": "tun_set_iff", "instr_loc": 2833, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, false, ifr->ifr_flags & IFF_NAPI,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_enable_queue", "instr_loc": 648, "instr_file": "drivers/net/tun.c", "instr": "--tun->numdisabled;"}], "at_file": "drivers/net/tun.c", "by": "IntegerOverflowDetector says:", "at_func": "tun_enable_queue"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3075, "file": "drivers/net/tun.c", "instr": "ret = tun_set_iff(net, file, &ifr);"}, {"lineno": 2733, "file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"lineno": 857, "file": "drivers/net/tun.c", "instr": "tun_enable_queue(tfile);"}],
"warnings":[{"warn_data": {"at_line": 648, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "--tun->numdisabled;", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_enable_queue", "instr_loc": 648, "instr_file": "drivers/net/tun.c", "instr": "--tun->numdisabled;"}], "at_file": "drivers/net/tun.c", "by": "IntegerOverflowDetector says:", "at_func": "tun_enable_queue"}, "warn_no": 1}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 3355, "file": "drivers/net/tun.c", "instr": "return __tun_chr_ioctl(file, cmd, arg, sizeof (struct ifreq));"}, {"lineno": 3057, "file": "drivers/net/tun.c", "instr": "return tun_set_queue(file, &ifr);"}, {"lineno": 2986, "file": "drivers/net/tun.c", "instr": "ret = tun_attach(tun, file, false, tun->flags & IFF_NAPI,"}],
"warnings":[{"warn_data": {"at_line": 811, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tun->numqueues + tun->numdisabled == MAX_TAP_QUEUES)", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 811, "instr_file": "drivers/net/tun.c", "instr": "tun->numqueues + tun->numdisabled == MAX_TAP_QUEUES)"}], "at_file": "drivers/net/tun.c", "by": "IntegerOverflowDetector says:", "at_func": "tun_attach"}, "warn_no": 1},
{"warn_data": {"at_line": 826, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_resize(&tfile->tx_ring, dev->tx_queue_len,", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 794, "instr_file": "drivers/net/tun.c", "instr": "struct net_device *dev = tun->dev;"}, {"instr_func": "tun_attach", "instr_loc": 794, "instr_file": "drivers/net/tun.c", "instr": "struct net_device *dev = tun->dev;"}, {"instr_func": "tun_attach", "instr_loc": 826, "instr_file": "drivers/net/tun.c", "instr": "ptr_ring_resize(&tfile->tx_ring, dev->tx_queue_len,"}, {"instr_func": "tun_attach", "instr_loc": 826, "instr_file": "drivers/net/tun.c", "instr": "ptr_ring_resize(&tfile->tx_ring, dev->tx_queue_len,"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 2},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 3},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 4},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 5},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 6},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 7},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 8},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 9},
{"warn_data": {"at_line": 876, "warn_str": "Trying to write to a user pointer.", "at": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}, {"instr_func": "tun_attach", "instr_loc": 876, "instr_file": "drivers/net/tun.c", "instr": "rcu_assign_pointer(tun->tfiles[tun->numqueues], tfile);"}], "at_file": "drivers/net/tun.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tun_attach"}, "warn_no": 10},
{"warn_data": {"at_line": 877, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "tun->numqueues++;", "inst_trace": [{"instr_func": "__tun_chr_ioctl", "instr_loc": 3044, "instr_file": "drivers/net/tun.c", "instr": "if (copy_from_user(&ifr, argp, ifreq_len))"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2735, "instr_file": "drivers/net/tun.c", "instr": "ifr->ifr_flags & IFF_NAPI_FRAGS, true);"}, {"instr_func": "tun_set_iff", "instr_loc": 2733, "instr_file": "drivers/net/tun.c", "instr": "err = tun_attach(tun, file, ifr->ifr_flags & IFF_NOFILTER,"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 792, "instr_file": "drivers/net/tun.c", "instr": "{"}, {"instr_func": "tun_attach", "instr_loc": 877, "instr_file": "drivers/net/tun.c", "instr": "tun->numqueues++;"}], "at_file": "drivers/net/tun.c", "by": "IntegerOverflowDetector says:", "at_func": "tun_attach"}, "warn_no": 11}]}]}