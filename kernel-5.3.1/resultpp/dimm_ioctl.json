{"all_contexts":[
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1217, "file": "drivers/nvdimm/bus.c", "instr": "return nd_ioctl(file, cmd, arg, DIMM_IOCTL);"}, {"lineno": 1200, "file": "drivers/nvdimm/bus.c", "instr": "rc = __nd_ioctl(nvdimm_bus, nvdimm, ro, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 1011, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&pkg, p, sizeof(pkg)))", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1089, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_from_user(&out_env[out_len],", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1053, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy && copy_from_user(&in_env[in_len], p + in_len, copy)) {", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1043, "warn_str": "Loop is bounded by a tainted value.", "at": "if (in_size == UINT_MAX) {", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1053, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&in_env[in_len], p + in_len, copy)) {"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 832, "instr_file": "drivers/nvdimm/bus.c", "instr": "return hdr->in_length;"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 832, "instr_file": "drivers/nvdimm/bus.c", "instr": "return hdr->in_length;"}, {"instr_func": "nd_cmd_in_size", "instr_loc": 844, "instr_file": "drivers/nvdimm/bus.c", "instr": "}"}, {"instr_func": "__nd_ioctl", "instr_loc": 1042, "instr_file": "drivers/nvdimm/bus.c", "instr": "in_size = nd_cmd_in_size(nvdimm, cmd, desc, i, in_env);"}, {"instr_func": "__nd_ioctl", "instr_loc": 1042, "instr_file": "drivers/nvdimm/bus.c", "instr": "in_size = nd_cmd_in_size(nvdimm, cmd, desc, i, in_env);"}, {"instr_func": "__nd_ioctl", "instr_loc": 1043, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (in_size == UINT_MAX) {"}, {"instr_func": "__nd_ioctl", "instr_loc": 1043, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (in_size == UINT_MAX) {"}], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1079, "warn_str": "Loop is bounded by a tainted value.", "at": "if (out_size == UINT_MAX) {", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1089, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 877, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1] - 8;"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 877, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1] - 8;"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 877, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1] - 8;"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 886, "instr_file": "drivers/nvdimm/bus.c", "instr": "}"}, {"instr_func": "__nd_ioctl", "instr_loc": 1075, "instr_file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}, {"instr_func": "__nd_ioctl", "instr_loc": 1075, "instr_file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}, {"instr_func": "__nd_ioctl", "instr_loc": 1079, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_size == UINT_MAX) {"}, {"instr_func": "__nd_ioctl", "instr_loc": 1079, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_size == UINT_MAX) {"}], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1133, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(p, buf, buf_len))", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1111, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(buf, p, buf_len)) {", "inst_trace": [], "at_file": "drivers/nvdimm/bus.c", "by": "TaintedSizeDetector says:", "at_func": "__nd_ioctl"}, "warn_no": 7}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 1217, "file": "drivers/nvdimm/bus.c", "instr": "return nd_ioctl(file, cmd, arg, DIMM_IOCTL);"}, {"lineno": 1200, "file": "drivers/nvdimm/bus.c", "instr": "rc = __nd_ioctl(nvdimm_bus, nvdimm, ro, cmd, arg);"}, {"lineno": 1075, "file": "drivers/nvdimm/bus.c", "instr": "u32 out_size = nd_cmd_out_size(nvdimm, cmd, desc, i,"}],
"warnings":[{"warn_data": {"at_line": 877, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return out_field[1] - 8;", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1089, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 877, "instr_file": "drivers/nvdimm/bus.c", "instr": "return out_field[1] - 8;"}], "at_file": "drivers/nvdimm/bus.c", "by": "IntegerOverflowDetector says:", "at_func": "nd_cmd_out_size"}, "warn_no": 1},
{"warn_data": {"at_line": 875, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (out_field[1] - 4 == remainder)", "inst_trace": [{"instr_func": "__nd_ioctl", "instr_loc": 1089, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (copy && copy_from_user(&out_env[out_len],"}, {"instr_func": "nd_cmd_out_size", "instr_loc": 875, "instr_file": "drivers/nvdimm/bus.c", "instr": "if (out_field[1] - 4 == remainder)"}], "at_file": "drivers/nvdimm/bus.c", "by": "IntegerOverflowDetector says:", "at_func": "nd_cmd_out_size"}, "warn_no": 2}]}]}