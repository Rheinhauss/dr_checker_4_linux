{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 667, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "return vtpmx_ioc_new_dev(f, ioctl, arg);"}],
"warnings":[{"warn_data": {"at_line": 645, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(vtpm_new_dev_p, &vtpm_new_dev,", "inst_trace": [], "at_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "by": "TaintedSizeDetector says:", "at_func": "vtpmx_ioc_new_dev"}, "warn_no": 1},
{"warn_data": {"at_line": 635, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "vtpm_new_dev_p = argp;", "inst_trace": [], "at_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "by": "TaintedSizeDetector says:", "at_func": "vtpmx_ioc_new_dev"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 667, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "return vtpmx_ioc_new_dev(f, ioctl, arg);"}, {"lineno": 641, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_file = vtpm_proxy_create_device(&vtpm_new_dev);"}, {"lineno": 543, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "proxy_dev = vtpm_proxy_create_proxy_dev();"}, {"lineno": 493, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "proxy_dev = kzalloc(sizeof(*proxy_dev), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !229002", "inst_trace": [{"instr_func": "vtpmx_fops_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "vtpmx_fops_ioctl", "instr_loc": 667, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "return vtpmx_ioc_new_dev(f, ioctl, arg);"}, {"instr_func": "vtpmx_ioc_new_dev", "instr_loc": 641, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_file = vtpm_proxy_create_device(&vtpm_new_dev);"}, {"instr_func": "vtpm_proxy_create_device", "instr_loc": 543, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "proxy_dev = vtpm_proxy_create_proxy_dev();"}, {"instr_func": "vtpm_proxy_create_proxy_dev", "instr_loc": 493, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "proxy_dev = kzalloc(sizeof(*proxy_dev), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc.2532"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 667, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "return vtpmx_ioc_new_dev(f, ioctl, arg);"}, {"lineno": 641, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_file = vtpm_proxy_create_device(&vtpm_new_dev);"}, {"lineno": 570, "file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_proxy_work_start(proxy_dev);"}],
"warnings":[{"warn_data": {"at_line": 481, "warn_str": "Trying to use a global variable without locking.", "at": "queue_work(workqueue, &proxy_dev->work);", "inst_trace": [{"instr_func": "vtpmx_fops_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "vtpmx_fops_ioctl", "instr_loc": 667, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "return vtpmx_ioc_new_dev(f, ioctl, arg);"}, {"instr_func": "vtpmx_ioc_new_dev", "instr_loc": 641, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_file = vtpm_proxy_create_device(&vtpm_new_dev);"}, {"instr_func": "vtpm_proxy_create_device", "instr_loc": 570, "instr_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "instr": "vtpm_proxy_work_start(proxy_dev);"}], "at_file": "drivers/char/tpm/tpm_vtpm_proxy.c", "by": "GlobalVariableRaceDetector says:", "at_func": "vtpm_proxy_work_start"}, "warn_no": 1}]}]}