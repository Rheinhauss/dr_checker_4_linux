{"all_contexts":[
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1191, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct genwqe_mem m;", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1182, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct genwqe_mem m;", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1172, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = do_flash_read(cfile, &load);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1169, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1148, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&load, (void __user *)arg,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1152, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = do_flash_update(cfile, &load);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "genwqe_ioctl"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1208, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}],
"warnings":[{"warn_data": {"at_line": 1011, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 1},
{"warn_data": {"at_line": 1023, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, cmd,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1208, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}],
"warnings":[{"warn_data": {"at_line": 928, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "page_offs = (u_addr -", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 929, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u64)m->u_vaddr)/PAGE_SIZE;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ddcb_cmd_fixups"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1208, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}, {"lineno": 926, "file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}],
"warnings":[{"warn_data": {"at_line": 106, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 1},
{"warn_data": {"at_line": 105, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 880, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 2},
{"warn_data": {"at_line": 110, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 110, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 3}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1208, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 1);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}, {"lineno": 894, "file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}],
"warnings":[{"warn_data": {"at_line": 163, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 162, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 2},
{"warn_data": {"at_line": 173, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 173, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 3},
{"warn_data": {"at_line": 169, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 4},
{"warn_data": {"at_line": 168, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*dma_addr = m->dma_addr +", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1201, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}],
"warnings":[{"warn_data": {"at_line": 1011, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 1},
{"warn_data": {"at_line": 1023, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)arg, cmd,", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_execute_ddcb"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1201, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}],
"warnings":[{"warn_data": {"at_line": 928, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "page_offs = (u_addr -", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 929, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u64)m->u_vaddr)/PAGE_SIZE;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "ddcb_cmd_fixups"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1201, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}, {"lineno": 926, "file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}],
"warnings":[{"warn_data": {"at_line": 106, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 1},
{"warn_data": {"at_line": 105, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 910, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 2},
{"warn_data": {"at_line": 110, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 926, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = genwqe_search_pin(cfile, u_addr, u_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 110, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 3}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1201, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return do_execute_ddcb(cfile, arg, 0);"}, {"lineno": 1017, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = genwqe_execute_ddcb(cfile, cmd);"}, {"lineno": 990, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = ddcb_cmd_fixups(cfile, req);"}, {"lineno": 894, "file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}],
"warnings":[{"warn_data": {"at_line": 163, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 1},
{"warn_data": {"at_line": 162, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 912, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_size = be32_to_cpu(*((__be32 *)"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 163, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 2},
{"warn_data": {"at_line": 173, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 173, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 3},
{"warn_data": {"at_line": 169, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 4},
{"warn_data": {"at_line": 168, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "*dma_addr = m->dma_addr +", "inst_trace": [{"instr_func": "do_execute_ddcb", "instr_loc": 1011, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(cmd, (void __user *)arg, sizeof(*cmd))) {"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 959, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "cpu_to_be64(req->sgls[i].sgl_dma_addr);"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 958, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "*((__be64 *)&cmd->asiv[asiv_offs]) ="}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 878, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "u_addr = be64_to_cpu(*((__be64 *)&cmd->"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "ddcb_cmd_fixups", "instr_loc": 894, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "m = __genwqe_search_mapping(cfile, u_addr, u_size,"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 154, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}, {"instr_func": "__genwqe_search_mapping", "instr_loc": 169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "__genwqe_search_mapping"}, "warn_no": 5}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1196, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_unpin_mem(cfile, &m);"}],
"warnings":[{"warn_data": {"at_line": 809, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 1},
{"warn_data": {"at_line": 809, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 2},
{"warn_data": {"at_line": 809, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 809, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_unpin_mem"}, "warn_no": 3}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1196, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_unpin_mem(cfile, &m);"}, {"lineno": 811, "file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}],
"warnings":[{"warn_data": {"at_line": 106, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 1},
{"warn_data": {"at_line": 105, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((((u64)m->u_vaddr) <= (u_addr)) &&", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}, {"instr_func": "genwqe_search_pin", "instr_loc": 106, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(((u64)m->u_vaddr + m->size) >= (u_addr + size))) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 2},
{"warn_data": {"at_line": 110, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(u_addr - (u64)m->u_vaddr);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1191, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 808, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_addr = (m->addr & PAGE_MASK);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_unpin_mem", "instr_loc": 811, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = genwqe_search_pin(cfile, map_addr, map_size, NULL);"}, {"instr_func": "genwqe_search_pin", "instr_loc": 98, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "{"}, {"instr_func": "genwqe_search_pin", "instr_loc": 110, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "(u_addr - (u64)m->u_vaddr);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_search_pin"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1187, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}],
"warnings":[{"warn_data": {"at_line": 775, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1182, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 775, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 775, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (m->size > ULONG_MAX - PAGE_SIZE - (m->addr & ~PAGE_MASK))"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 1},
{"warn_data": {"at_line": 779, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1182, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 2},
{"warn_data": {"at_line": 779, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1182, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 3},
{"warn_data": {"at_line": 779, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1182, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "struct genwqe_mem m;"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 779, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "map_size = round_up(m->size + (m->addr & ~PAGE_MASK), PAGE_SIZE);"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "genwqe_pin_mem"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1187, "file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}, {"lineno": 781, "file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = kzalloc(sizeof(struct dma_mapping), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !5895", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "genwqe_ioctl", "instr_loc": 1187, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "return genwqe_pin_mem(cfile, &m);"}, {"instr_func": "genwqe_pin_mem", "instr_loc": 781, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "dma_map = kzalloc(sizeof(struct dma_mapping), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1172, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = do_flash_read(cfile, &load);"}],
"warnings":[{"warn_data": {"at_line": 751, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "load->size  -= tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 751, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 1},
{"warn_data": {"at_line": 754, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blocks_to_flash--;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 675, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 675, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 675, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_read", "instr_loc": 754, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash--;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 2},
{"warn_data": {"at_line": 676, "warn_str": "Loop is bounded by a tainted value.", "at": "while (load->size) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 676, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}, {"instr_func": "do_flash_read", "instr_loc": 676, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_read"}, "warn_no": 3},
{"warn_data": {"at_line": 752, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "flash += tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1169, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg, sizeof(load)))"}, {"instr_func": "do_flash_read", "instr_loc": 751, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_read", "instr_loc": 751, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_read", "instr_loc": 751, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_read", "instr_loc": 751, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 681, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_read", "instr_loc": 752, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "flash += tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_read"}, "warn_no": 4},
{"warn_data": {"at_line": 734, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "rc = copy_to_user(buf, xbuf, tocopy);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_flash_read"}, "warn_no": 5}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1152, "file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = do_flash_update(cfile, &load);"}],
"warnings":[{"warn_data": {"at_line": 622, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "load->size  -= tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1148, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 1},
{"warn_data": {"at_line": 625, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "blocks_to_flash--;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1148, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 539, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 539, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 539, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash = load->size / FLASH_BLOCK;"}, {"instr_func": "do_flash_update", "instr_loc": 625, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "blocks_to_flash--;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 2},
{"warn_data": {"at_line": 540, "warn_str": "Loop is bounded by a tainted value.", "at": "while (load->size) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1148, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 540, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}, {"instr_func": "do_flash_update", "instr_loc": 540, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "while (load->size) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_update"}, "warn_no": 3},
{"warn_data": {"at_line": 623, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "flash += tocopy;", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1148, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 623, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "flash += tocopy;"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "IntegerOverflowDetector says:", "at_func": "do_flash_update"}, "warn_no": 4},
{"warn_data": {"at_line": 547, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);", "inst_trace": [], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedSizeDetector says:", "at_func": "do_flash_update"}, "warn_no": 5},
{"warn_data": {"at_line": 550, "warn_str": "Loop is bounded by a tainted value.", "at": "if (rc) {", "inst_trace": [{"instr_func": "genwqe_ioctl", "instr_loc": 1148, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (copy_from_user(&load, (void __user *)arg,"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 622, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "load->size  -= tocopy;"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 549, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 547, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "tocopy = min_t(size_t, load->size, FLASH_BLOCK);"}, {"instr_func": "do_flash_update", "instr_loc": 549, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 549, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "rc = copy_from_user(xbuf, buf, tocopy);"}, {"instr_func": "do_flash_update", "instr_loc": 550, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (rc) {"}, {"instr_func": "do_flash_update", "instr_loc": 550, "instr_file": "drivers/misc/genwqe/card_dev.c", "instr": "if (rc) {"}], "at_file": "drivers/misc/genwqe/card_dev.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_flash_update"}, "warn_no": 6}]}]}