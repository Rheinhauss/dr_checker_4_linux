{"all_contexts":[
{"num_warnings": 20,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1450, "warn_str": "Trying to use a global variable without locking.", "at": "dprintk(\"%s\\n\", __func__);", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "GlobalVariableRaceDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1465, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count -= 2;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1460, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&slot, buf, 1))", "inst_trace": [], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedSizeDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1462, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&connection_id, buf + 1, 1))", "inst_trace": [], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedSizeDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 4},
{"warn_data": {"at_line": 1473, "warn_str": "Trying to read from a user pointer.", "at": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING)", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1473, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING)"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1473, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING)"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 5},
{"warn_data": {"at_line": 1501, "warn_str": "Trying to read from a user pointer.", "at": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1501, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1501, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 6},
{"warn_data": {"at_line": 1501, "warn_str": "Loop is bounded by a tainted value.", "at": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1501, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1501, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1501, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (sl->slot_state != DVB_CA_SLOTSTATE_RUNNING) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 7},
{"warn_data": {"at_line": 1484, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "fraglen = count - fragpos;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 8},
{"warn_data": {"at_line": 1483, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if ((count - fragpos) < fraglen)", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1483, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if ((count - fragpos) < fraglen)"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 9},
{"warn_data": {"at_line": 1478, "warn_str": "Trying to read from a user pointer.", "at": "fraglen = sl->link_buf_size - 2;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1478, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = sl->link_buf_size - 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1478, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = sl->link_buf_size - 2;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 10},
{"warn_data": {"at_line": 1478, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "fraglen = sl->link_buf_size - 2;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1470, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1478, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = sl->link_buf_size - 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1478, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = sl->link_buf_size - 2;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 11},
{"warn_data": {"at_line": 1479, "warn_str": "Loop is bounded by a tainted value.", "at": "if (fraglen < 0)", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1479, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (fraglen < 0)"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1479, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (fraglen < 0)"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 12},
{"warn_data": {"at_line": 1477, "warn_str": "Loop is bounded by a tainted value.", "at": "while (fragpos < count) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1477, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "while (fragpos < count) {"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1477, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "while (fragpos < count) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 13},
{"warn_data": {"at_line": 1524, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "fragpos += fraglen;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1524, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fragpos += fraglen;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 14},
{"warn_data": {"at_line": 1508, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "fraglen + 2);", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1508, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen + 2);"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 15},
{"warn_data": {"at_line": 1510, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (status == (fraglen + 2)) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1510, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (status == (fraglen + 2)) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 16},
{"warn_data": {"at_line": 1487, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "fragbuf[1] = ((fragpos + fraglen) < count) ? 0x80 : 0x00;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1487, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fragbuf[1] = ((fragpos + fraglen) < count) ? 0x80 : 0x00;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 17},
{"warn_data": {"at_line": 1486, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "fragbuf[0] = connection_id;", "inst_trace": [], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedSizeDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 18},
{"warn_data": {"at_line": 1489, "warn_str": "Loop is bounded by a tainted value.", "at": "if (status) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1508, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen + 2);"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1508, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen + 2);"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 786, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 884, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = bytes_write;"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 884, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = bytes_write;"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 893, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "return status;"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 893, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "return status;"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 894, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "}"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1489, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (status) {"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1489, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (status) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 19},
{"warn_data": {"at_line": 1526, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "status = count + 2;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1526, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = count + 2;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "IntegerOverflowDetector says:", "at_func": "dvb_ca_en50221_io_write"}, "warn_no": 20}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1507, "file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}],
"warnings":[{"warn_data": {"at_line": 794, "warn_str": "Trying to read from a user pointer.", "at": "if (bytes_write > sl->link_buf_size)", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 786, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 794, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (bytes_write > sl->link_buf_size)"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 794, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (bytes_write > sl->link_buf_size)"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_write_data"}, "warn_no": 1},
{"warn_data": {"at_line": 798, "warn_str": "Trying to read from a user pointer.", "at": "(sl->slot_state != DVB_CA_SLOTSTATE_LINKINIT))", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 786, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 798, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "(sl->slot_state != DVB_CA_SLOTSTATE_LINKINIT))"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 798, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "(sl->slot_state != DVB_CA_SLOTSTATE_LINKINIT))"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_write_data"}, "warn_no": 2},
{"warn_data": {"at_line": 868, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < bytes_write; i++) {", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1438, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1465, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "count -= 2;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1484, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen = count - fragpos;"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1508, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen + 2);"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1508, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "fraglen + 2);"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 786, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 868, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "for (i = 0; i < bytes_write; i++) {"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 868, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "for (i = 0; i < bytes_write; i++) {"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedLoopBoundDetector says:", "at_func": "dvb_ca_en50221_write_data"}, "warn_no": 3},
{"warn_data": {"at_line": 880, "warn_str": "Trying to write to a user pointer.", "at": "sl->slot_state = DVB_CA_SLOTSTATE_LINKINIT;", "inst_trace": [{"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1460, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "if (copy_from_user(&slot, buf, 1))"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_io_write", "instr_loc": 1507, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "status = dvb_ca_en50221_write_data(ca, slot, fragbuf,"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 786, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "{"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 787, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "struct dvb_ca_slot *sl = &ca->slot_info[slot];"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 880, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl->slot_state = DVB_CA_SLOTSTATE_LINKINIT;"}, {"instr_func": "dvb_ca_en50221_write_data", "instr_loc": 880, "instr_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "instr": "sl->slot_state = DVB_CA_SLOTSTATE_LINKINIT;"}], "at_file": "drivers/media/dvb-core/dvb_ca_en50221.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dvb_ca_en50221_write_data"}, "warn_no": 4}]}]}