{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}],
"warnings":[{"warn_data": {"at_line": 117, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = copy_from_user(tdev->message, userbuf, count);", "inst_trace": [], "at_file": "drivers/mailbox/mailbox-test.c", "by": "TaintedSizeDetector says:", "at_func": "mbox_test_message_write"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 113, "file": "drivers/mailbox/mailbox-test.c", "instr": "tdev->message = kzalloc(MBOX_MAX_MSG_LEN, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !89782", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": -1, "instr": "  %5 = alloca i1, align 1"}, {"instr_func": "mbox_test_message_write", "instr_loc": 113, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "tdev->message = kzalloc(MBOX_MAX_MSG_LEN, GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc.701"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}],
"warnings":[{"warn_data": {"at_line": 267, "warn_str": "Trying to read from a user pointer.", "at": "if (!chan->cl->tx_tout) /* wait forever */", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 267, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (!chan->cl->tx_tout) /* wait forever */"}, {"instr_func": "mbox_send_message", "instr_loc": 267, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (!chan->cl->tx_tout) /* wait forever */"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mbox_send_message"}, "warn_no": 1},
{"warn_data": {"at_line": 263, "warn_str": "Trying to read from a user pointer.", "at": "if (chan->cl->tx_block) {", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 263, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_block) {"}, {"instr_func": "mbox_send_message", "instr_loc": 263, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_block) {"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mbox_send_message"}, "warn_no": 2},
{"warn_data": {"at_line": 270, "warn_str": "Trying to read from a user pointer.", "at": "wait = msecs_to_jiffies(chan->cl->tx_tout);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mbox_send_message"}, "warn_no": 3},
{"warn_data": {"at_line": 257, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "mbox_send_message"}, "warn_no": 4}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 255, "file": "drivers/mailbox/mailbox.c", "instr": "t = add_to_rbuf(chan, mssg);"}],
"warnings":[{"warn_data": {"at_line": 40, "warn_str": "Trying to write to a user pointer.", "at": "chan->msg_data[idx] = mssg;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "add_to_rbuf", "instr_loc": 39, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "add_to_rbuf", "instr_loc": 39, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "add_to_rbuf", "instr_loc": 40, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_data[idx] = mssg;"}, {"instr_func": "add_to_rbuf", "instr_loc": 40, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_data[idx] = mssg;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "add_to_rbuf"}, "warn_no": 1},
{"warn_data": {"at_line": 41, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "chan->msg_count++;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "add_to_rbuf", "instr_loc": 41, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_count++;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "add_to_rbuf"}, "warn_no": 2},
{"warn_data": {"at_line": 46, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "chan->msg_free++;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "add_to_rbuf", "instr_loc": 46, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_free++;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "add_to_rbuf"}, "warn_no": 3}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 261, "file": "drivers/mailbox/mailbox.c", "instr": "msg_submit(chan);"}],
"warnings":[{"warn_data": {"at_line": 70, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx += MBOX_TX_QUEUE_LEN - count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 1},
{"warn_data": {"at_line": 70, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx += MBOX_TX_QUEUE_LEN - count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 2},
{"warn_data": {"at_line": 68, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx -= count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 68, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx -= count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 3},
{"warn_data": {"at_line": 72, "warn_str": "Trying to read from a user pointer.", "at": "data = chan->msg_data[idx];", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 66, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "msg_submit", "instr_loc": 66, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "msg_submit", "instr_loc": 72, "instr_file": "drivers/mailbox/mailbox.c", "instr": "data = chan->msg_data[idx];"}, {"instr_func": "msg_submit", "instr_loc": 72, "instr_file": "drivers/mailbox/mailbox.c", "instr": "data = chan->msg_data[idx];"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 4},
{"warn_data": {"at_line": 74, "warn_str": "Trying to read from a user pointer.", "at": "if (chan->cl->tx_prepare)", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 74, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_prepare)"}, {"instr_func": "msg_submit", "instr_loc": 74, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_prepare)"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 5},
{"warn_data": {"at_line": 75, "warn_str": "Trying to read from a user pointer.", "at": "chan->cl->tx_prepare(chan->cl, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 75, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_prepare(chan->cl, data);"}, {"instr_func": "msg_submit", "instr_loc": 75, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_prepare(chan->cl, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 6},
{"warn_data": {"at_line": 77, "warn_str": "Trying to read from a user pointer.", "at": "err = chan->mbox->ops->send_data(chan, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 7},
{"warn_data": {"at_line": 77, "warn_str": "Trying to read from a user pointer.", "at": "err = chan->mbox->ops->send_data(chan, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 8},
{"warn_data": {"at_line": 80, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "chan->msg_count--;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 80, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_count--;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 9}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 270, "file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}],
"warnings":[{"warn_data": {"at_line": 311, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %5 = add i64 %4, 4, !dbg !89563", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "_msecs_to_jiffies.771", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies.771", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !89562"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies.771"}, "warn_no": 1},
{"warn_data": {"at_line": 311, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %6 = sub i64 %5, 1, !dbg !89564", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "mbox_send_message", "instr_loc": 270, "instr_file": "drivers/mailbox/mailbox.c", "instr": "wait = msecs_to_jiffies(chan->cl->tx_tout);"}, {"instr_func": "_msecs_to_jiffies.771", "instr_loc": 310, "instr_file": "./include/linux/jiffies.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "_msecs_to_jiffies.771", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !89562"}, {"instr_func": "_msecs_to_jiffies.771", "instr_loc": 311, "instr_file": "./include/linux/jiffies.h", "instr": "  %5 = add i64 %4, 4, !dbg !89563"}], "at_file": "./include/linux/jiffies.h", "by": "IntegerOverflowDetector says:", "at_func": "_msecs_to_jiffies.771"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 275, "file": "drivers/mailbox/mailbox.c", "instr": "tx_tick(chan, t);"}],
"warnings":[{"warn_data": {"at_line": 108, "warn_str": "Trying to read from a user pointer.", "at": "chan->cl->tx_done(chan->cl, mssg, r);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "tx_tick", "instr_loc": 108, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_done(chan->cl, mssg, r);"}, {"instr_func": "tx_tick", "instr_loc": 108, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_done(chan->cl, mssg, r);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tx_tick"}, "warn_no": 1},
{"warn_data": {"at_line": 107, "warn_str": "Trying to read from a user pointer.", "at": "if (chan->cl->tx_done)", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "tx_tick", "instr_loc": 107, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_done)"}, {"instr_func": "tx_tick", "instr_loc": 107, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_done)"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tx_tick"}, "warn_no": 2},
{"warn_data": {"at_line": 110, "warn_str": "Trying to read from a user pointer.", "at": "if (r != -ETIME && chan->cl->tx_block)", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "tx_tick", "instr_loc": 110, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (r != -ETIME && chan->cl->tx_block)"}, {"instr_func": "tx_tick", "instr_loc": 110, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (r != -ETIME && chan->cl->tx_block)"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "tx_tick"}, "warn_no": 3}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 275, "file": "drivers/mailbox/mailbox.c", "instr": "tx_tick(chan, t);"}, {"lineno": 101, "file": "drivers/mailbox/mailbox.c", "instr": "msg_submit(chan);"}],
"warnings":[{"warn_data": {"at_line": 70, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx += MBOX_TX_QUEUE_LEN - count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 1},
{"warn_data": {"at_line": 70, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx += MBOX_TX_QUEUE_LEN - count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}, {"instr_func": "msg_submit", "instr_loc": 70, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx += MBOX_TX_QUEUE_LEN - count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 2},
{"warn_data": {"at_line": 68, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idx -= count;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 65, "instr_file": "drivers/mailbox/mailbox.c", "instr": "count = chan->msg_count;"}, {"instr_func": "msg_submit", "instr_loc": 68, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx -= count;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 3},
{"warn_data": {"at_line": 72, "warn_str": "Trying to read from a user pointer.", "at": "data = chan->msg_data[idx];", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 66, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "msg_submit", "instr_loc": 66, "instr_file": "drivers/mailbox/mailbox.c", "instr": "idx = chan->msg_free;"}, {"instr_func": "msg_submit", "instr_loc": 72, "instr_file": "drivers/mailbox/mailbox.c", "instr": "data = chan->msg_data[idx];"}, {"instr_func": "msg_submit", "instr_loc": 72, "instr_file": "drivers/mailbox/mailbox.c", "instr": "data = chan->msg_data[idx];"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 4},
{"warn_data": {"at_line": 74, "warn_str": "Trying to read from a user pointer.", "at": "if (chan->cl->tx_prepare)", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 74, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_prepare)"}, {"instr_func": "msg_submit", "instr_loc": 74, "instr_file": "drivers/mailbox/mailbox.c", "instr": "if (chan->cl->tx_prepare)"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 5},
{"warn_data": {"at_line": 75, "warn_str": "Trying to read from a user pointer.", "at": "chan->cl->tx_prepare(chan->cl, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 75, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_prepare(chan->cl, data);"}, {"instr_func": "msg_submit", "instr_loc": 75, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->cl->tx_prepare(chan->cl, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 6},
{"warn_data": {"at_line": 77, "warn_str": "Trying to read from a user pointer.", "at": "err = chan->mbox->ops->send_data(chan, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 7},
{"warn_data": {"at_line": 77, "warn_str": "Trying to read from a user pointer.", "at": "err = chan->mbox->ops->send_data(chan, data);", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}, {"instr_func": "msg_submit", "instr_loc": 77, "instr_file": "drivers/mailbox/mailbox.c", "instr": "err = chan->mbox->ops->send_data(chan, data);"}], "at_file": "drivers/mailbox/mailbox.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "msg_submit"}, "warn_no": 8},
{"warn_data": {"at_line": 80, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "chan->msg_count--;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "msg_submit", "instr_loc": 80, "instr_file": "drivers/mailbox/mailbox.c", "instr": "chan->msg_count--;"}], "at_file": "drivers/mailbox/mailbox.c", "by": "IntegerOverflowDetector says:", "at_func": "msg_submit"}, "warn_no": 9}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 257, "file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3307, "file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}],
"warnings":[{"warn_data": {"at_line": 907, "warn_str": "Trying to read from a user pointer.", "at": "{", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1},
{"warn_data": {"at_line": 907, "warn_str": "Trying to read from a user pointer.", "at": "{", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 2},
{"warn_data": {"at_line": 907, "warn_str": "Trying to read from a user pointer.", "at": "{", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 3},
{"warn_data": {"at_line": 907, "warn_str": "Trying to read from a user pointer.", "at": "{", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 4},
{"warn_data": {"at_line": 916, "warn_str": "Trying to read from a user pointer.", "at": "(dev->bus ? dev->bus->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 5},
{"warn_data": {"at_line": 917, "warn_str": "Trying to read from a user pointer.", "at": "(dev->class ? dev->class->name : \"\"));", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 6},
{"warn_data": {"at_line": 917, "warn_str": "Trying to read from a user pointer.", "at": "(dev->class ? dev->class->name : \"\"));", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 7},
{"warn_data": {"at_line": 917, "warn_str": "Trying to read from a user pointer.", "at": "(dev->class ? dev->class->name : \"\"));", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 8},
{"warn_data": {"at_line": 916, "warn_str": "Trying to read from a user pointer.", "at": "(dev->bus ? dev->bus->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 9},
{"warn_data": {"at_line": 916, "warn_str": "Trying to read from a user pointer.", "at": "(dev->bus ? dev->bus->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 10},
{"warn_data": {"at_line": 915, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 11}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 257, "file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3307, "file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}],
"warnings":[{"warn_data": {"at_line": 1100, "warn_str": "Trying to read from a user pointer.", "at": "  %6 = load i8*, i8** %5, align 8, !dbg !89563", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_name.226", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device.1478* %0, %struct.device.1478** %3, align 8"}, {"instr_func": "dev_name.226", "instr_loc": 1100, "instr_file": "./include/linux/device.h", "instr": "  %4 = load %struct.device.1478*, %struct.device.1478** %3, align 8, !dbg !89561"}, {"instr_func": "dev_name.226", "instr_loc": 1100, "instr_file": "./include/linux/device.h", "instr": "  %5 = getelementptr inbounds %struct.device.1478, %struct.device.1478* %4, i32 0, i32 3, !dbg !89563"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_name.226"}, "warn_no": 1},
{"warn_data": {"at_line": 1101, "warn_str": "Trying to read from a user pointer.", "at": "  %11 = load i8*, i8** %10, align 8, !dbg !89566", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_name.226", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device.1478* %0, %struct.device.1478** %3, align 8"}, {"instr_func": "dev_name.226", "instr_loc": 1101, "instr_file": "./include/linux/device.h", "instr": "  %9 = load %struct.device.1478*, %struct.device.1478** %3, align 8, !dbg !89565"}, {"instr_func": "dev_name.226", "instr_loc": 1101, "instr_file": "./include/linux/device.h", "instr": "  %10 = getelementptr inbounds %struct.device.1478, %struct.device.1478* %9, i32 0, i32 3, !dbg !89566"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_name.226"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 138, "file": "drivers/mailbox/mailbox-test.c", "instr": "ret = mbox_send_message(tdev->tx_channel, data);"}, {"lineno": 257, "file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3307, "file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"lineno": 1103, "file": "./include/linux/device.h", "instr": "  %15 = call i8* @kobject_name.236(%struct.kobject* %14) #14, !dbg !89570"}],
"warnings":[{"warn_data": {"at_line": 91, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8*, i8** %4, align 8, !dbg !89564", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "mbox_send_message", "instr_loc": 257, "instr_file": "drivers/mailbox/mailbox.c", "instr": "dev_err(chan->mbox->dev, \"Try increasing MBOX_TX_QUEUE_LEN\\n\");"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "_dev_err", "instr_loc": 3349, "instr_file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"instr_func": "__dev_printk", "instr_loc": 3304, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "__dev_printk", "instr_loc": 3307, "instr_file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}, {"instr_func": "dev_name.226", "instr_loc": 1098, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device.1478* %0, %struct.device.1478** %3, align 8"}, {"instr_func": "dev_name.226", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %13 = load %struct.device.1478*, %struct.device.1478** %3, align 8, !dbg !89568"}, {"instr_func": "dev_name.226", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %14 = getelementptr inbounds %struct.device.1478, %struct.device.1478* %13, i32 0, i32 0, !dbg !89569"}, {"instr_func": "dev_name.226", "instr_loc": 1103, "instr_file": "./include/linux/device.h", "instr": "  %15 = call i8* @kobject_name.236(%struct.kobject* %14) #14, !dbg !89570"}, {"instr_func": "kobject_name.236", "instr_loc": 90, "instr_file": "./include/linux/kobject.h", "instr": "  store %struct.kobject* %0, %struct.kobject** %2, align 8"}, {"instr_func": "kobject_name.236", "instr_loc": 91, "instr_file": "./include/linux/kobject.h", "instr": "  %3 = load %struct.kobject*, %struct.kobject** %2, align 8, !dbg !89563"}, {"instr_func": "kobject_name.236", "instr_loc": 91, "instr_file": "./include/linux/kobject.h", "instr": "  %4 = getelementptr inbounds %struct.kobject, %struct.kobject* %3, i32 0, i32 0, !dbg !89564"}], "at_file": "./include/linux/kobject.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "kobject_name.236"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 140, "file": "drivers/mailbox/mailbox-test.c", "instr": "dev_err(tdev->dev, \"Failed to send message via mailbox\\n\");"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3307, "file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}],
"warnings":[{"warn_data": {"at_line": 917, "warn_str": "Trying to read from a user pointer.", "at": "(dev->class ? dev->class->name : \"\"));", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1},
{"warn_data": {"at_line": 916, "warn_str": "Trying to read from a user pointer.", "at": "(dev->bus ? dev->bus->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 2},
{"warn_data": {"at_line": 915, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 140, "file": "drivers/mailbox/mailbox-test.c", "instr": "dev_err(tdev->dev, \"Failed to send message via mailbox\\n\");"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3306, "file": "drivers/base/core.c", "instr": "dev_printk_emit(level[1] - '0', dev, \"%s %s: %pV\","}, {"lineno": 3294, "file": "drivers/base/core.c", "instr": "r = dev_vprintk_emit(level, dev, fmt, args);"}, {"lineno": 3281, "file": "drivers/base/core.c", "instr": "hdrlen = create_syslog_header(dev, hdr, sizeof(hdr));"}],
"warnings":[{"warn_data": {"at_line": 3227, "warn_str": "Trying to read from a user pointer.", "at": "subsys = dev->bus->name;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "create_syslog_header", "instr_loc": 3227, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->bus->name;"}, {"instr_func": "create_syslog_header", "instr_loc": 3227, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->bus->name;"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "create_syslog_header"}, "warn_no": 1},
{"warn_data": {"at_line": 3225, "warn_str": "Trying to read from a user pointer.", "at": "subsys = dev->class->name;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "create_syslog_header", "instr_loc": 3225, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->class->name;"}, {"instr_func": "create_syslog_header", "instr_loc": 3225, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->class->name;"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "create_syslog_header"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 107, "file": "drivers/mailbox/mailbox-test.c", "instr": "dev_err(tdev->dev,"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3307, "file": "drivers/base/core.c", "instr": "dev_driver_string(dev), dev_name(dev), vaf);"}],
"warnings":[{"warn_data": {"at_line": 917, "warn_str": "Trying to read from a user pointer.", "at": "(dev->class ? dev->class->name : \"\"));", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}, {"instr_func": "dev_driver_string", "instr_loc": 917, "instr_file": "drivers/base/core.c", "instr": "(dev->class ? dev->class->name : \"\"));"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 1},
{"warn_data": {"at_line": 916, "warn_str": "Trying to read from a user pointer.", "at": "(dev->bus ? dev->bus->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 916, "instr_file": "drivers/base/core.c", "instr": "(dev->bus ? dev->bus->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 2},
{"warn_data": {"at_line": 915, "warn_str": "Trying to read from a user pointer.", "at": "return drv ? drv->name :", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 907, "instr_file": "drivers/base/core.c", "instr": "{"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 914, "instr_file": "drivers/base/core.c", "instr": "drv = READ_ONCE(dev->driver);"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}, {"instr_func": "dev_driver_string", "instr_loc": 915, "instr_file": "drivers/base/core.c", "instr": "return drv ? drv->name :"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_driver_string"}, "warn_no": 3}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i1, align 1"}, {"lineno": 107, "file": "drivers/mailbox/mailbox-test.c", "instr": "dev_err(tdev->dev,"}, {"lineno": 3349, "file": "drivers/base/core.c", "instr": "define_dev_printk_level(_dev_err, KERN_ERR);"}, {"lineno": 3306, "file": "drivers/base/core.c", "instr": "dev_printk_emit(level[1] - '0', dev, \"%s %s: %pV\","}, {"lineno": 3294, "file": "drivers/base/core.c", "instr": "r = dev_vprintk_emit(level, dev, fmt, args);"}, {"lineno": 3281, "file": "drivers/base/core.c", "instr": "hdrlen = create_syslog_header(dev, hdr, sizeof(hdr));"}],
"warnings":[{"warn_data": {"at_line": 3227, "warn_str": "Trying to read from a user pointer.", "at": "subsys = dev->bus->name;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "create_syslog_header", "instr_loc": 3227, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->bus->name;"}, {"instr_func": "create_syslog_header", "instr_loc": 3227, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->bus->name;"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "create_syslog_header"}, "warn_no": 1},
{"warn_data": {"at_line": 3225, "warn_str": "Trying to read from a user pointer.", "at": "subsys = dev->class->name;", "inst_trace": [{"instr_func": "mbox_test_message_write", "instr_loc": 117, "instr_file": "drivers/mailbox/mailbox-test.c", "instr": "ret = copy_from_user(tdev->message, userbuf, count);"}, {"instr_func": "create_syslog_header", "instr_loc": 3225, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->class->name;"}, {"instr_func": "create_syslog_header", "instr_loc": 3225, "instr_file": "drivers/base/core.c", "instr": "subsys = dev->class->name;"}], "at_file": "drivers/base/core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "create_syslog_header"}, "warn_no": 2}]}]}