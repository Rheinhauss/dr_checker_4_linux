{"all_contexts":[
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1365, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "length = count > 30 ? 30 : count;", "inst_trace": [], "at_file": "drivers/video/fbdev/via/viafbdev.c", "by": "TaintedSizeDetector says:", "at_func": "viafb_vt1636_proc_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1368, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf[length - 1] = '\\0';\t/*Ensure end string */", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1359, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "{"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1368, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "buf[length - 1] = '\\0';\t/*Ensure end string */"}], "at_file": "drivers/video/fbdev/via/viafbdev.c", "by": "IntegerOverflowDetector says:", "at_func": "viafb_vt1636_proc_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1368, "warn_str": "Trying to write to a user pointer.", "at": "buf[length - 1] = '\\0';\t/*Ensure end string */", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1359, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "{"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1365, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "length = count > 30 ? 30 : count;"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1368, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "buf[length - 1] = '\\0';\t/*Ensure end string */"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1368, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "buf[length - 1] = '\\0';\t/*Ensure end string */"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1368, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "buf[length - 1] = '\\0';\t/*Ensure end string */"}], "at_file": "drivers/video/fbdev/via/viafbdev.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "viafb_vt1636_proc_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1370, "warn_str": "Trying to use a global variable without locking.", "at": "switch (viaparinfo->chip_info->lvds_chip_info.lvds_chip_name) {", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/video/fbdev/via/viafbdev.c", "by": "GlobalVariableRaceDetector says:", "at_func": "viafb_vt1636_proc_write"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 58, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "data = viafb_gpio_i2c_read_lvds(plvds_setting_info, plvds_chip_info,"}, {"lineno": 46, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_readbyte(plvds_chip_info->i2c_port,"}],
"warnings":[{"warn_data": {"at_line": 113, "warn_str": "Trying to use a global variable without locking.", "at": "if (!via_i2c_par[adap].is_active)", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 58, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "data = viafb_gpio_i2c_read_lvds(plvds_setting_info, plvds_chip_info,"}, {"instr_func": "viafb_gpio_i2c_read_lvds", "instr_loc": 46, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_readbyte(plvds_chip_info->i2c_port,"}], "at_file": "drivers/video/fbdev/via/via_i2c.c", "by": "GlobalVariableRaceDetector says:", "at_func": "viafb_i2c_readbyte"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 58, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "data = viafb_gpio_i2c_read_lvds(plvds_setting_info, plvds_chip_info,"}, {"lineno": 46, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_readbyte(plvds_chip_info->i2c_port,"}, {"lineno": 122, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, msgs, 2);"}, {"lineno": 2047, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}],
"warnings":[{"warn_data": {"at_line": 1981, "warn_str": "Trying to use a global variable without locking.", "at": "orig_jiffies = jiffies;", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 58, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "data = viafb_gpio_i2c_read_lvds(plvds_setting_info, plvds_chip_info,"}, {"instr_func": "viafb_gpio_i2c_read_lvds", "instr_loc": 46, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_readbyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_readbyte", "instr_loc": 122, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, msgs, 2);"}, {"instr_func": "i2c_transfer", "instr_loc": 2047, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}], "at_file": "drivers/i2c/i2c-core-base.c", "by": "GlobalVariableRaceDetector says:", "at_func": "__i2c_transfer"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}],
"warnings":[{"warn_data": {"at_line": 137, "warn_str": "Trying to use a global variable without locking.", "at": "if (!via_i2c_par[adap].is_active)", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}], "at_file": "drivers/video/fbdev/via/via_i2c.c", "by": "GlobalVariableRaceDetector says:", "at_func": "viafb_i2c_writebyte"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"lineno": 143, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"lineno": 2043, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_lock_bus_helper(adap);"}, {"lineno": 39, "file": "drivers/i2c/i2c-core.h", "instr": "  %6 = call zeroext i1 @i2c_in_atomic_xfer_mode() #17, !dbg !1108685"}],
"warnings":[{"warn_data": {"at_line": 32, "warn_str": "Trying to use a global variable without locking.", "at": "  %10 = load i32, i32* @system_state, align 4, !dbg !1108681", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_writebyte", "instr_loc": 143, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"instr_func": "i2c_transfer", "instr_loc": 2043, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_lock_bus_helper(adap);"}, {"instr_func": "__i2c_lock_bus_helper", "instr_loc": 39, "instr_file": "drivers/i2c/i2c-core.h", "instr": "  %6 = call zeroext i1 @i2c_in_atomic_xfer_mode() #17, !dbg !1108685"}], "at_file": "drivers/i2c/i2c-core.h", "by": "GlobalVariableRaceDetector says:", "at_func": "i2c_in_atomic_xfer_mode"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"lineno": 143, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"lineno": 2047, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"lineno": 1977, "file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_write(adap, &msgs[i], i);"}],
"warnings":[{"warn_data": {"at_line": 25, "warn_str": "Trying to use a global variable without locking.", "at": "  %257 = load i8, i8* @trace_i2c_write.__warned, align 1, !dbg !1108843", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_writebyte", "instr_loc": 143, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"instr_func": "i2c_transfer", "instr_loc": 2047, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"instr_func": "__i2c_transfer", "instr_loc": 1977, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_write(adap, &msgs[i], i);"}], "at_file": "./include/trace/events/i2c.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_i2c_write"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"lineno": 143, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"lineno": 2047, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"lineno": 1975, "file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_read(adap, &msgs[i], i);"}],
"warnings":[{"warn_data": {"at_line": 58, "warn_str": "Trying to use a global variable without locking.", "at": "  %257 = load i8, i8* @trace_i2c_read.__warned, align 1, !dbg !1108843", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_writebyte", "instr_loc": 143, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"instr_func": "i2c_transfer", "instr_loc": 2047, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"instr_func": "__i2c_transfer", "instr_loc": 1975, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_read(adap, &msgs[i], i);"}], "at_file": "./include/trace/events/i2c.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_i2c_read"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"lineno": 143, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"lineno": 2047, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"lineno": 1998, "file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_reply(adap, &msgs[i], i);"}],
"warnings":[{"warn_data": {"at_line": 89, "warn_str": "Trying to use a global variable without locking.", "at": "  %257 = load i8, i8* @trace_i2c_reply.__warned, align 1, !dbg !1108843", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_writebyte", "instr_loc": 143, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"instr_func": "i2c_transfer", "instr_loc": 2047, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"instr_func": "__i2c_transfer", "instr_loc": 1998, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_reply(adap, &msgs[i], i);"}], "at_file": "./include/trace/events/i2c.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_i2c_reply"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 1390, "file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"lineno": 62, "file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"lineno": 143, "file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"lineno": 2047, "file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"lineno": 1999, "file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_result(adap, num, ret);"}],
"warnings":[{"warn_data": {"at_line": 122, "warn_str": "Trying to use a global variable without locking.", "at": "  %257 = load i8, i8* @trace_i2c_result.__warned, align 1, !dbg !1108843", "inst_trace": [{"instr_func": "viafb_vt1636_proc_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "viafb_vt1636_proc_write", "instr_loc": 1390, "instr_file": "drivers/video/fbdev/via/viafbdev.c", "instr": "viafb_gpio_i2c_write_mask_lvds"}, {"instr_func": "viafb_gpio_i2c_write_mask_lvds", "instr_loc": 62, "instr_file": "drivers/video/fbdev/via/vt1636.c", "instr": "viafb_i2c_writebyte(plvds_chip_info->i2c_port,"}, {"instr_func": "viafb_i2c_writebyte", "instr_loc": 143, "instr_file": "drivers/video/fbdev/via/via_i2c.c", "instr": "ret = i2c_transfer(&via_i2c_par[adap].adapter, &msgs, 1);"}, {"instr_func": "i2c_transfer", "instr_loc": 2047, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "ret = __i2c_transfer(adap, msgs, num);"}, {"instr_func": "__i2c_transfer", "instr_loc": 1999, "instr_file": "drivers/i2c/i2c-core-base.c", "instr": "trace_i2c_result(adap, num, ret);"}], "at_file": "./include/trace/events/i2c.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_i2c_result"}, "warn_no": 1}]}]}