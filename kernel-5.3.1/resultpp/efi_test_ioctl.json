{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 712, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_reset_system(arg);"}],
"warnings":[{"warn_data": {"at_line": 547, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_reset_system"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 709, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}],
"warnings":[{"warn_data": {"at_line": 624, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "capsules = kcalloc(qcaps.capsule_count + 1,", "inst_trace": [{"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 607, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 624, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "IntegerOverflowDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 1},
{"warn_data": {"at_line": 607, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 2},
{"warn_data": {"at_line": 629, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < qcaps.capsule_count; i++) {", "inst_trace": [{"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 607, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 629, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "for (i = 0; i < qcaps.capsule_count; i++) {"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 629, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "for (i = 0; i < qcaps.capsule_count; i++) {"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedLoopBoundDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 3},
{"warn_data": {"at_line": 640, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&capsules[i], c,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_capsulecaps"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 709, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}, {"lineno": 624, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}, {"lineno": 687, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #13, !dbg !4559"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %221 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %220, !dbg !4794", "inst_trace": [{"instr_func": "efi_test_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "efi_test_ioctl", "instr_loc": 709, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_capsulecaps(arg);"}, {"instr_func": "efi_runtime_query_capsulecaps", "instr_loc": 624, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "capsules = kcalloc(qcaps.capsule_count + 1,"}, {"instr_func": "kcalloc", "instr_loc": 687, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array(i64 %7, i64 %8, i32 %10) #13, !dbg !4559"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 706, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_query_variableinfo(arg);"}],
"warnings":[{"warn_data": {"at_line": 571, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_query_variableinfo"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 703, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nexthighmonocount(arg);"}],
"warnings":[{"warn_data": {"at_line": 516, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nexthighmonocount"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 700, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}],
"warnings":[{"warn_data": {"at_line": 505, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getnextvariablename.vendor_guid, vd,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 1},
{"warn_data": {"at_line": 415, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 2},
{"warn_data": {"at_line": 439, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_nextvariablename"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 700, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}, {"lineno": 449, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = get_ucs2_strsize_from_user("}, {"lineno": 93, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 415, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 450, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "getnextvariablename.variable_name,"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 449, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = get_ucs2_strsize_from_user("}, {"instr_func": "get_ucs2_strsize_from_user", "instr_loc": 92, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "get_ucs2_strsize_from_user", "instr_loc": 93, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "get_ucs2_strsize_from_user", "instr_loc": 93, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 700, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}, {"lineno": 462, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user_len(&name,"}, {"lineno": 72, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 415, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 463, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "getnextvariablename.variable_name,"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 462, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user_len(&name,"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 64, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 700, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}, {"lineno": 490, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (copy_ucs2_to_user_len(getnextvariablename.variable_name,"}],
"warnings":[{"warn_data": {"at_line": 147, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user(dst, src, len);", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "copy_ucs2_to_user_len"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 700, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_nextvariablename(arg);"}, {"lineno": 490, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (copy_ucs2_to_user_len(getnextvariablename.variable_name,"}, {"lineno": 144, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(dst, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 415, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 490, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (copy_ucs2_to_user_len(getnextvariablename.variable_name,"}, {"instr_func": "efi_runtime_get_nextvariablename", "instr_loc": 490, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (copy_ucs2_to_user_len(getnextvariablename.variable_name,"}, {"instr_func": "copy_ucs2_to_user_len", "instr_loc": 140, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_to_user_len", "instr_loc": 144, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(dst, 1))"}, {"instr_func": "copy_ucs2_to_user_len", "instr_loc": 144, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(dst, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 697, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_waketime(arg);"}],
"warnings":[{"warn_data": {"at_line": 400, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&efi_time, setwakeuptime.time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_waketime"}, "warn_no": 1},
{"warn_data": {"at_line": 385, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_waketime"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 694, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_waketime(arg);"}],
"warnings":[{"warn_data": {"at_line": 348, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_waketime"}, "warn_no": 1},
{"warn_data": {"at_line": 376, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getwakeuptime.time, &efi_time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_waketime"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 691, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_time(arg);"}],
"warnings":[{"warn_data": {"at_line": 336, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&efi_time, settime.time,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_time"}, "warn_no": 1},
{"warn_data": {"at_line": 327, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_time"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 688, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_time(arg);"}],
"warnings":[{"warn_data": {"at_line": 289, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_time"}, "warn_no": 1},
{"warn_data": {"at_line": 319, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(gettime.time, &efi_time, sizeof(efi_time_t)))", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_time"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 685, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_variable(arg);"}],
"warnings":[{"warn_data": {"at_line": 241, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_variable"}, "warn_no": 1},
{"warn_data": {"at_line": 254, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid, setvariable.vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_set_variable"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 685, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_variable(arg);"}, {"lineno": 259, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"lineno": 120, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_set_variable", "instr_loc": 241, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_set_variable", "instr_loc": 259, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"instr_func": "efi_runtime_set_variable", "instr_loc": 259, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 117, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 120, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 120, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 685, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_set_variable(arg);"}, {"lineno": 259, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"lineno": 126, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"lineno": 72, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_set_variable", "instr_loc": 241, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_set_variable", "instr_loc": 259, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"instr_func": "efi_runtime_set_variable", "instr_loc": 259, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, setvariable.variable_name);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 117, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 126, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 126, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 64, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 682, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}],
"warnings":[{"warn_data": {"at_line": 220, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(getvariable.data, data, datasize)) {", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 1},
{"warn_data": {"at_line": 151, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 2},
{"warn_data": {"at_line": 171, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&vendor_guid, getvariable.vendor_guid,", "inst_trace": [], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "TaintedSizeDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 3},
{"warn_data": {"at_line": 187, "warn_str": "Trying to use a global variable without locking.", "at": "data = kmalloc(datasize, GFP_KERNEL);", "inst_trace": [{"instr_func": "efi_test_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "efi_test_ioctl", "instr_loc": 682, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}], "at_file": "drivers/firmware/efi/test/efi_test.c", "by": "GlobalVariableRaceDetector says:", "at_func": "efi_runtime_get_variable"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 682, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}, {"lineno": 178, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"lineno": 120, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_get_variable", "instr_loc": 151, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_get_variable", "instr_loc": 178, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"instr_func": "efi_runtime_get_variable", "instr_loc": 178, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 117, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 120, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 120, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 682, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return efi_runtime_get_variable(arg);"}, {"lineno": 178, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"lineno": 126, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"lineno": 72, "file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !4563", "inst_trace": [{"instr_func": "efi_runtime_get_variable", "instr_loc": 151, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "efi_runtime_get_variable", "instr_loc": 178, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"instr_func": "efi_runtime_get_variable", "instr_loc": 178, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "rv = copy_ucs2_from_user(&name, getvariable.variable_name);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 117, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 126, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"instr_func": "copy_ucs2_from_user", "instr_loc": 126, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "return copy_ucs2_from_user_len(dst, src, len);"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 64, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "{"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "copy_ucs2_from_user_len", "instr_loc": 72, "instr_file": "drivers/firmware/efi/test/efi_test.c", "instr": "if (!access_ok(src, 1))"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !4563"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]}]}