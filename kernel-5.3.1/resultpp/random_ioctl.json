{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}],
"warnings":[{"warn_data": {"at_line": 2089, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_init < 2)", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "random_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1014, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}],
"warnings":[{"warn_data": {"at_line": 1056, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_ready() &&", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1014, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1014, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 1059, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 1015, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"lineno": 1095, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}],
"warnings":[{"warn_data": {"at_line": 1074, "warn_str": "Trying to use a global variable without locking.", "at": "if (crng_node_pool)", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1014, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 1059, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1015, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1095, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "extract_crng"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1014, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 1059, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1614, "file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}],
"warnings":[{"warn_data": {"at_line": 249, "warn_str": "Trying to use a global variable without locking.", "at": "  %260 = load i8, i8* @trace_extract_entropy.__warned, align 1, !dbg !7910", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1014, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 1059, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1614, "instr_file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}], "at_file": "./include/trace/events/random.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_extract_entropy"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1014, "file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"lineno": 1059, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1616, "file": "drivers/char/random.c", "instr": "nbytes = account(r, nbytes, min, reserved);"}],
"warnings":[{"warn_data": {"at_line": 1485, "warn_str": "Trying to use a global variable without locking.", "at": "(r->entropy_count >> ENTROPY_SHIFT) < random_write_wakeup_bits) {", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1014, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(&primary_crng, buf.block);"}, {"instr_func": "_extract_crng", "instr_loc": 1059, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1616, "instr_file": "drivers/char/random.c", "instr": "nbytes = account(r, nbytes, min, reserved);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "account"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1015, "file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"lineno": 1095, "file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"lineno": 1079, "file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"lineno": 1059, "file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}],
"warnings":[{"warn_data": {"at_line": 1027, "warn_str": "Trying to use a global variable without locking.", "at": "crng->init_time = jiffies;", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1015, "instr_file": "drivers/char/random.c", "instr": "_crng_backtrack_protect(&primary_crng, buf.block,"}, {"instr_func": "_crng_backtrack_protect", "instr_loc": 1095, "instr_file": "drivers/char/random.c", "instr": "extract_crng(tmp);"}, {"instr_func": "extract_crng", "instr_loc": 1079, "instr_file": "drivers/char/random.c", "instr": "_extract_crng(crng, out);"}, {"instr_func": "_extract_crng", "instr_loc": 1059, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(crng, crng == &primary_crng ? &input_pool : NULL);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "crng_reseed"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1614, "file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}, {"lineno": 249, "file": "./include/trace/events/random.h", "instr": "  %66 = call i32 @cpumask_test_cpu(i32 %65, %struct.cpumask* @__cpu_online_mask) #15, !dbg !7834"}, {"lineno": 344, "file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #15, !dbg !7754"}],
"warnings":[{"warn_data": {"at_line": 128, "warn_str": "Trying to use a global variable without locking.", "at": "  %4 = load i32, i32* @nr_cpu_ids, align 4, !dbg !7752", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1614, "instr_file": "drivers/char/random.c", "instr": "trace_extract_entropy(r->name, nbytes, ENTROPY_BITS(r), _RET_IP_);"}, {"instr_func": "trace_extract_entropy", "instr_loc": 249, "instr_file": "./include/trace/events/random.h", "instr": "  %66 = call i32 @cpumask_test_cpu(i32 %65, %struct.cpumask* @__cpu_online_mask) #15, !dbg !7834"}, {"instr_func": "cpumask_test_cpu", "instr_loc": 344, "instr_file": "./include/linux/cpumask.h", "instr": "  %6 = call i32 @cpumask_check(i32 %5) #15, !dbg !7754"}], "at_file": "./include/linux/cpumask.h", "by": "GlobalVariableRaceDetector says:", "at_func": "cpumask_check"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1615, "file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"lineno": 1405, "file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}],
"warnings":[{"warn_data": {"at_line": 1415, "warn_str": "Trying to use a global variable without locking.", "at": "bytes = max_t(int, bytes, random_read_wakeup_bits / 8);", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1615, "instr_file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"instr_func": "xfer_secondary_pool", "instr_loc": 1405, "instr_file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "_xfer_secondary_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1615, "file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"lineno": 1405, "file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}, {"lineno": 1419, "file": "drivers/char/random.c", "instr": "trace_xfer_secondary_pool(r->name, bytes * 8, nbytes * 8,"}],
"warnings":[{"warn_data": {"at_line": 164, "warn_str": "Trying to use a global variable without locking.", "at": "  %263 = load i8, i8* @trace_xfer_secondary_pool.__warned, align 1, !dbg !7911", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1615, "instr_file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"instr_func": "xfer_secondary_pool", "instr_loc": 1405, "instr_file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}, {"instr_func": "_xfer_secondary_pool", "instr_loc": 1419, "instr_file": "drivers/char/random.c", "instr": "trace_xfer_secondary_pool(r->name, bytes * 8, nbytes * 8,"}], "at_file": "./include/trace/events/random.h", "by": "GlobalVariableRaceDetector says:", "at_func": "trace_xfer_secondary_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2091, "file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"lineno": 1010, "file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"lineno": 1615, "file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"lineno": 1405, "file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}, {"lineno": 1424, "file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, bytes*8);"}],
"warnings":[{"warn_data": {"at_line": 769, "warn_str": "Trying to use a global variable without locking.", "at": "if ((r == &blocking_pool) && !r->initialized &&", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2091, "instr_file": "drivers/char/random.c", "instr": "crng_reseed(&primary_crng, NULL);"}, {"instr_func": "crng_reseed", "instr_loc": 1010, "instr_file": "drivers/char/random.c", "instr": "num = extract_entropy(r, &buf, 32, 16, 0);"}, {"instr_func": "extract_entropy", "instr_loc": 1615, "instr_file": "drivers/char/random.c", "instr": "xfer_secondary_pool(r, nbytes);"}, {"instr_func": "xfer_secondary_pool", "instr_loc": 1405, "instr_file": "drivers/char/random.c", "instr": "_xfer_secondary_pool(r, nbytes);"}, {"instr_func": "_xfer_secondary_pool", "instr_loc": 1424, "instr_file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, bytes*8);"}], "at_file": "drivers/char/random.c", "by": "GlobalVariableRaceDetector says:", "at_func": "credit_entropy_bits"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2070, "file": "drivers/char/random.c", "instr": "retval = write_pool(&input_pool, (const char __user *)p,"}],
"warnings":[{"warn_data": {"at_line": 2010, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "bytes = min(count, sizeof(buf));", "inst_trace": [], "at_file": "drivers/char/random.c", "by": "TaintedSizeDetector says:", "at_func": "write_pool"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i64, align 8"}, {"lineno": 2074, "file": "drivers/char/random.c", "instr": "return credit_entropy_bits_safe(&input_pool, ent_count);"}, {"lineno": 829, "file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, nbits);"}, {"lineno": 798, "file": "drivers/char/random.c", "instr": "schedule_work(&other->push_work);"}],
"warnings":[{"warn_data": {"at_line": 548, "warn_str": "Trying to use a global variable without locking.", "at": "  %3 = load %struct.workqueue_struct*, %struct.workqueue_struct** @system_wq, align 8, !dbg !7751", "inst_trace": [{"instr_func": "random_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i64, align 8"}, {"instr_func": "random_ioctl", "instr_loc": 2074, "instr_file": "drivers/char/random.c", "instr": "return credit_entropy_bits_safe(&input_pool, ent_count);"}, {"instr_func": "credit_entropy_bits_safe", "instr_loc": 829, "instr_file": "drivers/char/random.c", "instr": "credit_entropy_bits(r, nbits);"}, {"instr_func": "credit_entropy_bits", "instr_loc": 798, "instr_file": "drivers/char/random.c", "instr": "schedule_work(&other->push_work);"}], "at_file": "./include/linux/workqueue.h", "by": "GlobalVariableRaceDetector says:", "at_func": "schedule_work"}, "warn_no": 1}]}]}