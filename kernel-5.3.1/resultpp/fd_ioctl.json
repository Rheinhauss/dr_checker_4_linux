{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3448, "file": "drivers/block/floppy.c", "instr": "ret = fd_copyin((void __user *)param, &inparam, size);"}],
"warnings":[{"warn_data": {"at_line": 2990, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "fd_copyin"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3564, "file": "drivers/block/floppy.c", "instr": "i = raw_cmd_ioctl(cmd, (void __user *)param);"}, {"lineno": 3198, "file": "drivers/block/floppy.c", "instr": "ret = raw_cmd_copyin(cmd, param, &my_raw_cmd);"}],
"warnings":[{"warn_data": {"at_line": 3125, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "*rcmd = ptr;", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "raw_cmd_copyin"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3564, "file": "drivers/block/floppy.c", "instr": "i = raw_cmd_ioctl(cmd, (void __user *)param);"}, {"lineno": 3198, "file": "drivers/block/floppy.c", "instr": "ret = raw_cmd_copyin(cmd, param, &my_raw_cmd);"}, {"lineno": 3158, "file": "drivers/block/floppy.c", "instr": "ret = fd_copyin(ptr->data, ptr->kernel_data, ptr->length);"}],
"warnings":[{"warn_data": {"at_line": 2990, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "fd_copyin"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3564, "file": "drivers/block/floppy.c", "instr": "i = raw_cmd_ioctl(cmd, (void __user *)param);"}, {"lineno": 3214, "file": "drivers/block/floppy.c", "instr": "ret2 = raw_cmd_copyout(cmd, param, my_raw_cmd);"}],
"warnings":[{"warn_data": {"leaked_struct": "  %20 = alloca %struct.floppy_raw_cmd, align 8", "at_line": 3070, "warn_str": "Potentially leaking memory on kernel stack (via padded fields) into user space", "at": "struct floppy_raw_cmd cmd = *ptr;", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "KernelUninitMemoryLeakDetector says:", "at_func": "raw_cmd_copyout"}, "warn_no": 1},
{"warn_data": {"at_line": 3070, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct floppy_raw_cmd cmd = *ptr;", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "raw_cmd_copyout"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3564, "file": "drivers/block/floppy.c", "instr": "i = raw_cmd_ioctl(cmd, (void __user *)param);"}, {"lineno": 3214, "file": "drivers/block/floppy.c", "instr": "ret2 = raw_cmd_copyout(cmd, param, my_raw_cmd);"}, {"lineno": 3081, "file": "drivers/block/floppy.c", "instr": "ret = fd_copyout(ptr->data, ptr->kernel_data,"}],
"warnings":[{"warn_data": {"at_line": 2984, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "fd_copyout"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %5 = alloca %struct.block_device*, align 8"}, {"lineno": 3591, "file": "drivers/block/floppy.c", "instr": "ret = fd_locked_ioctl(bdev, mode, cmd, param);"}, {"lineno": 3580, "file": "drivers/block/floppy.c", "instr": "return fd_copyout((void __user *)param, outparam, size);"}],
"warnings":[{"warn_data": {"at_line": 2984, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/block/floppy.c", "by": "TaintedSizeDetector says:", "at_func": "fd_copyout"}, "warn_no": 1}]}]}