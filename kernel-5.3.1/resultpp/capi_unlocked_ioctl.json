{"all_contexts":[
{"num_warnings": 16,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}],
"warnings":[{"warn_data": {"at_line": 900, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct capincci *nccip;", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 916, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct capincci *nccip;", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 844, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, data.manufacturer,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 889, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, &cdev->userflags,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 875, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "unsigned userflags;", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 869, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&mcmd, argp, sizeof(mcmd)))", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 854, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, &data.errcode,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 837, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&data.contr, argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 829, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "retval = copy_to_user(argp, &data.profile,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 811, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&data.contr, argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 820, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "retval = copy_to_user(argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 805, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, data.serial,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 12},
{"warn_data": {"at_line": 799, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&data.contr, argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 13},
{"warn_data": {"at_line": 793, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(argp, &data.version,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 14},
{"warn_data": {"at_line": 787, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&data.contr, argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 15},
{"warn_data": {"at_line": 768, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&cdev->ap.rparam, argp,", "inst_trace": [], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedSizeDetector says:", "at_func": "capi_ioctl"}, "warn_no": 16}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 925, "file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}],
"warnings":[{"warn_data": {"at_line": 376, "warn_str": "Loop is bounded by a tainted value.", "at": "if (np->ncci == ncci)", "inst_trace": [{"instr_func": "capi_ioctl", "instr_loc": 916, "instr_file": "drivers/isdn/capi/capi.c", "instr": "struct capincci *nccip;"}, {"instr_func": "capi_ioctl", "instr_loc": 925, "instr_file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}, {"instr_func": "capi_ioctl", "instr_loc": 925, "instr_file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}, {"instr_func": "capincci_find", "instr_loc": 372, "instr_file": "drivers/isdn/capi/capi.c", "instr": "{"}, {"instr_func": "capincci_find", "instr_loc": 376, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (np->ncci == ncci)"}, {"instr_func": "capincci_find", "instr_loc": 376, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (np->ncci == ncci)"}], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "capincci_find"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 908, "file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}],
"warnings":[{"warn_data": {"at_line": 376, "warn_str": "Loop is bounded by a tainted value.", "at": "if (np->ncci == ncci)", "inst_trace": [{"instr_func": "capi_ioctl", "instr_loc": 900, "instr_file": "drivers/isdn/capi/capi.c", "instr": "struct capincci *nccip;"}, {"instr_func": "capi_ioctl", "instr_loc": 908, "instr_file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}, {"instr_func": "capi_ioctl", "instr_loc": 908, "instr_file": "drivers/isdn/capi/capi.c", "instr": "nccip = capincci_find(cdev, (u32)ncci);"}, {"instr_func": "capincci_find", "instr_loc": 372, "instr_file": "drivers/isdn/capi/capi.c", "instr": "{"}, {"instr_func": "capincci_find", "instr_loc": 376, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (np->ncci == ncci)"}, {"instr_func": "capincci_find", "instr_loc": 376, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (np->ncci == ncci)"}], "at_file": "drivers/isdn/capi/capi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "capincci_find"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}],
"warnings":[{"warn_data": {"at_line": 1216, "warn_str": "Trying to read from a user pointer.", "at": "ctr->cnr, ctr->traceflag);", "inst_trace": [{"instr_func": "capi20_manufacturer", "instr_loc": 1205, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "kcapi_flagdef fdef;"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1216, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->cnr, ctr->traceflag);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1216, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->cnr, ctr->traceflag);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi20_manufacturer"}, "warn_no": 1},
{"warn_data": {"at_line": 1227, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct list_head *l;", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "capi20_manufacturer"}, "warn_no": 2},
{"warn_data": {"at_line": 1205, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "kcapi_flagdef fdef;", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "capi20_manufacturer"}, "warn_no": 3},
{"warn_data": {"at_line": 1214, "warn_str": "Trying to write to a user pointer.", "at": "ctr->traceflag = fdef.flag;", "inst_trace": [{"instr_func": "capi20_manufacturer", "instr_loc": 1205, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "kcapi_flagdef fdef;"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1214, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->traceflag = fdef.flag;"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1214, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->traceflag = fdef.flag;"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi20_manufacturer"}, "warn_no": 4},
{"warn_data": {"at_line": 1216, "warn_str": "Trying to read from a user pointer.", "at": "ctr->cnr, ctr->traceflag);", "inst_trace": [{"instr_func": "capi20_manufacturer", "instr_loc": 1205, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "kcapi_flagdef fdef;"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1216, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->cnr, ctr->traceflag);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1216, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->cnr, ctr->traceflag);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi20_manufacturer"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1212, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}],
"warnings":[{"warn_data": {"at_line": 96, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)", "inst_trace": [{"instr_func": "capi20_manufacturer", "instr_loc": 1205, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "kcapi_flagdef fdef;"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 96, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 1},
{"warn_data": {"at_line": 99, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return capi_controller[contr - 1];", "inst_trace": [{"instr_func": "capi20_manufacturer", "instr_loc": 1205, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "kcapi_flagdef fdef;"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "capi20_manufacturer", "instr_loc": 1212, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(fdef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 2}]},
{"num_warnings": 13,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}],
"warnings":[{"warn_data": {"at_line": 1146, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "old_capi_manufacturer"}, "warn_no": 1},
{"warn_data": {"at_line": 1159, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state == CAPI_CTR_DETECTED)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1159, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETECTED)"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1159, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETECTED)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 2},
{"warn_data": {"at_line": 1162, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->reset_ctr == NULL) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1162, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->reset_ctr == NULL) {"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1162, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->reset_ctr == NULL) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 3},
{"warn_data": {"at_line": 1168, "warn_str": "Trying to read from a user pointer.", "at": "ctr->reset_ctr(ctr);", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1168, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->reset_ctr(ctr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1168, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->reset_ctr(ctr);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 4},
{"warn_data": {"at_line": 1089, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ldef, data,", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "old_capi_manufacturer"}, "warn_no": 5},
{"warn_data": {"at_line": 1083, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ldef, data,", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "old_capi_manufacturer"}, "warn_no": 6},
{"warn_data": {"at_line": 1102, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->load_firmware == NULL) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1102, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->load_firmware == NULL) {"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1102, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->load_firmware == NULL) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 7},
{"warn_data": {"at_line": 1126, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state != CAPI_CTR_DETECTED) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1126, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state != CAPI_CTR_DETECTED) {"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1126, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state != CAPI_CTR_DETECTED) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 8},
{"warn_data": {"at_line": 1131, "warn_str": "Trying to write to a user pointer.", "at": "ctr->state = CAPI_CTR_LOADING;", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1131, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->state = CAPI_CTR_LOADING;"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1131, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->state = CAPI_CTR_LOADING;"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 9},
{"warn_data": {"at_line": 1133, "warn_str": "Trying to read from a user pointer.", "at": "retval = ctr->load_firmware(ctr, &ldata);", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1133, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = ctr->load_firmware(ctr, &ldata);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1133, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = ctr->load_firmware(ctr, &ldata);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 10},
{"warn_data": {"at_line": 1135, "warn_str": "Trying to write to a user pointer.", "at": "ctr->state = CAPI_CTR_DETECTED;", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1135, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->state = CAPI_CTR_DETECTED;"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1135, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr->state = CAPI_CTR_DETECTED;"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "old_capi_manufacturer"}, "warn_no": 11},
{"warn_data": {"at_line": 1038, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if ((retval = copy_from_user(&cdef, data,", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "old_capi_manufacturer"}, "warn_no": 12},
{"warn_data": {"at_line": 1032, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if ((retval = copy_from_user(&cdef, data,", "inst_trace": [], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedSizeDetector says:", "at_func": "old_capi_manufacturer"}, "warn_no": 13}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1153, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}],
"warnings":[{"warn_data": {"at_line": 96, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 96, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 1},
{"warn_data": {"at_line": 99, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return capi_controller[contr - 1];", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1170, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}],
"warnings":[{"warn_data": {"at_line": 995, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ctr->state == CAPI_CTR_DETACHED) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "wait_on_ctr_state"}, "warn_no": 1},
{"warn_data": {"at_line": 995, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state == CAPI_CTR_DETACHED) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "wait_on_ctr_state"}, "warn_no": 2},
{"warn_data": {"at_line": 993, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state == state)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "wait_on_ctr_state"}, "warn_no": 3},
{"warn_data": {"at_line": 993, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ctr->state == state)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "wait_on_ctr_state"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1170, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"lineno": 985, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}],
"warnings":[{"warn_data": {"at_line": 81, "warn_str": "Trying to read from a user pointer.", "at": "if (!try_module_get(ctr->owner))", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 985, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 985, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}, {"instr_func": "capi_ctr_get", "instr_loc": 80, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi_ctr_get", "instr_loc": 81, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (!try_module_get(ctr->owner))"}, {"instr_func": "capi_ctr_get", "instr_loc": 81, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (!try_module_get(ctr->owner))"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi_ctr_get"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1170, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"lineno": 1010, "file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}],
"warnings":[{"warn_data": {"at_line": 89, "warn_str": "Trying to read from a user pointer.", "at": "module_put(ctr->owner);", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1146, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&rdef, data, sizeof(avmb1_resetdef)))"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1153, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(rdef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1170, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_DETECTED);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 1010, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 1010, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}, {"instr_func": "capi_ctr_put", "instr_loc": 88, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi_ctr_put", "instr_loc": 89, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "module_put(ctr->owner);"}, {"instr_func": "capi_ctr_put", "instr_loc": 89, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "module_put(ctr->owner);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi_ctr_put"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1096, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}],
"warnings":[{"warn_data": {"at_line": 96, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 96, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 1},
{"warn_data": {"at_line": 99, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return capi_controller[contr - 1];", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1139, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}],
"warnings":[{"warn_data": {"at_line": 995, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ctr->state == CAPI_CTR_DETACHED) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "wait_on_ctr_state"}, "warn_no": 1},
{"warn_data": {"at_line": 995, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state == CAPI_CTR_DETACHED) {", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 995, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == CAPI_CTR_DETACHED) {"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "wait_on_ctr_state"}, "warn_no": 2},
{"warn_data": {"at_line": 993, "warn_str": "Trying to read from a user pointer.", "at": "if (ctr->state == state)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "wait_on_ctr_state"}, "warn_no": 3},
{"warn_data": {"at_line": 993, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ctr->state == state)", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 993, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (ctr->state == state)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedLoopBoundDetector says:", "at_func": "wait_on_ctr_state"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1139, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"lineno": 985, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}],
"warnings":[{"warn_data": {"at_line": 81, "warn_str": "Trying to read from a user pointer.", "at": "if (!try_module_get(ctr->owner))", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 985, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 985, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = capi_ctr_get(ctr);"}, {"instr_func": "capi_ctr_get", "instr_loc": 80, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi_ctr_get", "instr_loc": 81, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (!try_module_get(ctr->owner))"}, {"instr_func": "capi_ctr_get", "instr_loc": 81, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (!try_module_get(ctr->owner))"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi_ctr_get"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 871, "file": "drivers/isdn/capi/capi.c", "instr": "return capi20_manufacturer(mcmd.cmd, mcmd.data);"}, {"lineno": 1201, "file": "drivers/isdn/capi/kcapi.c", "instr": "return old_capi_manufacturer(cmd, data);"}, {"lineno": 1139, "file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"lineno": 1010, "file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}],
"warnings":[{"warn_data": {"at_line": 89, "warn_str": "Trying to read from a user pointer.", "at": "module_put(ctr->owner);", "inst_trace": [{"instr_func": "old_capi_manufacturer", "instr_loc": 1089, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (copy_from_user(&ldef, data,"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 100, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "}"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1096, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(ldef.contr);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "old_capi_manufacturer", "instr_loc": 1139, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "retval = wait_on_ctr_state(ctr, CAPI_CTR_RUNNING);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 981, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 1010, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}, {"instr_func": "wait_on_ctr_state", "instr_loc": 1010, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "capi_ctr_put(ctr);"}, {"instr_func": "capi_ctr_put", "instr_loc": 88, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi_ctr_put", "instr_loc": 89, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "module_put(ctr->owner);"}, {"instr_func": "capi_ctr_put", "instr_loc": 89, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "module_put(ctr->owner);"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "capi_ctr_put"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 947, "file": "drivers/isdn/capi/capi.c", "instr": "ret = capi_ioctl(file, cmd, arg);"}, {"lineno": 840, "file": "drivers/isdn/capi/capi.c", "instr": "cdev->errcode = capi20_get_manufacturer(data.contr, data.manufacturer);"}, {"lineno": 861, "file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(contr);"}],
"warnings":[{"warn_data": {"at_line": 96, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)", "inst_trace": [{"instr_func": "capi_ioctl", "instr_loc": 837, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (copy_from_user(&data.contr, argp,"}, {"instr_func": "capi_ioctl", "instr_loc": 840, "instr_file": "drivers/isdn/capi/capi.c", "instr": "cdev->errcode = capi20_get_manufacturer(data.contr, data.manufacturer);"}, {"instr_func": "capi_ioctl", "instr_loc": 840, "instr_file": "drivers/isdn/capi/capi.c", "instr": "cdev->errcode = capi20_get_manufacturer(data.contr, data.manufacturer);"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 850, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 861, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(contr);"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 861, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 96, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "if (contr < 1 || contr - 1 >= CAPI_MAXCONTR)"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 1},
{"warn_data": {"at_line": 99, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return capi_controller[contr - 1];", "inst_trace": [{"instr_func": "capi_ioctl", "instr_loc": 837, "instr_file": "drivers/isdn/capi/capi.c", "instr": "if (copy_from_user(&data.contr, argp,"}, {"instr_func": "capi_ioctl", "instr_loc": 840, "instr_file": "drivers/isdn/capi/capi.c", "instr": "cdev->errcode = capi20_get_manufacturer(data.contr, data.manufacturer);"}, {"instr_func": "capi_ioctl", "instr_loc": 840, "instr_file": "drivers/isdn/capi/capi.c", "instr": "cdev->errcode = capi20_get_manufacturer(data.contr, data.manufacturer);"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 850, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 861, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(contr);"}, {"instr_func": "capi20_get_manufacturer", "instr_loc": 861, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "ctr = get_capi_ctr_by_nr(contr);"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 95, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "{"}, {"instr_func": "get_capi_ctr_by_nr", "instr_loc": 99, "instr_file": "drivers/isdn/capi/kcapi.c", "instr": "return capi_controller[contr - 1];"}], "at_file": "drivers/isdn/capi/kcapi.c", "by": "IntegerOverflowDetector says:", "at_func": "get_capi_ctr_by_nr"}, "warn_no": 2}]}]}