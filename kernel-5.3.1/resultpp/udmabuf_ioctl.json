{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}],
"warnings":[{"warn_data": {"at_line": 231, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedSizeDetector says:", "at_func": "udmabuf_ioctl_create_list"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 246, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}],
"warnings":[{"warn_data": {"at_line": 139, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < head->count; i++) {", "inst_trace": [{"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 231, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 139, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}, {"instr_func": "udmabuf_create", "instr_loc": 139, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 1},
{"warn_data": {"at_line": 185, "warn_str": "Trying to use a global variable without locking.", "at": "exp_info.ops  = &udmabuf_ops;", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 246, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "GlobalVariableRaceDetector says:", "at_func": "udmabuf_create"}, "warn_no": 2},
{"warn_data": {"at_line": 156, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < head->count; i++) {", "inst_trace": [{"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 231, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 156, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}, {"instr_func": "udmabuf_create", "instr_loc": 156, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "for (i = 0; i < head->count; i++) {"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 246, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"lineno": 134, "file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf = kzalloc(sizeof(*ubuf), GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !36891", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 246, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 134, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf = kzalloc(sizeof(*ubuf), GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc.345"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 246, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"lineno": 148, "file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pages = kmalloc_array(ubuf->pagecount, sizeof(*ubuf->pages),"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %221 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %220, !dbg !36912", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 246, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 148, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pages = kmalloc_array(ubuf->pagecount, sizeof(*ubuf->pages),"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array.346"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 246, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"lineno": 190, "file": "drivers/dma-buf/udmabuf.c", "instr": "buf = dma_buf_export(&exp_info);"}, {"lineno": 531, "file": "drivers/dma-buf/dma-buf.c", "instr": "dmabuf = kzalloc(alloc_size, GFP_KERNEL);"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %183 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %182, !dbg !36891", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 246, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 190, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "buf = dma_buf_export(&exp_info);"}, {"instr_func": "dma_buf_export", "instr_loc": 531, "instr_file": "drivers/dma-buf/dma-buf.c", "instr": "dmabuf = kzalloc(alloc_size, GFP_KERNEL);"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kzalloc"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 261, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"lineno": 246, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"lineno": 190, "file": "drivers/dma-buf/udmabuf.c", "instr": "buf = dma_buf_export(&exp_info);"}, {"lineno": 552, "file": "drivers/dma-buf/dma-buf.c", "instr": "file = dma_buf_getfile(dmabuf, exp_info->flags);"}],
"warnings":[{"warn_data": {"at_line": 435, "warn_str": "Trying to use a global variable without locking.", "at": "struct inode *inode = alloc_anon_inode(dma_buf_mnt->mnt_sb);", "inst_trace": [{"instr_func": "udmabuf_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "udmabuf_ioctl", "instr_loc": 261, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create_list(filp, arg);"}, {"instr_func": "udmabuf_ioctl_create_list", "instr_loc": 246, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_create(&head, list);"}, {"instr_func": "udmabuf_create", "instr_loc": 190, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "buf = dma_buf_export(&exp_info);"}, {"instr_func": "dma_buf_export", "instr_loc": 552, "instr_file": "drivers/dma-buf/dma-buf.c", "instr": "file = dma_buf_getfile(dmabuf, exp_info->flags);"}], "at_file": "drivers/dma-buf/dma-buf.c", "by": "GlobalVariableRaceDetector says:", "at_func": "dma_buf_getfile"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 258, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}],
"warnings":[{"warn_data": {"at_line": 212, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedSizeDetector says:", "at_func": "udmabuf_ioctl_create"}, "warn_no": 1}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 258, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 227, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(&head, &list);"}],
"warnings":[{"warn_data": {"at_line": 144, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "IntegerOverflowDetector says:", "at_func": "udmabuf_create"}, "warn_no": 1},
{"warn_data": {"at_line": 145, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ubuf->pagecount > pglimit)", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 144, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "ubuf->pagecount += list[i].size >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 145, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (ubuf->pagecount > pglimit)"}, {"instr_func": "udmabuf_create", "instr_loc": 145, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (ubuf->pagecount > pglimit)"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 2},
{"warn_data": {"at_line": 142, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 225, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.size   = create.size;"}, {"instr_func": "udmabuf_create", "instr_loc": 142, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 142, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 142, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].size, PAGE_SIZE))"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 3},
{"warn_data": {"at_line": 140, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 224, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 224, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_create", "instr_loc": 140, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 140, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}, {"instr_func": "udmabuf_create", "instr_loc": 140, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "if (!IS_ALIGNED(list[i].offset, PAGE_SIZE))"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "udmabuf_create"}, "warn_no": 4},
{"warn_data": {"at_line": 174, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "file_inode(memfd)->i_mapping, pgoff + pgidx);", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 224, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_ioctl_create", "instr_loc": 224, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "list.offset = create.offset;"}, {"instr_func": "udmabuf_create", "instr_loc": 170, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 170, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 170, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "pgoff = list[i].offset >> PAGE_SHIFT;"}, {"instr_func": "udmabuf_create", "instr_loc": 174, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "file_inode(memfd)->i_mapping, pgoff + pgidx);"}], "at_file": "drivers/dma-buf/udmabuf.c", "by": "IntegerOverflowDetector says:", "at_func": "udmabuf_create"}, "warn_no": 5}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 258, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 227, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(&head, &list);"}, {"lineno": 203, "file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"lineno": 1025, "file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}],
"warnings":[{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "  %39 = load volatile i64, i64* %38, align 8, !dbg !36699", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = load %struct.page*, %struct.page** %6, align 8, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = getelementptr inbounds %struct.page, %struct.page* %11, i32 0, i32 1, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %14 = getelementptr inbounds %struct.anon.17.2442, %struct.anon.17.2442* %13, i32 0, i32 0, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %15 = bitcast i64* %14 to i8*, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i8* %15, i8** %2, align 8"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %37 = load i8*, i8** %2, align 8, !dbg !36699"}], "at_file": "./include/linux/page-flags.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "compound_head"}, "warn_no": 1},
{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "  %33 = load volatile i32, i32* %32, align 4, !dbg !36699", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = load %struct.page*, %struct.page** %6, align 8, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = getelementptr inbounds %struct.page, %struct.page* %11, i32 0, i32 1, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %14 = getelementptr inbounds %struct.anon.17.2442, %struct.anon.17.2442* %13, i32 0, i32 0, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %15 = bitcast i64* %14 to i8*, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i8* %15, i8** %2, align 8"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %31 = load i8*, i8** %2, align 8, !dbg !36699"}], "at_file": "./include/linux/page-flags.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "compound_head"}, "warn_no": 2},
{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "  %27 = load volatile i16, i16* %26, align 2, !dbg !36699", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = load %struct.page*, %struct.page** %6, align 8, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = getelementptr inbounds %struct.page, %struct.page* %11, i32 0, i32 1, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %14 = getelementptr inbounds %struct.anon.17.2442, %struct.anon.17.2442* %13, i32 0, i32 0, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %15 = bitcast i64* %14 to i8*, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i8* %15, i8** %2, align 8"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %25 = load i8*, i8** %2, align 8, !dbg !36699"}], "at_file": "./include/linux/page-flags.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "compound_head"}, "warn_no": 3},
{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "  %22 = load volatile i8, i8* %21, align 1, !dbg !36699", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = load %struct.page*, %struct.page** %6, align 8, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = getelementptr inbounds %struct.page, %struct.page* %11, i32 0, i32 1, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %14 = getelementptr inbounds %struct.anon.17.2442, %struct.anon.17.2442* %13, i32 0, i32 0, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %15 = bitcast i64* %14 to i8*, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i8* %15, i8** %2, align 8"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %21 = load i8*, i8** %2, align 8, !dbg !36699"}], "at_file": "./include/linux/page-flags.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "compound_head"}, "warn_no": 4},
{"warn_data": {"at_line": 177, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %63 = sub i64 %62, 1, !dbg !36709", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %11 = load %struct.page*, %struct.page** %6, align 8, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %12 = getelementptr inbounds %struct.page, %struct.page* %11, i32 0, i32 1, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %14 = getelementptr inbounds %struct.anon.17.2442, %struct.anon.17.2442* %13, i32 0, i32 0, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %15 = bitcast i64* %14 to i8*, !dbg !36696"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i8* %15, i8** %2, align 8"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %37 = load i8*, i8** %2, align 8, !dbg !36699"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %38 = bitcast i8* %37 to i64*, !dbg !36699"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  %39 = load volatile i64, i64* %38, align 8, !dbg !36699"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store i64 %39, i64* %41, align 8, !dbg !36699"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %51 = load i64, i64* %50, align 8, !dbg !36695"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  store i64 %51, i64* %9, align 8, !dbg !36703"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  %52 = load i64, i64* %9, align 8, !dbg !36695"}, {"instr_func": "compound_head", "instr_loc": 174, "instr_file": "./include/linux/page-flags.h", "instr": "  store i64 %52, i64* %7, align 8, !dbg !36688"}, {"instr_func": "compound_head", "instr_loc": 177, "instr_file": "./include/linux/page-flags.h", "instr": "  %62 = load i64, i64* %7, align 8, !dbg !36708"}], "at_file": "./include/linux/page-flags.h", "by": "IntegerOverflowDetector says:", "at_func": "compound_head"}, "warn_no": 5}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 258, "file": "drivers/dma-buf/udmabuf.c", "instr": "ret = udmabuf_ioctl_create(filp, arg);"}, {"lineno": 227, "file": "drivers/dma-buf/udmabuf.c", "instr": "return udmabuf_create(&head, &list);"}, {"lineno": 203, "file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"lineno": 1033, "file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @put_devmap_managed_page(%struct.page* %5) #14, !dbg !36673"}],
"warnings":[{"warn_data": {"at_line": 965, "warn_str": "Trying to read from a user pointer.", "at": "  %35 = load %struct.dev_pagemap*, %struct.dev_pagemap** %34, align 8, !dbg !36704", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 178, "instr_file": "./include/linux/page-flags.h", "instr": "  %66 = load %struct.page*, %struct.page** %6, align 8, !dbg !36712"}, {"instr_func": "compound_head", "instr_loc": 178, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %66, %struct.page** %5, align 8, !dbg !36713"}, {"instr_func": "compound_head", "instr_loc": 179, "instr_file": "./include/linux/page-flags.h", "instr": "  %68 = load %struct.page*, %struct.page** %5, align 8, !dbg !36714"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %4, %struct.page** %2, align 8, !dbg !36670"}, {"instr_func": "put_page", "instr_loc": 1033, "instr_file": "./include/linux/mm.h", "instr": "  %5 = load %struct.page*, %struct.page** %2, align 8, !dbg !36671"}, {"instr_func": "put_page", "instr_loc": 1033, "instr_file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @put_devmap_managed_page(%struct.page* %5) #14, !dbg !36673"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 960, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %31 = load %struct.page*, %struct.page** %6, align 8, !dbg !36703"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %32 = getelementptr inbounds %struct.page, %struct.page* %31, i32 0, i32 1, !dbg !36704"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %34 = getelementptr inbounds %struct.anon.21, %struct.anon.21* %33, i32 0, i32 0, !dbg !36704"}], "at_file": "./include/linux/mm.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "put_devmap_managed_page"}, "warn_no": 1},
{"warn_data": {"at_line": 965, "warn_str": "Trying to read from a user pointer.", "at": "  %37 = load i32, i32* %36, align 8, !dbg !36705", "inst_trace": [{"instr_func": "udmabuf_ioctl_create", "instr_loc": 212, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "{"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "udmabuf_create", "instr_loc": 203, "instr_file": "drivers/dma-buf/udmabuf.c", "instr": "put_page(ubuf->pages[--pgbuf]);"}, {"instr_func": "put_page", "instr_loc": 1024, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %2, align 8"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %3 = load %struct.page*, %struct.page** %2, align 8, !dbg !36668"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "compound_head", "instr_loc": 173, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "compound_head", "instr_loc": 178, "instr_file": "./include/linux/page-flags.h", "instr": "  %66 = load %struct.page*, %struct.page** %6, align 8, !dbg !36712"}, {"instr_func": "compound_head", "instr_loc": 178, "instr_file": "./include/linux/page-flags.h", "instr": "  store %struct.page* %66, %struct.page** %5, align 8, !dbg !36713"}, {"instr_func": "compound_head", "instr_loc": 179, "instr_file": "./include/linux/page-flags.h", "instr": "  %68 = load %struct.page*, %struct.page** %5, align 8, !dbg !36714"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  %4 = call %struct.page* @compound_head(%struct.page* %3) #14, !dbg !36669"}, {"instr_func": "put_page", "instr_loc": 1025, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %4, %struct.page** %2, align 8, !dbg !36670"}, {"instr_func": "put_page", "instr_loc": 1033, "instr_file": "./include/linux/mm.h", "instr": "  %5 = load %struct.page*, %struct.page** %2, align 8, !dbg !36671"}, {"instr_func": "put_page", "instr_loc": 1033, "instr_file": "./include/linux/mm.h", "instr": "  %6 = call zeroext i1 @put_devmap_managed_page(%struct.page* %5) #14, !dbg !36673"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 960, "instr_file": "./include/linux/mm.h", "instr": "  store %struct.page* %0, %struct.page** %6, align 8"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %31 = load %struct.page*, %struct.page** %6, align 8, !dbg !36703"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %32 = getelementptr inbounds %struct.page, %struct.page* %31, i32 0, i32 1, !dbg !36704"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %34 = getelementptr inbounds %struct.anon.21, %struct.anon.21* %33, i32 0, i32 0, !dbg !36704"}, {"instr_func": "put_devmap_managed_page", "instr_loc": 965, "instr_file": "./include/linux/mm.h", "instr": "  %36 = getelementptr inbounds %struct.dev_pagemap, %struct.dev_pagemap* %35, i32 0, i32 6, !dbg !36705"}], "at_file": "./include/linux/mm.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "put_devmap_managed_page"}, "warn_no": 2}]}]}