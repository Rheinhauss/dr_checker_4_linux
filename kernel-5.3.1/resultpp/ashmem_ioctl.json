{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 818, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_shrink_count(&ashmem_shrinker, &sc);"}],
"warnings":[{"warn_data": {"at_line": 486, "warn_str": "Trying to use a global variable without locking.", "at": "return lru_count;", "inst_trace": [{"instr_func": "ashmem_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "ashmem_ioctl", "instr_loc": 818, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_shrink_count(&ashmem_shrinker, &sc);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "GlobalVariableRaceDetector says:", "at_func": "ashmem_shrink_count"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 729, "warn_str": "Trying to use a global variable without locking.", "at": "range = kmem_cache_zalloc(ashmem_range_cachep, GFP_KERNEL);", "inst_trace": [{"instr_func": "ashmem_ioctl", "instr_loc": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"instr_func": "ashmem_ioctl", "instr_loc": 809, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "GlobalVariableRaceDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 1},
{"warn_data": {"at_line": 719, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedSizeDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 2},
{"warn_data": {"at_line": 742, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pin.len = PAGE_ALIGN(asma->size) - pin.offset;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 742, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pin.len = PAGE_ALIGN(asma->size) - pin.offset;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 3},
{"warn_data": {"at_line": 747, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (((__u32)-1) - pin.offset < pin.len)", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 747, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (((__u32)-1) - pin.offset < pin.len)"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 4},
{"warn_data": {"at_line": 750, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (PAGE_ALIGN(asma->size) < pin.offset + pin.len)", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 750, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (PAGE_ALIGN(asma->size) < pin.offset + pin.len)"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 5},
{"warn_data": {"at_line": 754, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 6},
{"warn_data": {"at_line": 754, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin_unpin"}, "warn_no": 7}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 764, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_get_pin_status(asma, pgstart, pgend);"}],
"warnings":[{"warn_data": {"at_line": 708, "warn_str": "Loop is bounded by a tainted value.", "at": "if (page_range_in_range(range, pgstart, pgend)) {", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 764, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_get_pin_status(asma, pgstart, pgend);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 764, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_get_pin_status(asma, pgstart, pgend);"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 701, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 708, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_in_range(range, pgstart, pgend)) {"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 708, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_in_range(range, pgstart, pgend)) {"}, {"instr_func": "page_range_in_range", "instr_loc": 127, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "page_range_in_range", "instr_loc": 129, "instr_file": "drivers/staging/android/ashmem.c", "instr": "page_range_subsumes_range(range, start, end);"}, {"instr_func": "page_range_in_range", "instr_loc": 129, "instr_file": "drivers/staging/android/ashmem.c", "instr": "page_range_subsumes_range(range, start, end);"}, {"instr_func": "page_range_subsumes_range", "instr_loc": 110, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "page_range_subsumes_range", "instr_loc": 111, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return (range->pgstart >= start) && (range->pgend <= end);"}, {"instr_func": "page_range_subsumes_range", "instr_loc": 111, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return (range->pgstart >= start) && (range->pgend <= end);"}, {"instr_func": "page_range_subsumes_range", "instr_loc": 0, "instr_file": "drivers/staging/android/ashmem.c", "instr": "  %20 = phi i1 [ false, %12 ], [ %18, %13 ], !dbg !68617"}, {"instr_func": "page_range_in_range", "instr_loc": 129, "instr_file": "drivers/staging/android/ashmem.c", "instr": "page_range_subsumes_range(range, start, end);"}, {"instr_func": "page_range_in_range", "instr_loc": 128, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return page_in_range(range, start) || page_in_range(range, end) ||"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 708, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_in_range(range, pgstart, pgend)) {"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_get_pin_status"}, "warn_no": 1},
{"warn_data": {"at_line": 706, "warn_str": "Loop is bounded by a tainted value.", "at": "if (range_before_page(range, pgstart))", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 764, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_get_pin_status(asma, pgstart, pgend);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 764, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_get_pin_status(asma, pgstart, pgend);"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 701, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 706, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 706, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "range_before_page", "instr_loc": 134, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "ashmem_get_pin_status", "instr_loc": 706, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_get_pin_status"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 761, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}],
"warnings":[{"warn_data": {"at_line": 671, "warn_str": "Loop is bounded by a tainted value.", "at": "if (range_before_page(range, pgstart))", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 671, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "ashmem_unpin", "instr_loc": 671, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "range_before_page", "instr_loc": 134, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "ashmem_unpin", "instr_loc": 671, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_unpin"}, "warn_no": 1},
{"warn_data": {"at_line": 678, "warn_str": "Loop is bounded by a tainted value.", "at": "if (page_range_subsumed_by_range(range, pgstart, pgend))", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 678, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_subsumed_by_range(range, pgstart, pgend))"}, {"instr_func": "ashmem_unpin", "instr_loc": 678, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_subsumed_by_range(range, pgstart, pgend))"}, {"instr_func": "page_range_subsumed_by_range", "instr_loc": 116, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "page_range_subsumed_by_range", "instr_loc": 117, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return (range->pgstart <= start) && (range->pgend >= end);"}, {"instr_func": "page_range_subsumed_by_range", "instr_loc": 117, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return (range->pgstart <= start) && (range->pgend >= end);"}, {"instr_func": "page_range_subsumed_by_range", "instr_loc": 0, "instr_file": "drivers/staging/android/ashmem.c", "instr": "  %20 = phi i1 [ false, %12 ], [ %18, %13 ], !dbg !68617"}, {"instr_func": "ashmem_unpin", "instr_loc": 678, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (page_range_subsumed_by_range(range, pgstart, pgend))"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_unpin"}, "warn_no": 2}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}],
"warnings":[{"warn_data": {"at_line": 638, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgstart - 1);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin"}, "warn_no": 1},
{"warn_data": {"at_line": 636, "warn_str": "Loop is bounded by a tainted value.", "at": "if (range->pgend <= pgend) {", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 636, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range->pgend <= pgend) {"}, {"instr_func": "ashmem_pin", "instr_loc": 636, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range->pgend <= pgend) {"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_pin"}, "warn_no": 2},
{"warn_data": {"at_line": 631, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "range_shrink(range, pgend + 1, range->pgend);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin"}, "warn_no": 3},
{"warn_data": {"at_line": 648, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "pgend + 1, range->pgend, new_range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 648, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend + 1, range->pgend, new_range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin"}, "warn_no": 4},
{"warn_data": {"at_line": 602, "warn_str": "Loop is bounded by a tainted value.", "at": "if (range_before_page(range, pgstart))", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 602, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "ashmem_pin", "instr_loc": 602, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}, {"instr_func": "range_before_page", "instr_loc": 134, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "range_before_page", "instr_loc": 135, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend < page;"}, {"instr_func": "ashmem_pin", "instr_loc": 602, "instr_file": "drivers/staging/android/ashmem.c", "instr": "if (range_before_page(range, pgstart))"}], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ashmem_pin"}, "warn_no": 5},
{"warn_data": {"at_line": 649, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "range_shrink(range, range->pgstart, pgstart - 1);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "ashmem_pin"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 761, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"lineno": 689, "file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"lineno": 192, "file": "drivers/staging/android/ashmem.c", "instr": "lru_add(range);"}],
"warnings":[{"warn_data": {"at_line": 150, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count += range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "lru_add", "instr_loc": 150, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count += range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "lru_add"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 761, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"lineno": 689, "file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"lineno": 192, "file": "drivers/staging/android/ashmem.c", "instr": "lru_add(range);"}, {"lineno": 150, "file": "drivers/staging/android/ashmem.c", "instr": "lru_count += range_size(range);"}],
"warnings":[{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 1},
{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 682, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = max(range->pgend, pgend);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 637, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}],
"warnings":[{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 1},
{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 637, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"lineno": 228, "file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}],
"warnings":[{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 1},
{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 631, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}],
"warnings":[{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 1},
{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 631, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"lineno": 228, "file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}],
"warnings":[{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 1},
{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "ashmem_pin", "instr_loc": 631, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, pgend + 1, range->pgend);"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_shrink", "instr_loc": 224, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgstart = start;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 647, "file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, range->purged,"}, {"lineno": 192, "file": "drivers/staging/android/ashmem.c", "instr": "lru_add(range);"}],
"warnings":[{"warn_data": {"at_line": 150, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count += range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "lru_add", "instr_loc": 150, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count += range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "lru_add"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 647, "file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, range->purged,"}, {"lineno": 192, "file": "drivers/staging/android/ashmem.c", "instr": "lru_add(range);"}, {"lineno": 150, "file": "drivers/staging/android/ashmem.c", "instr": "lru_count += range_size(range);"}],
"warnings":[{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 1},
{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 754, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgend = pgstart + (pin.len / PAGE_SIZE) - 1;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 761, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_unpin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 664, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "ashmem_unpin", "instr_loc": 689, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_alloc(asma, range, purged, pgstart, pgend, new_range);"}, {"instr_func": "range_alloc", "instr_loc": 180, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_alloc", "instr_loc": 186, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 649, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}],
"warnings":[{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 1},
{"warn_data": {"at_line": 228, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "lru_count -= pre - range_size(range);", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 649, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}, {"instr_func": "range_shrink", "instr_loc": 228, "instr_file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_shrink"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 809, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin_unpin(asma, cmd, (void __user *)arg);"}, {"lineno": 758, "file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"lineno": 649, "file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart, pgstart - 1);"}, {"lineno": 228, "file": "drivers/staging/android/ashmem.c", "instr": "lru_count -= pre - range_size(range);"}],
"warnings":[{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 1},
{"warn_data": {"at_line": 100, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return range->pgend - range->pgstart + 1;", "inst_trace": [{"instr_func": "ashmem_pin_unpin", "instr_loc": 719, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 753, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart = pin.offset / PAGE_SIZE;"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin_unpin", "instr_loc": 758, "instr_file": "drivers/staging/android/ashmem.c", "instr": "ret = ashmem_pin(asma, pgstart, pgend, &range);"}, {"instr_func": "ashmem_pin", "instr_loc": 596, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 638, "instr_file": "drivers/staging/android/ashmem.c", "instr": "pgstart - 1);"}, {"instr_func": "ashmem_pin", "instr_loc": 637, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range_shrink(range, range->pgstart,"}, {"instr_func": "range_shrink", "instr_loc": 221, "instr_file": "drivers/staging/android/ashmem.c", "instr": "{"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_shrink", "instr_loc": 225, "instr_file": "drivers/staging/android/ashmem.c", "instr": "range->pgend = end;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}, {"instr_func": "range_size", "instr_loc": 100, "instr_file": "drivers/staging/android/ashmem.c", "instr": "return range->pgend - range->pgstart + 1;"}], "at_file": "drivers/staging/android/ashmem.c", "by": "IntegerOverflowDetector says:", "at_func": "range_size"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca %struct.file*, align 8"}, {"lineno": 786, "file": "drivers/staging/android/ashmem.c", "instr": "ret = get_name(asma, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 577, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "mutex_unlock(&ashmem_mutex);", "inst_trace": [], "at_file": "drivers/staging/android/ashmem.c", "by": "TaintedSizeDetector says:", "at_func": "get_name"}, "warn_no": 1}]}]}