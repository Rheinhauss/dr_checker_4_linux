{"all_contexts":[
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2239, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insn_ioctl(dev, (struct comedi_insn __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 1627, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&insn, arg, sizeof(insn)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insn_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1645, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insn_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1656, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(insn.data,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insn_ioctl"}, "warn_no": 3}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2234, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 1534, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&insnlist, arg, sizeof(insnlist)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1543, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(insns, insnlist.insns,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1552, "warn_str": "Loop is bounded by a tainted value.", "at": "if (insns[i].n > MAX_SAMPLES) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1552, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (insns[i].n > MAX_SAMPLES) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1552, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (insns[i].n > MAX_SAMPLES) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1551, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insnlist.n_insns; ++i) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1534, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insnlist, arg, sizeof(insnlist)))"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1551, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insnlist.n_insns; ++i) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1551, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insnlist.n_insns; ++i) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1569, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insnlist.n_insns; ++i) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1534, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insnlist, arg, sizeof(insnlist)))"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1569, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insnlist.n_insns; ++i) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1569, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insnlist.n_insns; ++i) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1583, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_to_user(insns[i].data, data,", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1584, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1584, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1583, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1583, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1583, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_to_user(insns[i].data, data,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1571, "warn_str": "Loop is bounded by a tainted value.", "at": "if (copy_from_user(data, insns[i].data,", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1572, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1572, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "insns[i].n * sizeof(unsigned int))) {"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1571, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1571, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}, {"instr_func": "do_insnlist_ioctl", "instr_loc": 1571, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(data, insns[i].data,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1583, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(insns[i].data, data,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1571, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(data, insns[i].data,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_insnlist_ioctl"}, "warn_no": 9}]},
{"num_warnings": 25,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2239, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insn_ioctl(dev, (struct comedi_insn __user *)arg,"}, {"lineno": 1652, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, &insn, data, file);"}],
"warnings":[{"warn_data": {"at_line": 1412, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 1},
{"warn_data": {"at_line": 1404, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1404, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "parse_insn", "instr_loc": 1404, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 2},
{"warn_data": {"at_line": 1412, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 3},
{"warn_data": {"at_line": 1430, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = parse_insn;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1430, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}, {"instr_func": "parse_insn", "instr_loc": 1430, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 4},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1425, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "parse_insn", "instr_loc": 1425, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 5},
{"warn_data": {"at_line": 1491, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_config(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1491, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1491, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 6},
{"warn_data": {"at_line": 1473, "warn_str": "Trying to read from a user pointer.", "at": "if (s->n_chan <= 32) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1473, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}, {"instr_func": "parse_insn", "instr_loc": 1473, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 7},
{"warn_data": {"at_line": 1481, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_bits(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1481, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1481, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 8},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "maxdata = s->maxdata_list", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 9},
{"warn_data": {"at_line": 1443, "warn_str": "Trying to read from a user pointer.", "at": ": s->maxdata;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": ": s->maxdata;"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": ": s->maxdata;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 10},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 11},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 12},
{"warn_data": {"at_line": 1445, "warn_str": "Loop is bounded by a tainted value.", "at": "if (data[i] > maxdata) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1645, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(data,"}, {"instr_func": "parse_insn", "instr_loc": 1445, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}, {"instr_func": "parse_insn", "instr_loc": 1445, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 13},
{"warn_data": {"at_line": 1444, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insn->n; ++i) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 14},
{"warn_data": {"at_line": 1453, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_write(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1453, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1453, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 15},
{"warn_data": {"at_line": 1455, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1455, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1455, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 16},
{"warn_data": {"at_line": 1433, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_read(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1433, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1433, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 17},
{"warn_data": {"at_line": 1435, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1435, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1435, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 18},
{"warn_data": {"at_line": 1498, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1498, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "parse_insn", "instr_loc": 1498, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 19},
{"warn_data": {"at_line": 1360, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 20},
{"warn_data": {"at_line": 1379, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data[1] = (insn->n - 2) / 2;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1379, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "data[1] = (insn->n - 2) / 2;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "parse_insn"}, "warn_no": 21},
{"warn_data": {"at_line": 1355, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1355, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async) {"}, {"instr_func": "parse_insn", "instr_loc": 1355, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 22},
{"warn_data": {"at_line": 1365, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 23},
{"warn_data": {"at_line": 1360, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 24},
{"warn_data": {"at_line": 1365, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 25}]},
{"num_warnings": 13,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2239, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insn_ioctl(dev, (struct comedi_insn __user *)arg,"}, {"lineno": 1652, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, &insn, data, file);"}, {"lineno": 1418, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}],
"warnings":[{"warn_data": {"at_line": 111, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_device *dev = s->device;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 1},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 2},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 3},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 4},
{"warn_data": {"at_line": 120, "warn_str": "Trying to read from a user pointer.", "at": "else if (s->range_table_list && chan < s->n_chan)", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 5},
{"warn_data": {"at_line": 120, "warn_str": "Trying to read from a user pointer.", "at": "else if (s->range_table_list && chan < s->n_chan)", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 6},
{"warn_data": {"at_line": 124, "warn_str": "Loop is bounded by a tainted value.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 125, "instr_file": "drivers/staging/comedi/range.c", "instr": "CR_RANGE(chanspec) >= range_len) {"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 125, "instr_file": "drivers/staging/comedi/range.c", "instr": "CR_RANGE(chanspec) >= range_len) {"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_check_chanlist"}, "warn_no": 7},
{"warn_data": {"at_line": 124, "warn_str": "Trying to read from a user pointer.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 8},
{"warn_data": {"at_line": 124, "warn_str": "Loop is bounded by a tainted value.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_check_chanlist"}, "warn_no": 9},
{"warn_data": {"at_line": 119, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table->length;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 10},
{"warn_data": {"at_line": 119, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table->length;", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 11},
{"warn_data": {"at_line": 118, "warn_str": "Trying to read from a user pointer.", "at": "if (s->range_table)", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 118, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 118, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 12},
{"warn_data": {"at_line": 126, "warn_str": "Trying to read from a user pointer.", "at": "dev_warn(dev->class_dev,", "inst_trace": [{"instr_func": "do_insn_ioctl", "instr_loc": 1627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&insn, arg, sizeof(insn)))"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 126, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_warn(dev->class_dev,"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 126, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_warn(dev->class_dev,"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 13}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2230, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_cmdtest_ioctl(dev, (struct comedi_cmd __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 1907, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = s->do_cmdtest(dev, s, &cmd);", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_cmdtest_ioctl"}, "warn_no": 1}]},
{"num_warnings": 25,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2234, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev,"}, {"lineno": 1579, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, insns + i, data, file);"}],
"warnings":[{"warn_data": {"at_line": 1404, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1404, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "parse_insn", "instr_loc": 1404, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 1},
{"warn_data": {"at_line": 1412, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 2},
{"warn_data": {"at_line": 1412, "warn_str": "Trying to read from a user pointer.", "at": "if (s->lock && s->lock != file) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}, {"instr_func": "parse_insn", "instr_loc": 1412, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->lock && s->lock != file) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 3},
{"warn_data": {"at_line": 1430, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = parse_insn;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1430, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}, {"instr_func": "parse_insn", "instr_loc": 1430, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = parse_insn;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 4},
{"warn_data": {"at_line": 1425, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1425, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "parse_insn", "instr_loc": 1425, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 5},
{"warn_data": {"at_line": 1491, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_config(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1491, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1491, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_config(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 6},
{"warn_data": {"at_line": 1473, "warn_str": "Trying to read from a user pointer.", "at": "if (s->n_chan <= 32) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1473, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}, {"instr_func": "parse_insn", "instr_loc": 1473, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->n_chan <= 32) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 7},
{"warn_data": {"at_line": 1481, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_bits(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1481, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1481, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_bits(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 8},
{"warn_data": {"at_line": 1441, "warn_str": "Trying to read from a user pointer.", "at": "maxdata = s->maxdata_list", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 9},
{"warn_data": {"at_line": 1443, "warn_str": "Trying to read from a user pointer.", "at": ": s->maxdata;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": ": s->maxdata;"}, {"instr_func": "parse_insn", "instr_loc": 1443, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": ": s->maxdata;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 10},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 11},
{"warn_data": {"at_line": 1442, "warn_str": "Trying to read from a user pointer.", "at": "? s->maxdata_list[CR_CHAN(insn->chanspec)]", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 12},
{"warn_data": {"at_line": 1445, "warn_str": "Loop is bounded by a tainted value.", "at": "if (data[i] > maxdata) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1442, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "? s->maxdata_list[CR_CHAN(insn->chanspec)]"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1441, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "maxdata = s->maxdata_list"}, {"instr_func": "parse_insn", "instr_loc": 1445, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}, {"instr_func": "parse_insn", "instr_loc": 1445, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (data[i] > maxdata) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 13},
{"warn_data": {"at_line": 1444, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < insn->n; ++i) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}, {"instr_func": "parse_insn", "instr_loc": 1444, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < insn->n; ++i) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "parse_insn"}, "warn_no": 14},
{"warn_data": {"at_line": 1453, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_write(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1453, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1453, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_write(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 15},
{"warn_data": {"at_line": 1455, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1455, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1455, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 16},
{"warn_data": {"at_line": 1433, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->insn_read(dev, s, insn, data);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1433, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}, {"instr_func": "parse_insn", "instr_loc": 1433, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->insn_read(dev, s, insn, data);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 17},
{"warn_data": {"at_line": 1435, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1435, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "parse_insn", "instr_loc": 1435, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 18},
{"warn_data": {"at_line": 1498, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1498, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "parse_insn", "instr_loc": 1498, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 19},
{"warn_data": {"at_line": 1360, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 20},
{"warn_data": {"at_line": 1379, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "data[1] = (insn->n - 2) / 2;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1379, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "data[1] = (insn->n - 2) / 2;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "parse_insn"}, "warn_no": 21},
{"warn_data": {"at_line": 1355, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1355, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async) {"}, {"instr_func": "parse_insn", "instr_loc": 1355, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 22},
{"warn_data": {"at_line": 1365, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 23},
{"warn_data": {"at_line": 1360, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->async->inttrig) {", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}, {"instr_func": "parse_insn", "instr_loc": 1360, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->async->inttrig) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 24},
{"warn_data": {"at_line": 1365, "warn_str": "Trying to read from a user pointer.", "at": "ret = s->async->inttrig(dev, s, data[0]);", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}, {"instr_func": "parse_insn", "instr_loc": 1365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = s->async->inttrig(dev, s, data[0]);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "parse_insn"}, "warn_no": 25}]},
{"num_warnings": 13,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2234, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_insnlist_ioctl(dev,"}, {"lineno": 1579, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = parse_insn(dev, insns + i, data, file);"}, {"lineno": 1418, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}],
"warnings":[{"warn_data": {"at_line": 111, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_device *dev = s->device;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 1},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 2},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 3},
{"warn_data": {"at_line": 121, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table_list[chan]->length;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 4},
{"warn_data": {"at_line": 120, "warn_str": "Trying to read from a user pointer.", "at": "else if (s->range_table_list && chan < s->n_chan)", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 5},
{"warn_data": {"at_line": 120, "warn_str": "Trying to read from a user pointer.", "at": "else if (s->range_table_list && chan < s->n_chan)", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 120, "instr_file": "drivers/staging/comedi/range.c", "instr": "else if (s->range_table_list && chan < s->n_chan)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 6},
{"warn_data": {"at_line": 124, "warn_str": "Loop is bounded by a tainted value.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 121, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table_list[chan]->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 125, "instr_file": "drivers/staging/comedi/range.c", "instr": "CR_RANGE(chanspec) >= range_len) {"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 125, "instr_file": "drivers/staging/comedi/range.c", "instr": "CR_RANGE(chanspec) >= range_len) {"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_check_chanlist"}, "warn_no": 7},
{"warn_data": {"at_line": 124, "warn_str": "Trying to read from a user pointer.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 8},
{"warn_data": {"at_line": 124, "warn_str": "Loop is bounded by a tainted value.", "at": "if (chan >= s->n_chan ||", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 124, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan ||"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_check_chanlist"}, "warn_no": 9},
{"warn_data": {"at_line": 119, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table->length;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 10},
{"warn_data": {"at_line": 119, "warn_str": "Trying to read from a user pointer.", "at": "range_len = s->range_table->length;", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 119, "instr_file": "drivers/staging/comedi/range.c", "instr": "range_len = s->range_table->length;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 11},
{"warn_data": {"at_line": 118, "warn_str": "Trying to read from a user pointer.", "at": "if (s->range_table)", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 118, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table)"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 118, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 12},
{"warn_data": {"at_line": 126, "warn_str": "Trying to read from a user pointer.", "at": "dev_warn(dev->class_dev,", "inst_trace": [{"instr_func": "do_insnlist_ioctl", "instr_loc": 1543, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(insns, insnlist.insns,"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1402, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[insn->subdev];"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "parse_insn", "instr_loc": 1418, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = comedi_check_chanlist(s, 1, &insn->chanspec);"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 110, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 111, "instr_file": "drivers/staging/comedi/range.c", "instr": "struct comedi_device *dev = s->device;"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 126, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_warn(dev->class_dev,"}, {"instr_func": "comedi_check_chanlist", "instr_loc": 126, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_warn(dev->class_dev,"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_check_chanlist"}, "warn_no": 13}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2227, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, (struct comedi_cmd __user *)arg, file);"}],
"warnings":[{"warn_data": {"at_line": 1822, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "cmd = async->cmd;", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_cmd_ioctl"}, "warn_no": 1}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2230, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_cmdtest_ioctl(dev, (struct comedi_cmd __user *)arg,"}, {"lineno": 1890, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_cmd(dev, arg, &cmd);"}],
"warnings":[{"warn_data": {"at_line": 1678, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 1690, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1690, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1690, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 5},
{"warn_data": {"at_line": 1704, "warn_str": "Trying to read from a user pointer.", "at": "if (cmd->chanlist_len > s->len_chanlist) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1704, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1704, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 6},
{"warn_data": {"at_line": 1714, "warn_str": "Trying to read from a user pointer.", "at": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1714, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1714, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 7},
{"warn_data": {"at_line": 1705, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\",", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1705, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1705, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 8}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2227, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_cmd_ioctl(dev, (struct comedi_cmd __user *)arg, file);"}, {"lineno": 1781, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "ret = __comedi_get_user_cmd(dev, arg, &cmd);"}],
"warnings":[{"warn_data": {"at_line": 1678, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 1},
{"warn_data": {"at_line": 1690, "warn_str": "Trying to read from a user pointer.", "at": "if (s->type == COMEDI_SUBD_UNUSED) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1690, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1690, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->type == COMEDI_SUBD_UNUSED) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 2},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 3},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 4},
{"warn_data": {"at_line": 1696, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1696, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->do_cmd || !s->do_cmdtest || !s->async) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 5},
{"warn_data": {"at_line": 1704, "warn_str": "Trying to read from a user pointer.", "at": "if (cmd->chanlist_len > s->len_chanlist) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1704, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1704, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (cmd->chanlist_len > s->len_chanlist) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 6},
{"warn_data": {"at_line": 1714, "warn_str": "Trying to read from a user pointer.", "at": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1714, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1714, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "switch (s->subdev_flags & (SDF_CMD_READ | SDF_CMD_WRITE)) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 7},
{"warn_data": {"at_line": 1705, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\",", "inst_trace": [{"instr_func": "__comedi_get_user_cmd", "instr_loc": 1678, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(cmd, arg, sizeof(*cmd))) {"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1688, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[cmd->subdev];"}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1705, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}, {"instr_func": "__comedi_get_user_cmd", "instr_loc": 1705, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"channel/gain list too long %d > %d\\n\","}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_user_cmd"}, "warn_no": 8}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 1116, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&bi, arg, sizeof(bi)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1124, "warn_str": "Trying to read from a user pointer.", "at": "async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1126, "warn_str": "Trying to read from a user pointer.", "at": "if (!async || s->busy != file)", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1126, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!async || s->busy != file)"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1126, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!async || s->busy != file)"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1130, "warn_str": "Trying to read from a user pointer.", "at": "if (!(async->cmd.flags & CMDF_WRITE)) {", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1130, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1130, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1130, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!(async->cmd.flags & CMDF_WRITE)) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1165, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_write_count = async->buf_write_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1165, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_write_count = async->buf_write_count;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1165, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_write_count = async->buf_write_count;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1166, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_write_ptr = async->buf_write_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1166, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_write_ptr = async->buf_write_ptr;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1166, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_write_ptr = async->buf_write_ptr;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1167, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_read_count = async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1167, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_read_count = async->buf_read_count;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1167, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_read_count = async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1168, "warn_str": "Trying to read from a user pointer.", "at": "bi.buf_read_ptr = async->buf_read_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1124, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1168, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_read_ptr = async->buf_read_ptr;"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1168, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.buf_read_ptr = async->buf_read_ptr;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1176, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &bi, sizeof(bi)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufinfo_ioctl"}, "warn_no": 9}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2210, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_rangeinfo_ioctl(dev, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 50, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedSizeDetector says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 66, "warn_str": "Trying to read from a user pointer.", "at": "if (s->range_table) {", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 66, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table) {"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 66, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (s->range_table) {"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 68, "warn_str": "Trying to read from a user pointer.", "at": "} else if (s->range_table_list) {", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 68, "instr_file": "drivers/staging/comedi/range.c", "instr": "} else if (s->range_table_list) {"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 68, "instr_file": "drivers/staging/comedi/range.c", "instr": "} else if (s->range_table_list) {"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "if (chan >= s->n_chan)", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 69, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan)"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 69, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (chan >= s->n_chan)"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 71, "warn_str": "Trying to read from a user pointer.", "at": "lr = s->range_table_list[chan];", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 71, "warn_str": "Trying to read from a user pointer.", "at": "lr = s->range_table_list[chan];", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 67, "warn_str": "Trying to read from a user pointer.", "at": "lr = s->range_table;", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 67, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 67, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table;"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 76, "warn_str": "Trying to read from a user pointer.", "at": "if (RANGE_LENGTH(it.range_type) != lr->length) {", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 76, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (RANGE_LENGTH(it.range_type) != lr->length) {"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 76, "instr_file": "drivers/staging/comedi/range.c", "instr": "if (RANGE_LENGTH(it.range_type) != lr->length) {"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 85, "warn_str": "Trying to read from a user pointer.", "at": "sizeof(struct comedi_krange) * lr->length))", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 85, "instr_file": "drivers/staging/comedi/range.c", "instr": "sizeof(struct comedi_krange) * lr->length))"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 85, "instr_file": "drivers/staging/comedi/range.c", "instr": "sizeof(struct comedi_krange) * lr->length))"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 77, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev,", "inst_trace": [{"instr_func": "do_rangeinfo_ioctl", "instr_loc": 50, "instr_file": "drivers/staging/comedi/range.c", "instr": "{"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 58, "instr_file": "drivers/staging/comedi/range.c", "instr": "subd = (it.range_type >> 24) & 0xf;"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 65, "instr_file": "drivers/staging/comedi/range.c", "instr": "s = &dev->subdevices[subd];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 71, "instr_file": "drivers/staging/comedi/range.c", "instr": "lr = s->range_table_list[chan];"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 77, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_dbg(dev->class_dev,"}, {"instr_func": "do_rangeinfo_ioctl", "instr_loc": 77, "instr_file": "drivers/staging/comedi/range.c", "instr": "dev_dbg(dev->class_dev,"}], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 84, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(it.range_ptr, lr->range,", "inst_trace": [], "at_file": "drivers/staging/comedi/range.c", "by": "TaintedSizeDetector says:", "at_func": "do_rangeinfo_ioctl"}, "warn_no": 11}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1129, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"lineno": 647, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}],
"warnings":[{"warn_data": {"at_line": 638, "warn_str": "Trying to read from a user pointer.", "at": "return s->runflags;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1129, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1129, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = comedi_get_subdevice_runflags(s);"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 642, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 647, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}, {"instr_func": "comedi_get_subdevice_runflags", "instr_loc": 647, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "runflags = __comedi_get_subdevice_runflags(s);"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 637, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 638, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "return s->runflags;"}, {"instr_func": "__comedi_get_subdevice_runflags", "instr_loc": 638, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "return s->runflags;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_get_subdevice_runflags"}, "warn_no": 1}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1133, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}],
"warnings":[{"warn_data": {"at_line": 498, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 501, "warn_str": "Trying to read from a user pointer.", "at": "available = async->munge_count - async->buf_read_alloc_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 2},
{"warn_data": {"at_line": 501, "warn_str": "Trying to read from a user pointer.", "at": "available = async->munge_count - async->buf_read_alloc_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 3},
{"warn_data": {"at_line": 501, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "available = async->munge_count - async->buf_read_alloc_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 501, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "available = async->munge_count - async->buf_read_alloc_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 4},
{"warn_data": {"at_line": 505, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_read_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 505, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count += nbytes;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 505, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 5},
{"warn_data": {"at_line": 505, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_read_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 505, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 6},
{"warn_data": {"at_line": 505, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1133, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_read_alloc(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 497, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 498, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 505, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count += nbytes;"}, {"instr_func": "comedi_buf_read_alloc", "instr_loc": 505, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_alloc"}, "warn_no": 7}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1141, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}],
"warnings":[{"warn_data": {"at_line": 462, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 461, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_n_available"}, "warn_no": 1},
{"warn_data": {"at_line": 468, "warn_str": "Trying to read from a user pointer.", "at": "num_bytes = async->munge_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 461, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_n_available"}, "warn_no": 2},
{"warn_data": {"at_line": 468, "warn_str": "Trying to read from a user pointer.", "at": "num_bytes = async->munge_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 461, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_n_available"}, "warn_no": 3},
{"warn_data": {"at_line": 468, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num_bytes = async->munge_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1141, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_read_n_available(s) == 0 &&"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 461, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 462, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_available", "instr_loc": 468, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes = async->munge_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_n_available"}, "warn_no": 4}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1134, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}],
"warnings":[{"warn_data": {"at_line": 538, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 1},
{"warn_data": {"at_line": 551, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_read_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 551, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_free"}, "warn_no": 2},
{"warn_data": {"at_line": 551, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_read_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 551, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count += nbytes;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 551, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 3},
{"warn_data": {"at_line": 551, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 551, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count += nbytes;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 551, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 4},
{"warn_data": {"at_line": 552, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_read_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 552, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr += nbytes;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 552, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 5},
{"warn_data": {"at_line": 552, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_read_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 552, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_free"}, "warn_no": 6},
{"warn_data": {"at_line": 552, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 552, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr += nbytes;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 552, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 7},
{"warn_data": {"at_line": 553, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_read_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 8},
{"warn_data": {"at_line": 553, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_read_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 9},
{"warn_data": {"at_line": 553, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 553, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_free"}, "warn_no": 10}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1134, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"lineno": 547, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}],
"warnings":[{"warn_data": {"at_line": 519, "warn_str": "Trying to read from a user pointer.", "at": "return async->buf_read_alloc_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 518, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_n_allocated"}, "warn_no": 1},
{"warn_data": {"at_line": 519, "warn_str": "Trying to read from a user pointer.", "at": "return async->buf_read_alloc_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 518, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_read_n_allocated"}, "warn_no": 2},
{"warn_data": {"at_line": 519, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return async->buf_read_alloc_count - async->buf_read_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1134, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bi.bytes_read = comedi_buf_read_free(s, bi.bytes_read);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 537, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 538, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_free", "instr_loc": 547, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "allocated = comedi_buf_read_n_allocated(async);"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 518, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}, {"instr_func": "comedi_buf_read_n_allocated", "instr_loc": 519, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_read_alloc_count - async->buf_read_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_read_n_allocated"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1158, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}],
"warnings":[{"warn_data": {"at_line": 343, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 349, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_write_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 349, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_alloc"}, "warn_no": 2},
{"warn_data": {"at_line": 349, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_write_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 349, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count += nbytes;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 349, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_alloc"}, "warn_no": 3},
{"warn_data": {"at_line": 349, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_alloc_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 343, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 349, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count += nbytes;"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 349, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_alloc"}, "warn_no": 4}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1158, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"lineno": 344, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}],
"warnings":[{"warn_data": {"at_line": 315, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 1},
{"warn_data": {"at_line": 316, "warn_str": "Trying to read from a user pointer.", "at": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 2},
{"warn_data": {"at_line": 316, "warn_str": "Trying to read from a user pointer.", "at": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 3},
{"warn_data": {"at_line": 316, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 4},
{"warn_data": {"at_line": 318, "warn_str": "Trying to read from a user pointer.", "at": "return free_end - async->buf_write_alloc_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 318, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return free_end - async->buf_write_alloc_count;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 318, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return free_end - async->buf_write_alloc_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 5},
{"warn_data": {"at_line": 318, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return free_end - async->buf_write_alloc_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1158, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_alloc(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 342, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_alloc", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int unalloc = comedi_buf_write_n_unalloc(s);"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 314, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 315, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 316, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int free_end = async->buf_read_count + async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_n_unalloc", "instr_loc": 318, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return free_end - async->buf_write_alloc_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_n_unalloc"}, "warn_no": 6}]},
{"num_warnings": 15,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1160, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}],
"warnings":[{"warn_data": {"at_line": 433, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 1},
{"warn_data": {"at_line": 439, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_write_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_free"}, "warn_no": 2},
{"warn_data": {"at_line": 439, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_write_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 3},
{"warn_data": {"at_line": 439, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_count += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 4},
{"warn_data": {"at_line": 440, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_write_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 440, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 440, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 5},
{"warn_data": {"at_line": 440, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->buf_write_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 440, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_free"}, "warn_no": 6},
{"warn_data": {"at_line": 440, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_ptr += nbytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 440, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 440, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr += nbytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 7},
{"warn_data": {"at_line": 441, "warn_str": "Trying to read from a user pointer.", "at": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 8},
{"warn_data": {"at_line": 441, "warn_str": "Trying to read from a user pointer.", "at": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 9},
{"warn_data": {"at_line": 441, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_free"}, "warn_no": 10},
{"warn_data": {"at_line": 442, "warn_str": "Trying to read from a user pointer.", "at": "if (async->buf_write_ptr >= async->prealloc_bufsz)", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 442, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->buf_write_ptr >= async->prealloc_bufsz)"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 442, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->buf_write_ptr >= async->prealloc_bufsz)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 11},
{"warn_data": {"at_line": 442, "warn_str": "Trying to read from a user pointer.", "at": "if (async->buf_write_ptr >= async->prealloc_bufsz)", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 442, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->buf_write_ptr >= async->prealloc_bufsz)"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 442, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->buf_write_ptr >= async->prealloc_bufsz)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 12},
{"warn_data": {"at_line": 443, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_write_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 13},
{"warn_data": {"at_line": 443, "warn_str": "Trying to read from a user pointer.", "at": "async->buf_write_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 14},
{"warn_data": {"at_line": 443, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 443, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_free"}, "warn_no": 15}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1160, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"lineno": 434, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}],
"warnings":[{"warn_data": {"at_line": 410, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 409, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_allocated"}, "warn_no": 1},
{"warn_data": {"at_line": 412, "warn_str": "Trying to read from a user pointer.", "at": "return async->buf_write_alloc_count - async->buf_write_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 409, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_allocated"}, "warn_no": 2},
{"warn_data": {"at_line": 412, "warn_str": "Trying to read from a user pointer.", "at": "return async->buf_write_alloc_count - async->buf_write_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 409, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_write_n_allocated"}, "warn_no": 3},
{"warn_data": {"at_line": 412, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return async->buf_write_alloc_count - async->buf_write_count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 434, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int allocated = comedi_buf_write_n_allocated(s);"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 409, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 410, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}, {"instr_func": "comedi_buf_write_n_allocated", "instr_loc": 412, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "return async->buf_write_alloc_count - async->buf_write_count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_write_n_allocated"}, "warn_no": 4}]},
{"num_warnings": 33,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1160, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"lineno": 441, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}],
"warnings":[{"warn_data": {"at_line": 368, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 1},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 372, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {"}, {"instr_func": "comedi_buf_munge", "instr_loc": 372, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 2},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 372, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {"}, {"instr_func": "comedi_buf_munge", "instr_loc": 372, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {"}, {"instr_func": "comedi_buf_munge", "instr_loc": 372, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!s->munge || (async->cmd.flags & CMDF_RAWDATA)) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 3},
{"warn_data": {"at_line": 377, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "num_bytes -= num_bytes % num_sample_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 377, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes -= num_bytes % num_sample_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 4},
{"warn_data": {"at_line": 386, "warn_str": "Trying to read from a user pointer.", "at": "s->munge(s->device, s,", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 386, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "s->munge(s->device, s,"}, {"instr_func": "comedi_buf_munge", "instr_loc": 386, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "s->munge(s->device, s,"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 5},
{"warn_data": {"at_line": 386, "warn_str": "Trying to read from a user pointer.", "at": "s->munge(s->device, s,", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 386, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "s->munge(s->device, s,"}, {"instr_func": "comedi_buf_munge", "instr_loc": 386, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "s->munge(s->device, s,"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 6},
{"warn_data": {"at_line": 387, "warn_str": "Trying to read from a user pointer.", "at": "async->prealloc_buf + async->munge_ptr,", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 387, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf + async->munge_ptr,"}, {"instr_func": "comedi_buf_munge", "instr_loc": 387, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf + async->munge_ptr,"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 7},
{"warn_data": {"at_line": 387, "warn_str": "Trying to read from a user pointer.", "at": "async->prealloc_buf + async->munge_ptr,", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 387, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf + async->munge_ptr,"}, {"instr_func": "comedi_buf_munge", "instr_loc": 387, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf + async->munge_ptr,"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 8},
{"warn_data": {"at_line": 388, "warn_str": "Trying to read from a user pointer.", "at": "block_size, async->munge_chan);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 388, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "block_size, async->munge_chan);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 388, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "block_size, async->munge_chan);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 9},
{"warn_data": {"at_line": 396, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_chan += block_size / num_sample_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 10},
{"warn_data": {"at_line": 396, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->munge_chan += block_size / num_sample_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 11},
{"warn_data": {"at_line": 396, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_chan += block_size / num_sample_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 396, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan += block_size / num_sample_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 12},
{"warn_data": {"at_line": 397, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_chan %= async->cmd.chanlist_len;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 13},
{"warn_data": {"at_line": 397, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_chan %= async->cmd.chanlist_len;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 14},
{"warn_data": {"at_line": 397, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_chan %= async->cmd.chanlist_len;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 397, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan %= async->cmd.chanlist_len;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 15},
{"warn_data": {"at_line": 398, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_count += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 16},
{"warn_data": {"at_line": 398, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->munge_count += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 17},
{"warn_data": {"at_line": 398, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_count += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 398, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 18},
{"warn_data": {"at_line": 399, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_ptr += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 19},
{"warn_data": {"at_line": 399, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->munge_ptr += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 20},
{"warn_data": {"at_line": 399, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_ptr += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 399, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 21},
{"warn_data": {"at_line": 400, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 22},
{"warn_data": {"at_line": 400, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 23},
{"warn_data": {"at_line": 400, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_ptr %= async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 400, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr %= async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 24},
{"warn_data": {"at_line": 379, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "int block_size = num_bytes - count;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 379, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "int block_size = num_bytes - count;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 25},
{"warn_data": {"at_line": 382, "warn_str": "Trying to read from a user pointer.", "at": "buf_end = async->prealloc_bufsz - async->munge_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 26},
{"warn_data": {"at_line": 382, "warn_str": "Trying to read from a user pointer.", "at": "buf_end = async->prealloc_bufsz - async->munge_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 27},
{"warn_data": {"at_line": 382, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "buf_end = async->prealloc_bufsz - async->munge_ptr;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 382, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "buf_end = async->prealloc_bufsz - async->munge_ptr;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 28},
{"warn_data": {"at_line": 378, "warn_str": "Loop is bounded by a tainted value.", "at": "while (count < num_bytes) {", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 378, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "while (count < num_bytes) {"}, {"instr_func": "comedi_buf_munge", "instr_loc": 378, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "while (count < num_bytes) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 29},
{"warn_data": {"at_line": 401, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count += block_size;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 377, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes -= num_bytes % num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 377, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes -= num_bytes % num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 377, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes -= num_bytes % num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 377, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "num_bytes -= num_bytes % num_sample_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 379, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "int block_size = num_bytes - count;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 379, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "int block_size = num_bytes - count;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 379, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "int block_size = num_bytes - count;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 401, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "count += block_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 30},
{"warn_data": {"at_line": 373, "warn_str": "Trying to read from a user pointer.", "at": "async->munge_count += num_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 373, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += num_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 373, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += num_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 31},
{"warn_data": {"at_line": 373, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "async->munge_count += num_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 433, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 439, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count += nbytes;"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 373, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += num_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_munge"}, "warn_no": 32},
{"warn_data": {"at_line": 373, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_count += num_bytes;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 368, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 373, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += num_bytes;"}, {"instr_func": "comedi_buf_munge", "instr_loc": 373, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count += num_bytes;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_munge"}, "warn_no": 33}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1160, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"lineno": 441, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"lineno": 370, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "const unsigned int num_sample_bytes = comedi_bytes_per_sample(s);"}],
"warnings":[{"warn_data": {"at_line": 799, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i32, i32* %4, align 4, !dbg !608105", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1160, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_write_free(s, bi.bytes_written);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 432, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_write_free", "instr_loc": 441, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "comedi_buf_munge(s, async->buf_write_count - async->munge_count);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 367, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_munge", "instr_loc": 370, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "const unsigned int num_sample_bytes = comedi_bytes_per_sample(s);"}, {"instr_func": "comedi_buf_munge", "instr_loc": 370, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "const unsigned int num_sample_bytes = comedi_bytes_per_sample(s);"}, {"instr_func": "comedi_bytes_per_sample.805", "instr_loc": 798, "instr_file": "drivers/staging/comedi/comedidev.h", "instr": "  store %struct.comedi_subdevice* %0, %struct.comedi_subdevice** %2, align 8"}, {"instr_func": "comedi_bytes_per_sample.805", "instr_loc": 799, "instr_file": "drivers/staging/comedi/comedidev.h", "instr": "  %3 = load %struct.comedi_subdevice*, %struct.comedi_subdevice** %2, align 8, !dbg !608104"}, {"instr_func": "comedi_bytes_per_sample.805", "instr_loc": 799, "instr_file": "drivers/staging/comedi/comedidev.h", "instr": "  %4 = getelementptr inbounds %struct.comedi_subdevice, %struct.comedi_subdevice* %3, i32 0, i32 4, !dbg !608105"}], "at_file": "drivers/staging/comedi/comedidev.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_bytes_per_sample.805"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1171, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}],
"warnings":[{"warn_data": {"at_line": 732, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 1},
{"warn_data": {"at_line": 746, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 746, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 746, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 2},
{"warn_data": {"at_line": 739, "warn_str": "Trying to read from a user pointer.", "at": "kfree(async->cmd.chanlist);", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 739, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 739, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 739, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "kfree(async->cmd.chanlist);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 3},
{"warn_data": {"at_line": 738, "warn_str": "Trying to write to a user pointer.", "at": "async->inttrig = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 738, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 738, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->inttrig = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 4},
{"warn_data": {"at_line": 740, "warn_str": "Trying to write to a user pointer.", "at": "async->cmd.chanlist = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 732, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 740, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->cmd.chanlist = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 5},
{"warn_data": {"at_line": 741, "warn_str": "Trying to write to a user pointer.", "at": "s->busy = NULL;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}, {"instr_func": "do_become_nonbusy", "instr_loc": 741, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->busy = NULL;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_become_nonbusy"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1171, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 735, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 631, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}],
"warnings":[{"warn_data": {"at_line": 615, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 631, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 631, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 614, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 615, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 615, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 615, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags &= ~bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 631, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 631, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_clear_subdevice_runflags(s, mask);"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 614, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 615, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}, {"instr_func": "__comedi_clear_subdevice_runflags", "instr_loc": 615, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags &= ~bits;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_clear_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1171, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 735, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"lineno": 632, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}],
"warnings":[{"warn_data": {"at_line": 621, "warn_str": "Trying to read from a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 632, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 632, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 620, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 621, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 621, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 1},
{"warn_data": {"at_line": 621, "warn_str": "Trying to write to a user pointer.", "at": "s->runflags |= bits;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 735, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_update_subdevice_runflags(s, COMEDI_SRF_RUNNING, 0);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 627, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 632, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "comedi_update_subdevice_runflags", "instr_loc": 632, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "__comedi_set_subdevice_runflags(s, bits & mask);"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 620, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 621, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}, {"instr_func": "__comedi_set_subdevice_runflags", "instr_loc": 621, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->runflags |= bits;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_set_subdevice_runflags"}, "warn_no": 2}]},
{"num_warnings": 14,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2213, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufinfo_ioctl(dev,"}, {"lineno": 1171, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"lineno": 737, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}],
"warnings":[{"warn_data": {"at_line": 293, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 1},
{"warn_data": {"at_line": 295, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_alloc_count = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 295, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 295, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_alloc_count = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 2},
{"warn_data": {"at_line": 296, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_count = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 296, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 296, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_count = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 3},
{"warn_data": {"at_line": 297, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_alloc_count = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 297, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 297, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_alloc_count = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 4},
{"warn_data": {"at_line": 298, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_count = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 298, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 298, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_count = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 5},
{"warn_data": {"at_line": 300, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_write_ptr = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 300, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 300, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_write_ptr = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 6},
{"warn_data": {"at_line": 301, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_read_ptr = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 301, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 301, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_read_ptr = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 7},
{"warn_data": {"at_line": 303, "warn_str": "Trying to write to a user pointer.", "at": "async->cur_chan = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 303, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->cur_chan = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 303, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->cur_chan = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 8},
{"warn_data": {"at_line": 304, "warn_str": "Trying to write to a user pointer.", "at": "async->scans_done = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 304, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->scans_done = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 304, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->scans_done = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 9},
{"warn_data": {"at_line": 305, "warn_str": "Trying to write to a user pointer.", "at": "async->scan_progress = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 305, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->scan_progress = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 305, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->scan_progress = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 10},
{"warn_data": {"at_line": 306, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_chan = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 306, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 306, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_chan = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 11},
{"warn_data": {"at_line": 307, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_count = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 307, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 307, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_count = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 12},
{"warn_data": {"at_line": 308, "warn_str": "Trying to write to a user pointer.", "at": "async->munge_ptr = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 308, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 308, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->munge_ptr = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 13},
{"warn_data": {"at_line": 310, "warn_str": "Trying to write to a user pointer.", "at": "async->events = 0;", "inst_trace": [{"instr_func": "do_bufinfo_ioctl", "instr_loc": 1116, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bi, arg, sizeof(bi)))"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1122, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bi.subdevice];"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_bufinfo_ioctl", "instr_loc": 1171, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "do_become_nonbusy(dev, s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 731, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "do_become_nonbusy", "instr_loc": 737, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "comedi_buf_reset(s);"}, {"instr_func": "comedi_buf_reset", "instr_loc": 292, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 293, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 310, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->events = 0;"}, {"instr_func": "comedi_buf_reset", "instr_loc": 310, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->events = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_reset"}, "warn_no": 14}]},
{"num_warnings": 12,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2207, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_chaninfo_ioctl(dev, (void __user *)arg);"}],
"warnings":[{"warn_data": {"at_line": 1056, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&it, arg, sizeof(it)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1064, "warn_str": "Trying to read from a user pointer.", "at": "if (s->maxdata || !s->maxdata_list)", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1064, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1064, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1064, "warn_str": "Trying to read from a user pointer.", "at": "if (s->maxdata || !s->maxdata_list)", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1064, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1064, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->maxdata || !s->maxdata_list)"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1066, "warn_str": "Trying to read from a user pointer.", "at": "if (copy_to_user(it.maxdata_list, s->maxdata_list,", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1066, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_to_user(it.maxdata_list, s->maxdata_list,"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1066, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_to_user(it.maxdata_list, s->maxdata_list,"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1067, "warn_str": "Trying to read from a user pointer.", "at": "s->n_chan * sizeof(unsigned int)))", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1067, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->n_chan * sizeof(unsigned int)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1067, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s->n_chan * sizeof(unsigned int)))"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1077, "warn_str": "Trying to read from a user pointer.", "at": "if (!s->range_table_list)", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1077, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->range_table_list)"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1077, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (!s->range_table_list)"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1066, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(it.maxdata_list, s->maxdata_list,", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1083, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1083, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 1083, "warn_str": "Trying to read from a user pointer.", "at": "(s->range_table_list[i]->length);", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1083, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "(s->range_table_list[i]->length);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 1079, "warn_str": "Trying to read from a user pointer.", "at": "for (i = 0; i < s->n_chan; i++) {", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1079, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1079, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 1079, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < s->n_chan; i++) {", "inst_trace": [{"instr_func": "do_chaninfo_ioctl", "instr_loc": 1056, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&it, arg, sizeof(it)))"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1061, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[it.subdev];"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1079, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1079, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}, {"instr_func": "do_chaninfo_ioctl", "instr_loc": 1079, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "for (i = 0; i < s->n_chan; i++) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedLoopBoundDetector says:", "at_func": "do_chaninfo_ioctl"}, "warn_no": 12}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2202, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_subdinfo_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 1028, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "ret = copy_to_user(arg, tmp, dev->n_subdevices * sizeof(*tmp));", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_subdinfo_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2198, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_devinfo_ioctl(dev, (struct comedi_devinfo __user *)arg,"}],
"warnings":[{"warn_data": {"at_line": 955, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user(arg, &devinfo, sizeof(devinfo)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_devinfo_ioctl"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 874, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&bc, arg, sizeof(bc)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 881, "warn_str": "Trying to read from a user pointer.", "at": "async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 895, "warn_str": "Trying to write to a user pointer.", "at": "async->max_bufsize = bc.maximum_size;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 895, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->max_bufsize = bc.maximum_size;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 895, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async->max_bufsize = bc.maximum_size;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 904, "warn_str": "Trying to read from a user pointer.", "at": "bc.size = async->prealloc_bufsz;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 904, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bc.size = async->prealloc_bufsz;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 904, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bc.size = async->prealloc_bufsz;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 905, "warn_str": "Trying to read from a user pointer.", "at": "bc.maximum_size = async->max_bufsize;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 881, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "async = s->async;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 905, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bc.maximum_size = async->max_bufsize;"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 905, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "bc.maximum_size = async->max_bufsize;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 907, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "copyback:", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_bufconfig_ioctl"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2167, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_devconfig_ioctl(dev,"}],
"warnings":[{"warn_data": {"at_line": 833, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&it, arg, sizeof(it)))", "inst_trace": [], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedSizeDetector says:", "at_func": "do_devconfig_ioctl"}, "warn_no": 1}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}],
"warnings":[{"warn_data": {"at_line": 339, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 1},
{"warn_data": {"at_line": 344, "warn_str": "Trying to read from a user pointer.", "at": "if (new_size > async->max_bufsize)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (new_size > async->max_bufsize)"}, {"instr_func": "resize_async_buffer", "instr_loc": 344, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (new_size > async->max_bufsize)"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 2},
{"warn_data": {"at_line": 347, "warn_str": "Trying to read from a user pointer.", "at": "if (s->busy) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 347, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 347, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->busy) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 3},
{"warn_data": {"at_line": 359, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "resize_async_buffer"}, "warn_no": 4},
{"warn_data": {"at_line": 359, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "IntegerOverflowDetector says:", "at_func": "resize_async_buffer"}, "warn_no": 5},
{"warn_data": {"at_line": 365, "warn_str": "Trying to read from a user pointer.", "at": "if (s->buf_change) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->buf_change) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 365, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (s->buf_change) {"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 6},
{"warn_data": {"at_line": 366, "warn_str": "Trying to read from a user pointer.", "at": "retval = s->buf_change(dev, s);", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 366, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = s->buf_change(dev, s);"}, {"instr_func": "resize_async_buffer", "instr_loc": 366, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = s->buf_change(dev, s);"}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 7},
{"warn_data": {"at_line": 371, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\",", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 371, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}, {"instr_func": "resize_async_buffer", "instr_loc": 371, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 8},
{"warn_data": {"at_line": 371, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\",", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 339, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "resize_async_buffer", "instr_loc": 371, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}, {"instr_func": "resize_async_buffer", "instr_loc": 371, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "dev_dbg(dev->class_dev, \"subd %d buffer resized to %i bytes\\n\","}], "at_file": "drivers/staging/comedi/comedi_fops.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "resize_async_buffer"}, "warn_no": 9}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 352, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_is_mmapped(s)) {"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_buf_map *bm = s->async->buf_map;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 352, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_is_mmapped(s)) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 352, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_is_mmapped(s)) {"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 251, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 252, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_buf_map *bm = s->async->buf_map;"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 252, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_buf_map *bm = s->async->buf_map;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_is_mmapped"}, "warn_no": 1},
{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_buf_map *bm = s->async->buf_map;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 352, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_is_mmapped(s)) {"}, {"instr_func": "resize_async_buffer", "instr_loc": 352, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (comedi_buf_is_mmapped(s)) {"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 251, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 252, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_buf_map *bm = s->async->buf_map;"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 252, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_buf_map *bm = s->async->buf_map;"}, {"instr_func": "comedi_buf_is_mmapped", "instr_loc": 252, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_buf_map *bm = s->async->buf_map;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_is_mmapped"}, "warn_no": 2}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 361, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}],
"warnings":[{"warn_data": {"at_line": 280, "warn_str": "Trying to read from a user pointer.", "at": "if (!async->prealloc_buf) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 280, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!async->prealloc_buf) {"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 280, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!async->prealloc_buf) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 260, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_alloc"}, "warn_no": 2},
{"warn_data": {"at_line": 265, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_alloc"}, "warn_no": 3},
{"warn_data": {"at_line": 265, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "IntegerOverflowDetector says:", "at_func": "comedi_buf_alloc"}, "warn_no": 4},
{"warn_data": {"at_line": 268, "warn_str": "Trying to read from a user pointer.", "at": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 268, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 268, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_alloc"}, "warn_no": 5},
{"warn_data": {"at_line": 268, "warn_str": "Trying to read from a user pointer.", "at": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 268, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 268, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf && async->prealloc_bufsz == new_size)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_alloc"}, "warn_no": 6},
{"warn_data": {"at_line": 286, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_bufsz = new_size;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 260, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 286, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = new_size;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 286, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = new_size;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "comedi_buf_alloc"}, "warn_no": 7}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 361, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"lineno": 272, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 1},
{"warn_data": {"at_line": 60, "warn_str": "Trying to read from a user pointer.", "at": "if (async->prealloc_buf) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 60, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf) {"}, {"instr_func": "__comedi_buf_free", "instr_loc": 60, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 2},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "if (s->async_dma_dir == DMA_NONE)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 61, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (s->async_dma_dir == DMA_NONE)"}, {"instr_func": "__comedi_buf_free", "instr_loc": 61, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (s->async_dma_dir == DMA_NONE)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 3},
{"warn_data": {"at_line": 62, "warn_str": "Trying to read from a user pointer.", "at": "vunmap(async->prealloc_buf);", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 62, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "vunmap(async->prealloc_buf);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 62, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "vunmap(async->prealloc_buf);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 4},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_buf = NULL;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 63, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = NULL;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 63, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = NULL;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 5},
{"warn_data": {"at_line": 64, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_bufsz = 0;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 64, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = 0;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 64, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 6},
{"warn_data": {"at_line": 68, "warn_str": "Trying to read from a user pointer.", "at": "bm = async->buf_map;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 68, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = async->buf_map;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 68, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = async->buf_map;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 7},
{"warn_data": {"at_line": 69, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_map = NULL;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 272, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 69, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = NULL;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 69, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = NULL;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 8}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 361, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"lineno": 278, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}],
"warnings":[{"warn_data": {"at_line": 144, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 157, "warn_str": "Trying to read from a user pointer.", "at": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 2},
{"warn_data": {"at_line": 162, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_map = bm;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 162, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = bm;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 162, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = bm;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 3},
{"warn_data": {"at_line": 177, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < n_pages; i++) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 177, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 177, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 4},
{"warn_data": {"at_line": 171, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_buf = buf->virt_addr;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 171, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = buf->virt_addr;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 171, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = buf->virt_addr;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 5},
{"warn_data": {"at_line": 183, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_buf = vmap(pages, n_pages, VM_MAP,", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 144, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 183, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = vmap(pages, n_pages, VM_MAP,"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 183, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = vmap(pages, n_pages, VM_MAP,"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_alloc"}, "warn_no": 6}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 361, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"lineno": 278, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"lineno": 157, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}],
"warnings":[{"warn_data": {"at_line": 122, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!buf->virt_addr)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 122, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!buf->virt_addr)"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 122, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (!buf->virt_addr)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_buf_map_alloc"}, "warn_no": 1},
{"warn_data": {"at_line": 119, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < n_pages; i++) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 265, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 77, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 119, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 119, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_buf_map_alloc"}, "warn_no": 2},
{"warn_data": {"at_line": 111, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < n_pages; i++) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 359, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "new_size = (new_size + PAGE_SIZE - 1) & PAGE_MASK;"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 276, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "unsigned int n_pages = new_size >> PAGE_SHIFT;"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 278, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_alloc(dev, s, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 143, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}, {"instr_func": "__comedi_buf_alloc", "instr_loc": 157, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = comedi_buf_map_alloc(dev, s->async_dma_dir, n_pages);"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 77, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 111, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}, {"instr_func": "comedi_buf_map_alloc", "instr_loc": 111, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "for (i = 0; i < n_pages; i++) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedLoopBoundDetector says:", "at_func": "comedi_buf_map_alloc"}, "warn_no": 3}]},
{"num_warnings": 8,
"context":[{"lineno": -1, "instr": "  %4 = alloca i1, align 1"}, {"lineno": 2194, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "rc = do_bufconfig_ioctl(dev,"}, {"lineno": 899, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"lineno": 361, "file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"lineno": 282, "file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Trying to read from a user pointer.", "at": "struct comedi_async *async = s->async;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 1},
{"warn_data": {"at_line": 60, "warn_str": "Trying to read from a user pointer.", "at": "if (async->prealloc_buf) {", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 60, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf) {"}, {"instr_func": "__comedi_buf_free", "instr_loc": 60, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (async->prealloc_buf) {"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 2},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "if (s->async_dma_dir == DMA_NONE)", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 61, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (s->async_dma_dir == DMA_NONE)"}, {"instr_func": "__comedi_buf_free", "instr_loc": 61, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "if (s->async_dma_dir == DMA_NONE)"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 3},
{"warn_data": {"at_line": 62, "warn_str": "Trying to read from a user pointer.", "at": "vunmap(async->prealloc_buf);", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 62, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "vunmap(async->prealloc_buf);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 62, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "vunmap(async->prealloc_buf);"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 4},
{"warn_data": {"at_line": 63, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_buf = NULL;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 63, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = NULL;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 63, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_buf = NULL;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 5},
{"warn_data": {"at_line": 64, "warn_str": "Trying to write to a user pointer.", "at": "async->prealloc_bufsz = 0;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 64, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = 0;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 64, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->prealloc_bufsz = 0;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 6},
{"warn_data": {"at_line": 68, "warn_str": "Trying to read from a user pointer.", "at": "bm = async->buf_map;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 68, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = async->buf_map;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 68, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "bm = async->buf_map;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 7},
{"warn_data": {"at_line": 69, "warn_str": "Trying to write to a user pointer.", "at": "async->buf_map = NULL;", "inst_trace": [{"instr_func": "do_bufconfig_ioctl", "instr_loc": 874, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "if (copy_from_user(&bc, arg, sizeof(bc)))"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 880, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "s = &dev->subdevices[bc.subdevice];"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "do_bufconfig_ioctl", "instr_loc": 899, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = resize_async_buffer(dev, s, bc.size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 338, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "{"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "resize_async_buffer", "instr_loc": 361, "instr_file": "drivers/staging/comedi/comedi_fops.c", "instr": "retval = comedi_buf_alloc(dev, s, new_size);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 259, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "comedi_buf_alloc", "instr_loc": 282, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "__comedi_buf_free(dev, s);"}, {"instr_func": "__comedi_buf_free", "instr_loc": 55, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "{"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 56, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "struct comedi_async *async = s->async;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 69, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = NULL;"}, {"instr_func": "__comedi_buf_free", "instr_loc": 69, "instr_file": "drivers/staging/comedi/comedi_buf.c", "instr": "async->buf_map = NULL;"}], "at_file": "drivers/staging/comedi/comedi_buf.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__comedi_buf_free"}, "warn_no": 8}]}]}