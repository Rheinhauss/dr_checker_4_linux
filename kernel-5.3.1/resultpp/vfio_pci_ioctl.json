{"all_contexts":[
{"num_warnings": 46,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1110, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_device_ioeventfd ioeventfd;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 7},
{"warn_data": {"at_line": 1126, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hweight8(count) != 1 || ioeventfd.fd < -1)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1126, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (hweight8(count) != 1 || ioeventfd.fd < -1)"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 8},
{"warn_data": {"at_line": 1007, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_pci_hot_reset hdr;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 9},
{"warn_data": {"at_line": 1052, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(group_fds, (void __user *)(arg + minsz),", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 10},
{"warn_data": {"at_line": 1064, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i < hdr.count; i++) {", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1007, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_pci_hot_reset hdr;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1064, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "for (i = 0; i < hdr.count; i++) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1064, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "for (i = 0; i < hdr.count; i++) {"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 11},
{"warn_data": {"at_line": 934, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_pci_hot_reset_info hdr;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 12},
{"warn_data": {"at_line": 993, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "reset_info_exit:", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 13},
{"warn_data": {"at_line": 998, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_to_user((void __user *)(arg + minsz), devices,", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 14},
{"warn_data": {"at_line": 895, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_irq_set hdr;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 15},
{"warn_data": {"at_line": 859, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_irq_info info;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 16},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 17},
{"warn_data": {"at_line": 891, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user((void __user *)arg, &info, minsz) ?", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 18},
{"warn_data": {"at_line": 711, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct pci_dev *pdev = vdev->pdev;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 19},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 20},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 21},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 22},
{"warn_data": {"at_line": 761, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 23},
{"warn_data": {"at_line": 761, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 24},
{"warn_data": {"at_line": 761, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 761, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 25},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 26},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 27},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 28},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 29},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 30},
{"warn_data": {"at_line": 733, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 31},
{"warn_data": {"at_line": 733, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "info.size = pci_resource_len(pdev, info.index);", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 733, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = pci_resource_len(pdev, info.index);"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 32},
{"warn_data": {"at_line": 741, "warn_str": "Trying to read from a user pointer.", "at": "if (vdev->bar_mmap_supported[info.index]) {", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 741, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->bar_mmap_supported[info.index]) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 741, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->bar_mmap_supported[info.index]) {"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 33},
{"warn_data": {"at_line": 689, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "struct vfio_device_info info;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 34},
{"warn_data": {"at_line": 813, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "i = info.index - VFIO_PCI_NUM_REGIONS;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 35},
{"warn_data": {"at_line": 816, "warn_str": "Trying to read from a user pointer.", "at": "info.size = vdev->region[i].size;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 816, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = vdev->region[i].size;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 816, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = vdev->region[i].size;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 816, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.size = vdev->region[i].size;"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 36},
{"warn_data": {"at_line": 817, "warn_str": "Trying to read from a user pointer.", "at": "info.flags = vdev->region[i].flags;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 817, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.flags = vdev->region[i].flags;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 817, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.flags = vdev->region[i].flags;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 817, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "info.flags = vdev->region[i].flags;"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 37},
{"warn_data": {"at_line": 819, "warn_str": "Trying to read from a user pointer.", "at": "cap_type.type = vdev->region[i].type;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 819, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.type = vdev->region[i].type;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 819, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.type = vdev->region[i].type;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 819, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.type = vdev->region[i].type;"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 38},
{"warn_data": {"at_line": 820, "warn_str": "Trying to read from a user pointer.", "at": "cap_type.subtype = vdev->region[i].subtype;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 820, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.subtype = vdev->region[i].subtype;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 820, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.subtype = vdev->region[i].subtype;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 820, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "cap_type.subtype = vdev->region[i].subtype;"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 39},
{"warn_data": {"at_line": 827, "warn_str": "Trying to read from a user pointer.", "at": "if (vdev->region[i].ops->add_capability) {", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 40},
{"warn_data": {"at_line": 827, "warn_str": "Trying to read from a user pointer.", "at": "if (vdev->region[i].ops->add_capability) {", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 827, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "if (vdev->region[i].ops->add_capability) {"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 41},
{"warn_data": {"at_line": 828, "warn_str": "Trying to read from a user pointer.", "at": "ret = vdev->region[i].ops->add_capability(vdev,", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 42},
{"warn_data": {"at_line": 828, "warn_str": "Trying to read from a user pointer.", "at": "ret = vdev->region[i].ops->add_capability(vdev,", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 711, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct pci_dev *pdev = vdev->pdev;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 813, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "i = info.index - VFIO_PCI_NUM_REGIONS;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 828, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vdev->region[i].ops->add_capability(vdev,"}], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 43},
{"warn_data": {"at_line": 842, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "vfio_info_cap_shift(&caps, sizeof(info));", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 44},
{"warn_data": {"at_line": 855, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "return copy_to_user((void __user *)arg, &info, minsz) ?", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 45},
{"warn_data": {"at_line": 704, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "info.num_regions = VFIO_PCI_NUM_REGIONS + vdev->num_regions;", "inst_trace": [], "at_file": "drivers/vfio/pci/vfio_pci.c", "by": "TaintedSizeDetector says:", "at_func": "vfio_pci_ioctl"}, "warn_no": 46}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1129, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}],
"warnings":[{"warn_data": {"at_line": 313, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 1},
{"warn_data": {"at_line": 313, "warn_str": "Trying to read from a user pointer.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 2},
{"warn_data": {"at_line": 313, "warn_str": "Trying to read from a user pointer.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 3},
{"warn_data": {"at_line": 313, "warn_str": "Trying to read from a user pointer.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 4},
{"warn_data": {"at_line": 313, "warn_str": "Trying to read from a user pointer.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 5},
{"warn_data": {"at_line": 313, "warn_str": "Trying to read from a user pointer.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 6},
{"warn_data": {"at_line": 313, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 7},
{"warn_data": {"at_line": 313, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (pos + count > pci_resource_len(pdev, bar))", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 313, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (pos + count > pci_resource_len(pdev, bar))"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 8},
{"warn_data": {"at_line": 318, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "!(pos + count <= vdev->msix_offset ||", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 305, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "loff_t pos = offset & VFIO_PCI_OFFSET_MASK;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 318, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "!(pos + count <= vdev->msix_offset ||"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 9},
{"warn_data": {"at_line": 334, "warn_str": "Loop is bounded by a tainted value.", "at": "if (ioeventfd->pos == pos && ioeventfd->bar == bar &&", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1124, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "count = ioeventfd.flags & VFIO_DEVICE_IOEVENTFD_SIZE_MASK;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1130, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "ioeventfd.data, count, ioeventfd.fd);"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 335, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ioeventfd->data == data && ioeventfd->count == count) {"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 335, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ioeventfd->data == data && ioeventfd->count == count) {"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 10},
{"warn_data": {"at_line": 365, "warn_str": "Trying to read from a user pointer.", "at": "ioeventfd->addr = vdev->barmap[bar] + pos;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 365, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ioeventfd->addr = vdev->barmap[bar] + pos;"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 365, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ioeventfd->addr = vdev->barmap[bar] + pos;"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_ioeventfd"}, "warn_no": 11}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1129, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"lineno": 327, "file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ret = vfio_pci_setup_barmap(vdev, bar);"}],
"warnings":[{"warn_data": {"at_line": 138, "warn_str": "Trying to read from a user pointer.", "at": "if (vdev->barmap[bar])", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 327, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ret = vfio_pci_setup_barmap(vdev, bar);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 327, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ret = vfio_pci_setup_barmap(vdev, bar);"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 133, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 138, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (vdev->barmap[bar])"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 138, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "if (vdev->barmap[bar])"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_setup_barmap"}, "warn_no": 1},
{"warn_data": {"at_line": 151, "warn_str": "Trying to write to a user pointer.", "at": "vdev->barmap[bar] = io;", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 1110, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_device_ioeventfd ioeventfd;"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1129, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "return vfio_pci_ioeventfd(vdev, ioeventfd.offset,"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 303, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 306, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "int ret, bar = VFIO_PCI_OFFSET_TO_INDEX(offset);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 327, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ret = vfio_pci_setup_barmap(vdev, bar);"}, {"instr_func": "vfio_pci_ioeventfd", "instr_loc": 327, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "ret = vfio_pci_setup_barmap(vdev, bar);"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 133, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "{"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 151, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "vdev->barmap[bar] = io;"}, {"instr_func": "vfio_pci_setup_barmap", "instr_loc": 151, "instr_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "instr": "vdev->barmap[bar] = io;"}], "at_file": "drivers/vfio/pci/vfio_pci_rdwr.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfio_pci_setup_barmap"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1044, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "group_fds = kcalloc(hdr.count, sizeof(*group_fds), GFP_KERNEL);"}, {"lineno": 687, "file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.884(i64 %7, i64 %8, i32 %10) #13, !dbg !107441"}],
"warnings":[{"warn_data": {"at_line": 553, "warn_str": "Trying to use a global variable without locking.", "at": "  %221 = getelementptr [3 x [14 x %struct.kmem_cache*]], [3 x [14 x %struct.kmem_cache*]]* @kmalloc_caches, i64 0, i64 %220, !dbg !107675", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1044, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "group_fds = kcalloc(hdr.count, sizeof(*group_fds), GFP_KERNEL);"}, {"instr_func": "kcalloc.880", "instr_loc": 687, "instr_file": "./include/linux/slab.h", "instr": "  %11 = call i8* @kmalloc_array.884(i64 %7, i64 %8, i32 %10) #13, !dbg !107441"}], "at_file": "./include/linux/slab.h", "by": "GlobalVariableRaceDetector says:", "at_func": "kmalloc_array.884"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1072, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "group = vfio_group_get_external_user(f.file);"}],
"warnings":[{"warn_data": {"at_line": 1743, "warn_str": "Trying to use a global variable without locking.", "at": "if (filep->f_op != &vfio_group_fops)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 1072, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "group = vfio_group_get_external_user(f.file);"}], "at_file": "drivers/vfio/vfio.c", "by": "GlobalVariableRaceDetector says:", "at_func": "vfio_group_get_external_user"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 931, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"lineno": 5003, "file": "drivers/pci/pci.c", "instr": "pci_dev_save_and_disable(dev);"}, {"lineno": 4799, "file": "drivers/pci/pci.c", "instr": "pci_set_power_state(dev, PCI_D0);"}, {"lineno": 1146, "file": "drivers/pci/pci.c", "instr": "error = pci_raw_set_power_state(dev, state > PCI_D3hot ?"}, {"lineno": 887, "file": "drivers/pci/pci.c", "instr": "pci_dev_d3_sleep(dev);"}],
"warnings":[{"warn_data": {"at_line": 70, "warn_str": "Trying to use a global variable without locking.", "at": "if (delay < pci_pm_d3_delay)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 931, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"instr_func": "pci_try_reset_function", "instr_loc": 5003, "instr_file": "drivers/pci/pci.c", "instr": "pci_dev_save_and_disable(dev);"}, {"instr_func": "pci_dev_save_and_disable", "instr_loc": 4799, "instr_file": "drivers/pci/pci.c", "instr": "pci_set_power_state(dev, PCI_D0);"}, {"instr_func": "pci_set_power_state", "instr_loc": 1146, "instr_file": "drivers/pci/pci.c", "instr": "error = pci_raw_set_power_state(dev, state > PCI_D3hot ?"}, {"instr_func": "pci_raw_set_power_state", "instr_loc": 887, "instr_file": "drivers/pci/pci.c", "instr": "pci_dev_d3_sleep(dev);"}], "at_file": "drivers/pci/pci.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pci_dev_d3_sleep"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 931, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"lineno": 5005, "file": "drivers/pci/pci.c", "instr": "pci_dev_restore(dev);"}, {"lineno": 4817, "file": "drivers/pci/pci.c", "instr": "pci_restore_state(dev);"}, {"lineno": 1484, "file": "drivers/pci/pci.c", "instr": "pci_enable_acs(dev);"}],
"warnings":[{"warn_data": {"at_line": 3275, "warn_str": "Trying to use a global variable without locking.", "at": "if (!pci_acs_enable)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 931, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"instr_func": "pci_try_reset_function", "instr_loc": 5005, "instr_file": "drivers/pci/pci.c", "instr": "pci_dev_restore(dev);"}, {"instr_func": "pci_dev_restore", "instr_loc": 4817, "instr_file": "drivers/pci/pci.c", "instr": "pci_restore_state(dev);"}, {"instr_func": "pci_restore_state", "instr_loc": 1484, "instr_file": "drivers/pci/pci.c", "instr": "pci_enable_acs(dev);"}], "at_file": "drivers/pci/pci.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pci_enable_acs"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 931, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"lineno": 5005, "file": "drivers/pci/pci.c", "instr": "pci_dev_restore(dev);"}, {"lineno": 4817, "file": "drivers/pci/pci.c", "instr": "pci_restore_state(dev);"}, {"lineno": 1484, "file": "drivers/pci/pci.c", "instr": "pci_enable_acs(dev);"}, {"lineno": 3291, "file": "drivers/pci/pci.c", "instr": "pci_disable_acs_redir(dev);"}],
"warnings":[{"warn_data": {"at_line": 3192, "warn_str": "Trying to use a global variable without locking.", "at": "if (!disable_acs_redir_param)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": -1, "instr": "  %4 = alloca i8*, align 8"}, {"instr_func": "vfio_pci_ioctl", "instr_loc": 931, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "pci_try_reset_function(vdev->pdev) : -EINVAL;"}, {"instr_func": "pci_try_reset_function", "instr_loc": 5005, "instr_file": "drivers/pci/pci.c", "instr": "pci_dev_restore(dev);"}, {"instr_func": "pci_dev_restore", "instr_loc": 4817, "instr_file": "drivers/pci/pci.c", "instr": "pci_restore_state(dev);"}, {"instr_func": "pci_restore_state", "instr_loc": 1484, "instr_file": "drivers/pci/pci.c", "instr": "pci_enable_acs(dev);"}, {"instr_func": "pci_enable_acs", "instr_loc": 3291, "instr_file": "drivers/pci/pci.c", "instr": "pci_disable_acs_redir(dev);"}], "at_file": "drivers/pci/pci.c", "by": "GlobalVariableRaceDetector says:", "at_func": "pci_disable_acs_redir"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 907, "file": "drivers/vfio/pci/vfio_pci.c", "instr": "ret = vfio_set_irqs_validate_and_prepare(&hdr, max,"}],
"warnings":[{"warn_data": {"at_line": 1863, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(hdr->count >= (U32_MAX - hdr->start)) ||", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 895, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_irq_set hdr;"}, {"instr_func": "vfio_set_irqs_validate_and_prepare", "instr_loc": 1863, "instr_file": "drivers/vfio/vfio.c", "instr": "(hdr->count >= (U32_MAX - hdr->start)) ||"}], "at_file": "drivers/vfio/vfio.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_set_irqs_validate_and_prepare"}, "warn_no": 1},
{"warn_data": {"at_line": 1871, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hdr->start >= num_irqs || hdr->start + hdr->count > num_irqs)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 895, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_irq_set hdr;"}, {"instr_func": "vfio_set_irqs_validate_and_prepare", "instr_loc": 1871, "instr_file": "drivers/vfio/vfio.c", "instr": "if (hdr->start >= num_irqs || hdr->start + hdr->count > num_irqs)"}], "at_file": "drivers/vfio/vfio.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_set_irqs_validate_and_prepare"}, "warn_no": 2},
{"warn_data": {"at_line": 1889, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (hdr->argsz - minsz < hdr->count * size)", "inst_trace": [{"instr_func": "vfio_pci_ioctl", "instr_loc": 895, "instr_file": "drivers/vfio/pci/vfio_pci.c", "instr": "struct vfio_irq_set hdr;"}, {"instr_func": "vfio_set_irqs_validate_and_prepare", "instr_loc": 1889, "instr_file": "drivers/vfio/vfio.c", "instr": "if (hdr->argsz - minsz < hdr->count * size)"}], "at_file": "drivers/vfio/vfio.c", "by": "IntegerOverflowDetector says:", "at_func": "vfio_set_irqs_validate_and_prepare"}, "warn_no": 3}]}]}