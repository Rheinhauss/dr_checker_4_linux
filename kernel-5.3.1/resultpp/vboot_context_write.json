{"all_contexts":[
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}],
"warnings":[{"warn_data": {"at_line": 62, "warn_str": "Trying to read from a user pointer.", "at": "struct cros_ec_device *ecdev = ec->ec_dev;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}], "at_file": "drivers/platform/chrome/cros_ec_vbc.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vboot_context_write"}, "warn_no": 1},
{"warn_data": {"at_line": 70, "warn_str": "Trying to use a global variable without locking.", "at": "if (count != data_sz)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}], "at_file": "drivers/platform/chrome/cros_ec_vbc.c", "by": "GlobalVariableRaceDetector says:", "at_func": "vboot_context_write"}, "warn_no": 2}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}],
"warnings":[{"warn_data": {"at_line": 461, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version == EC_PROTO_VERSION_UNKNOWN) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 461, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version == EC_PROTO_VERSION_UNKNOWN) {"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 461, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version == EC_PROTO_VERSION_UNKNOWN) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 1},
{"warn_data": {"at_line": 471, "warn_str": "Trying to read from a user pointer.", "at": "if (msg->insize > ec_dev->max_response) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 471, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->insize > ec_dev->max_response) {"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 471, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->insize > ec_dev->max_response) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 2},
{"warn_data": {"at_line": 472, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev, \"clamping message receive buffer\\n\");", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 472, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"clamping message receive buffer\\n\");"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 472, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"clamping message receive buffer\\n\");"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 3},
{"warn_data": {"at_line": 473, "warn_str": "Trying to read from a user pointer.", "at": "msg->insize = ec_dev->max_response;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 473, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "msg->insize = ec_dev->max_response;"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 473, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "msg->insize = ec_dev->max_response;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 4},
{"warn_data": {"at_line": 486, "warn_str": "Trying to read from a user pointer.", "at": "if (msg->outsize > ec_dev->max_passthru) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 486, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->outsize > ec_dev->max_passthru) {"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 486, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->outsize > ec_dev->max_passthru) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 5},
{"warn_data": {"at_line": 487, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 487, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 487, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 6},
{"warn_data": {"at_line": 487, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 487, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 487, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 7},
{"warn_data": {"at_line": 477, "warn_str": "Trying to read from a user pointer.", "at": "if (msg->outsize > ec_dev->max_request) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 477, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->outsize > ec_dev->max_request) {"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 477, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (msg->outsize > ec_dev->max_request) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 8},
{"warn_data": {"at_line": 478, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 478, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 478, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 9},
{"warn_data": {"at_line": 478, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 478, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 478, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 10},
{"warn_data": {"at_line": 464, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 464, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 464, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_cmd_xfer"}, "warn_no": 11}]},
{"num_warnings": 42,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}],
"warnings":[{"warn_data": {"at_line": 330, "warn_str": "Trying to read from a user pointer.", "at": "struct device *dev = ec_dev->dev;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 1},
{"warn_data": {"at_line": 402, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev, \"EC query failed: %d\\n\", ret);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 402, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"EC query failed: %d\\n\", ret);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 402, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"EC query failed: %d\\n\", ret);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 2},
{"warn_data": {"at_line": 342, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->proto_version = 3;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 342, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = 3;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 342, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = 3;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 3},
{"warn_data": {"at_line": 382, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->proto_version = 2;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 382, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = 2;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 382, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = 2;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 4},
{"warn_data": {"at_line": 401, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->proto_version = EC_PROTO_VERSION_UNKNOWN;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 401, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = EC_PROTO_VERSION_UNKNOWN;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 401, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version = EC_PROTO_VERSION_UNKNOWN;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 5},
{"warn_data": {"at_line": 387, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev, \"falling back to proto v2\\n\");", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 387, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"falling back to proto v2\\n\");"}, {"instr_func": "cros_ec_query_all", "instr_loc": 387, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"falling back to proto v2\\n\");"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 6},
{"warn_data": {"at_line": 389, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_request = EC_PROTO2_MAX_PARAM_SIZE;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 389, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_request = EC_PROTO2_MAX_PARAM_SIZE;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 389, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_request = EC_PROTO2_MAX_PARAM_SIZE;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 7},
{"warn_data": {"at_line": 390, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_response = EC_PROTO2_MAX_PARAM_SIZE;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 390, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_response = EC_PROTO2_MAX_PARAM_SIZE;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 390, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_response = EC_PROTO2_MAX_PARAM_SIZE;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 8},
{"warn_data": {"at_line": 391, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_passthru = 0;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 391, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru = 0;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 391, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru = 0;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 9},
{"warn_data": {"at_line": 392, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->pkt_xfer = NULL;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 392, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->pkt_xfer = NULL;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 392, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->pkt_xfer = NULL;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 10},
{"warn_data": {"at_line": 393, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->din_size = EC_PROTO2_MSG_BYTES;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 393, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = EC_PROTO2_MSG_BYTES;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 393, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = EC_PROTO2_MSG_BYTES;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 11},
{"warn_data": {"at_line": 394, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->dout_size = EC_PROTO2_MSG_BYTES;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 394, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = EC_PROTO2_MSG_BYTES;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 394, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = EC_PROTO2_MSG_BYTES;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 12},
{"warn_data": {"at_line": 348, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_request = proto_info->max_request_packet_size -", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 348, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_request = proto_info->max_request_packet_size -"}, {"instr_func": "cros_ec_query_all", "instr_loc": 348, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_request = proto_info->max_request_packet_size -"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 13},
{"warn_data": {"at_line": 350, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_response = proto_info->max_response_packet_size -", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 350, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_response = proto_info->max_response_packet_size -"}, {"instr_func": "cros_ec_query_all", "instr_loc": 350, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_response = proto_info->max_response_packet_size -"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 14},
{"warn_data": {"at_line": 352, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->proto_version =", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 352, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version ="}, {"instr_func": "cros_ec_query_all", "instr_loc": 352, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->proto_version ="}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 15},
{"warn_data": {"at_line": 355, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 355, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 355, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 16},
{"warn_data": {"at_line": 355, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 355, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 355, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 17},
{"warn_data": {"at_line": 359, "warn_str": "Trying to read from a user pointer.", "at": "ec_dev->din_size = ec_dev->max_response +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 18},
{"warn_data": {"at_line": 359, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ec_dev->din_size = ec_dev->max_response +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_query_all"}, "warn_no": 19},
{"warn_data": {"at_line": 360, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sizeof(struct ec_host_response) +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_query_all"}, "warn_no": 20},
{"warn_data": {"at_line": 359, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->din_size = ec_dev->max_response +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 359, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din_size = ec_dev->max_response +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 21},
{"warn_data": {"at_line": 362, "warn_str": "Trying to read from a user pointer.", "at": "ec_dev->dout_size = ec_dev->max_request +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 22},
{"warn_data": {"at_line": 362, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ec_dev->dout_size = ec_dev->max_request +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_query_all"}, "warn_no": 23},
{"warn_data": {"at_line": 363, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sizeof(struct ec_host_request) +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "IntegerOverflowDetector says:", "at_func": "cros_ec_query_all"}, "warn_no": 24},
{"warn_data": {"at_line": 362, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->dout_size = ec_dev->max_request +", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}, {"instr_func": "cros_ec_query_all", "instr_loc": 362, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout_size = ec_dev->max_request +"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 25},
{"warn_data": {"at_line": 376, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_passthru =", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 376, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru ="}, {"instr_func": "cros_ec_query_all", "instr_loc": 376, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru ="}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 26},
{"warn_data": {"at_line": 375, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev, \"found PD chip\\n\");", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 375, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"found PD chip\\n\");"}, {"instr_func": "cros_ec_query_all", "instr_loc": 375, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"found PD chip\\n\");"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 27},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev, \"no PD chip found: %d\\n\", ret);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 372, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"no PD chip found: %d\\n\", ret);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 372, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev, \"no PD chip found: %d\\n\", ret);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 28},
{"warn_data": {"at_line": 407, "warn_str": "Trying to read from a user pointer.", "at": "devm_kfree(dev, ec_dev->din);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 407, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->din);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 407, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->din);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 29},
{"warn_data": {"at_line": 373, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->max_passthru = 0;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 373, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru = 0;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 373, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->max_passthru = 0;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 30},
{"warn_data": {"at_line": 408, "warn_str": "Trying to read from a user pointer.", "at": "devm_kfree(dev, ec_dev->dout);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 408, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->dout);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 408, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->dout);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 31},
{"warn_data": {"at_line": 410, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 32},
{"warn_data": {"at_line": 410, "warn_str": "Trying to read from a user pointer.", "at": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 33},
{"warn_data": {"at_line": 411, "warn_str": "Trying to read from a user pointer.", "at": "if (!ec_dev->din) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 411, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->din) {"}, {"instr_func": "cros_ec_query_all", "instr_loc": 411, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->din) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 34},
{"warn_data": {"at_line": 416, "warn_str": "Trying to read from a user pointer.", "at": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 35},
{"warn_data": {"at_line": 417, "warn_str": "Trying to read from a user pointer.", "at": "if (!ec_dev->dout) {", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 417, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->dout) {"}, {"instr_func": "cros_ec_query_all", "instr_loc": 417, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->dout) {"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 36},
{"warn_data": {"at_line": 416, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 37},
{"warn_data": {"at_line": 418, "warn_str": "Trying to read from a user pointer.", "at": "devm_kfree(dev, ec_dev->din);", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 418, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->din);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 418, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "devm_kfree(dev, ec_dev->din);"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 38},
{"warn_data": {"at_line": 430, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->mkbp_event_supported = 1;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 430, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->mkbp_event_supported = 1;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 430, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->mkbp_event_supported = 1;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 39},
{"warn_data": {"at_line": 436, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->host_sleep_v1 = (ret >= 0 && (ver_mask & EC_VER_MASK(1)));", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 436, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->host_sleep_v1 = (ret >= 0 && (ver_mask & EC_VER_MASK(1)));"}, {"instr_func": "cros_ec_query_all", "instr_loc": 436, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->host_sleep_v1 = (ret >= 0 && (ver_mask & EC_VER_MASK(1)));"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 40},
{"warn_data": {"at_line": 428, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->mkbp_event_supported = 0;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 428, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->mkbp_event_supported = 0;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 428, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->mkbp_event_supported = 0;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 41},
{"warn_data": {"at_line": 445, "warn_str": "Trying to write to a user pointer.", "at": "ec_dev->host_event_wake_mask = U32_MAX;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 445, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->host_event_wake_mask = U32_MAX;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 445, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->host_event_wake_mask = U32_MAX;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_query_all"}, "warn_no": 42}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 343, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"lineno": 214, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 343, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}],
"warnings":[{"warn_data": {"at_line": 207, "warn_str": "Trying to read from a user pointer.", "at": "if (!ec_dev->pkt_xfer)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 207, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->pkt_xfer)"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 207, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->pkt_xfer)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query"}, "warn_no": 1},
{"warn_data": {"at_line": 217, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 343, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 0, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 217, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 217, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 383, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}],
"warnings":[{"warn_data": {"at_line": 260, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 260, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 260, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query_v2"}, "warn_no": 1},
{"warn_data": {"at_line": 266, "warn_str": "Trying to read from a user pointer.", "at": "dev_err(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 266, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 266, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query_v2"}, "warn_no": 2},
{"warn_data": {"at_line": 255, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 255, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 255, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query_v2"}, "warn_no": 3}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 383, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"lineno": 252, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 383, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query_v2(ec_dev);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 232, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query_v2", "instr_loc": 252, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 369, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}],
"warnings":[{"warn_data": {"at_line": 207, "warn_str": "Trying to read from a user pointer.", "at": "if (!ec_dev->pkt_xfer)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 207, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->pkt_xfer)"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 207, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (!ec_dev->pkt_xfer)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query"}, "warn_no": 1},
{"warn_data": {"at_line": 217, "warn_str": "Trying to read from a user pointer.", "at": "dev_dbg(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 217, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 217, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_dbg(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_host_command_proto_query"}, "warn_no": 2}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 369, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"lineno": 214, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 369, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_host_command_proto_query(ec_dev, 1, proto_msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 198, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_host_command_proto_query", "instr_loc": 214, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 410, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}],
"warnings":[{"warn_data": {"src_obj": "  %47 = call i8* @__kmalloc_node_track_caller(i64 %42, i32 %43, i32 %44, i64 %46) #15, !dbg !169457", "src_obj_taint": "tainted", "at_line": 103, "dst_obj_size": 40, "src_obj_size": -1, "warn_str": "Trying to cast an object", "at": "dr = kmalloc_node_track_caller(tot_size, gfp, nid);", "inst_trace": [], "at_func": "devm_kmalloc", "by": "InvalidCastDetector says:", "at_file": "drivers/base/devres.c"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 410, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"lineno": 815, "file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}],
"warnings":[{"warn_data": {"at_line": 1112, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i32, i32* %4, align 8, !dbg !169421", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 410, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 682, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %4, align 8"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 683, "instr_file": "./include/linux/device.h", "instr": "  %7 = load %struct.device*, %struct.device** %4, align 8, !dbg !169426"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 683, "instr_file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"instr_func": "devm_kmalloc", "instr_loc": 811, "instr_file": "drivers/base/devres.c", "instr": "{"}, {"instr_func": "devm_kmalloc", "instr_loc": 815, "instr_file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}, {"instr_func": "devm_kmalloc", "instr_loc": 815, "instr_file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}, {"instr_func": "dev_to_node.818", "instr_loc": 1111, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_to_node.818", "instr_loc": 1112, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !169420"}, {"instr_func": "dev_to_node.818", "instr_loc": 1112, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 29, !dbg !169421"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_to_node.818"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 410, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->din = devm_kzalloc(dev, ec_dev->din_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"lineno": 824, "file": "drivers/base/devres.c", "instr": "devres_add(dev, dr->data);"}],
"warnings":[{"warn_data": {"src_obj": "  %47 = call i8* @__kmalloc_node_track_caller(i64 %42, i32 %43, i32 %44, i64 %46) #15, !dbg !169457", "src_obj_taint": "tainted", "at_line": 231, "dst_obj_size": 40, "src_obj_size": -1, "warn_str": "Trying to cast an object", "at": "struct devres *dr = container_of(res, struct devres, data);", "inst_trace": [], "at_func": "devres_add", "by": "InvalidCastDetector says:", "at_file": "drivers/base/devres.c"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 416, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}],
"warnings":[{"warn_data": {"src_obj": "  %47 = call i8* @__kmalloc_node_track_caller(i64 %42, i32 %43, i32 %44, i64 %46) #15, !dbg !169457", "src_obj_taint": "tainted", "at_line": 103, "dst_obj_size": 40, "src_obj_size": -1, "warn_str": "Trying to cast an object", "at": "dr = kmalloc_node_track_caller(tot_size, gfp, nid);", "inst_trace": [], "at_func": "devm_kmalloc", "by": "InvalidCastDetector says:", "at_file": "drivers/base/devres.c"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 416, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"lineno": 815, "file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}],
"warnings":[{"warn_data": {"at_line": 1112, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i32, i32* %4, align 8, !dbg !169421", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 330, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "struct device *dev = ec_dev->dev;"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 416, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 682, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %4, align 8"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 683, "instr_file": "./include/linux/device.h", "instr": "  %7 = load %struct.device*, %struct.device** %4, align 8, !dbg !169426"}, {"instr_func": "devm_kzalloc.417", "instr_loc": 683, "instr_file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"instr_func": "devm_kmalloc", "instr_loc": 811, "instr_file": "drivers/base/devres.c", "instr": "{"}, {"instr_func": "devm_kmalloc", "instr_loc": 815, "instr_file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}, {"instr_func": "devm_kmalloc", "instr_loc": 815, "instr_file": "drivers/base/devres.c", "instr": "dr = alloc_dr(devm_kmalloc_release, size, gfp, dev_to_node(dev));"}, {"instr_func": "dev_to_node.818", "instr_loc": 1111, "instr_file": "./include/linux/device.h", "instr": "  store %struct.device* %0, %struct.device** %2, align 8"}, {"instr_func": "dev_to_node.818", "instr_loc": 1112, "instr_file": "./include/linux/device.h", "instr": "  %3 = load %struct.device*, %struct.device** %2, align 8, !dbg !169420"}, {"instr_func": "dev_to_node.818", "instr_loc": 1112, "instr_file": "./include/linux/device.h", "instr": "  %4 = getelementptr inbounds %struct.device, %struct.device* %3, i32 0, i32 29, !dbg !169421"}], "at_file": "./include/linux/device.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "dev_to_node.818"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 416, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ec_dev->dout = devm_kzalloc(dev, ec_dev->dout_size, GFP_KERNEL);"}, {"lineno": 683, "file": "./include/linux/device.h", "instr": "  %11 = call noalias i8* @devm_kmalloc(%struct.device* %7, i64 %8, i32 %10) #14, !dbg !169430"}, {"lineno": 824, "file": "drivers/base/devres.c", "instr": "devres_add(dev, dr->data);"}],
"warnings":[{"warn_data": {"src_obj": "  %47 = call i8* @__kmalloc_node_track_caller(i64 %42, i32 %43, i32 %44, i64 %46) #15, !dbg !169457", "src_obj_taint": "tainted", "at_line": 231, "dst_obj_size": 40, "src_obj_size": -1, "warn_str": "Trying to cast an object", "at": "struct devres *dr = container_of(res, struct devres, data);", "inst_trace": [], "at_func": "devres_add", "by": "InvalidCastDetector says:", "at_file": "drivers/base/devres.c"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 424, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"lineno": 317, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 424, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 442, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"lineno": 186, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 177, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 177, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 177, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 177, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 186, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 433, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"lineno": 317, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_query_all", "instr_loc": 433, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_command_version_mask(ec_dev,"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 298, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_get_host_command_version_mask", "instr_loc": 317, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 462, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"lineno": 442, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}],
"warnings":[{"warn_data": {"at_line": 189, "warn_str": "Trying to write to a user pointer.", "at": "*mask = r->mask;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 462, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_query_all(ec_dev);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 329, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_query_all", "instr_loc": 443, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "&ec_dev->host_event_wake_mask);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 443, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "&ec_dev->host_event_wake_mask);"}, {"instr_func": "cros_ec_query_all", "instr_loc": 442, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = cros_ec_get_host_event_wake_mask(ec_dev, proto_msg,"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 177, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_get_host_event_wake_mask", "instr_loc": 189, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "*mask = r->mask;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "cros_ec_get_host_event_wake_mask"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %7 = alloca i32, align 4"}, {"lineno": 86, "file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"lineno": 495, "file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}],
"warnings":[{"warn_data": {"at_line": 61, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->cmd_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}, {"instr_func": "send_command", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->cmd_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 1},
{"warn_data": {"at_line": 58, "warn_str": "Trying to read from a user pointer.", "at": "if (ec_dev->proto_version > 2)", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}, {"instr_func": "send_command", "instr_loc": 58, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "if (ec_dev->proto_version > 2)"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 2},
{"warn_data": {"at_line": 59, "warn_str": "Trying to read from a user pointer.", "at": "xfer_fxn = ec_dev->pkt_xfer;", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}, {"instr_func": "send_command", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "xfer_fxn = ec_dev->pkt_xfer;"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 3},
{"warn_data": {"at_line": 69, "warn_str": "Trying to read from a user pointer.", "at": "dev_err_once(ec_dev->dev,", "inst_trace": [{"instr_func": "vboot_context_write", "instr_loc": -1, "instr": "  %7 = alloca i32, align 4"}, {"instr_func": "vboot_context_write", "instr_loc": 59, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "{"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 60, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct device *dev = container_of(kobj, struct device, kobj);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 61, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_dev *ec = to_cros_ec_dev(dev);"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 62, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "struct cros_ec_device *ecdev = ec->ec_dev;"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "vboot_context_write", "instr_loc": 86, "instr_file": "drivers/platform/chrome/cros_ec_vbc.c", "instr": "err = cros_ec_cmd_xfer(ecdev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 457, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "cros_ec_cmd_xfer", "instr_loc": 495, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "ret = send_command(ec_dev, msg);"}, {"instr_func": "send_command", "instr_loc": 52, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "{"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}, {"instr_func": "send_command", "instr_loc": 69, "instr_file": "drivers/platform/chrome/cros_ec_proto.c", "instr": "dev_err_once(ec_dev->dev,"}], "at_file": "drivers/platform/chrome/cros_ec_proto.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "send_command"}, "warn_no": 4}]}]}