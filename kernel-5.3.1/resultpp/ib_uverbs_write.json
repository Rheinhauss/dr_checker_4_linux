{"all_contexts":[
{"num_warnings": 17,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 678, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&hdr, buf, sizeof(hdr)))", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 1},
{"warn_data": {"at_line": 670, "warn_str": "Trying to use a global variable without locking.", "at": "pr_err_once(\"uverbs_write: process %d (%s) changed security contexts after opening file descriptor, this is not allowed.\\n\",", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "GlobalVariableRaceDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 2},
{"warn_data": {"at_line": 685, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 685, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 685, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 3},
{"warn_data": {"at_line": 688, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&ex_hdr, buf + sizeof(hdr), sizeof(ex_hdr)))", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 4},
{"warn_data": {"at_line": 703, "warn_str": "Trying to read from a user pointer.", "at": "if (!method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 703, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!method_elm->is_ex) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 703, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 5},
{"warn_data": {"at_line": 704, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 6},
{"warn_data": {"at_line": 708, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_udata) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 708, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 708, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 7},
{"warn_data": {"at_line": 710, "warn_str": "Trying to read from a user pointer.", "at": "in_len - method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 710, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 710, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 8},
{"warn_data": {"at_line": 710, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "in_len - method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 704, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t in_len = hdr.in_words * 4 - sizeof(hdr);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 710, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len - method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 9},
{"warn_data": {"at_line": 711, "warn_str": "Trying to read from a user pointer.", "at": "in_len = method_elm->req_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 711, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len = method_elm->req_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 711, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "in_len = method_elm->req_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 10},
{"warn_data": {"at_line": 721, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_resp) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 721, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_resp) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 721, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_resp) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 11},
{"warn_data": {"at_line": 731, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->has_udata) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 731, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}, {"instr_func": "ib_uverbs_write", "instr_loc": 731, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->has_udata) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 12},
{"warn_data": {"at_line": 733, "warn_str": "Trying to read from a user pointer.", "at": "out_len - method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 733, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 733, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 13},
{"warn_data": {"at_line": 733, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "out_len - method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 733, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len - method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 14},
{"warn_data": {"at_line": 734, "warn_str": "Trying to read from a user pointer.", "at": "out_len = method_elm->resp_size;", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 734, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len = method_elm->resp_size;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 734, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "out_len = method_elm->resp_size;"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 15},
{"warn_data": {"at_line": 737, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u64_to_user_ptr(response +", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 705, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "size_t out_len = hdr.out_words * 4;"}, {"instr_func": "ib_uverbs_write", "instr_loc": 737, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "u64_to_user_ptr(response +"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "ib_uverbs_write"}, "warn_no": 16},
{"warn_data": {"at_line": 765, "warn_str": "Trying to read from a user pointer.", "at": "ret = method_elm->handler(&bundle);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 765, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = method_elm->handler(&bundle);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 765, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = method_elm->handler(&bundle);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_uverbs_write"}, "warn_no": 17}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 681, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}],
"warnings":[{"warn_data": {"at_line": 218, "warn_str": "Trying to read from a user pointer.", "at": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}], "at_file": "drivers/infiniband/core/rdma_core.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_method"}, "warn_no": 1},
{"warn_data": {"at_line": 213, "warn_str": "Trying to read from a user pointer.", "at": "  %35 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %34, align 8, !dbg !545988", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 213, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %32 = load i32, i32* %6, align 4, !dbg !545990"}, {"instr_func": "uapi_get_method", "instr_loc": 213, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %34 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %31, i64 %33, !dbg !545988"}], "at_file": "drivers/infiniband/core/rdma_core.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_method"}, "warn_no": 2}]},
{"num_warnings": 9,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 692, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}],
"warnings":[{"warn_data": {"at_line": 602, "warn_str": "Trying to read from a user pointer.", "at": "if (method_elm->is_ex) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 602, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}, {"instr_func": "verify_hdr", "instr_loc": 602, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (method_elm->is_ex) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 1},
{"warn_data": {"at_line": 636, "warn_str": "Trying to read from a user pointer.", "at": "if (count < method_elm->req_size + sizeof(hdr)) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 2},
{"warn_data": {"at_line": 636, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (count < method_elm->req_size + sizeof(hdr)) {", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}, {"instr_func": "verify_hdr", "instr_loc": 636, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (count < method_elm->req_size + sizeof(hdr)) {"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 3},
{"warn_data": {"at_line": 651, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->out_words * 4 < method_elm->resp_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 651, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 4 < method_elm->resp_size)"}, {"instr_func": "verify_hdr", "instr_loc": 651, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 4 < method_elm->resp_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 4},
{"warn_data": {"at_line": 603, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count -= sizeof(*hdr) + sizeof(*ex_hdr);", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": -1, "instr": "  %5 = alloca i8*, align 8"}, {"instr_func": "ib_uverbs_write", "instr_loc": 659, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 603, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "count -= sizeof(*hdr) + sizeof(*ex_hdr);"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 5},
{"warn_data": {"at_line": 605, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if ((hdr->in_words + ex_hdr->provider_in_words) * 8 != count)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 605, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if ((hdr->in_words + ex_hdr->provider_in_words) * 8 != count)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 6},
{"warn_data": {"at_line": 608, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->in_words * 8 < method_elm->req_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 608, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->in_words * 8 < method_elm->req_size)"}, {"instr_func": "verify_hdr", "instr_loc": 608, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->in_words * 8 < method_elm->req_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 7},
{"warn_data": {"at_line": 618, "warn_str": "Trying to read from a user pointer.", "at": "if (hdr->out_words * 8 < method_elm->resp_size)", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "uapi_get_method", "instr_loc": 203, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %1, i32* %5, align 4"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %7 = load i32, i32* %5, align 4, !dbg !545967"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %8 = and i32 %7, 255, !dbg !545968"}, {"instr_func": "uapi_get_method", "instr_loc": 204, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store i32 %8, i32* %6, align 4, !dbg !545966"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %49 = load i32, i32* %6, align 4, !dbg !546002"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %51 = getelementptr %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %48, i64 %50, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %52 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %51, align 8, !dbg !546000"}, {"instr_func": "uapi_get_method", "instr_loc": 218, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  store %struct.uverbs_api_write_method.29463* %52, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546003"}, {"instr_func": "uapi_get_method", "instr_loc": 219, "instr_file": "drivers/infiniband/core/rdma_core.h", "instr": "  %54 = load %struct.uverbs_api_write_method.29463*, %struct.uverbs_api_write_method.29463** %3, align 8, !dbg !546004"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 681, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "method_elm = uapi_get_method(uapi, hdr.command);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "ib_uverbs_write", "instr_loc": 692, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"instr_func": "verify_hdr", "instr_loc": 601, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "{"}, {"instr_func": "verify_hdr", "instr_loc": 618, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 8 < method_elm->resp_size)"}, {"instr_func": "verify_hdr", "instr_loc": 618, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (hdr->out_words * 8 < method_elm->resp_size)"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "verify_hdr"}, "warn_no": 8},
{"warn_data": {"at_line": 621, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}], "at_file": "drivers/infiniband/core/uverbs_main.c", "by": "IntegerOverflowDetector says:", "at_func": "verify_hdr"}, "warn_no": 9}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %5 = alloca i8*, align 8"}, {"lineno": 692, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "ret = verify_hdr(&hdr, &ex_hdr, count, method_elm);"}, {"lineno": 621, "file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !545973", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !545972"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !545970", "inst_trace": [{"instr_func": "ib_uverbs_write", "instr_loc": 678, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (copy_from_user(&hdr, buf, sizeof(hdr)))"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "verify_hdr", "instr_loc": 621, "instr_file": "drivers/infiniband/core/uverbs_main.c", "instr": "if (!access_ok(u64_to_user_ptr(ex_hdr->response),"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !545970"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]}]}