{"all_contexts":[
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 1728, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "features = VHOST_NET_BACKEND_FEATURES;", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1733, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&features, featurep, sizeof(features)))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1722, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&features, featurep, sizeof features))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1717, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "features = VHOST_NET_FEATURES;", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1713, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&backend, argp, sizeof backend))", "inst_trace": [], "at_file": "drivers/vhost/net.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_net_ioctl"}, "warn_no": 5}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}],
"warnings":[{"warn_data": {"at_line": 1531, "warn_str": "Trying to read from a user pointer.", "at": "oldsock = vq->private_data;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 1},
{"warn_data": {"at_line": 1541, "warn_str": "Trying to write to a user pointer.", "at": "vq->private_data = sock;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1541, "instr_file": "drivers/vhost/net.c", "instr": "vq->private_data = sock;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1541, "instr_file": "drivers/vhost/net.c", "instr": "vq->private_data = sock;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 2},
{"warn_data": {"at_line": 1550, "warn_str": "Trying to write to a user pointer.", "at": "nvq->rx_ring = get_tap_ptr_ring(fd);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1550, "instr_file": "drivers/vhost/net.c", "instr": "nvq->rx_ring = get_tap_ptr_ring(fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1550, "instr_file": "drivers/vhost/net.c", "instr": "nvq->rx_ring = get_tap_ptr_ring(fd);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 3},
{"warn_data": {"at_line": 1552, "warn_str": "Trying to read from a user pointer.", "at": "oldubufs = nvq->ubufs;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 4},
{"warn_data": {"at_line": 1553, "warn_str": "Trying to write to a user pointer.", "at": "nvq->ubufs = ubufs;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1553, "instr_file": "drivers/vhost/net.c", "instr": "nvq->ubufs = ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1553, "instr_file": "drivers/vhost/net.c", "instr": "nvq->ubufs = ubufs;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 5},
{"warn_data": {"at_line": 1571, "warn_str": "Trying to read from a user pointer.", "at": "sockfd_put(oldsock);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1531, "instr_file": "drivers/vhost/net.c", "instr": "oldsock = vq->private_data;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1571, "instr_file": "drivers/vhost/net.c", "instr": "sockfd_put(oldsock);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1571, "instr_file": "drivers/vhost/net.c", "instr": "sockfd_put(oldsock);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 6},
{"warn_data": {"at_line": 1578, "warn_str": "Trying to write to a user pointer.", "at": "vq->private_data = oldsock;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1578, "instr_file": "drivers/vhost/net.c", "instr": "vq->private_data = oldsock;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1578, "instr_file": "drivers/vhost/net.c", "instr": "vq->private_data = oldsock;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_set_backend"}, "warn_no": 7}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}],
"warnings":[{"warn_data": {"at_line": 1394, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq_log_access_ok(vq, vq->log_base))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 1401, "warn_str": "Trying to read from a user pointer.", "at": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 1398, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->iotlb)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1398, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->iotlb)"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1398, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->iotlb)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 1401, "warn_str": "Trying to read from a user pointer.", "at": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 4},
{"warn_data": {"at_line": 1401, "warn_str": "Trying to read from a user pointer.", "at": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 5},
{"warn_data": {"at_line": 1401, "warn_str": "Trying to read from a user pointer.", "at": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_access_ok"}, "warn_no": 6}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}],
"warnings":[{"warn_data": {"at_line": 1384, "warn_str": "Trying to read from a user pointer.", "at": "return vq_memory_access_ok(log_base, vq->umem,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_log_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 1386, "warn_str": "Trying to read from a user pointer.", "at": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_log_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 1386, "warn_str": "Trying to read from a user pointer.", "at": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_log_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 1387, "warn_str": "Trying to read from a user pointer.", "at": "vhost_get_used_size(vq, vq->num)));", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_log_access_ok"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1385, "file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VHOST_F_LOG_ALL)) &&"}],
"warnings":[{"warn_data": {"at_line": 248, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i64, i64* %6, align 8, !dbg !87619", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1385, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VHOST_F_LOG_ALL)) &&"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1385, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VHOST_F_LOG_ALL)) &&"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 247, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %5, i32 0, i32 28, !dbg !87619"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_has_feature.1016"}, "warn_no": 1}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}],
"warnings":[{"warn_data": {"at_line": 720, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(node, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 720, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(node, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 731, "warn_str": "Trying to read from a user pointer.", "at": "node->start,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 732, "warn_str": "Trying to read from a user pointer.", "at": "node->size))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 4},
{"warn_data": {"at_line": 727, "warn_str": "Trying to read from a user pointer.", "at": "if (!access_ok((void __user *)a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 5},
{"warn_data": {"at_line": 721, "warn_str": "Trying to read from a user pointer.", "at": "unsigned long a = node->userspace_addr;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 6},
{"warn_data": {"at_line": 723, "warn_str": "Trying to read from a user pointer.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 7},
{"warn_data": {"at_line": 723, "warn_str": "Trying to read from a user pointer.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 8},
{"warn_data": {"at_line": 720, "warn_str": "Loop is bounded by a tainted value.", "at": "list_for_each_entry(node, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 9},
{"warn_data": {"at_line": 727, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!access_ok((void __user *)a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %24 = add i64 %23, %22, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %24, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %35 = load i64, i64* %5, align 8, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %37 = icmp ugt i64 %35, %36, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %38 = xor i1 %37, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %39 = xor i1 %38, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %40 = zext i1 %39 to i32, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %42 = icmp ne i64 %41, 0, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i1 %42, i1* %4, align 1, !dbg !87633"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 60, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %44 = load i1, i1* %4, align 1, !dbg !87634"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 10},
{"warn_data": {"at_line": 723, "warn_str": "Loop is bounded by a tainted value.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vhost_overflow", "instr_loc": 706, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 11}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 730, "file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}],
"warnings":[{"warn_data": {"at_line": 697, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (a > ULONG_MAX - (unsigned long)log_base ||", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 697, "instr_file": "drivers/vhost/vhost.c", "instr": "if (a > ULONG_MAX - (unsigned long)log_base ||"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "a + (unsigned long)log_base > ULONG_MAX)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 698, "instr_file": "drivers/vhost/vhost.c", "instr": "a + (unsigned long)log_base > ULONG_MAX)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 727, "file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 723, "file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}],
"warnings":[{"warn_data": {"at_line": 708, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vhost_overflow", "instr_loc": 706, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_overflow"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1387, "file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}],
"warnings":[{"warn_data": {"at_line": 446, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sizeof(*vq->used->ring) * num + event;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_used_size"}, "warn_no": 1},
{"warn_data": {"at_line": 445, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return sizeof(*vq->used) +", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_used_size"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1387, "file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"lineno": 443, "file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}],
"warnings":[{"warn_data": {"at_line": 248, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i64, i64* %6, align 8, !dbg !87619", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 443, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 443, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 247, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %5, i32 0, i32 28, !dbg !87619"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_has_feature.1016"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1386, "file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}],
"warnings":[{"warn_data": {"at_line": 697, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (a > ULONG_MAX - (unsigned long)log_base ||", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 697, "instr_file": "drivers/vhost/vhost.c", "instr": "if (a > ULONG_MAX - (unsigned long)log_base ||"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "a + (unsigned long)log_base > ULONG_MAX)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 698, "instr_file": "drivers/vhost/vhost.c", "instr": "a + (unsigned long)log_base > ULONG_MAX)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1394, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"lineno": 1386, "file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"lineno": 701, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1394, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_log_access_ok(vq, vq->log_base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1387, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_get_used_size(vq, vq->num)));"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1302, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 451, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 452, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->desc) * num;"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 452, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->desc) * num;"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 451, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 452, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->desc) * num;"}, {"instr_func": "vhost_get_desc_size", "instr_loc": 452, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->desc) * num;"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1303, "file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}],
"warnings":[{"warn_data": {"at_line": 436, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sizeof(*vq->avail->ring) * num + event;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 431, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 435, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->avail) +"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_avail_size"}, "warn_no": 1},
{"warn_data": {"at_line": 435, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return sizeof(*vq->avail) +", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 431, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_avail_size"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1303, "file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"lineno": 433, "file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}],
"warnings":[{"warn_data": {"at_line": 248, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i64, i64* %6, align 8, !dbg !87619", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 431, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 433, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 433, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 247, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %5, i32 0, i32 28, !dbg !87619"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_has_feature.1016"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1303, "file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 431, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 435, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->avail) +"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 431, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 435, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->avail) +"}, {"instr_func": "vhost_get_avail_size", "instr_loc": 436, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->avail->ring) * num + event;"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1304, "file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}],
"warnings":[{"warn_data": {"at_line": 446, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "sizeof(*vq->used->ring) * num + event;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_used_size"}, "warn_no": 1},
{"warn_data": {"at_line": 445, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return sizeof(*vq->used) +", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_get_used_size"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1304, "file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"lineno": 443, "file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}],
"warnings":[{"warn_data": {"at_line": 248, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i64, i64* %6, align 8, !dbg !87619", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 443, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 443, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_has_feature(vq, VIRTIO_RING_F_EVENT_IDX) ? 2 : 0;"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 247, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %5, i32 0, i32 28, !dbg !87619"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_has_feature.1016"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1520, "file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"lineno": 1401, "file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"lineno": 1304, "file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1520, "instr_file": "drivers/vhost/net.c", "instr": "if (!vhost_vq_access_ok(vq)) {"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1393, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vhost_vq_access_ok", "instr_loc": 1401, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_access_ok(vq, vq->num, vq->desc, vq->avail, vq->used);"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vhost_get_used_size", "instr_loc": 441, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vhost_get_used_size", "instr_loc": 445, "instr_file": "drivers/vhost/vhost.c", "instr": "return sizeof(*vq->used) +"}, {"instr_func": "vhost_get_used_size", "instr_loc": 446, "instr_file": "drivers/vhost/vhost.c", "instr": "sizeof(*vq->used->ring) * num + event;"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1540, "file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 426, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 423, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_disable_vq"}, "warn_no": 1},
{"warn_data": {"at_line": 427, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq->private_data)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 423, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 427, "instr_file": "drivers/vhost/net.c", "instr": "if (!vq->private_data)"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 427, "instr_file": "drivers/vhost/net.c", "instr": "if (!vq->private_data)"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_disable_vq"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1540, "file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"lineno": 429, "file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}],
"warnings":[{"warn_data": {"at_line": 226, "warn_str": "Trying to read from a user pointer.", "at": "if (poll->wqh) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 423, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 1},
{"warn_data": {"at_line": 227, "warn_str": "Trying to read from a user pointer.", "at": "remove_wait_queue(poll->wqh, &poll->wait);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 423, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 2},
{"warn_data": {"at_line": 228, "warn_str": "Trying to write to a user pointer.", "at": "poll->wqh = NULL;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1540, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_disable_vq(n, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 423, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 425, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 424, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 426, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_net_disable_vq", "instr_loc": 429, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 3}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}],
"warnings":[{"warn_data": {"at_line": 190, "warn_str": "Trying to read from a user pointer.", "at": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 1},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 2},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 3},
{"warn_data": {"at_line": 191, "warn_str": "Trying to read from a user pointer.", "at": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 4},
{"warn_data": {"at_line": 194, "warn_str": "Trying to write to a user pointer.", "at": "rxq->head = rxq->tail = 0;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 5},
{"warn_data": {"at_line": 194, "warn_str": "Trying to write to a user pointer.", "at": "rxq->head = rxq->tail = 0;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 194, "instr_file": "drivers/vhost/net.c", "instr": "rxq->head = rxq->tail = 0;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_unproduce"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 190, "file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}],
"warnings":[{"warn_data": {"at_line": 166, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail == rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 165, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_is_empty"}, "warn_no": 1},
{"warn_data": {"at_line": 166, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail == rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 190, "instr_file": "drivers/vhost/net.c", "instr": "if (nvq->rx_ring && !vhost_net_buf_is_empty(rxq)) {"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 165, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}, {"instr_func": "vhost_net_buf_is_empty", "instr_loc": 166, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail == rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_is_empty"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 192, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}],
"warnings":[{"warn_data": {"at_line": 161, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 1},
{"warn_data": {"at_line": 161, "warn_str": "Trying to read from a user pointer.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 2},
{"warn_data": {"at_line": 161, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return rxq->tail - rxq->head;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_buf_get_size"}, "warn_no": 3}]},
{"num_warnings": 30,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1542, "file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"lineno": 191, "file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}],
"warnings":[{"warn_data": {"at_line": 519, "warn_str": "Trying to read from a user pointer.", "at": "  %47 = load i32, i32* %46, align 64, !dbg !87688", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 519, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %45 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87686"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 519, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %46 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %45, i32 0, i32 7, !dbg !87688"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 1},
{"warn_data": {"at_line": 526, "warn_str": "Trying to read from a user pointer.", "at": "  %53 = load i32, i32* %52, align 64, !dbg !87692", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %51 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87691"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %52 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %51, i32 0, i32 3, !dbg !87692"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 2},
{"warn_data": {"at_line": 526, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %54 = sub i32 %53, 1, !dbg !87693", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %51 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87691"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %52 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %51, i32 0, i32 3, !dbg !87692"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 3},
{"warn_data": {"at_line": 528, "warn_str": "Trying to read from a user pointer.", "at": "  %69 = load i8**, i8*** %68, align 8, !dbg !87698", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %67 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87697"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %68 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %67, i32 0, i32 9, !dbg !87698"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 4},
{"warn_data": {"at_line": 528, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %71 = add i32 %70, -1, !dbg !87699", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %51 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87691"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %52 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %51, i32 0, i32 3, !dbg !87692"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %54 = sub i32 %53, 1, !dbg !87693"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %54, i32* %21, align 4, !dbg !87694"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %70 = load i32, i32* %21, align 4, !dbg !87699"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 5},
{"warn_data": {"at_line": 528, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* null, i8** %73, align 8, !dbg !87700", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %67 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87697"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %68 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %67, i32 0, i32 9, !dbg !87698"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 528, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %73 = getelementptr i8*, i8** %69, i64 %72, !dbg !87697"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 6},
{"warn_data": {"at_line": 527, "warn_str": "Trying to read from a user pointer.", "at": "  %59 = load i32, i32* %58, align 4, !dbg !87696", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %57 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %58 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %57, i32 0, i32 4, !dbg !87696"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 7},
{"warn_data": {"at_line": 527, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %65, label %66, label %74, !dbg !87695", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %51 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87691"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %52 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %51, i32 0, i32 3, !dbg !87692"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %54 = sub i32 %53, 1, !dbg !87693"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 526, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %54, i32* %21, align 4, !dbg !87694"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %56 = load i32, i32* %21, align 4, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %60 = icmp sge i32 %56, %59, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %61 = xor i1 %60, true, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %62 = xor i1 %61, true, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %63 = zext i1 %62 to i32, !dbg !87696"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 527, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %65 = icmp ne i64 %64, 0, !dbg !87695"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 8},
{"warn_data": {"at_line": 529, "warn_str": "Trying to read from a user pointer.", "at": "  %77 = load i32, i32* %76, align 64, !dbg !87704", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %75 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87703"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %76 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %75, i32 0, i32 3, !dbg !87704"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 9},
{"warn_data": {"at_line": 529, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %77, i32* %79, align 4, !dbg !87707", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %78 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87705"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 529, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %79 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %78, i32 0, i32 4, !dbg !87706"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 10},
{"warn_data": {"at_line": 543, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %109 = add i32 %108, -1, !dbg !87731", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %18, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %108 = load i32, i32* %18, align 4, !dbg !87731"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 11},
{"warn_data": {"at_line": 543, "warn_str": "Trying to read from a user pointer.", "at": "  %112 = load i8*, i8** %111, align 8, !dbg !87730", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8** %1, i8*** %17, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %107 = load i8**, i8*** %17, align 8, !dbg !87730"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %111 = getelementptr i8*, i8** %107, i64 %110, !dbg !87730"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 12},
{"warn_data": {"at_line": 543, "warn_str": "Trying to read from a user pointer.", "at": "  %115 = load i8**, i8*** %114, align 8, !dbg !87733", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %113 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87732"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %114 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %113, i32 0, i32 9, !dbg !87733"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 13},
{"warn_data": {"at_line": 543, "warn_str": "Trying to write to a user pointer.", "at": "  store i8* %112, i8** %118, align 8, !dbg !87735", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %113 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87732"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %114 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %113, i32 0, i32 9, !dbg !87733"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %118 = getelementptr i8*, i8** %115, i64 %117, !dbg !87732"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 14},
{"warn_data": {"at_line": 544, "warn_str": "Trying to write to a user pointer.", "at": "  store i32 %119, i32* %121, align 4, !dbg !87739", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %120 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87737"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 544, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %121 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %120, i32 0, i32 4, !dbg !87738"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 15},
{"warn_data": {"at_line": 539, "warn_str": "Trying to read from a user pointer.", "at": "  %99 = load i8**, i8*** %98, align 8, !dbg !87725", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %97 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87723"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %98 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %97, i32 0, i32 9, !dbg !87725"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 16},
{"warn_data": {"at_line": 539, "warn_str": "Trying to read from a user pointer.", "at": "  %103 = load i8*, i8** %102, align 8, !dbg !87723", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %97 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87723"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %98 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %97, i32 0, i32 9, !dbg !87725"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %102 = getelementptr i8*, i8** %99, i64 %101, !dbg !87723"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 17},
{"warn_data": {"at_line": 539, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %104, label %105, label %106, !dbg !87727", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %97 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87723"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %98 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %97, i32 0, i32 9, !dbg !87725"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %102 = getelementptr i8*, i8** %99, i64 %101, !dbg !87723"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 539, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %104 = icmp ne i8* %103, null, !dbg !87723"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 18},
{"warn_data": {"at_line": 538, "warn_str": "Trying to read from a user pointer.", "at": "  %94 = load i32, i32* %93, align 64, !dbg !87719", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 538, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %92 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87718"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 538, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %93 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %92, i32 0, i32 7, !dbg !87719"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 19},
{"warn_data": {"at_line": 538, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %95 = sub i32 %94, 1, !dbg !87720", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 538, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %92 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87718"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 538, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %93 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %92, i32 0, i32 7, !dbg !87719"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 20},
{"warn_data": {"at_line": 536, "warn_str": "Trying to read from a user pointer.", "at": "  %86 = load i32, i32* %85, align 64, !dbg !87711", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %84 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87710"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %85 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %84, i32 0, i32 3, !dbg !87711"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 21},
{"warn_data": {"at_line": 536, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %87 = sub i32 %86, 1, !dbg !87712", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %84 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87710"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 536, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %85 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %84, i32 0, i32 3, !dbg !87711"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 22},
{"warn_data": {"at_line": 535, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %82, label %83, label %163, !dbg !87708", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %18, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 535, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %81 = load i32, i32* %18, align 4, !dbg !87709"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 535, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %82 = icmp ne i32 %81, 0, !dbg !87708"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 23},
{"warn_data": {"at_line": 543, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i64 %151, i64* %153, align 8, !dbg !87774", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %125 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %126 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %125, i32 0, i32 3, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %127 = bitcast i32* %126 to i8*, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8* %127, i8** %6, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %152 = load i8*, i8** %6, align 8, !dbg !87772"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 24},
{"warn_data": {"at_line": 543, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i32 %145, i32* %147, align 4, !dbg !87767", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %125 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %126 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %125, i32 0, i32 3, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %127 = bitcast i32* %126 to i8*, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8* %127, i8** %6, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %146 = load i8*, i8** %6, align 8, !dbg !87765"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 25},
{"warn_data": {"at_line": 543, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i16 %139, i16* %141, align 2, !dbg !87760", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %125 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %126 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %125, i32 0, i32 3, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %127 = bitcast i32* %126 to i8*, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8* %127, i8** %6, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %140 = load i8*, i8** %6, align 8, !dbg !87758"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 26},
{"warn_data": {"at_line": 543, "warn_str": "Trying to write to a user pointer.", "at": "  store volatile i8 %134, i8* %135, align 1, !dbg !87753", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store %struct.ptr_ring* %0, %struct.ptr_ring** %16, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %125 = load %struct.ptr_ring*, %struct.ptr_ring** %16, align 8, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %126 = getelementptr inbounds %struct.ptr_ring, %struct.ptr_ring* %125, i32 0, i32 3, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 546, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %127 = bitcast i32* %126 to i8*, !dbg !87746"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8* %127, i8** %6, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %135 = load i8*, i8** %6, align 8, !dbg !87752"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 27},
{"warn_data": {"at_line": 552, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %172 = add i32 %171, -1, !dbg !87793", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %18, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 552, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %171 = load i32, i32* %18, align 4, !dbg !87793"}], "at_file": "./include/linux/ptr_ring.h", "by": "IntegerOverflowDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 28},
{"warn_data": {"at_line": 552, "warn_str": "Trying to read from a user pointer.", "at": "  %175 = load i8*, i8** %174, align 8, !dbg !87792", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i8** %1, i8*** %17, align 8"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 552, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %170 = load i8**, i8*** %17, align 8, !dbg !87792"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 552, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %174 = getelementptr i8*, i8** %170, i64 %173, !dbg !87792"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 29},
{"warn_data": {"at_line": 551, "warn_str": "Loop is bounded by a tainted value.", "at": "  br i1 %167, label %168, label %176, !dbg !87789", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1542, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_unproduce(nvq);"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 187, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 188, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_buf *rxq = &nvq->rxq;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 160, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_get_size", "instr_loc": 161, "instr_file": "drivers/vhost/net.c", "instr": "return rxq->tail - rxq->head;"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 192, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_buf_get_size(rxq),"}, {"instr_func": "vhost_net_buf_unproduce", "instr_loc": 191, "instr_file": "drivers/vhost/net.c", "instr": "ptr_ring_unconsume(nvq->rx_ring, rxq->queue + rxq->head,"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 512, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %2, i32* %18, align 4"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %108 = load i32, i32* %18, align 4, !dbg !87731"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %109 = add i32 %108, -1, !dbg !87731"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 543, "instr_file": "./include/linux/ptr_ring.h", "instr": "  store i32 %109, i32* %18, align 4, !dbg !87731"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 551, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %166 = load i32, i32* %18, align 4, !dbg !87790"}, {"instr_func": "ptr_ring_unconsume", "instr_loc": 551, "instr_file": "./include/linux/ptr_ring.h", "instr": "  %167 = icmp ne i32 %166, 0, !dbg !87789"}], "at_file": "./include/linux/ptr_ring.h", "by": "TaintedLoopBoundDetector says:", "at_func": "ptr_ring_unconsume"}, "warn_no": 30}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}],
"warnings":[{"warn_data": {"at_line": 1772, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&p, argp, sizeof p)) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_dev_ioctl"}, "warn_no": 1}]},
{"num_warnings": 10,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}],
"warnings":[{"warn_data": {"at_line": 2009, "warn_str": "Trying to read from a user pointer.", "at": "bool is_le = vq->is_le;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2009, "instr_file": "drivers/vhost/vhost.c", "instr": "bool is_le = vq->is_le;"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2009, "instr_file": "drivers/vhost/vhost.c", "instr": "bool is_le = vq->is_le;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 1},
{"warn_data": {"at_line": 2019, "warn_str": "Trying to write to a user pointer.", "at": "vq->signalled_used_valid = false;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2019, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2019, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 2},
{"warn_data": {"at_line": 2011, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq->private_data)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2011, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->private_data)"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2011, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->private_data)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 3},
{"warn_data": {"at_line": 2020, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq->iotlb &&", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2020, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb &&"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2020, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb &&"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 4},
{"warn_data": {"at_line": 2027, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Can't access used idx at %p\\n\",", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 5},
{"warn_data": {"at_line": 2021, "warn_str": "Trying to read from a user pointer.", "at": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 6},
{"warn_data": {"at_line": 2031, "warn_str": "Trying to write to a user pointer.", "at": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2031, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2031, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 7},
{"warn_data": {"at_line": 2027, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Can't access used idx at %p\\n\",", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 8},
{"warn_data": {"at_line": 2027, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Can't access used idx at %p\\n\",", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2027, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Can't access used idx at %p\\n\","}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 9},
{"warn_data": {"at_line": 2035, "warn_str": "Trying to write to a user pointer.", "at": "vq->is_le = is_le;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2035, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = is_le;"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2035, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = is_le;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_init_access"}, "warn_no": 10}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2014, "file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}],
"warnings":[{"warn_data": {"at_line": 115, "warn_str": "Trying to read from a user pointer.", "at": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_init_is_le", "instr_loc": 109, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_init_is_le"}, "warn_no": 1},
{"warn_data": {"at_line": 115, "warn_str": "Trying to write to a user pointer.", "at": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_init_is_le", "instr_loc": 109, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_init_is_le"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2014, "file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"lineno": 115, "file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}],
"warnings":[{"warn_data": {"at_line": 248, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i64, i64* %6, align 8, !dbg !87619", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2014, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_init_is_le(vq);"}, {"instr_func": "vhost_init_is_le", "instr_loc": 109, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}, {"instr_func": "vhost_init_is_le", "instr_loc": 115, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->is_le = vhost_has_feature(vq, VIRTIO_F_VERSION_1) || !vq->user_be;"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 247, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost_has_feature.1016", "instr_loc": 248, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %5, i32 0, i32 28, !dbg !87619"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_has_feature.1016"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}],
"warnings":[{"warn_data": {"at_line": 1974, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(vq->log_used)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1974, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1974, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_update_used_flags"}, "warn_no": 1},
{"warn_data": {"at_line": 1978, "warn_str": "Trying to read from a user pointer.", "at": "used = &vq->used->flags;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_update_used_flags"}, "warn_no": 2},
{"warn_data": {"at_line": 1979, "warn_str": "Trying to read from a user pointer.", "at": "log_used(vq, (used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_update_used_flags"}, "warn_no": 3},
{"warn_data": {"at_line": 1979, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "log_used(vq, (used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_update_used_flags"}, "warn_no": 4},
{"warn_data": {"at_line": 1981, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->log_ctx)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1981, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->log_ctx)"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1981, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->log_ctx)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_update_used_flags"}, "warn_no": 5},
{"warn_data": {"at_line": 1982, "warn_str": "Trying to read from a user pointer.", "at": "eventfd_signal(vq->log_ctx, 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1982, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->log_ctx, 1);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1982, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->log_ctx, 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_update_used_flags"}, "warn_no": 6}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"lineno": 1972, "file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}],
"warnings":[{"warn_data": {"at_line": 931, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 930, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_flags"}, "warn_no": 1},
{"warn_data": {"at_line": 931, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 930, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_flags"}, "warn_no": 2},
{"warn_data": {"at_line": 931, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 930, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_flags"}, "warn_no": 3},
{"warn_data": {"at_line": 931, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 930, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_flags"}, "warn_no": 4},
{"warn_data": {"at_line": 931, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1972, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_flags(vq))"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 930, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}, {"instr_func": "vhost_put_used_flags", "instr_loc": 931, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->used_flags),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_flags"}, "warn_no": 5}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"lineno": 1979, "file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}],
"warnings":[{"warn_data": {"at_line": 1915, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq->iotlb)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1915, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb)"}, {"instr_func": "log_used", "instr_loc": 1915, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 1},
{"warn_data": {"at_line": 1916, "warn_str": "Trying to read from a user pointer.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 2},
{"warn_data": {"at_line": 1916, "warn_str": "Trying to read from a user pointer.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 3},
{"warn_data": {"at_line": 1916, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_used"}, "warn_no": 4},
{"warn_data": {"at_line": 1918, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_used"}, "warn_no": 5},
{"warn_data": {"at_line": 1918, "warn_str": "Trying to read from a user pointer.", "at": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 6}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"lineno": 1979, "file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"lineno": 1916, "file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}],
"warnings":[{"warn_data": {"at_line": 1852, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "write_length += write_address % VHOST_PAGE_SIZE;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write"}, "warn_no": 1},
{"warn_data": {"at_line": 1864, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "write_length -= VHOST_PAGE_SIZE;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1864, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length -= VHOST_PAGE_SIZE;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write"}, "warn_no": 2},
{"warn_data": {"at_line": 1865, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "write_page += 1;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1847, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 write_page = write_address / VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1847, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 write_page = write_address / VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1847, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 write_page = write_address / VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1865, "instr_file": "drivers/vhost/vhost.c", "instr": "write_page += 1;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write"}, "warn_no": 3},
{"warn_data": {"at_line": 1862, "warn_str": "Loop is bounded by a tainted value.", "at": "if (write_length <= VHOST_PAGE_SIZE)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1852, "instr_file": "drivers/vhost/vhost.c", "instr": "write_length += write_address % VHOST_PAGE_SIZE;"}, {"instr_func": "log_write", "instr_loc": 1862, "instr_file": "drivers/vhost/vhost.c", "instr": "if (write_length <= VHOST_PAGE_SIZE)"}, {"instr_func": "log_write", "instr_loc": 1862, "instr_file": "drivers/vhost/vhost.c", "instr": "if (write_length <= VHOST_PAGE_SIZE)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "log_write"}, "warn_no": 4},
{"warn_data": {"at_line": 1855, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u64 log = base + write_page / 8;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1855, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 log = base + write_page / 8;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write"}, "warn_no": 5},
{"warn_data": {"at_line": 1857, "warn_str": "Loop is bounded by a tainted value.", "at": "if ((u64)(unsigned long)log != log)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_write", "instr_loc": 1846, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1854, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 base = (u64)(unsigned long)log_base;"}, {"instr_func": "log_write", "instr_loc": 1855, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 log = base + write_page / 8;"}, {"instr_func": "log_write", "instr_loc": 1855, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 log = base + write_page / 8;"}, {"instr_func": "log_write", "instr_loc": 1855, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 log = base + write_page / 8;"}, {"instr_func": "log_write", "instr_loc": 1857, "instr_file": "drivers/vhost/vhost.c", "instr": "if ((u64)(unsigned long)log != log)"}, {"instr_func": "log_write", "instr_loc": 1857, "instr_file": "drivers/vhost/vhost.c", "instr": "if ((u64)(unsigned long)log != log)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "log_write"}, "warn_no": 6}]},
{"num_warnings": 16,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"lineno": 1979, "file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"lineno": 1918, "file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}],
"warnings":[{"warn_data": {"at_line": 2044, "warn_str": "Trying to read from a user pointer.", "at": "struct vhost_dev *dev = vq->dev;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "translate_desc"}, "warn_no": 1},
{"warn_data": {"at_line": 2045, "warn_str": "Trying to read from a user pointer.", "at": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "translate_desc"}, "warn_no": 2},
{"warn_data": {"at_line": 2045, "warn_str": "Trying to read from a user pointer.", "at": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "translate_desc"}, "warn_no": 3},
{"warn_data": {"at_line": 2045, "warn_str": "Trying to read from a user pointer.", "at": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}, {"instr_func": "translate_desc", "instr_loc": 2045, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = dev->iotlb ? dev->iotlb : dev->umem;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "translate_desc"}, "warn_no": 4},
{"warn_data": {"at_line": 2075, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2075, "instr_file": "drivers/vhost/vhost.c", "instr": "(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 5},
{"warn_data": {"at_line": 2075, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2075, "instr_file": "drivers/vhost/vhost.c", "instr": "(node->userspace_addr + addr - node->start);"}, {"instr_func": "translate_desc", "instr_loc": 2075, "instr_file": "drivers/vhost/vhost.c", "instr": "(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 6},
{"warn_data": {"at_line": 2077, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "addr += size;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2077, "instr_file": "drivers/vhost/vhost.c", "instr": "addr += size;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 7},
{"warn_data": {"at_line": 2072, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = node->size - addr + node->start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 8},
{"warn_data": {"at_line": 2072, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "size = node->size - addr + node->start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 9},
{"warn_data": {"at_line": 2059, "warn_str": "Loop is bounded by a tainted value.", "at": "if (node == NULL || node->start > addr) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2059, "instr_file": "drivers/vhost/vhost.c", "instr": "if (node == NULL || node->start > addr) {"}, {"instr_func": "translate_desc", "instr_loc": 2059, "instr_file": "drivers/vhost/vhost.c", "instr": "if (node == NULL || node->start > addr) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "translate_desc"}, "warn_no": 10},
{"warn_data": {"at_line": 2058, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "addr, addr + len - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2058, "instr_file": "drivers/vhost/vhost.c", "instr": "addr, addr + len - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 11},
{"warn_data": {"at_line": 2058, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "addr, addr + len - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2058, "instr_file": "drivers/vhost/vhost.c", "instr": "addr, addr + len - 1);"}, {"instr_func": "translate_desc", "instr_loc": 2058, "instr_file": "drivers/vhost/vhost.c", "instr": "addr, addr + len - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 12},
{"warn_data": {"at_line": 2076, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "s += size;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1978, "instr_file": "drivers/vhost/vhost.c", "instr": "used = &vq->used->flags;"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 13},
{"warn_data": {"at_line": 2073, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "_iov->iov_len = min((u64)len - s, size);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2077, "instr_file": "drivers/vhost/vhost.c", "instr": "addr += size;"}, {"instr_func": "translate_desc", "instr_loc": 2077, "instr_file": "drivers/vhost/vhost.c", "instr": "addr += size;"}, {"instr_func": "translate_desc", "instr_loc": 2077, "instr_file": "drivers/vhost/vhost.c", "instr": "addr += size;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2073, "instr_file": "drivers/vhost/vhost.c", "instr": "_iov->iov_len = min((u64)len - s, size);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "translate_desc"}, "warn_no": 14},
{"warn_data": {"at_line": 2050, "warn_str": "Loop is bounded by a tainted value.", "at": "while ((u64)len > s) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2072, "instr_file": "drivers/vhost/vhost.c", "instr": "size = node->size - addr + node->start;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2076, "instr_file": "drivers/vhost/vhost.c", "instr": "s += size;"}, {"instr_func": "translate_desc", "instr_loc": 2050, "instr_file": "drivers/vhost/vhost.c", "instr": "while ((u64)len > s) {"}, {"instr_func": "translate_desc", "instr_loc": 2050, "instr_file": "drivers/vhost/vhost.c", "instr": "while ((u64)len > s) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "translate_desc"}, "warn_no": 15},
{"warn_data": {"at_line": 2060, "warn_str": "Trying to read from a user pointer.", "at": "if (umem != dev->iotlb) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "translate_desc", "instr_loc": 2042, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2044, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_dev *dev = vq->dev;"}, {"instr_func": "translate_desc", "instr_loc": 2060, "instr_file": "drivers/vhost/vhost.c", "instr": "if (umem != dev->iotlb) {"}, {"instr_func": "translate_desc", "instr_loc": 2060, "instr_file": "drivers/vhost/vhost.c", "instr": "if (umem != dev->iotlb) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "translate_desc"}, "warn_no": 16}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2016, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"lineno": 1979, "file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"lineno": 1924, "file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}],
"warnings":[{"warn_data": {"at_line": 1872, "warn_str": "Trying to read from a user pointer.", "at": "struct vhost_umem *umem = vq->umem;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 1},
{"warn_data": {"at_line": 1891, "warn_str": "Trying to read from a user pointer.", "at": "r = log_write(vq->log_base,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1891, "instr_file": "drivers/vhost/vhost.c", "instr": "r = log_write(vq->log_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1891, "instr_file": "drivers/vhost/vhost.c", "instr": "r = log_write(vq->log_base,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 2},
{"warn_data": {"at_line": 1883, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(u, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 3},
{"warn_data": {"at_line": 1892, "warn_str": "Trying to read from a user pointer.", "at": "u->start + start - u->userspace_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 4},
{"warn_data": {"at_line": 1892, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->start + start - u->userspace_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 5},
{"warn_data": {"at_line": 1892, "warn_str": "Trying to read from a user pointer.", "at": "u->start + start - u->userspace_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 6},
{"warn_data": {"at_line": 1892, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->start + start - u->userspace_addr,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}, {"instr_func": "log_write_hva", "instr_loc": 1892, "instr_file": "drivers/vhost/vhost.c", "instr": "u->start + start - u->userspace_addr,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 7},
{"warn_data": {"at_line": 1888, "warn_str": "Trying to read from a user pointer.", "at": "end = min(u->userspace_addr - 1 + u->size,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 8},
{"warn_data": {"at_line": 1888, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "end = min(u->userspace_addr - 1 + u->size,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 9},
{"warn_data": {"at_line": 1888, "warn_str": "Trying to read from a user pointer.", "at": "end = min(u->userspace_addr - 1 + u->size,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 10},
{"warn_data": {"at_line": 1888, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "end = min(u->userspace_addr - 1 + u->size,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}, {"instr_func": "log_write_hva", "instr_loc": 1888, "instr_file": "drivers/vhost/vhost.c", "instr": "end = min(u->userspace_addr - 1 + u->size,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 11},
{"warn_data": {"at_line": 1887, "warn_str": "Trying to read from a user pointer.", "at": "start = max(u->userspace_addr, hva);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1887, "instr_file": "drivers/vhost/vhost.c", "instr": "start = max(u->userspace_addr, hva);"}, {"instr_func": "log_write_hva", "instr_loc": 1887, "instr_file": "drivers/vhost/vhost.c", "instr": "start = max(u->userspace_addr, hva);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 12},
{"warn_data": {"at_line": 1885, "warn_str": "Trying to read from a user pointer.", "at": "u->userspace_addr - 1 + u->size < hva)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 13},
{"warn_data": {"at_line": 1885, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->userspace_addr - 1 + u->size < hva)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 14},
{"warn_data": {"at_line": 1885, "warn_str": "Trying to read from a user pointer.", "at": "u->userspace_addr - 1 + u->size < hva)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 15},
{"warn_data": {"at_line": 1885, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "u->userspace_addr - 1 + u->size < hva)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}, {"instr_func": "log_write_hva", "instr_loc": 1885, "instr_file": "drivers/vhost/vhost.c", "instr": "u->userspace_addr - 1 + u->size < hva)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_write_hva"}, "warn_no": 16},
{"warn_data": {"at_line": 1883, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(u, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 17},
{"warn_data": {"at_line": 1884, "warn_str": "Trying to read from a user pointer.", "at": "if (u->userspace_addr > hva - 1 + len ||", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2016, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_update_used_flags(vq);"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1970, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "vhost_update_used_flags", "instr_loc": 1979, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, (used - (void __user *)vq->used),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_used", "instr_loc": 1924, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = log_write_hva(vq,\t(uintptr_t)iov[i].iov_base,"}, {"instr_func": "log_write_hva", "instr_loc": 1871, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1872, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_umem *umem = vq->umem;"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1883, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(u, &umem->umem_list, link) {"}, {"instr_func": "log_write_hva", "instr_loc": 1884, "instr_file": "drivers/vhost/vhost.c", "instr": "if (u->userspace_addr > hva - 1 + len ||"}, {"instr_func": "log_write_hva", "instr_loc": 1884, "instr_file": "drivers/vhost/vhost.c", "instr": "if (u->userspace_addr > hva - 1 + len ||"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_write_hva"}, "warn_no": 18}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 437, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 1},
{"warn_data": {"at_line": 440, "warn_str": "Trying to read from a user pointer.", "at": "sock = vq->private_data;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 2},
{"warn_data": {"at_line": 444, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_poll_start(poll, sock->file);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2021, "file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2021, "instr_file": "drivers/vhost/vhost.c", "instr": "!access_ok(&vq->used->idx, sizeof vq->used->idx)) {"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2025, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}],
"warnings":[{"warn_data": {"at_line": 1008, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_get_used(vq, *idx, &vq->used->idx);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_get_used_idx"}, "warn_no": 1},
{"warn_data": {"at_line": 1008, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_get_used(vq, *idx, &vq->used->idx);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_get_used_idx"}, "warn_no": 2},
{"warn_data": {"at_line": 1008, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_get_used(vq, *idx, &vq->used->idx);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_get_used_idx"}, "warn_no": 3}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2025, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"lineno": 1008, "file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"lineno": 889, "file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}],
"warnings":[{"warn_data": {"at_line": 742, "warn_str": "Trying to read from a user pointer.", "at": "const struct vhost_umem_node *node = vq->meta_iotlb[type];", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 741, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_meta_fetch"}, "warn_no": 1},
{"warn_data": {"at_line": 747, "warn_str": "Trying to read from a user pointer.", "at": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 741, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_meta_fetch"}, "warn_no": 2},
{"warn_data": {"at_line": 747, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 741, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_vq_meta_fetch"}, "warn_no": 3},
{"warn_data": {"at_line": 747, "warn_str": "Trying to read from a user pointer.", "at": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 741, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_vq_meta_fetch"}, "warn_no": 4},
{"warn_data": {"at_line": 747, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "__vhost_get_user", "instr_loc": 889, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *uaddr = vhost_vq_meta_fetch(vq,"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 741, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 742, "instr_file": "drivers/vhost/vhost.c", "instr": "const struct vhost_umem_node *node = vq->meta_iotlb[type];"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}, {"instr_func": "vhost_vq_meta_fetch", "instr_loc": 747, "instr_file": "drivers/vhost/vhost.c", "instr": "return (void *)(uintptr_t)(node->userspace_addr + addr - node->start);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_vq_meta_fetch"}, "warn_no": 5}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2025, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"lineno": 1008, "file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"lineno": 894, "file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}],
"warnings":[{"warn_data": {"at_line": 870, "warn_str": "Trying to read from a user pointer.", "at": "if (ret != 1 || vq->iotlb_iov[0].iov_len != size) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 870, "instr_file": "drivers/vhost/vhost.c", "instr": "if (ret != 1 || vq->iotlb_iov[0].iov_len != size) {"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 870, "instr_file": "drivers/vhost/vhost.c", "instr": "if (ret != 1 || vq->iotlb_iov[0].iov_len != size) {"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 870, "instr_file": "drivers/vhost/vhost.c", "instr": "if (ret != 1 || vq->iotlb_iov[0].iov_len != size) {"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 870, "instr_file": "drivers/vhost/vhost.c", "instr": "if (ret != 1 || vq->iotlb_iov[0].iov_len != size) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 1},
{"warn_data": {"at_line": 877, "warn_str": "Trying to read from a user pointer.", "at": "return vq->iotlb_iov[0].iov_base;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 877, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq->iotlb_iov[0].iov_base;"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 877, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq->iotlb_iov[0].iov_base;"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 877, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq->iotlb_iov[0].iov_base;"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 877, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq->iotlb_iov[0].iov_base;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 2},
{"warn_data": {"at_line": 871, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Non atomic userspace memory access: uaddr \"", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 871, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Non atomic userspace memory access: uaddr \""}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 871, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Non atomic userspace memory access: uaddr \""}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 3},
{"warn_data": {"at_line": 871, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Non atomic userspace memory access: uaddr \"", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 871, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Non atomic userspace memory access: uaddr \""}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 871, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Non atomic userspace memory access: uaddr \""}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 4},
{"warn_data": {"at_line": 864, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"IOTLB translation failure: uaddr \"", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 864, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"IOTLB translation failure: uaddr \""}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 864, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"IOTLB translation failure: uaddr \""}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 5},
{"warn_data": {"at_line": 864, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"IOTLB translation failure: uaddr \"", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2025, "instr_file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_used_idx(vq, &last_used_idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1007, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "vhost_get_used_idx", "instr_loc": 1008, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_get_used(vq, *idx, &vq->used->idx);"}, {"instr_func": "__vhost_get_user", "instr_loc": 888, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user", "instr_loc": 894, "instr_file": "drivers/vhost/vhost.c", "instr": "return __vhost_get_user_slow(vq, addr, size, type);"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 857, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 864, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"IOTLB translation failure: uaddr \""}, {"instr_func": "__vhost_get_user_slow", "instr_loc": 864, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"IOTLB translation failure: uaddr \""}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_get_user_slow"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1543, "file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"lineno": 2031, "file": "drivers/vhost/vhost.c", "instr": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);"}, {"lineno": 271, "file": "drivers/vhost/vhost.h", "instr": "  %6 = call zeroext i1 @vhost_is_little_endian.1046(%struct.vhost_virtqueue* %5) #15, !dbg !87619"}],
"warnings":[{"warn_data": {"at_line": 259, "warn_str": "Trying to read from a user pointer.", "at": "  %5 = load i8, i8* %4, align 8, !dbg !87617", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1543, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_vq_init_access(vq);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2006, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2031, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);"}, {"instr_func": "vhost_vq_init_access", "instr_loc": 2031, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);"}, {"instr_func": "vhost16_to_cpu.1053", "instr_loc": 270, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %3, align 8"}, {"instr_func": "vhost16_to_cpu.1053", "instr_loc": 271, "instr_file": "drivers/vhost/vhost.h", "instr": "  %5 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %3, align 8, !dbg !87618"}, {"instr_func": "vhost16_to_cpu.1053", "instr_loc": 271, "instr_file": "drivers/vhost/vhost.h", "instr": "  %6 = call zeroext i1 @vhost_is_little_endian.1046(%struct.vhost_virtqueue* %5) #15, !dbg !87619"}, {"instr_func": "vhost_is_little_endian.1046", "instr_loc": 258, "instr_file": "drivers/vhost/vhost.h", "instr": "  store %struct.vhost_virtqueue* %0, %struct.vhost_virtqueue** %2, align 8"}, {"instr_func": "vhost_is_little_endian.1046", "instr_loc": 259, "instr_file": "drivers/vhost/vhost.h", "instr": "  %3 = load %struct.vhost_virtqueue*, %struct.vhost_virtqueue** %2, align 8, !dbg !87616"}, {"instr_func": "vhost_is_little_endian.1046", "instr_loc": 259, "instr_file": "drivers/vhost/vhost.h", "instr": "  %4 = getelementptr inbounds %struct.vhost_virtqueue, %struct.vhost_virtqueue* %3, i32 0, i32 32, !dbg !87617"}], "at_file": "drivers/vhost/vhost.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_is_little_endian.1046"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}],
"warnings":[{"warn_data": {"at_line": 207, "warn_str": "Trying to read from a user pointer.", "at": "if (poll->wqh)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 207, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh)"}, {"instr_func": "vhost_poll_start", "instr_loc": 207, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_start"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 210, "file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}],
"warnings":[{"warn_data": {"at_line": 88, "warn_str": "Trying to read from a user pointer.", "at": "  %8 = load %struct.file_operations*, %struct.file_operations** %7, align 8, !dbg !87616", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %6 = load %struct.file*, %struct.file** %4, align 8, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %7 = getelementptr inbounds %struct.file, %struct.file* %6, i32 0, i32 3, !dbg !87616"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 1},
{"warn_data": {"at_line": 88, "warn_str": "Trying to read from a user pointer.", "at": "  %10 = load i32 (%struct.file*, %struct.poll_table_struct*)*, i32 (%struct.file*, %struct.poll_table_struct*)** %9, align 8, !dbg !87616", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %6 = load %struct.file*, %struct.file** %4, align 8, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %7 = getelementptr inbounds %struct.file, %struct.file* %6, i32 0, i32 3, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %9 = getelementptr inbounds %struct.file_operations, %struct.file_operations* %8, i32 0, i32 9, !dbg !87616"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 2},
{"warn_data": {"at_line": 90, "warn_str": "Trying to read from a user pointer.", "at": "  %22 = load %struct.file_operations*, %struct.file_operations** %21, align 8, !dbg !87621", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %20 = load %struct.file*, %struct.file** %4, align 8, !dbg !87620"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %21 = getelementptr inbounds %struct.file, %struct.file* %20, i32 0, i32 3, !dbg !87621"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 3},
{"warn_data": {"at_line": 90, "warn_str": "Trying to read from a user pointer.", "at": "  %24 = load i32 (%struct.file*, %struct.poll_table_struct*)*, i32 (%struct.file*, %struct.poll_table_struct*)** %23, align 8, !dbg !87622", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %20 = load %struct.file*, %struct.file** %4, align 8, !dbg !87620"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %21 = getelementptr inbounds %struct.file, %struct.file* %20, i32 0, i32 3, !dbg !87621"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %23 = getelementptr inbounds %struct.file_operations, %struct.file_operations* %22, i32 0, i32 9, !dbg !87622"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 212, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}],
"warnings":[{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "if (!(key_to_poll(key) & poll->mask))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 170, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 173, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!(key_to_poll(key) & poll->mask))"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 173, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!(key_to_poll(key) & poll->mask))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_wakeup"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 212, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"lineno": 176, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}],
"warnings":[{"warn_data": {"at_line": 280, "warn_str": "Trying to read from a user pointer.", "at": "vhost_work_queue(poll->dev, &poll->work);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 170, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 176, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 176, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}, {"instr_func": "vhost_poll_queue", "instr_loc": 279, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_queue", "instr_loc": 280, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_queue", "instr_loc": 280, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(poll->dev, &poll->work);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_queue"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1546, "file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 214, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}],
"warnings":[{"warn_data": {"at_line": 227, "warn_str": "Trying to read from a user pointer.", "at": "remove_wait_queue(poll->wqh, &poll->wait);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 1},
{"warn_data": {"at_line": 226, "warn_str": "Trying to read from a user pointer.", "at": "if (poll->wqh) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 2},
{"warn_data": {"at_line": 228, "warn_str": "Trying to write to a user pointer.", "at": "poll->wqh = NULL;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1546, "instr_file": "drivers/vhost/net.c", "instr": "r = vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1563, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"lineno": 265, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}],
"warnings":[{"warn_data": {"at_line": 260, "warn_str": "Loop is bounded by a tainted value.", "at": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %22 = load i8*, i8** %2, align 8, !dbg !87653"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %23 = load volatile i8, i8* %22, align 1, !dbg !87653"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8 %23, i8* %24, align 1, !dbg !87653"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %50 = load i32, i32* %49, align 4, !dbg !87644"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i32 %50, i32* %7, align 4, !dbg !87657"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %51 = load i32, i32* %7, align 4, !dbg !87644"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_net_ubuf_put_and_wait"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1563, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"lineno": 265, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"lineno": 260, "file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}],
"warnings":[{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %40 = load volatile i64, i64* %39, align 8, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %38 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 1},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %34 = load volatile i32, i32* %33, align 4, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %32 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 2},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i16, i16* %27, align 2, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %26 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 3},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load volatile i8, i8* %22, align 1, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %22 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 4}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1563, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"lineno": 265, "file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"lineno": 260, "file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}],
"warnings":[{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %34 = load volatile i32, i32* %33, align 4, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %32 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 1},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %40 = load volatile i64, i64* %39, align 8, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %38 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 2},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i16, i16* %27, align 2, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %26 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 3},
{"warn_data": {"at_line": 25, "warn_str": "Trying to read from a user pointer.", "at": "  %23 = load volatile i8, i8* %22, align 1, !dbg !87653", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1516, "instr_file": "drivers/vhost/net.c", "instr": "nvq = &n->vqs[index];"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1552, "instr_file": "drivers/vhost/net.c", "instr": "oldubufs = nvq->ubufs;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1563, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_wait_and_free(oldubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 264, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_wait_and_free", "instr_loc": 265, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_ubuf_put_and_wait(ubufs);"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 258, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "vhost_net_ubuf_put_and_wait", "instr_loc": 260, "instr_file": "drivers/vhost/net.c", "instr": "wait_event(ubufs->wait, !atomic_read(&ubufs->refcount));"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %0, %struct.atomic_t** %8, align 8"}, {"instr_func": "atomic_read", "instr_loc": 27, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %12 = load %struct.atomic_t*, %struct.atomic_t** %8, align 8, !dbg !87649"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store %struct.atomic_t* %12, %struct.atomic_t** %5, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %14 = load %struct.atomic_t*, %struct.atomic_t** %5, align 8, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %15 = getelementptr inbounds %struct.atomic_t, %struct.atomic_t* %14, i32 0, i32 0, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %16 = bitcast i32* %15 to i8*, !dbg !87650"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  store i8* %16, i8** %2, align 8"}, {"instr_func": "atomic_read", "instr_loc": 25, "instr_file": "./include/asm-generic/atomic-instrumented.h", "instr": "  %22 = load i8*, i8** %2, align 8, !dbg !87653"}], "at_file": "./include/asm-generic/atomic-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "atomic_read"}, "warn_no": 4}]},
{"num_warnings": 21,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 366, "warn_str": "Trying to read from a user pointer.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 1},
{"warn_data": {"at_line": 366, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 2},
{"warn_data": {"at_line": 370, "warn_str": "Trying to read from a user pointer.", "at": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 3},
{"warn_data": {"at_line": 370, "warn_str": "Trying to write to a user pointer.", "at": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 370, "instr_file": "drivers/vhost/net.c", "instr": "vq->heads[i].len = VHOST_DMA_CLEAR_LEN;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 4},
{"warn_data": {"at_line": 369, "warn_str": "Trying to read from a user pointer.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 5},
{"warn_data": {"at_line": 369, "warn_str": "Trying to read from a user pointer.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 6},
{"warn_data": {"at_line": 369, "warn_str": "Loop is bounded by a tainted value.", "at": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 369, "instr_file": "drivers/vhost/net.c", "instr": "if (VHOST_DMA_IS_DONE(vq->heads[i].len)) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 7},
{"warn_data": {"at_line": 367, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 8},
{"warn_data": {"at_line": 367, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 367, "instr_file": "drivers/vhost/net.c", "instr": "if (vq->heads[i].len == VHOST_DMA_FAILED_LEN)"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 9},
{"warn_data": {"at_line": 366, "warn_str": "Trying to read from a user pointer.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 10},
{"warn_data": {"at_line": 366, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 366, "instr_file": "drivers/vhost/net.c", "instr": "for (i = nvq->done_idx; i != nvq->upend_idx; i = (i + 1) % UIO_MAXIOV) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 11},
{"warn_data": {"at_line": 378, "warn_str": "Trying to read from a user pointer.", "at": "&vq->heads[nvq->done_idx], add);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 12},
{"warn_data": {"at_line": 377, "warn_str": "Trying to read from a user pointer.", "at": "vhost_add_used_and_signal_n(vq->dev, vq,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 13},
{"warn_data": {"at_line": 378, "warn_str": "Trying to read from a user pointer.", "at": "&vq->heads[nvq->done_idx], add);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 14},
{"warn_data": {"at_line": 379, "warn_str": "Trying to read from a user pointer.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 15},
{"warn_data": {"at_line": 379, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 16},
{"warn_data": {"at_line": 379, "warn_str": "Trying to write to a user pointer.", "at": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 17},
{"warn_data": {"at_line": 376, "warn_str": "Trying to read from a user pointer.", "at": "add = min(UIO_MAXIOV - nvq->done_idx, j);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 18},
{"warn_data": {"at_line": 376, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "add = min(UIO_MAXIOV - nvq->done_idx, j);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 19},
{"warn_data": {"at_line": 380, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "j -= add;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 20},
{"warn_data": {"at_line": 375, "warn_str": "Loop is bounded by a tainted value.", "at": "while (j) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 375, "instr_file": "drivers/vhost/net.c", "instr": "while (j) {"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 375, "instr_file": "drivers/vhost/net.c", "instr": "while (j) {"}], "at_file": "drivers/vhost/net.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_zerocopy_signal_used"}, "warn_no": 21}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2499, "file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}],
"warnings":[{"warn_data": {"at_line": 2408, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 1},
{"warn_data": {"at_line": 2408, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 2},
{"warn_data": {"at_line": 2408, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_add_used_n"}, "warn_no": 3},
{"warn_data": {"at_line": 2409, "warn_str": "Trying to read from a user pointer.", "at": "n = vq->num - start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 4},
{"warn_data": {"at_line": 2409, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "n = vq->num - start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_add_used_n"}, "warn_no": 5},
{"warn_data": {"at_line": 2425, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(vq->log_used)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2425, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2425, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 6},
{"warn_data": {"at_line": 2415, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "count -= n;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2408, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2415, "instr_file": "drivers/vhost/vhost.c", "instr": "count -= n;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_add_used_n"}, "warn_no": 7},
{"warn_data": {"at_line": 2432, "warn_str": "Trying to read from a user pointer.", "at": "eventfd_signal(vq->log_ctx, 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2432, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->log_ctx, 1);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2432, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->log_ctx, 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 8},
{"warn_data": {"at_line": 2431, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->log_ctx)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2431, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->log_ctx)"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2431, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->log_ctx)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 9},
{"warn_data": {"at_line": 2422, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to increment used idx\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2422, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to increment used idx\");"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2422, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to increment used idx\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 10},
{"warn_data": {"at_line": 2422, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to increment used idx\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2422, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to increment used idx\");"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2422, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to increment used idx\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_add_used_n"}, "warn_no": 11}]},
{"num_warnings": 17,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2499, "file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"lineno": 2411, "file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}],
"warnings":[{"warn_data": {"at_line": 2377, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 1},
{"warn_data": {"at_line": 2377, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 2},
{"warn_data": {"at_line": 2377, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 3},
{"warn_data": {"at_line": 2378, "warn_str": "Trying to read from a user pointer.", "at": "used = vq->used->ring + start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 4},
{"warn_data": {"at_line": 2383, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(vq->log_used)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2383, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2383, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 5},
{"warn_data": {"at_line": 2387, "warn_str": "Trying to read from a user pointer.", "at": "log_used(vq, ((void __user *)used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 6},
{"warn_data": {"at_line": 2387, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "log_used(vq, ((void __user *)used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 7},
{"warn_data": {"at_line": 2390, "warn_str": "Trying to read from a user pointer.", "at": "old = vq->last_used_idx;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2390, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->last_used_idx;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2390, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->last_used_idx;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 8},
{"warn_data": {"at_line": 2391, "warn_str": "Trying to read from a user pointer.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 9},
{"warn_data": {"at_line": 2391, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 10},
{"warn_data": {"at_line": 2391, "warn_str": "Trying to write to a user pointer.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 11},
{"warn_data": {"at_line": 2396, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 12},
{"warn_data": {"at_line": 2396, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 13},
{"warn_data": {"at_line": 2396, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 14},
{"warn_data": {"at_line": 2397, "warn_str": "Trying to write to a user pointer.", "at": "vq->signalled_used_valid = false;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2397, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2397, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 15},
{"warn_data": {"at_line": 2380, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to write used\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 16},
{"warn_data": {"at_line": 2380, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to write used\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2411, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, n);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 17}]},
{"num_warnings": 17,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2499, "file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"lineno": 2417, "file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}],
"warnings":[{"warn_data": {"at_line": 2377, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 1},
{"warn_data": {"at_line": 2377, "warn_str": "Trying to read from a user pointer.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 2},
{"warn_data": {"at_line": 2377, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "start = vq->last_used_idx & (vq->num - 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2377, "instr_file": "drivers/vhost/vhost.c", "instr": "start = vq->last_used_idx & (vq->num - 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 3},
{"warn_data": {"at_line": 2378, "warn_str": "Trying to read from a user pointer.", "at": "used = vq->used->ring + start;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 4},
{"warn_data": {"at_line": 2383, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely(vq->log_used)) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2383, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2383, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely(vq->log_used)) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 5},
{"warn_data": {"at_line": 2387, "warn_str": "Trying to read from a user pointer.", "at": "log_used(vq, ((void __user *)used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 6},
{"warn_data": {"at_line": 2387, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "log_used(vq, ((void __user *)used - (void __user *)vq->used),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2378, "instr_file": "drivers/vhost/vhost.c", "instr": "used = vq->used->ring + start;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2387, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, ((void __user *)used - (void __user *)vq->used),"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 7},
{"warn_data": {"at_line": 2390, "warn_str": "Trying to read from a user pointer.", "at": "old = vq->last_used_idx;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2390, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->last_used_idx;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2390, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->last_used_idx;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 8},
{"warn_data": {"at_line": 2391, "warn_str": "Trying to read from a user pointer.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 9},
{"warn_data": {"at_line": 2391, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2409, "instr_file": "drivers/vhost/vhost.c", "instr": "n = vq->num - start;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2415, "instr_file": "drivers/vhost/vhost.c", "instr": "count -= n;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2415, "instr_file": "drivers/vhost/vhost.c", "instr": "count -= n;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2415, "instr_file": "drivers/vhost/vhost.c", "instr": "count -= n;"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 10},
{"warn_data": {"at_line": 2391, "warn_str": "Trying to write to a user pointer.", "at": "new = (vq->last_used_idx += count);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 11},
{"warn_data": {"at_line": 2396, "warn_str": "Trying to read from a user pointer.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 12},
{"warn_data": {"at_line": 2396, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 13},
{"warn_data": {"at_line": 2396, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 362, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 361, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 379, "instr_file": "drivers/vhost/net.c", "instr": "nvq->done_idx = (nvq->done_idx + add) % UIO_MAXIOV;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 380, "instr_file": "drivers/vhost/net.c", "instr": "j -= add;"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 376, "instr_file": "drivers/vhost/net.c", "instr": "add = min(UIO_MAXIOV - nvq->done_idx, j);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 378, "instr_file": "drivers/vhost/net.c", "instr": "&vq->heads[nvq->done_idx], add);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2391, "instr_file": "drivers/vhost/vhost.c", "instr": "new = (vq->last_used_idx += count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2396, "instr_file": "drivers/vhost/vhost.c", "instr": "if (unlikely((u16)(new - vq->signalled_used) < (u16)(new - old)))"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "__vhost_add_used_n"}, "warn_no": 14},
{"warn_data": {"at_line": 2397, "warn_str": "Trying to write to a user pointer.", "at": "vq->signalled_used_valid = false;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2397, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2397, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = false;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 15},
{"warn_data": {"at_line": 2380, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to write used\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 16},
{"warn_data": {"at_line": 2380, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to write used\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2417, "instr_file": "drivers/vhost/vhost.c", "instr": "r = __vhost_add_used_n(vq, heads, count);"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2372, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}, {"instr_func": "__vhost_add_used_n", "instr_loc": 2380, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to write used\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "__vhost_add_used_n"}, "warn_no": 17}]},
{"num_warnings": 5,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2499, "file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"lineno": 2421, "file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}],
"warnings":[{"warn_data": {"at_line": 938, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 937, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_idx"}, "warn_no": 1},
{"warn_data": {"at_line": 938, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 937, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_idx"}, "warn_no": 2},
{"warn_data": {"at_line": 938, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 937, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_idx"}, "warn_no": 3},
{"warn_data": {"at_line": 938, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 937, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_idx"}, "warn_no": 4},
{"warn_data": {"at_line": 938, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2421, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_put_used_idx(vq)) {"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 937, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}, {"instr_func": "vhost_put_used_idx", "instr_loc": 938, "instr_file": "drivers/vhost/vhost.c", "instr": "return vhost_put_user(vq, cpu_to_vhost16(vq, vq->last_used_idx),"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_put_used_idx"}, "warn_no": 5}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2499, "file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"lineno": 2429, "file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}],
"warnings":[{"warn_data": {"at_line": 1915, "warn_str": "Trying to read from a user pointer.", "at": "if (!vq->iotlb)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1915, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb)"}, {"instr_func": "log_used", "instr_loc": 1915, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq->iotlb)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 1},
{"warn_data": {"at_line": 1916, "warn_str": "Trying to read from a user pointer.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 2},
{"warn_data": {"at_line": 1916, "warn_str": "Trying to read from a user pointer.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 3},
{"warn_data": {"at_line": 1916, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return log_write(vq->log_base, vq->log_addr + used_offset, len);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}, {"instr_func": "log_used", "instr_loc": 1916, "instr_file": "drivers/vhost/vhost.c", "instr": "return log_write(vq->log_base, vq->log_addr + used_offset, len);"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_used"}, "warn_no": 4},
{"warn_data": {"at_line": 1918, "warn_str": "Trying to read from a user pointer.", "at": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "log_used"}, "warn_no": 5},
{"warn_data": {"at_line": 1918, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2499, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_add_used_n(vq, heads, count);"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2405, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "vhost_add_used_n", "instr_loc": 2429, "instr_file": "drivers/vhost/vhost.c", "instr": "log_used(vq, offsetof(struct vring_used, idx),"}, {"instr_func": "log_used", "instr_loc": 1911, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}, {"instr_func": "log_used", "instr_loc": 1918, "instr_file": "drivers/vhost/vhost.c", "instr": "ret = translate_desc(vq, (uintptr_t)vq->used + used_offset,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_used"}, "warn_no": 6}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2500, "file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}],
"warnings":[{"warn_data": {"at_line": 2479, "warn_str": "Trying to read from a user pointer.", "at": "if (vq->call_ctx && vhost_notify(dev, vq))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_signal"}, "warn_no": 1},
{"warn_data": {"at_line": 2480, "warn_str": "Trying to read from a user pointer.", "at": "eventfd_signal(vq->call_ctx, 1);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2480, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->call_ctx, 1);"}, {"instr_func": "vhost_signal", "instr_loc": 2480, "instr_file": "drivers/vhost/vhost.c", "instr": "eventfd_signal(vq->call_ctx, 1);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_signal"}, "warn_no": 2}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1565, "file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"lineno": 377, "file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"lineno": 2500, "file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"lineno": 2479, "file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}],
"warnings":[{"warn_data": {"at_line": 2449, "warn_str": "Trying to read from a user pointer.", "at": "unlikely(vq->avail_idx == vq->last_avail_idx))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2449, "instr_file": "drivers/vhost/vhost.c", "instr": "unlikely(vq->avail_idx == vq->last_avail_idx))"}, {"instr_func": "vhost_notify", "instr_loc": 2449, "instr_file": "drivers/vhost/vhost.c", "instr": "unlikely(vq->avail_idx == vq->last_avail_idx))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 1},
{"warn_data": {"at_line": 2449, "warn_str": "Trying to read from a user pointer.", "at": "unlikely(vq->avail_idx == vq->last_avail_idx))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2449, "instr_file": "drivers/vhost/vhost.c", "instr": "unlikely(vq->avail_idx == vq->last_avail_idx))"}, {"instr_func": "vhost_notify", "instr_loc": 2449, "instr_file": "drivers/vhost/vhost.c", "instr": "unlikely(vq->avail_idx == vq->last_avail_idx))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 2},
{"warn_data": {"at_line": 2455, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to get flags\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2455, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get flags\");"}, {"instr_func": "vhost_notify", "instr_loc": 2455, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get flags\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 3},
{"warn_data": {"at_line": 2455, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to get flags\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2455, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get flags\");"}, {"instr_func": "vhost_notify", "instr_loc": 2455, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get flags\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 4},
{"warn_data": {"at_line": 2460, "warn_str": "Trying to read from a user pointer.", "at": "old = vq->signalled_used;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2460, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->signalled_used;"}, {"instr_func": "vhost_notify", "instr_loc": 2460, "instr_file": "drivers/vhost/vhost.c", "instr": "old = vq->signalled_used;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 5},
{"warn_data": {"at_line": 2461, "warn_str": "Trying to read from a user pointer.", "at": "v = vq->signalled_used_valid;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2461, "instr_file": "drivers/vhost/vhost.c", "instr": "v = vq->signalled_used_valid;"}, {"instr_func": "vhost_notify", "instr_loc": 2461, "instr_file": "drivers/vhost/vhost.c", "instr": "v = vq->signalled_used_valid;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 6},
{"warn_data": {"at_line": 2462, "warn_str": "Trying to read from a user pointer.", "at": "new = vq->signalled_used = vq->last_used_idx;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2462, "instr_file": "drivers/vhost/vhost.c", "instr": "new = vq->signalled_used = vq->last_used_idx;"}, {"instr_func": "vhost_notify", "instr_loc": 2462, "instr_file": "drivers/vhost/vhost.c", "instr": "new = vq->signalled_used = vq->last_used_idx;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 7},
{"warn_data": {"at_line": 2462, "warn_str": "Trying to write to a user pointer.", "at": "new = vq->signalled_used = vq->last_used_idx;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2462, "instr_file": "drivers/vhost/vhost.c", "instr": "new = vq->signalled_used = vq->last_used_idx;"}, {"instr_func": "vhost_notify", "instr_loc": 2462, "instr_file": "drivers/vhost/vhost.c", "instr": "new = vq->signalled_used = vq->last_used_idx;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 8},
{"warn_data": {"at_line": 2463, "warn_str": "Trying to write to a user pointer.", "at": "vq->signalled_used_valid = true;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2463, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = true;"}, {"instr_func": "vhost_notify", "instr_loc": 2463, "instr_file": "drivers/vhost/vhost.c", "instr": "vq->signalled_used_valid = true;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 9},
{"warn_data": {"at_line": 2469, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to get used event idx\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2469, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get used event idx\");"}, {"instr_func": "vhost_notify", "instr_loc": 2469, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get used event idx\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 10},
{"warn_data": {"at_line": 2469, "warn_str": "Trying to read from a user pointer.", "at": "vq_err(vq, \"Failed to get used event idx\");", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1565, "instr_file": "drivers/vhost/net.c", "instr": "vhost_zerocopy_signal_used(n, vq);"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 360, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_zerocopy_signal_used", "instr_loc": 377, "instr_file": "drivers/vhost/net.c", "instr": "vhost_add_used_and_signal_n(vq->dev, vq,"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2498, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_add_used_and_signal_n", "instr_loc": 2500, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_signal(dev, vq);"}, {"instr_func": "vhost_signal", "instr_loc": 2477, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_signal", "instr_loc": 2479, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->call_ctx && vhost_notify(dev, vq))"}, {"instr_func": "vhost_notify", "instr_loc": 2439, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_notify", "instr_loc": 2469, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get used event idx\");"}, {"instr_func": "vhost_notify", "instr_loc": 2469, "instr_file": "drivers/vhost/vhost.c", "instr": "vq_err(vq, \"Failed to get used event idx\");"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_notify"}, "warn_no": 11}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1365, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}],
"warnings":[{"warn_data": {"at_line": 251, "warn_str": "Trying to read from a user pointer.", "at": "vhost_work_flush(poll->dev, &poll->work);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_flush"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1365, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"lineno": 251, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}],
"warnings":[{"warn_data": {"at_line": 237, "warn_str": "Trying to read from a user pointer.", "at": "if (dev->worker) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 237, "instr_file": "drivers/vhost/vhost.c", "instr": "if (dev->worker) {"}, {"instr_func": "vhost_work_flush", "instr_loc": 237, "instr_file": "drivers/vhost/vhost.c", "instr": "if (dev->worker) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_flush"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1366, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}],
"warnings":[{"warn_data": {"at_line": 251, "warn_str": "Trying to read from a user pointer.", "at": "vhost_work_flush(poll->dev, &poll->work);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_flush"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1365, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"lineno": 251, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"lineno": 241, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}],
"warnings":[{"warn_data": {"at_line": 257, "warn_str": "Trying to read from a user pointer.", "at": "if (!dev->worker)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_queue", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_queue", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!dev->worker)"}, {"instr_func": "vhost_work_queue", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!dev->worker)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_queue"}, "warn_no": 1},
{"warn_data": {"at_line": 266, "warn_str": "Trying to read from a user pointer.", "at": "wake_up_process(dev->worker);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1365, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(n->poll + index);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_queue", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_queue", "instr_loc": 266, "instr_file": "drivers/vhost/vhost.c", "instr": "wake_up_process(dev->worker);"}, {"instr_func": "vhost_work_queue", "instr_loc": 266, "instr_file": "drivers/vhost/vhost.c", "instr": "wake_up_process(dev->worker);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_queue"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1366, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"lineno": 251, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}],
"warnings":[{"warn_data": {"at_line": 237, "warn_str": "Trying to read from a user pointer.", "at": "if (dev->worker) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 237, "instr_file": "drivers/vhost/vhost.c", "instr": "if (dev->worker) {"}, {"instr_func": "vhost_work_flush", "instr_loc": 237, "instr_file": "drivers/vhost/vhost.c", "instr": "if (dev->worker) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_flush"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1570, "file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"lineno": 1366, "file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"lineno": 251, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"lineno": 241, "file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}],
"warnings":[{"warn_data": {"at_line": 257, "warn_str": "Trying to read from a user pointer.", "at": "if (!dev->worker)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_queue", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_queue", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!dev->worker)"}, {"instr_func": "vhost_work_queue", "instr_loc": 257, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!dev->worker)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_queue"}, "warn_no": 1},
{"warn_data": {"at_line": 266, "warn_str": "Trying to read from a user pointer.", "at": "wake_up_process(dev->worker);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1570, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_flush_vq(n, index);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1364, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_net_flush_vq", "instr_loc": 1366, "instr_file": "drivers/vhost/net.c", "instr": "vhost_poll_flush(&n->vqs[index].vq.poll);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 250, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_flush", "instr_loc": 251, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_flush(poll->dev, &poll->work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 234, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_flush", "instr_loc": 241, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(dev, &flush.work);"}, {"instr_func": "vhost_work_queue", "instr_loc": 256, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_work_queue", "instr_loc": 266, "instr_file": "drivers/vhost/vhost.c", "instr": "wake_up_process(dev->worker);"}, {"instr_func": "vhost_work_queue", "instr_loc": 266, "instr_file": "drivers/vhost/vhost.c", "instr": "wake_up_process(dev->worker);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_work_queue"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}],
"warnings":[{"warn_data": {"at_line": 437, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}], "at_file": "drivers/vhost/net.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 1},
{"warn_data": {"at_line": 440, "warn_str": "Trying to read from a user pointer.", "at": "sock = vq->private_data;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 2},
{"warn_data": {"at_line": 444, "warn_str": "Trying to read from a user pointer.", "at": "return vhost_poll_start(poll, sock->file);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}], "at_file": "drivers/vhost/net.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_net_enable_vq"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}],
"warnings":[{"warn_data": {"at_line": 207, "warn_str": "Trying to read from a user pointer.", "at": "if (poll->wqh)", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 207, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh)"}, {"instr_func": "vhost_poll_start", "instr_loc": 207, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh)"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_start"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 210, "file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}],
"warnings":[{"warn_data": {"at_line": 88, "warn_str": "Trying to read from a user pointer.", "at": "  %8 = load %struct.file_operations*, %struct.file_operations** %7, align 8, !dbg !87616", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %6 = load %struct.file*, %struct.file** %4, align 8, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %7 = getelementptr inbounds %struct.file, %struct.file* %6, i32 0, i32 3, !dbg !87616"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 1},
{"warn_data": {"at_line": 88, "warn_str": "Trying to read from a user pointer.", "at": "  %10 = load i32 (%struct.file*, %struct.poll_table_struct*)*, i32 (%struct.file*, %struct.poll_table_struct*)** %9, align 8, !dbg !87616", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %6 = load %struct.file*, %struct.file** %4, align 8, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %7 = getelementptr inbounds %struct.file, %struct.file* %6, i32 0, i32 3, !dbg !87616"}, {"instr_func": "vfs_poll", "instr_loc": 88, "instr_file": "./include/linux/poll.h", "instr": "  %9 = getelementptr inbounds %struct.file_operations, %struct.file_operations* %8, i32 0, i32 9, !dbg !87616"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 2},
{"warn_data": {"at_line": 90, "warn_str": "Trying to read from a user pointer.", "at": "  %22 = load %struct.file_operations*, %struct.file_operations** %21, align 8, !dbg !87621", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %20 = load %struct.file*, %struct.file** %4, align 8, !dbg !87620"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %21 = getelementptr inbounds %struct.file, %struct.file* %20, i32 0, i32 3, !dbg !87621"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 3},
{"warn_data": {"at_line": 90, "warn_str": "Trying to read from a user pointer.", "at": "  %24 = load i32 (%struct.file*, %struct.poll_table_struct*)*, i32 (%struct.file*, %struct.poll_table_struct*)** %23, align 8, !dbg !87622", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 440, "instr_file": "drivers/vhost/net.c", "instr": "sock = vq->private_data;"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vhost_poll_start", "instr_loc": 210, "instr_file": "drivers/vhost/vhost.c", "instr": "mask = vfs_poll(file, &poll->table);"}, {"instr_func": "vfs_poll", "instr_loc": 87, "instr_file": "./include/linux/poll.h", "instr": "  store %struct.file* %0, %struct.file** %4, align 8"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %20 = load %struct.file*, %struct.file** %4, align 8, !dbg !87620"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %21 = getelementptr inbounds %struct.file, %struct.file* %20, i32 0, i32 3, !dbg !87621"}, {"instr_func": "vfs_poll", "instr_loc": 90, "instr_file": "./include/linux/poll.h", "instr": "  %23 = getelementptr inbounds %struct.file_operations, %struct.file_operations* %22, i32 0, i32 9, !dbg !87622"}], "at_file": "./include/linux/poll.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vfs_poll"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 212, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}],
"warnings":[{"warn_data": {"at_line": 173, "warn_str": "Trying to read from a user pointer.", "at": "if (!(key_to_poll(key) & poll->mask))", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 170, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 173, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!(key_to_poll(key) & poll->mask))"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 173, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!(key_to_poll(key) & poll->mask))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_wakeup"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 212, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"lineno": 176, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}],
"warnings":[{"warn_data": {"at_line": 280, "warn_str": "Trying to read from a user pointer.", "at": "vhost_work_queue(poll->dev, &poll->work);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_start", "instr_loc": 212, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_wakeup(&poll->wait, 0, 0, poll_to_key(mask));"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 170, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 171, "instr_file": "drivers/vhost/vhost.c", "instr": "struct vhost_poll *poll = container_of(wait, struct vhost_poll, wait);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 176, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}, {"instr_func": "vhost_poll_wakeup", "instr_loc": 176, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_queue(poll);"}, {"instr_func": "vhost_poll_queue", "instr_loc": 279, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_queue", "instr_loc": 280, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(poll->dev, &poll->work);"}, {"instr_func": "vhost_poll_queue", "instr_loc": 280, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_work_queue(poll->dev, &poll->work);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_queue"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1715, "file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"lineno": 1579, "file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"lineno": 444, "file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"lineno": 214, "file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}],
"warnings":[{"warn_data": {"at_line": 227, "warn_str": "Trying to read from a user pointer.", "at": "remove_wait_queue(poll->wqh, &poll->wait);", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 227, "instr_file": "drivers/vhost/vhost.c", "instr": "remove_wait_queue(poll->wqh, &poll->wait);"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 1},
{"warn_data": {"at_line": 226, "warn_str": "Trying to read from a user pointer.", "at": "if (poll->wqh) {", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}, {"instr_func": "vhost_poll_stop", "instr_loc": 226, "instr_file": "drivers/vhost/vhost.c", "instr": "if (poll->wqh) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 2},
{"warn_data": {"at_line": 228, "warn_str": "Trying to write to a user pointer.", "at": "poll->wqh = NULL;", "inst_trace": [{"instr_func": "vhost_net_ioctl", "instr_loc": 1713, "instr_file": "drivers/vhost/net.c", "instr": "if (copy_from_user(&backend, argp, sizeof backend))"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_ioctl", "instr_loc": 1715, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_net_set_backend(n, backend.index, backend.fd);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1499, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1515, "instr_file": "drivers/vhost/net.c", "instr": "vq = &n->vqs[index].vq;"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_set_backend", "instr_loc": 1579, "instr_file": "drivers/vhost/net.c", "instr": "vhost_net_enable_vq(n, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 434, "instr_file": "drivers/vhost/net.c", "instr": "{"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 436, "instr_file": "drivers/vhost/net.c", "instr": "container_of(vq, struct vhost_net_virtqueue, vq);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 435, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_net_virtqueue *nvq ="}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 437, "instr_file": "drivers/vhost/net.c", "instr": "struct vhost_poll *poll = n->poll + (nvq - n->vqs);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_net_enable_vq", "instr_loc": 444, "instr_file": "drivers/vhost/net.c", "instr": "return vhost_poll_start(poll, sock->file);"}, {"instr_func": "vhost_poll_start", "instr_loc": 204, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_start", "instr_loc": 214, "instr_file": "drivers/vhost/vhost.c", "instr": "vhost_poll_stop(poll);"}, {"instr_func": "vhost_poll_stop", "instr_loc": 225, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}, {"instr_func": "vhost_poll_stop", "instr_loc": 228, "instr_file": "drivers/vhost/vhost.c", "instr": "poll->wqh = NULL;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vhost_poll_stop"}, "warn_no": 3}]},
{"num_warnings": 11,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}],
"warnings":[{"warn_data": {"at_line": 720, "warn_str": "Trying to read from a user pointer.", "at": "list_for_each_entry(node, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 731, "warn_str": "Trying to read from a user pointer.", "at": "node->start,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 732, "warn_str": "Trying to read from a user pointer.", "at": "node->size))", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 727, "warn_str": "Trying to read from a user pointer.", "at": "if (!access_ok((void __user *)a,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 4},
{"warn_data": {"at_line": 721, "warn_str": "Trying to read from a user pointer.", "at": "unsigned long a = node->userspace_addr;", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 5},
{"warn_data": {"at_line": 723, "warn_str": "Trying to read from a user pointer.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 6},
{"warn_data": {"at_line": 723, "warn_str": "Trying to read from a user pointer.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "vq_memory_access_ok"}, "warn_no": 7},
{"warn_data": {"at_line": 720, "warn_str": "Loop is bounded by a tainted value.", "at": "list_for_each_entry(node, &umem->umem_list, link) {", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 8},
{"warn_data": {"at_line": 723, "warn_str": "Loop is bounded by a tainted value.", "at": "if (vhost_overflow(node->userspace_addr, node->size))", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vhost_overflow", "instr_loc": 706, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 9},
{"warn_data": {"at_line": 730, "warn_str": "Loop is bounded by a tainted value.", "at": "else if (log_all && !log_access_ok(log_base,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %24 = add i64 %23, %22, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %24, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %35 = load i64, i64* %5, align 8, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %37 = icmp ugt i64 %35, %36, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %38 = xor i1 %37, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %39 = xor i1 %38, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %40 = zext i1 %39 to i32, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %42 = icmp ne i64 %41, 0, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i1 %42, i1* %4, align 1, !dbg !87633"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 60, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %44 = load i1, i1* %4, align 1, !dbg !87634"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 703, "instr_file": "drivers/vhost/vhost.c", "instr": "}"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 10},
{"warn_data": {"at_line": 727, "warn_str": "Loop is bounded by a tainted value.", "at": "if (!access_ok((void __user *)a,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 721, "instr_file": "drivers/vhost/vhost.c", "instr": "unsigned long a = node->userspace_addr;"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %24 = add i64 %23, %22, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %24, i64* %5, align 8, !dbg !87627"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %35 = load i64, i64* %5, align 8, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %37 = icmp ugt i64 %35, %36, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %38 = xor i1 %37, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %39 = xor i1 %38, true, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %40 = zext i1 %39 to i32, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %42 = icmp ne i64 %41, 0, !dbg !87632"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 59, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i1 %42, i1* %4, align 1, !dbg !87633"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 60, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %44 = load i1, i1* %4, align 1, !dbg !87634"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vq_memory_access_ok"}, "warn_no": 11}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 730, "file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}],
"warnings":[{"warn_data": {"at_line": 697, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (a > ULONG_MAX - (unsigned long)log_base ||", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1384, "instr_file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 714, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 697, "instr_file": "drivers/vhost/vhost.c", "instr": "if (a > ULONG_MAX - (unsigned long)log_base ||"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "a + (unsigned long)log_base > ULONG_MAX)", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 731, "instr_file": "drivers/vhost/vhost.c", "instr": "node->start,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 698, "instr_file": "drivers/vhost/vhost.c", "instr": "a + (unsigned long)log_base > ULONG_MAX)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 2},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 3},
{"warn_data": {"at_line": 701, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return access_ok(log_base + a,", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 4}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 727, "file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 727, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!access_ok((void __user *)a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 730, "file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"lineno": 701, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %22 = load i64, i64* %6, align 8, !dbg !87626"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 53, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %14 = sub i64 %12, %13, !dbg !87624", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 732, "instr_file": "drivers/vhost/vhost.c", "instr": "node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 730, "instr_file": "drivers/vhost/vhost.c", "instr": "else if (log_all && !log_access_ok(log_base,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %1, i64* %6, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 53, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %13 = load i64, i64* %6, align 8, !dbg !87624"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1384, "file": "drivers/vhost/vhost.c", "instr": "return vq_memory_access_ok(log_base, vq->umem,"}, {"lineno": 723, "file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}],
"warnings":[{"warn_data": {"at_line": 708, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 720, "instr_file": "drivers/vhost/vhost.c", "instr": "list_for_each_entry(node, &umem->umem_list, link) {"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vq_memory_access_ok", "instr_loc": 723, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vhost_overflow(node->userspace_addr, node->size))"}, {"instr_func": "vhost_overflow", "instr_loc": 706, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_overflow", "instr_loc": 708, "instr_file": "drivers/vhost/vhost.c", "instr": "return uaddr > ULONG_MAX || size > ULONG_MAX || uaddr > ULONG_MAX - size;"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_overflow"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1386, "file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}],
"warnings":[{"warn_data": {"at_line": 697, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (a > ULONG_MAX - (unsigned long)log_base ||", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 697, "instr_file": "drivers/vhost/vhost.c", "instr": "if (a > ULONG_MAX - (unsigned long)log_base ||"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 1},
{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "a + (unsigned long)log_base > ULONG_MAX)", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 698, "instr_file": "drivers/vhost/vhost.c", "instr": "a + (unsigned long)log_base > ULONG_MAX)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1786, "file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"lineno": 1386, "file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"lineno": 701, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_dev_ioctl", "instr_loc": 1772, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&p, argp, sizeof p)) {"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1782, "instr_file": "drivers/vhost/vhost.c", "instr": "void __user *base = (void __user *)(unsigned long)p;"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vhost_dev_ioctl", "instr_loc": 1786, "instr_file": "drivers/vhost/vhost.c", "instr": "if (vq->private_data && !vq_log_access_ok(vq, base))"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1383, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "vq_log_access_ok", "instr_loc": 1386, "instr_file": "drivers/vhost/vhost.c", "instr": "(!vq->log_used || log_access_ok(log_base, vq->log_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1744, "file": "drivers/vhost/net.c", "instr": "r = vhost_dev_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1769, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_set_memory(d, argp);"}],
"warnings":[{"warn_data": {"at_line": 1420, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_set_memory"}, "warn_no": 1},
{"warn_data": {"at_line": 1438, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "memcpy(newmem, &mem, size);", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_set_memory"}, "warn_no": 2},
{"warn_data": {"at_line": 1451, "warn_str": "Loop is bounded by a tainted value.", "at": "for (region = newmem->regions;", "inst_trace": [{"instr_func": "vhost_set_memory", "instr_loc": 1420, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_set_memory", "instr_loc": 1452, "instr_file": "drivers/vhost/vhost.c", "instr": "region < newmem->regions + mem.nregions;"}, {"instr_func": "vhost_set_memory", "instr_loc": 1452, "instr_file": "drivers/vhost/vhost.c", "instr": "region < newmem->regions + mem.nregions;"}, {"instr_func": "vhost_set_memory", "instr_loc": 1452, "instr_file": "drivers/vhost/vhost.c", "instr": "region < newmem->regions + mem.nregions;"}], "at_file": "drivers/vhost/vhost.c", "by": "TaintedLoopBoundDetector says:", "at_func": "vhost_set_memory"}, "warn_no": 3}]},
{"num_warnings": 7,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}],
"warnings":[{"warn_data": {"at_line": 1686, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&s, argp, sizeof(s))) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 1},
{"warn_data": {"at_line": 1693, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "s.index = idx;", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 2},
{"warn_data": {"at_line": 1668, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&f, argp, sizeof f)) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 3},
{"warn_data": {"at_line": 1656, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&f, argp, sizeof f)) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 4},
{"warn_data": {"at_line": 1640, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&f, argp, sizeof f)) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 5},
{"warn_data": {"at_line": 1634, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "s.index = idx;", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 6},
{"warn_data": {"at_line": 1621, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&s, argp, sizeof s)) {", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_ioctl"}, "warn_no": 7}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1683, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_get_vring_endian(vq, idx, argp);"}],
"warnings":[{"warn_data": {"at_line": 96, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_get_vring_endian"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1680, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_set_vring_endian(vq, argp);"}],
"warnings":[{"warn_data": {"at_line": 79, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&s, argp, sizeof(s)))", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_set_vring_endian"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}],
"warnings":[{"warn_data": {"at_line": 1511, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "{", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_set_addr"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1572, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_num(d, vq, argp);"}],
"warnings":[{"warn_data": {"at_line": 1501, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "if (!s.num || s.num > 0xffff || (s.num & (s.num - 1)))", "inst_trace": [{"instr_func": "vhost_vring_set_num", "instr_loc": 1498, "instr_file": "drivers/vhost/vhost.c", "instr": "if (copy_from_user(&s, argp, sizeof s))"}, {"instr_func": "vhost_vring_set_num", "instr_loc": 1501, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!s.num || s.num > 0xffff || (s.num & (s.num - 1)))"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "vhost_vring_set_num"}, "warn_no": 1},
{"warn_data": {"at_line": 1498, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(&s, argp, sizeof s))", "inst_trace": [], "at_file": "drivers/vhost/vhost.c", "by": "TaintedSizeDetector says:", "at_func": "vhost_vring_set_num"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}, {"lineno": 1538, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"lineno": 1302, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_vring_set_addr", "instr_loc": 1511, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1539, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.desc_user_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1539, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.desc_user_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1538, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1302, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(desc, vhost_get_desc_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}, {"lineno": 1538, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"lineno": 1303, "file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_vring_set_addr", "instr_loc": 1511, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1540, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.avail_user_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1540, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.avail_user_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1538, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "vq_access_ok", "instr_loc": 1303, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(avail, vhost_get_avail_size(vq, num)) &&"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}, {"lineno": 1538, "file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"lineno": 1304, "file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_vring_set_addr", "instr_loc": 1511, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1541, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.used_user_addr))"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1541, "instr_file": "drivers/vhost/vhost.c", "instr": "(void __user *)(unsigned long)a.used_user_addr))"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1538, "instr_file": "drivers/vhost/vhost.c", "instr": "if (!vq_access_ok(vq, vq->num,"}, {"instr_func": "vq_access_ok", "instr_loc": 1301, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "vq_access_ok", "instr_loc": 1304, "instr_file": "drivers/vhost/vhost.c", "instr": "access_ok(used, vhost_get_used_size(vq, num));"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}, {"lineno": 1546, "file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}],
"warnings":[{"warn_data": {"at_line": 698, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "a + (unsigned long)log_base > ULONG_MAX)", "inst_trace": [{"instr_func": "vhost_vring_set_addr", "instr_loc": 1511, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1546, "instr_file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1546, "instr_file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 698, "instr_file": "drivers/vhost/vhost.c", "instr": "a + (unsigned long)log_base > ULONG_MAX)"}], "at_file": "drivers/vhost/vhost.c", "by": "IntegerOverflowDetector says:", "at_func": "log_access_ok"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 1746, "file": "drivers/vhost/net.c", "instr": "r = vhost_vring_ioctl(&n->dev, ioctl, argp);"}, {"lineno": 1608, "file": "drivers/vhost/vhost.c", "instr": "return vhost_vring_set_num_addr(d, vq, ioctl, argp);"}, {"lineno": 1575, "file": "drivers/vhost/vhost.c", "instr": "r = vhost_vring_set_addr(d, vq, argp);"}, {"lineno": 1546, "file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}, {"lineno": 701, "file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}],
"warnings":[{"warn_data": {"at_line": 56, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %24 = add i64 %23, %22, !dbg !87627", "inst_trace": [{"instr_func": "vhost_vring_set_addr", "instr_loc": 1511, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1546, "instr_file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}, {"instr_func": "vhost_vring_set_addr", "instr_loc": 1546, "instr_file": "drivers/vhost/vhost.c", "instr": "!log_access_ok(vq->log_base, a.log_guest_addr,"}, {"instr_func": "log_access_ok", "instr_loc": 693, "instr_file": "drivers/vhost/vhost.c", "instr": "{"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 694, "instr_file": "drivers/vhost/vhost.c", "instr": "u64 a = addr / VHOST_PAGE_SIZE / 8;"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "log_access_ok", "instr_loc": 701, "instr_file": "drivers/vhost/vhost.c", "instr": "return access_ok(log_base + a,"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 44, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  store i64 %0, i64* %5, align 8"}, {"instr_func": "__chk_range_not_ok", "instr_loc": 56, "instr_file": "./arch/x86/include/asm/uaccess.h", "instr": "  %23 = load i64, i64* %5, align 8, !dbg !87627"}], "at_file": "./arch/x86/include/asm/uaccess.h", "by": "IntegerOverflowDetector says:", "at_func": "__chk_range_not_ok"}, "warn_no": 1}]}]}