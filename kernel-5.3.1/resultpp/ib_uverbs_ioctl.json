{"all_contexts":[
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}],
"warnings":[{"warn_data": {"at_line": 632, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "err = copy_from_user(&hdr, user_hdr, sizeof(hdr));", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_ioctl"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 573, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_obj(hdr->object_id) |"}],
"warnings":[{"warn_data": {"at_line": 191, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %15 = add i32 %14, 24, !dbg !545973", "inst_trace": [{"instr_func": "ib_uverbs_ioctl", "instr_loc": 632, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = copy_from_user(&hdr, user_hdr, sizeof(hdr));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 573, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_obj(hdr->object_id) |"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 573, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_obj(hdr->object_id) |"}, {"instr_func": "uapi_key_obj.2966", "instr_loc": 186, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_obj.2966", "instr_loc": 191, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %14 = load i32, i32* %3, align 4, !dbg !545972"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "IntegerOverflowDetector says:", "at_func": "uapi_key_obj.2966"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 574, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_ioctl_method(hdr->method_id));"}],
"warnings":[{"warn_data": {"at_line": 213, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %18 = add i32 %17, 1, !dbg !545976", "inst_trace": [{"instr_func": "ib_uverbs_ioctl", "instr_loc": 632, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = copy_from_user(&hdr, user_hdr, sizeof(hdr));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 574, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_ioctl_method(hdr->method_id));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 574, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_ioctl_method(hdr->method_id));"}, {"instr_func": "uapi_key_ioctl_method", "instr_loc": 206, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_ioctl_method", "instr_loc": 213, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = load i32, i32* %3, align 4, !dbg !545976"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "IntegerOverflowDetector says:", "at_func": "uapi_key_ioctl_method"}, "warn_no": 1},
{"warn_data": {"at_line": 211, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %15 = add i32 %14, 22, !dbg !545973", "inst_trace": [{"instr_func": "ib_uverbs_ioctl", "instr_loc": 632, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = copy_from_user(&hdr, user_hdr, sizeof(hdr));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 574, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_ioctl_method(hdr->method_id));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 574, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uapi_key_ioctl_method(hdr->method_id));"}, {"instr_func": "uapi_key_ioctl_method", "instr_loc": 206, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_ioctl_method", "instr_loc": 211, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %14 = load i32, i32* %3, align 4, !dbg !545972"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "IntegerOverflowDetector says:", "at_func": "uapi_key_ioctl_method"}, "warn_no": 2}]},
{"num_warnings": 3,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}],
"warnings":[{"warn_data": {"at_line": 440, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i != num_attrs; i++) {", "inst_trace": [{"instr_func": "ib_uverbs_ioctl", "instr_loc": 632, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = copy_from_user(&hdr, user_hdr, sizeof(hdr));"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 612, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"instr_func": "ib_uverbs_cmd_verbs", "instr_loc": 612, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 420, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 440, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "for (i = 0; i != num_attrs; i++) {"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 440, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "for (i = 0; i != num_attrs; i++) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ib_uverbs_run_method"}, "warn_no": 1},
{"warn_data": {"at_line": 437, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "ib_uverbs_run_method"}, "warn_no": 2},
{"warn_data": {"at_line": 442, "warn_str": "Loop is bounded by a tainted value.", "at": "if (unlikely(ret))", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "PTR_ERR.2950", "instr_loc": 30, "instr_file": "./include/linux/err.h", "instr": "  store i8* %0, i8** %2, align 8"}, {"instr_func": "PTR_ERR.2950", "instr_loc": 31, "instr_file": "./include/linux/err.h", "instr": "  %3 = load i8*, i8** %2, align 8, !dbg !545962"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 354, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 411, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return ret;"}, {"instr_func": "uverbs_set_attr", "instr_loc": 411, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return ret;"}, {"instr_func": "uverbs_set_attr", "instr_loc": 416, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 441, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 441, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 442, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(ret))"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "ib_uverbs_run_method"}, "warn_no": 3}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}],
"warnings":[{"warn_data": {"at_line": 403, "warn_str": "Trying to read from a user pointer.", "at": "attr = rcu_dereference_protected(*slot, true);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_set_attr"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 387, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}],
"warnings":[{"warn_data": {"at_line": 277, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %11 = add i32 %10, 1, !dbg !545967", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "IntegerOverflowDetector says:", "at_func": "uapi_key_attr.2953"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 388, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}],
"warnings":[{"warn_data": {"at_line": 307, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %4 = sub i32 %3, 1, !dbg !545962", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "IntegerOverflowDetector says:", "at_func": "uapi_bkey_attr.2954"}, "warn_no": 1}]},
{"num_warnings": 4,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 393, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}],
"warnings":[{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "void *entry;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_attr_for_method"}, "warn_no": 1},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "void *entry;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_attr_for_method"}, "warn_no": 2},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "void *entry;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_attr_for_method"}, "warn_no": 3},
{"warn_data": {"at_line": 372, "warn_str": "Trying to read from a user pointer.", "at": "void *entry;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 375, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "entry = rcu_dereference_raw(*slot);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 372, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "void *entry;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uapi_get_attr_for_method"}, "warn_no": 4}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 406, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (test_bit(attr_bkey, pbundle->bundle.attr_present))"}],
"warnings":[{"warn_data": {"at_line": 238, "warn_str": "Trying to read from a user pointer.", "at": "  %28 = load volatile i64, i64* %27, align 8, !dbg !545990", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 406, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (test_bit(attr_bkey, pbundle->bundle.attr_present))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 406, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (test_bit(attr_bkey, pbundle->bundle.attr_present))"}, {"instr_func": "test_bit.2955", "instr_loc": 236, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %0, i64* %8, align 8"}, {"instr_func": "test_bit.2955", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %19 = load i64, i64* %8, align 8, !dbg !545986"}, {"instr_func": "test_bit.2955", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  store i64 %19, i64* %6, align 8"}, {"instr_func": "test_bit.2955", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %25 = load i64, i64* %6, align 8, !dbg !545991"}, {"instr_func": "test_bit.2955", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %26 = ashr i64 %25, 6, !dbg !545992"}, {"instr_func": "test_bit.2955", "instr_loc": 238, "instr_file": "./include/asm-generic/bitops-instrumented.h", "instr": "  %27 = getelementptr i64, i64* %24, i64 %26, !dbg !545990"}], "at_file": "./include/asm-generic/bitops-instrumented.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "test_bit.2955"}, "warn_no": 1}]},
{"num_warnings": 27,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 409, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}],
"warnings":[{"warn_data": {"at_line": 252, "warn_str": "Trying to read from a user pointer.", "at": "switch (spec->type) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 252, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "switch (spec->type) {"}, {"instr_func": "uverbs_process_attr", "instr_loc": 252, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "switch (spec->type) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 1},
{"warn_data": {"at_line": 328, "warn_str": "Trying to read from a user pointer.", "at": "spec->u.obj.obj_type, spec->u.obj.access,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 2},
{"warn_data": {"at_line": 319, "warn_str": "Trying to write to a user pointer.", "at": "o_attr->attr_elm = attr_uapi;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 319, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr->attr_elm = attr_uapi;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 319, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr->attr_elm = attr_uapi;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 3},
{"warn_data": {"at_line": 328, "warn_str": "Trying to read from a user pointer.", "at": "spec->u.obj.obj_type, spec->u.obj.access,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 328, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u.obj.obj_type, spec->u.obj.access,"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 4},
{"warn_data": {"at_line": 330, "warn_str": "Trying to read from a user pointer.", "at": "if (IS_ERR(o_attr->uobject))", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 330, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(o_attr->uobject))"}, {"instr_func": "uverbs_process_attr", "instr_loc": 330, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(o_attr->uobject))"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 5},
{"warn_data": {"at_line": 327, "warn_str": "Trying to write to a user pointer.", "at": "o_attr->uobject = uverbs_get_uobject_from_file(", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 327, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr->uobject = uverbs_get_uobject_from_file("}, {"instr_func": "uverbs_process_attr", "instr_loc": 327, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr->uobject = uverbs_get_uobject_from_file("}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 6},
{"warn_data": {"at_line": 334, "warn_str": "Trying to read from a user pointer.", "at": "if (spec->u.obj.access == UVERBS_ACCESS_NEW) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 334, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (spec->u.obj.access == UVERBS_ACCESS_NEW) {"}, {"instr_func": "uverbs_process_attr", "instr_loc": 334, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (spec->u.obj.access == UVERBS_ACCESS_NEW) {"}, {"instr_func": "uverbs_process_attr", "instr_loc": 334, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (spec->u.obj.access == UVERBS_ACCESS_NEW) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 7},
{"warn_data": {"at_line": 336, "warn_str": "Trying to read from a user pointer.", "at": "s64 id = o_attr->uobject->id;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 336, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "s64 id = o_attr->uobject->id;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 336, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "s64 id = o_attr->uobject->id;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 8},
{"warn_data": {"at_line": 336, "warn_str": "Trying to read from a user pointer.", "at": "s64 id = o_attr->uobject->id;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 336, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "s64 id = o_attr->uobject->id;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 336, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "s64 id = o_attr->uobject->id;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 336, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "s64 id = o_attr->uobject->id;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 9},
{"warn_data": {"at_line": 331, "warn_str": "Trying to read from a user pointer.", "at": "return PTR_ERR(o_attr->uobject);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 318, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "o_attr = &e->obj_attr;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 331, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(o_attr->uobject);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 10},
{"warn_data": {"at_line": 260, "warn_str": "Trying to read from a user pointer.", "at": "val_spec = &spec->u2.enum_def.ids[uattr->attr_data.enum_data.elem_id];", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 260, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "val_spec = &spec->u2.enum_def.ids[uattr->attr_data.enum_data.elem_id];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 260, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "val_spec = &spec->u2.enum_def.ids[uattr->attr_data.enum_data.elem_id];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 260, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "val_spec = &spec->u2.enum_def.ids[uattr->attr_data.enum_data.elem_id];"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 11},
{"warn_data": {"at_line": 254, "warn_str": "Trying to read from a user pointer.", "at": "if (uattr->attr_data.enum_data.elem_id >= spec->u.enum_def.num_elems)", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 254, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->attr_data.enum_data.elem_id >= spec->u.enum_def.num_elems)"}, {"instr_func": "uverbs_process_attr", "instr_loc": 254, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->attr_data.enum_data.elem_id >= spec->u.enum_def.num_elems)"}, {"instr_func": "uverbs_process_attr", "instr_loc": 254, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->attr_data.enum_data.elem_id >= spec->u.enum_def.num_elems)"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 12},
{"warn_data": {"at_line": 263, "warn_str": "Trying to read from a user pointer.", "at": "if (val_spec->type != UVERBS_ATTR_TYPE_PTR_IN)", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 263, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->type != UVERBS_ATTR_TYPE_PTR_IN)"}, {"instr_func": "uverbs_process_attr", "instr_loc": 263, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->type != UVERBS_ATTR_TYPE_PTR_IN)"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 13},
{"warn_data": {"at_line": 266, "warn_str": "Trying to write to a user pointer.", "at": "e->ptr_attr.enum_id = uattr->attr_data.enum_data.elem_id;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 266, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.enum_id = uattr->attr_data.enum_data.elem_id;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 266, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.enum_id = uattr->attr_data.enum_data.elem_id;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 266, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.enum_id = uattr->attr_data.enum_data.elem_id;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 14},
{"warn_data": {"at_line": 274, "warn_str": "Trying to read from a user pointer.", "at": "if (uattr->len > val_spec->u.ptr.len &&", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 274, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len > val_spec->u.ptr.len &&"}, {"instr_func": "uverbs_process_attr", "instr_loc": 274, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len > val_spec->u.ptr.len &&"}, {"instr_func": "uverbs_process_attr", "instr_loc": 274, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len > val_spec->u.ptr.len &&"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 15},
{"warn_data": {"at_line": 275, "warn_str": "Trying to read from a user pointer.", "at": "val_spec->zero_trailing &&", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %23 = load i32, i32* %3, align 4, !dbg !545983"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %24 = shl i32 %23, 1, !dbg !545984"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %25 = or i32 %24, 1, !dbg !545985"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 284, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %25, i32* %3, align 4, !dbg !545986"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 275, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "val_spec->zero_trailing &&"}, {"instr_func": "uverbs_process_attr", "instr_loc": 275, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "val_spec->zero_trailing &&"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 16},
{"warn_data": {"at_line": 276, "warn_str": "Trying to read from a user pointer.", "at": "!uverbs_is_attr_cleared(uattr, val_spec->u.ptr.len))", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 276, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "!uverbs_is_attr_cleared(uattr, val_spec->u.ptr.len))"}, {"instr_func": "uverbs_process_attr", "instr_loc": 276, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "!uverbs_is_attr_cleared(uattr, val_spec->u.ptr.len))"}, {"instr_func": "uverbs_process_attr", "instr_loc": 276, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "!uverbs_is_attr_cleared(uattr, val_spec->u.ptr.len))"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 17},
{"warn_data": {"at_line": 281, "warn_str": "Trying to read from a user pointer.", "at": "if (uattr->len < val_spec->u.ptr.min_len ||", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 281, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len < val_spec->u.ptr.min_len ||"}, {"instr_func": "uverbs_process_attr", "instr_loc": 281, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len < val_spec->u.ptr.min_len ||"}, {"instr_func": "uverbs_process_attr", "instr_loc": 281, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (uattr->len < val_spec->u.ptr.min_len ||"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 18},
{"warn_data": {"at_line": 282, "warn_str": "Trying to read from a user pointer.", "at": "(!val_spec->zero_trailing &&", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 282, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "(!val_spec->zero_trailing &&"}, {"instr_func": "uverbs_process_attr", "instr_loc": 282, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "(!val_spec->zero_trailing &&"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 19},
{"warn_data": {"at_line": 283, "warn_str": "Trying to read from a user pointer.", "at": "uattr->len > val_spec->u.ptr.len))", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 283, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uattr->len > val_spec->u.ptr.len))"}, {"instr_func": "uverbs_process_attr", "instr_loc": 283, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uattr->len > val_spec->u.ptr.len))"}, {"instr_func": "uverbs_process_attr", "instr_loc": 283, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uattr->len > val_spec->u.ptr.len))"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 20},
{"warn_data": {"at_line": 286, "warn_str": "Trying to read from a user pointer.", "at": "if (spec->type != UVERBS_ATTR_TYPE_ENUM_IN &&", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 286, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (spec->type != UVERBS_ATTR_TYPE_ENUM_IN &&"}, {"instr_func": "uverbs_process_attr", "instr_loc": 286, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (spec->type != UVERBS_ATTR_TYPE_ENUM_IN &&"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 21},
{"warn_data": {"at_line": 290, "warn_str": "Trying to write to a user pointer.", "at": "e->ptr_attr.uattr_idx = uattr - pbundle->uattrs;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 290, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.uattr_idx = uattr - pbundle->uattrs;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 290, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.uattr_idx = uattr - pbundle->uattrs;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 290, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.uattr_idx = uattr - pbundle->uattrs;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 22},
{"warn_data": {"at_line": 291, "warn_str": "Trying to write to a user pointer.", "at": "e->ptr_attr.len = uattr->len;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 291, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.len = uattr->len;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 291, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.len = uattr->len;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 291, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.len = uattr->len;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 23},
{"warn_data": {"at_line": 293, "warn_str": "Trying to read from a user pointer.", "at": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 247, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 249, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *val_spec = spec;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 293, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {"}, {"instr_func": "uverbs_process_attr", "instr_loc": 293, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 24},
{"warn_data": {"at_line": 300, "warn_str": "Trying to write to a user pointer.", "at": "e->ptr_attr.ptr = p;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 300, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.ptr = p;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 300, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.ptr = p;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 300, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.ptr = p;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 25},
{"warn_data": {"at_line": 300, "warn_str": "Non-constant size used in copy_to(or from)_user function.", "at": "e->ptr_attr.ptr = p;", "inst_trace": [], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedSizeDetector says:", "at_func": "uverbs_process_attr"}, "warn_no": 26},
{"warn_data": {"at_line": 306, "warn_str": "Trying to write to a user pointer.", "at": "e->ptr_attr.data = uattr->data;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 306, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.data = uattr->data;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 306, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.data = uattr->data;"}, {"instr_func": "uverbs_process_attr", "instr_loc": 306, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "e->ptr_attr.data = uattr->data;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_attr"}, "warn_no": 27}]},
{"num_warnings": 18,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 409, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"lineno": 346, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}],
"warnings":[{"warn_data": {"at_line": 181, "warn_str": "Trying to read from a user pointer.", "at": "if (array_len < spec->u2.objs_arr.min_len ||", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 181, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (array_len < spec->u2.objs_arr.min_len ||"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 181, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (array_len < spec->u2.objs_arr.min_len ||"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 181, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (array_len < spec->u2.objs_arr.min_len ||"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 1},
{"warn_data": {"at_line": 182, "warn_str": "Trying to read from a user pointer.", "at": "array_len > spec->u2.objs_arr.max_len)", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 182, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len > spec->u2.objs_arr.max_len)"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 182, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len > spec->u2.objs_arr.max_len)"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 182, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len > spec->u2.objs_arr.max_len)"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 2},
{"warn_data": {"at_line": 185, "warn_str": "Trying to write to a user pointer.", "at": "attr->uobjects =", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 185, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects ="}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 185, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects ="}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 3},
{"warn_data": {"at_line": 188, "warn_str": "Trying to read from a user pointer.", "at": "if (IS_ERR(attr->uobjects))", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 188, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects))"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 188, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects))"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 4},
{"warn_data": {"at_line": 197, "warn_str": "Trying to read from a user pointer.", "at": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 5},
{"warn_data": {"at_line": 197, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "IntegerOverflowDetector says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 6},
{"warn_data": {"at_line": 210, "warn_str": "Trying to read from a user pointer.", "at": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 7},
{"warn_data": {"at_line": 210, "warn_str": "Trying to read from a user pointer.", "at": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 368, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 374, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = pbundle->radix_slots + attr_key;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 377, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return slot;"}, {"instr_func": "uapi_get_attr_for_method", "instr_loc": 382, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "}"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 393, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "slot = uapi_get_attr_for_method(pbundle, attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 403, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr = rcu_dereference_protected(*slot, true);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 168, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "const struct uverbs_attr_spec *spec = &attr_uapi->spec;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 210, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "spec->u2.objs_arr.obj_type, spec->u2.objs_arr.access,"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 8},
{"warn_data": {"at_line": 211, "warn_str": "Trying to read from a user pointer.", "at": "idr_vals[i], &pbundle->bundle);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 197, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals = (u32 *)(attr->uobjects + array_len) - array_len;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 211, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals[i], &pbundle->bundle);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 211, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "idr_vals[i], &pbundle->bundle);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 9},
{"warn_data": {"at_line": 209, "warn_str": "Trying to read from a user pointer.", "at": "attr->uobjects[i] = uverbs_get_uobject_from_file(", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 209, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects[i] = uverbs_get_uobject_from_file("}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 209, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects[i] = uverbs_get_uobject_from_file("}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 10},
{"warn_data": {"at_line": 209, "warn_str": "Trying to write to a user pointer.", "at": "attr->uobjects[i] = uverbs_get_uobject_from_file(", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 209, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects[i] = uverbs_get_uobject_from_file("}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 209, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects[i] = uverbs_get_uobject_from_file("}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 209, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->uobjects[i] = uverbs_get_uobject_from_file("}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 11},
{"warn_data": {"at_line": 212, "warn_str": "Trying to read from a user pointer.", "at": "if (IS_ERR(attr->uobjects[i])) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 212, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects[i])) {"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 212, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects[i])) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 12},
{"warn_data": {"at_line": 212, "warn_str": "Trying to read from a user pointer.", "at": "if (IS_ERR(attr->uobjects[i])) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 212, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects[i])) {"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 212, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects[i])) {"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 212, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (IS_ERR(attr->uobjects[i])) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 13},
{"warn_data": {"at_line": 208, "warn_str": "Loop is bounded by a tainted value.", "at": "for (i = 0; i != array_len; i++) {", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 180, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "array_len = uattr->len / sizeof(u32);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 208, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "for (i = 0; i != array_len; i++) {"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 208, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "for (i = 0; i != array_len; i++) {"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedLoopBoundDetector says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 14},
{"warn_data": {"at_line": 213, "warn_str": "Trying to read from a user pointer.", "at": "ret = PTR_ERR(attr->uobjects[i]);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %10 = load i32, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %11 = add i32 %10, 1, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 277, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %11, i32* %3, align 4, !dbg !545967"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 213, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = PTR_ERR(attr->uobjects[i]);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 213, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = PTR_ERR(attr->uobjects[i]);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 15},
{"warn_data": {"at_line": 213, "warn_str": "Trying to read from a user pointer.", "at": "ret = PTR_ERR(attr->uobjects[i]);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 213, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = PTR_ERR(attr->uobjects[i]);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 213, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = PTR_ERR(attr->uobjects[i]);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 213, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = PTR_ERR(attr->uobjects[i]);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 16},
{"warn_data": {"at_line": 218, "warn_str": "Trying to write to a user pointer.", "at": "attr->len = i;", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 218, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->len = i;"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 218, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "attr->len = i;"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 17},
{"warn_data": {"at_line": 189, "warn_str": "Trying to read from a user pointer.", "at": "return PTR_ERR(attr->uobjects);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %8 = load i32, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %9 = and i32 %8, -4097, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 276, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %9, i32* %3, align 4, !dbg !545965"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 347, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "&e->objs_arr_attr, uattr,"}, {"instr_func": "uverbs_process_attr", "instr_loc": 346, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return uverbs_process_idrs_array(pbundle, attr_uapi,"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 167, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 189, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(attr->uobjects);"}, {"instr_func": "uverbs_process_idrs_array", "instr_loc": 189, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "return PTR_ERR(attr->uobjects);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_process_idrs_array"}, "warn_no": 18}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 409, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"lineno": 276, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "!uverbs_is_attr_cleared(uattr, val_spec->u.ptr.len))"}],
"warnings":[{"warn_data": {"at_line": 144, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "0, uattr->len - len);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_is_attr_cleared", "instr_loc": 144, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "0, uattr->len - len);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "IntegerOverflowDetector says:", "at_func": "uverbs_is_attr_cleared"}, "warn_no": 1},
{"warn_data": {"at_line": 141, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "uattr->len - len);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_is_attr_cleared", "instr_loc": 141, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uattr->len - len);"}], "at_file": "drivers/infiniband/core/uverbs_ioctl.c", "by": "IntegerOverflowDetector says:", "at_func": "uverbs_is_attr_cleared"}, "warn_no": 2}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 441, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_set_attr(pbundle, &pbundle->uattrs[i]);"}, {"lineno": 409, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"lineno": 293, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {"}],
"warnings":[{"warn_data": {"at_line": 789, "warn_str": "Trying to read from a user pointer.", "at": "  %7 = load i16, i16* %6, align 8, !dbg !545965", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 268, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %3, align 4"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %16 = load i32, i32* %3, align 4, !dbg !545973"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %17 = shl i32 %16, 1, !dbg !545974"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 280, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %17, i32* %3, align 4, !dbg !545975"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %27 = load i32, i32* %3, align 4, !dbg !545987"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 287, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %27, i32* %2, align 4, !dbg !545988"}, {"instr_func": "uapi_key_attr.2953", "instr_loc": 288, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %29 = load i32, i32* %2, align 4, !dbg !545989"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 387, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_key = uapi_key_attr(uattr->attr_id);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 306, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store i32 %0, i32* %2, align 4"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load i32, i32* %2, align 4, !dbg !545961"}, {"instr_func": "uapi_bkey_attr.2954", "instr_loc": 307, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = sub i32 %3, 1, !dbg !545962"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 388, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "u32 attr_bkey = uapi_bkey_attr(attr_key);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_set_attr", "instr_loc": 409, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uverbs_process_attr(pbundle, attr, uattr, attr_bkey);"}, {"instr_func": "uverbs_process_attr", "instr_loc": 246, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "{"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 248, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "struct uverbs_attr *e = &pbundle->bundle.attrs[attr_bkey];"}, {"instr_func": "uverbs_process_attr", "instr_loc": 293, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {"}, {"instr_func": "uverbs_process_attr", "instr_loc": 293, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (val_spec->alloc_and_copy && !uverbs_attr_ptr_is_inline(e)) {"}, {"instr_func": "uverbs_attr_ptr_is_inline", "instr_loc": 788, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  store %struct.uverbs_attr* %0, %struct.uverbs_attr** %2, align 8"}, {"instr_func": "uverbs_attr_ptr_is_inline", "instr_loc": 789, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %3 = load %struct.uverbs_attr*, %struct.uverbs_attr** %2, align 8, !dbg !545963"}, {"instr_func": "uverbs_attr_ptr_is_inline", "instr_loc": 789, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %4 = getelementptr inbounds %struct.uverbs_attr, %struct.uverbs_attr* %3, i32 0, i32 0, !dbg !545964"}, {"instr_func": "uverbs_attr_ptr_is_inline", "instr_loc": 789, "instr_file": "./include/rdma/uverbs_ioctl.h", "instr": "  %6 = getelementptr inbounds %struct.uverbs_ptr_attr, %struct.uverbs_ptr_attr* %5, i32 0, i32 1, !dbg !545965"}], "at_file": "./include/rdma/uverbs_ioctl.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_attr_ptr_is_inline"}, "warn_no": 1}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 447, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(!bitmap_subset(pbundle->method_elm->attr_mandatory,"}],
"warnings":[{"warn_data": {"at_line": 337, "warn_str": "Potential overflow, using tainted value in binary operation.", "at": "  %27 = sub i32 0, %26, !dbg !545975", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 447, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(!bitmap_subset(pbundle->method_elm->attr_mandatory,"}, {"instr_func": "ib_uverbs_run_method", "instr_loc": 447, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (unlikely(!bitmap_subset(pbundle->method_elm->attr_mandatory,"}, {"instr_func": "bitmap_subset", "instr_loc": 335, "instr_file": "./include/linux/bitmap.h", "instr": "  store i32 %2, i32* %7, align 4"}, {"instr_func": "bitmap_subset", "instr_loc": 337, "instr_file": "./include/linux/bitmap.h", "instr": "  %26 = load i32, i32* %7, align 4, !dbg !545975"}], "at_file": "./include/linux/bitmap.h", "by": "IntegerOverflowDetector says:", "at_func": "bitmap_subset"}, "warn_no": 1}]},
{"num_warnings": 6,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 463, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uobj_destroy(destroy_attr->uobject, &pbundle->bundle);"}, {"lineno": 212, "file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uverbs_destroy_uobject(uobj, RDMA_REMOVE_DESTROY, attrs);"}],
"warnings":[{"warn_data": {"at_line": 139, "warn_str": "Trying to read from a user pointer.", "at": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 139, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 139, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 1},
{"warn_data": {"at_line": 139, "warn_str": "Trying to read from a user pointer.", "at": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 139, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 139, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 139, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uobj->uapi_object->type_class->destroy_hw(uobj, reason,"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 2},
{"warn_data": {"at_line": 157, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->alloc_abort(uobj);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 157, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->alloc_abort(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 157, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->alloc_abort(uobj);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 3},
{"warn_data": {"at_line": 157, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->alloc_abort(uobj);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 157, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->alloc_abort(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 157, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->alloc_abort(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 157, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->alloc_abort(uobj);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 4},
{"warn_data": {"at_line": 170, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->remove_handle(uobj);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->remove_handle(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->remove_handle(uobj);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 5},
{"warn_data": {"at_line": 170, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->remove_handle(uobj);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->remove_handle(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->remove_handle(uobj);"}, {"instr_func": "uverbs_destroy_uobject", "instr_loc": 170, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->remove_handle(uobj);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "uverbs_destroy_uobject"}, "warn_no": 6}]},
{"num_warnings": 1,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 463, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = uobj_destroy(destroy_attr->uobject, &pbundle->bundle);"}, {"lineno": 212, "file": "drivers/infiniband/core/rdma_core.c", "instr": "ret = uverbs_destroy_uobject(uobj, RDMA_REMOVE_DESTROY, attrs);"}, {"lineno": 142, "file": "drivers/infiniband/core/rdma_core.c", "instr": "if (ib_is_destroy_retryable(ret, reason, uobj))"}],
"warnings":[{"warn_data": {"at_line": 2813, "warn_str": "Trying to read from a user pointer.", "at": "  %19 = load i8, i8* %18, align 1, !dbg !545972", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "ib_is_destroy_retryable", "instr_loc": 2813, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %17 = load %struct.ib_ucontext*, %struct.ib_ucontext** %16, align 8, !dbg !545971"}, {"instr_func": "ib_is_destroy_retryable", "instr_loc": 2813, "instr_file": "./include/rdma/ib_verbs.h", "instr": "  %18 = getelementptr inbounds %struct.ib_ucontext, %struct.ib_ucontext* %17, i32 0, i32 3, !dbg !545972"}], "at_file": "./include/rdma/ib_verbs.h", "by": "TaintedPointerDereferenceChecker says:", "at_func": "ib_is_destroy_retryable"}, "warn_no": 1}]},
{"num_warnings": 2,
"context":[{"lineno": -1, "instr": "  %4 = alloca i8*, align 8"}, {"lineno": 644, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "err = ib_uverbs_cmd_verbs(file, &hdr, user_hdr->attrs);"}, {"lineno": 612, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "ret = ib_uverbs_run_method(pbundle, hdr->num_attrs);"}, {"lineno": 469, "file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "uobj_put_destroy(destroy_attr->uobject);"}, {"lineno": 91, "file": "./include/rdma/uverbs_std_types.h", "instr": "  call void bitcast (void (%struct.ib_uobject*, i32)* @rdma_lookup_put_uobject to void (%struct.ib_uobject.28590*, i32)*)(%struct.ib_uobject.28590* %3, i32 1) #16, !dbg !545960"}],
"warnings":[{"warn_data": {"at_line": 692, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->lookup_put(uobj, mode);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "rdma_lookup_put_uobject", "instr_loc": 692, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->lookup_put(uobj, mode);"}, {"instr_func": "rdma_lookup_put_uobject", "instr_loc": 692, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->lookup_put(uobj, mode);"}, {"instr_func": "rdma_lookup_put_uobject", "instr_loc": 692, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->lookup_put(uobj, mode);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_lookup_put_uobject"}, "warn_no": 1},
{"warn_data": {"at_line": 692, "warn_str": "Trying to read from a user pointer.", "at": "uobj->uapi_object->type_class->lookup_put(uobj, mode);", "inst_trace": [{"instr_func": "ib_uverbs_run_method", "instr_loc": 437, "instr_file": "drivers/infiniband/core/uverbs_ioctl.c", "instr": "if (copy_from_user(pbundle->uattrs, pbundle->user_attrs, uattrs_size))"}, {"instr_func": "rdma_lookup_put_uobject", "instr_loc": 692, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->lookup_put(uobj, mode);"}, {"instr_func": "rdma_lookup_put_uobject", "instr_loc": 692, "instr_file": "drivers/infiniband/core/rdma_core.c", "instr": "uobj->uapi_object->type_class->lookup_put(uobj, mode);"}], "at_file": "drivers/infiniband/core/rdma_core.c", "by": "TaintedPointerDereferenceChecker says:", "at_func": "rdma_lookup_put_uobject"}, "warn_no": 2}]}]}